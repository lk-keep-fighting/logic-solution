"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[874],{19435:function(ie,j,e){e.d(j,{O:function(){return re},A:function(){return b.Z}});var b=e(28576),P=e(54306),u=e.n(P),D=e(8049),M=e(14990),h=e(22465),A=e(5671),T=e(17696),I=e(19227),C=e(75476),N=e(1167),J=e(22150),O=e(40767),m=e(38243),v=e(58856),L=e(22983),p=e(39092),y=e(75904),F=e(18725),i=e(87363),R=e.n(i),f=e(10486),B=e(14232),d=e(37555),x=e(59998),le=e(72107),se=e(88287),ae=e(23620),t=e(33130),Me=R().createContext({logic:new le.Iz("")}),de=function(a){var U,ue=(0,i.useState)(),H=u()(ue,2),n=H[0],ce=H[1],ge=(0,i.useState)(),G=u()(ge,2),S=G[0],ve=G[1],fe=(0,i.useState)(!1),Y=u()(fe,2),Te=Y[0],Ne=Y[1],he=(0,i.useState)(!0),V=u()(he,2),Z=V[0],W=V[1],me=(0,i.useState)(),Q=u()(me,2),K=Q[0],X=Q[1],xe=(0,i.useState)(),k=u()(xe,2),c=k[0],Se=k[1],Ee=(0,i.useState)(),_=u()(Ee,2),$=_[0],Ce=_[1],Le=(0,i.useState)(),w=u()(Le,2),ye=w[0],q=w[1],je=(0,i.useState)(),ee=u()(je,2),Pe=ee[0],De=ee[1],te=(0,i.useRef)(),ne=function(g){var s=g.node;q(s);var o=c==null?void 0:c.itemLogs.find(function(r){return r.config.id==s.id});X(o)};(0,i.useEffect)(function(){$&&(n==null||n.centerCell($))},[$,n]),(0,i.useEffect)(function(){console.log("play curItemLog",K)},[K]),(0,i.useEffect)(function(){var l=n==null?void 0:n.getNodes().find(function(g){return g.id==a.nextId});l==null||l.attr("body/fill","red"),Ce(l)},[a.nextId]),(0,i.useEffect)(function(){var l;n==null||(l=n.getNodes().find(function(g){return g.id==a.nextId}))===null||l===void 0||l.attr("body/fill","red")},[n]),(0,i.useEffect)(function(){a.config&&ve(a.config)},[a.config]),(0,i.useEffect)(function(){var l,g;console.log("props.debugLogs",a.debugLogs),((l=a.debugLogs)===null||l===void 0?void 0:l.length)>0&&setInterval(Ie,2e3);var s=[];a&&((g=a.debugLogs)===null||g===void 0||g.forEach(function(o){var r,E;s.push({children:(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("span",{style:{cursor:"pointer",fontWeight:o.id==(c==null?void 0:c.id)?"bolder":"normal",color:o.id==(c==null?void 0:c.id)?"#52c41a":"black"},onClick:function(){Se(o),console.log(o),n==null||n.fromJSON(S==null?void 0:S.visualConfig);var oe;o.itemLogs.forEach(function(Ze){var z=n==null?void 0:n.getNodes().find(function(be){return be.id==Ze.config.id});z&&(z.attr("body/fill","#52c41a"),oe=z)}),n==null||n.centerCell(oe),X({}),q({})},children:[(0,t.jsx)("p",{children:(r=o.itemLogs[0])===null||r===void 0?void 0:r.config.name}),((E=a.logicIns)===null||E===void 0?void 0:E.version)==o.version?(0,t.jsx)("p",{}):(0,t.jsx)("p",{children:(0,t.jsxs)(O.Z,{children:[(0,t.jsx)(m.Z.Paragraph,{style:{color:"red"},children:"\u7248\u672C\u53F7:"}),(0,t.jsxs)(m.Z.Paragraph,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F!"],text:o.version},children:[o.version,(0,t.jsx)(m.Z.Link,{style:{margin:"5px"},href:"#/assets/logic/i/".concat(o.logicId,"/view/").concat(o.version),target:"_blank",children:(0,t.jsx)(D.Z,{})})]})]})}),(0,t.jsxs)("p",{children:["\u4E1A\u52A1\u6807\u8BC6\uFF1A",o.bizId]}),(0,t.jsx)("p",{children:o.serverTime}),(0,t.jsx)("p",{children:o.message})]})}),color:o.success?"green":"red"})})),De(s)},[a.debugLogs,a.logicIns,n,c]),(0,i.useEffect)(function(){if(S){try{var l=(0,f.K)(),g=l.Shapes;(0,B.m)(g)}catch(o){console.error("\u6CE8\u518C\u8282\u70B9\u51FA\u9519\uFF1A"),console.error(o)}var s=new A.kJ({container:te.current,embedding:{enabled:!0,validate:function(r){return r.child.setData({hoverNode:r.parent}),!0}},mousewheel:{enabled:!0,modifiers:"ctrl",minScale:.5,maxScale:3},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:15}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,allowMulti:!0,snap:{radius:20},createEdge:function(){return new A.bn.kS({tools:[{name:"edge-editor",args:{attrs:{backgroundColor:"#fff"}}}],zIndex:0})},validateConnection:function(r){var E=r.targetMagnet;return!!E}},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5F95FF",stroke:"#5F95FF"}}}},background:{color:"#F2F7FA"},grid:!0});s.use(new N.H({enabled:!0,sharp:!0})).use(new T.A({enabled:!0})).use(new C.Y({enabled:!0,multiple:!0,strict:!0,rubberband:!0,movable:!0,showNodeSelectionBox:!0,pointerEvents:"none"})).use(new J.T({enabled:!0})).use(new I.N),s.on("edge:dblclick",function(){}),s.on("edge:mouseenter",function(){}),s.on("edge:mouseleave",function(){}),s.on("node:moved",function(){}),s.on("node:mouseenter",function(){}),s.on("node:mouseleave",function(){}),s.on("node:added",function(){}),s.on("node:dblclick",function(o){var r=o.node;W(!1)}),s.on("blank:dblclick",function(o){var r=o.x,E=o.y}),s.fromJSON(S.visualConfig),(0,x.V)(s),ce(s)}},[S]),(0,i.useEffect)(function(){n==null||n.off("node:click",ne),n==null||n.on("node:click",ne)},[c]);var Ie=function(){},Oe=[{key:"1",label:"\u65E5\u5FD7",children:(0,t.jsx)(ae.gcu,{src:K})},{key:"2",label:"\u8282\u70B9\u914D\u7F6E",children:(0,t.jsx)(se.Z,{editNode:ye,configSchemaProvider:a.configSchemaProvider})}];return(0,t.jsxs)(v.Z,{style:{margin:0,height:"100vh"},children:[(0,t.jsxs)(v.Z.Sider,{theme:"light",collapsedWidth:0,width:300,style:{overflow:"auto",height:"100vh",position:"fixed",left:0,top:0,bottom:0,borderRight:"0.5px solid"},children:[(0,t.jsx)(L.Z,{children:"\u6700\u8FD1\u8BF7\u6C42"}),(0,t.jsx)(p.Z,{style:{height:"100%"},items:Pe})]}),(0,t.jsxs)(v.Z,{style:{marginLeft:300},children:[(0,t.jsxs)(v.Z.Header,{style:{backgroundColor:"white",padding:0},children:[(0,t.jsxs)(O.Z,{direction:"horizontal",style:{},children:[(0,t.jsx)(L.Z,{type:"vertical"}),(U=a.btns)===null||U===void 0?void 0:U.map(function(l){return l})]}),(0,t.jsx)(y.ZP,{type:"text",icon:Z?(0,t.jsx)(M.Z,{}):(0,t.jsx)(h.Z,{}),onClick:function(){W(!Z)},style:{float:"right",right:"16px",fontSize:"16px",width:64,height:64}})]}),(0,t.jsx)(v.Z.Content,{className:"app-content",children:(0,t.jsx)(d.Z,{ref:te})})]}),(0,t.jsxs)(v.Z.Sider,{theme:"light",collapsed:Z,collapsedWidth:0,style:{overflow:"scroll"},title:"ddd",width:500,children:[(0,t.jsx)(y.ZP,{type:"text",onClick:function(){W(!Z)},style:{float:"right",fontSize:"16px",width:64,height:64},children:"x"}),(0,t.jsx)(F.Z,{items:Oe,defaultActiveKey:"1"})]})]})},re=de},38882:function(ie,j,e){e.r(j);var b=e(54306),P=e.n(b),u=e(19435),D=e(43702),M=e(52615),h=e(87363),A=e.n(h),T=e(98306),I=e(48364),C=e(33130),N=function(){var O=(0,T.UO)(),m=O.id,v=(0,h.useState)(),L=P()(v,2),p=L[0],y=L[1],F=(0,h.useState)(!1),i=P()(F,2),R=i[0],f=i[1],B=(0,h.useCallback)(function(d){d.id=m,f(!0),y(d),(0,I.az)(d.id,d.version,JSON.stringify(d)).then(function(x){f(!1),D.ZP.success("\u4FDD\u5B58\u6210\u529F"),console.log("save logic"),console.log(d)}).catch(function(x){f(!1),console.log("err"),console.log(x),D.ZP.error("\u4FDD\u5B58\u5931\u8D25")})},[]);return(0,h.useEffect)(function(){f(!0),(0,I.YH)(m).then(function(d){var x=d;x.id=m,y(x),f(!1)}).catch(function(d){f(!1),console.log("err"),console.log(d)})},[]),(0,C.jsx)("div",{children:(0,C.jsx)(M.Z,{spinning:R,children:(0,C.jsx)(u.A,{config:p,onSave:B})})})};j.default=N}}]);
