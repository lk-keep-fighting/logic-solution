"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[7199],{67199:function(Oe,L,m){m.r(L),m.d(L,{BaseTransferRenderer:function(){return Z},TransferRender:function(){return V},default:function(){return le},getCustomFilterOption:function(){return K}});var t=m(15767),Q=m(87363),D=m.n(Q),Y=m(33170),q=m.n(Y),ee=m(19334),te=m.n(ee),ne=m(6663),x=m(8427),r=m(42977),U=m(94391),re=m(45581),K=function(_){switch(typeof _){case"string":return(0,r.PqP)(_,"options","inputValue","option");case"function":return _;default:return null}},Z=function(_){(0,t.ZT)(i,_);function i(){return _!==null&&_.apply(this,arguments)||this}return i.prototype.reload=function(n,l){var e=this.props.reloadOptions;e&&e(n,l)},i.prototype.handleChange=function(n,l){return(0,t.mG)(this,void 0,void 0,function(){var e,a,o,u,s,p,d,O,f,w,g,E,P,C,h,S,I,A,b,c;return(0,t.Jh)(this,function(R){switch(R.label){case 0:return e=this.props,a=e.onChange,o=e.joinValues,u=e.delimiter,s=e.valueField,p=e.extractValue,d=e.options,O=e.dispatchEvent,f=e.setOptions,w=e.selectMode,g=e.deferApi,E=e.deferField,P=E===void 0?"defer":E,C=n,h=d.concat(),S=n,Array.isArray(n)?(C=n.map(function(v){var F=(0,r.L$8)(d,(0,r.IWw)(v[s||"value"],s||"value"),{resolve:(0,r.xzo)(s),value:v[s]||"value"});if(!F)h.push((0,t.pi)((0,t.pi)({},v),{visible:!1}));else if(l){var j=(0,r.IMU)(h,F);h=(0,r.o5f)(h,F,1,(0,t.pi)((0,t.pi)({},j),v))}return o||p?v[s||"value"]:v}),o&&(C=C.join(u||","))):n&&(C=o||p?n[s||"value"]:n,I=(0,r.L$8)(d,(0,r.IWw)(n[s||"value"],s||"value")),I?l&&(A=(0,r.IMU)(h,I),h=(0,r.o5f)(h,I,1,(0,t.pi)((0,t.pi)({},A),n))):h.push((0,t.pi)((0,t.pi)({},n),{visible:!1}))),b=w==="tree"&&(!!g||!!(0,r.hEs)(d,function(v){return v.deferApi||v[P]})),(b===!0||h.length>d.length||l)&&f(h,!0),[4,O("change",(0,r.vXk)(this.props,{value:C,options:d,items:d,selectedItems:S}))];case 1:return c=R.sent(),c!=null&&c.prevented?[2]:(a(C),[2])}})})},i.prototype.option2value=function(n){return n},i.prototype.getResult=function(n){var l=n.data.options||n.data.items||n.data;return l},i.prototype.handleSearch=function(n,l,e){return(0,t.mG)(this,void 0,void 0,function(){var a,o,u,s,p,d,O,f,w,g,E,P,C,h,S,I,A;return(0,t.Jh)(this,function(b){switch(b.label){case 0:if(a=this.props,o=a.searchApi,u=a.options,s=a.labelField,p=a.valueField,d=a.env,O=a.data,f=a.translate,w=a.filterOption,!o)return[3,5];b.label=1;case 1:return b.trys.push([1,3,,4]),[4,d.fetcher(o,(0,r.nW9)(O,(0,t.pi)({term:n},e||{})),{cancelExecutor:l})];case 2:if(g=b.sent(),!g.ok)throw new Error(f(g.msg||"networkError"));if(E=this.getResult(g),!Array.isArray(E))throw new Error(f("CRUD.invalidArray"));return P={},e&&(P={page:g.data.page,perPage:e.perPage,total:g.data.count}),[2,(0,t.pi)({items:(0,r.GyU)(E,function(c){var R=null,v=c[p||"value"];return Array.isArray(u)&&v!==null&&v!==void 0&&(R=q()(u,(0,r.IWw)(v,p)),c!=null&&c.children&&(R=(0,t.pi)((0,t.pi)({},R),{children:c.children}))),R||c})},P)];case 3:return C=b.sent(),!d.isCancel(C)&&!o.silent&&d.notify("error",C.message),[2,{items:[]}];case 4:return[3,6];case 5:return n?(h=s||"label",S=p||"value",I={keys:[h,S]},w?(A=K(w),A?[2,{items:A(u,n,I)}]:(d.notify("error","\u81EA\u5B9A\u4E49\u68C0\u7D22\u51FD\u6570\u4E0D\u7B26\u5408\u8981\u6C42"),[2,{items:[]}])):[2,{items:(0,r.get)(u,function(c,R,v,F){return!!(Array.isArray(c.children)&&c.children.length||(0,x.Lu)([c].concat(F),n,{keys:[s||"label",p||"value"],threshold:x.Lu.rankings.CONTAINS}).length)},0,!0)}]):[2,{items:u}];case 6:return[2]}})})},i.prototype.handleResultSearch=function(n,l){var e=this.props,a=e.valueField,o=e.labelField,u=(0,r.EvO)(n),s=l[o||"label"],p=l[a||"value"];return u.test(s)||u.test(p)},i.prototype.handlePageChange=function(n,l,e){var a=this.props,o=a.source,u=a.data,s=a.formItem,p=a.onChange,d=(0,r.nW9)(u,(0,t.pi)({page:n!=null?n:1,perPage:l!=null?l:10},e?{pageDir:e}:{}));!s||!(0,ne.fh)(s)||((0,r.SSQ)(o)?s.loadOptionsFromDataScope(o,d,p):(0,r.X1t)(o,d)&&s.loadOptions(o,d,void 0,!1,p,!1))},i.prototype.optionItemRender=function(n,l){var e=this.props,a=e.menuTpl,o=e.render,u=e.data;return o("item/".concat(l.index),a,{data:(0,r.nW9)((0,r.nW9)(u,l),n)})},i.prototype.resultItemRender=function(n,l){var e=this.props,a=e.valueTpl,o=e.render,u=e.data;return o("value/".concat(l.index),a,{onChange:l.onChange,data:(0,r.nW9)((0,r.nW9)(u,l),n)})},i.prototype.renderCell=function(n,l,e,a){var o=this.props,u=o.render,s=o.data,p=o.classnames,d=o.showInvalidMatch;return u("cell/".concat(e,"/").concat(a),(0,t.pi)({type:"text",className:p({"is-invalid":d?l==null?void 0:l.__unmatched:!1})},n),{value:(0,r.H_J)(n.name,l),data:(0,r.nW9)(s,l)})},i.prototype.getRef=function(n){for(;n&&n.getWrappedInstance;)n=n.getWrappedInstance();this.tranferRef=n},i.prototype.onSelectAll=function(n){var l=this.props,e=l.dispatchEvent,a=l.data;e("selectAll",(0,r.nW9)(a,{items:n}))},i.prototype.doAction=function(n,l,e){var a,o,u,s,p,d=this.props,O=d.resetValue,f=d.onChange,w=d.formStore,g=d.store,E=d.name;switch(n.actionType){case"clear":f==null||f("");break;case"reset":f==null||f((u=(o=(0,r.E04)((a=w==null?void 0:w.pristine)!==null&&a!==void 0?a:g==null?void 0:g.pristine,E))!==null&&o!==void 0?o:O)!==null&&u!==void 0?u:"");break;case"selectAll":(s=this.tranferRef)===null||s===void 0||s.selectAll();break;case"clearSearch":{(p=this.tranferRef)===null||p===void 0||p.clearSearch(l);break}}},i.prototype.render=function(){var n,l,e=this.props,a=e.className,o=e.style,u=e.classnames,s=e.selectedOptions,p=e.showArrow,d=e.sortable,O=e.selectMode,f=e.columns,w=e.loading,g=e.searchable,E=e.searchResultMode,P=e.searchResultColumns,C=e.deferLoad,h=e.leftMode,S=e.rightMode,I=e.disabled,A=e.selectTitle,b=e.resultTitle,c=e.menuTpl,R=e.valueTpl,v=e.searchPlaceholder,F=e.resultListModeFollowSelect,j=F===void 0?!1:F,ae=e.resultSearchPlaceholder,k=e.resultSearchable,ie=k===void 0?!1:k,oe=e.statistics,se=e.labelField,de=e.valueField,ue=e.virtualThreshold,H=e.itemHeight,G=e.loadingConfig,pe=e.showInvalidMatch,ce=e.onlyChildren,he=e.mobileUI,ve=e.noResultsText,T=e.pagination,y=e.formItem,N=e.env,W=e.popOverContainer,fe=e.data,J=e.autoCheckChildren,ge=J===void 0?!0:J,$=e.initiallyOpen,ye=$===void 0?!0:$,me=e.testIdBuilder,B=this.props,M=B.options,z=B.leftOptions,X=B.leftDefaultValue;return O==="associated"&&M&&M.length&&M[0].leftOptions&&Array.isArray(M[0].children)&&(z=M[0].leftOptions,X=(n=M[0].leftDefaultValue)!==null&&n!==void 0?n:X,M=M[0].children),D().createElement("div",{className:u("TransferControl",a)},D().createElement(U.FE0,{onlyChildren:ce,value:s,options:M,accumulatedOptions:(l=y==null?void 0:y.accumulatedOptions)!==null&&l!==void 0?l:[],disabled:I,onChange:this.handleChange,option2value:this.option2value,sortable:d,showArrow:p,selectMode:O,searchResultMode:E,searchResultColumns:P,columns:f,onSearch:g?this.handleSearch:void 0,onDeferLoad:C,leftOptions:z,leftMode:h,rightMode:S,cellRender:this.renderCell,selectTitle:A,resultTitle:b,resultListModeFollowSelect:j,onResultSearch:this.handleResultSearch,searchPlaceholder:v,resultSearchable:ie,resultSearchPlaceholder:ae,statistics:oe,labelField:se,valueField:de,optionItemRender:c?this.optionItemRender:void 0,resultItemRender:R?this.resultItemRender:void 0,onSelectAll:this.onSelectAll,onRef:this.getRef,virtualThreshold:ue,itemHeight:(0,r.He2)(H)>0?(0,r.He2)(H):void 0,loadingConfig:G,showInvalidMatch:pe,mobileUI:he,noResultsText:ve,pagination:(0,t.pi)((0,t.pi)({},te()(T,["className","layout","perPageAvailable","popOverContainerSelector"])),{enable:(T&&T.enable!==void 0?!!(typeof T.enable=="string"?(0,r.fz_)(T.enable,fe):T.enable):!!(y!=null&&y.enableSourcePagination))&&(!O||O==="list"||O==="table")&&M.length>0,maxButtons:Number.isInteger(T==null?void 0:T.maxButtons)?T.maxButtons:5,page:y==null?void 0:y.sourcePageNum,perPage:y==null?void 0:y.sourcePerPageNum,total:y==null?void 0:y.sourceTotalNum,popOverContainer:W!=null?W:N==null?void 0:N.getModalContainer}),onPageChange:this.handlePageChange,initiallyOpen:ye,autoCheckChildren:ge,testIdBuilder:me}),D().createElement(U.$jN,{overlay:!0,key:"info",loadingConfig:G,show:w}))},i.defaultProps={multiple:!0},(0,t.gn)([r.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[Object,Boolean]),(0,t.w6)("design:returntype",Promise)],i.prototype,"handleChange",null),(0,t.gn)([r.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[Object]),(0,t.w6)("design:returntype",void 0)],i.prototype,"option2value",null),(0,t.gn)([r.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[Object]),(0,t.w6)("design:returntype",void 0)],i.prototype,"getResult",null),(0,t.gn)([r.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[String,Function,Object]),(0,t.w6)("design:returntype",Promise)],i.prototype,"handleSearch",null),(0,t.gn)([r.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[String,Object]),(0,t.w6)("design:returntype",void 0)],i.prototype,"handleResultSearch",null),(0,t.gn)([r.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[Number,Number,String]),(0,t.w6)("design:returntype",void 0)],i.prototype,"handlePageChange",null),(0,t.gn)([r.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[Object,Object]),(0,t.w6)("design:returntype",void 0)],i.prototype,"optionItemRender",null),(0,t.gn)([r.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[Object,Object]),(0,t.w6)("design:returntype",void 0)],i.prototype,"resultItemRender",null),(0,t.gn)([r.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[Object,Object,Number,Number]),(0,t.w6)("design:returntype",void 0)],i.prototype,"renderCell",null),(0,t.gn)([r.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[Object]),(0,t.w6)("design:returntype",void 0)],i.prototype,"getRef",null),(0,t.gn)([r.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[Array]),(0,t.w6)("design:returntype",void 0)],i.prototype,"onSelectAll",null),(0,t.gn)([(0,re.i)(),(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[]),(0,t.w6)("design:returntype",void 0)],i.prototype,"render",null),i}(D().Component),V=function(_){(0,t.ZT)(i,_);function i(){return _!==null&&_.apply(this,arguments)||this}return i}(Z),le=(0,r.oZB)({type:"transfer"})(V)}}]);
