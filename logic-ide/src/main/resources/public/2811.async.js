"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[2811],{12119:function(R,P,t){t.d(P,{Z:function(){return e}});var p=t(25298),E=t.n(p),a=t(17069),D=t.n(a),_=t(82092),c=t.n(_),e=function(){function l(i){E()(this,l),c()(this,"_nodeConfig",void 0),c()(this,"_groups",void 0),this._nodeConfig=JSON.parse(JSON.stringify(i)),this._nodeConfig._groups&&(this._groups=this._nodeConfig._groups)}return D()(l,[{key:"getNodeConfig",value:function(){return this._nodeConfig}},{key:"getGroups",value:function(){return this._groups}},{key:"setLabel",value:function(o){this._nodeConfig.attrs&&(this._nodeConfig.attrs.text.text=o)}},{key:"setGroups",value:function(o){this._groups=o}},{key:"setConfigSchemel",value:function(o){this._nodeConfig.data?(this._nodeConfig.data.configSchema=o,this._nodeConfig.data.config={type:o}):this._nodeConfig.data={configSchema:o,config:{type:o}}}},{key:"setConfigData",value:function(o){this._nodeConfig.data?this._nodeConfig.data.config=o:this._nodeConfig.data={config:o}}}]),l}()},88195:function(R,P,t){t.d(P,{Ld:function(){return p.L},Iz:function(){return i},Du:function(){return o},dO:function(){return u},z1:function(){return s},X0:function(){return l},_w:function(){return r}});var p=t(98601),E=t(17069),a=t.n(E),D=t(25298),_=t.n(D),c=t(82092),e=t.n(c),l=a()(function m(f){_()(this,m),e()(this,"concept",void 0),e()(this,"name",void 0),e()(this,"label",void 0),e()(this,"description",void 0),e()(this,"typeAnnotation",void 0),e()(this,"required",!1),e()(this,"defaultValue",void 0),this.concept=p.L.StructureProperty,this.name=f}),i=a()(function m(f){_()(this,m),e()(this,"concept",p.L.Logic),e()(this,"schemeVersion",void 0),e()(this,"version",void 0),e()(this,"id",void 0),e()(this,"name",void 0),e()(this,"label",void 0),e()(this,"description",void 0),e()(this,"triggerType",void 0),e()(this,"log",void 0),e()(this,"cron",void 0),e()(this,"typeParams",void 0),e()(this,"params",void 0),e()(this,"returns",void 0),e()(this,"variables",void 0),e()(this,"envs",void 0),e()(this,"items",[]),e()(this,"visualConfig",void 0),this.id=f,this.schemeVersion="0.1"}),o=a()(function m(f,h){var A=this;_()(this,m),e()(this,"concept","LogicItem"),e()(this,"id",void 0),e()(this,"name",void 0),e()(this,"type",void 0),e()(this,"label",void 0),e()(this,"description",void 0),e()(this,"params",void 0),e()(this,"returns",void 0),e()(this,"envs",void 0),e()(this,"afterReturnAdaptor",void 0),e()(this,"returnAccept",void 0),e()(this,"nextId",void 0),e()(this,"endId",void 0),e()(this,"condition",void 0),e()(this,"script",void 0),e()(this,"timeout",void 0),e()(this,"branches",void 0),e()(this,"url",void 0),e()(this,"method",void 0),e()(this,"headers",void 0),e()(this,"queryParams",void 0),e()(this,"tranScope",void 0),e()(this,"body",void 0),e()(this,"setEnv",function(O){A.envs=O}),this.type=h,this.id=f}),n=null,u=a()(function m(f){_()(this,m),e()(this,"concept","Param"),e()(this,"name",void 0),e()(this,"description",void 0),e()(this,"typeAnnotation",void 0),e()(this,"required",void 0),e()(this,"defaultValue",void 0),this.name=f}),C=t(21742),b=t.n(C),w=t(83136),d=t.n(w),s=function(m){b()(h,m);var f=d()(h);function h(A){var O;return _()(this,h),O=f.call(this,A),O.concept="Return",O}return a()(h)}(u),r=function(m){b()(h,m);var f=d()(h);function h(A){var O;return _()(this,h),O=f.call(this,A),O.concept="Variable",O}return a()(h)}(u)},68784:function(R,P,t){var p=t(26068),E=t.n(p),a=t(48305),D=t.n(a),_=t(950),c=t(87363),e=t.n(c),l=t(874),i=t.n(l),o=t(66345),n=t(94391),u=t(99294),C=t(42327),b=t(3044),w=t(21644),d=t(77201),s=t(30697),r=t(12146),m=t(33627),f=t(370),h=t(62086),A=function(M){var k=(0,c.useState)({type:"page"}),I=D()(k,2),K=I[0],N=I[1],Z=(0,c.useState)(),B=D()(Z,2),z=B[0],V=B[1],Y=(0,c.useState)(),S=D()(Y,2),X=S[0],F=S[1],L="cxd",W="zh-CN";(0,c.useEffect)(function(){(0,r.m)(_.Z)},[]),(0,c.useEffect)(function(){M.pageId&&((0,u.UD)(M.pageId).then(function(U){N(U)}),f.S.getEnvJson().then(function(U){V(JSON.parse(m.j.getEnv()))}))},[M.pageId]);var J=function(v,T){console.log("broadcast:",v,T),M.onBroadcast&&M.onBroadcast(v,T.data)};return(0,h.jsxs)("div",{children:[(0,h.jsx)(n.qRY,{theme:L,position:"top-right",locale:W},"toast"),(0,h.jsx)(n.wxo,{theme:L,locale:W},"alert"),(0,o.sYA)(K,{data:E()({envs:z},M.data),onBroadcast:J},{fetcher:function(v){var T=v.url,x=v.method,y=v.data,j=v.responseType,g=v.config,G=v.headers;return M.data&&M.data.runtime&&(T="/api/ide/papi/".concat(M.data.runtime).concat(T)),g=g||{},g.withCredentials=!0,j&&(g.responseType=j),g.cancelExecutor&&(g.cancelToken=new _.Z.CancelToken(g.cancelExecutor)),g.headers=G||{},g.headers.Authorization||(g.headers.Authorization="Bearer "+s.F.getTokenFormLocal()),x!=="post"&&x!=="put"&&x!=="patch"?(y&&(g.params=y),_.Z[x](T,g)):(y&&y instanceof FormData?(g.headers=g.headers||{},g.headers["Content-Type"]="multipart/form-data"):y&&typeof y!="string"&&!(y instanceof Blob)&&!(y instanceof ArrayBuffer)&&(y=JSON.stringify(y),g.headers=g.headers||{},g.headers["Content-Type"]="application/json"),_.Z[x](T,y,g))},isCancel:function(v){return _.Z.isCancel(v)},copy:function(v){i()(v),n.Amu.success("\u5185\u5BB9\u5DF2\u590D\u5236\u5230\u7C98\u8D34\u677F")},theme:L,jumpTo:function(v,T){debugger;T.blank==!0?window.open(window.location.origin+window.location.pathname+"#"+v,"_blank"):window.location.hash=v}})]})};P.Z=A},83359:function(R,P,t){t.d(P,{V:function(){return E}});var p=t(1973),E=function(_){var c,e=_.getSelectedCells(),l=[],i=[];if(e&&e.length>2){e.forEach(function(d){d.isNode()?l.push(d):i.push(d)}),c=new p.Vq({type:"dagre",begin:[l[0].getPosition().x,l[0].getPosition().y],ranker:"tight-tree",rankdir:"TB",ranksep:20,nodeSize:50,controlPoints:!0}),_.getEdges().forEach(function(d){var s=d.getSourceCellId(),r=0,m=d.getTargetCellId(),f=0;l.find(function(h){return h.id===s})&&r++,l.find(function(h){return h.id===m})&&f++,r>0&&f>0&&i.push(d)});var o=c.layout({nodes:l,edges:i}),n=o.nodes,u=n===void 0?[]:n;l.forEach(function(d){var s=u.find(function(r){return r.id===d.id});s&&(s.x-=d.size().width/2,s.y-=d.size().height/2,d.position(s.x,s.y))})}else{c=new p.Vq({type:"dagre",begin:[400,100],ranker:"network-simplex",rankdir:"TB",ranksep:20,nodeSize:50,align:"DL",controlPoints:!0}),l=_.getNodes(),i=_.getEdges();var C=c.layout({nodes:l,edges:i}),b=C.nodes,w=b===void 0?[]:b;l.forEach(function(d){var s=w.find(function(r){return r.id===d.id});s&&(s.x-=d.size().width/2,s.y-=d.size().height>40?20:d.size().height/2,d.position(s.x,s.y))})}},a=function(_,c){debugger;var e=new DagreLayout({type:"dagre",begin:[400,100],ranker:"tight-tree",rankdir:"TB",ranksep:20,nodeSize:50,controlPoints:!0}),l=e.layout({nodes:_,edges:c}),i=l.nodes,o=i===void 0?[]:i;_.forEach(function(n){var u=o.find(function(C){return C.id===n.id});u&&(u.x-=n.size().width/2,u.y-=n.size().height/2,n.position(u.x,u.y))})}},8250:function(R,P,t){t.d(P,{K:function(){return c}});var p=t(15558),E=t.n(p),a=t(15451),D=t(72920),_=t(12119);function c(e,l,i){var o=50,n=50,u=[new _.Z({shape:"wait-for-continue",width:o,height:n,ports:a.Tt,data:{config:{type:"wait-for-continue",name:"\u4EA4\u4E92\u70B9"}},_groups:["ctrl"]}),new _.Z({shape:"wait",width:o,height:n,attrs:{image:{"xlink:href":"/logic/icons/delay.svg"}},data:{config:{type:"wait",name:"\u7B49\u5F85",timeout:"2000"}},ports:a.Tt,_groups:["ctrl"]}),new _.Z({shape:"ExtSharp",width:50,height:n,label:"switch\u5224\u65AD",attrs:{image:{"xlink:href":"/logic/icons/switch.svg",width:45,x:1,y:2},body:{strokeWidth:0},text:{text:"switch\u5224\u65AD",refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"switch",name:"\u6761\u4EF6\u5224\u65AD"}},ports:a.Tt,_groups:["ctrl"]}),new _.Z({shape:"ExtSharp",width:o,height:n,attrs:{body:{strokeWidth:0},image:{"xlink:href":"/logic/icons/text.svg",width:30,x:8,y:10},text:{text:"case",refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"switch-case",name:"\u6761\u4EF6\u5206\u652F"}},ports:a.Tt,_groups:["ctrl"]}),new _.Z({shape:"ExtSharp",width:o,height:n,attrs:{body:{strokeWidth:0},image:{"xlink:href":"/logic/icons/texts.svg",width:30,x:8,y:10}},data:{config:{type:"switch-cases",name:"\u591A\u6761\u4EF6\u5206\u652F"}},ports:a.Tt,_groups:["ctrl"]}),new _.Z({shape:"ExtSharp",width:50,height:n,attrs:{body:{strokeWidth:0},image:{"xlink:href":"/logic/icons/text.svg",width:30,x:8,y:10}},data:{config:{type:"switch-default",name:"\u9ED8\u8BA4\u5206\u652F"}},ports:a.Tt,_groups:["ctrl"]}),new _.Z({shape:"http",width:100,height:n,text:"http\u8BF7\u6C42",data:{config:{type:"http",name:"http\u8BF7\u6C42",method:"POST"}},ports:a.Tt,_groups:["ctrl"]}),new _.Z({shape:"js",width:100,height:n,ports:a.Tt,imgSrc:"/logic/icons/code.svg",text:"js\u811A\u672C",data:{config:{name:"js\u811A\u672C",type:"js"}},_groups:["ctrl"]}),new _.Z({shape:"java",ports:a.Tt,width:100,height:n,attrs:{image:{"xlink:href":"/icons/java.svg",width:20,x:2,y:2},text:{text:"java\u65B9\u6CD5",fontSize:14}},text:"java\u65B9\u6CD5",data:{config:{name:"java\u65B9\u6CD5",type:"java"}},_groups:["ctrl"]}),new _.Z({shape:"sub-logic",ports:a.Tt,width:100,height:n,data:{config:{name:"\u590D\u7528\u903B\u8F91",type:"sub-logic"}},_groups:["ctrl"]}),new _.Z({shape:"ExtSharp",width:50,height:n,attrs:{image:{"xlink:href":"/logic/icons/assign-global.svg",width:30,x:8,y:10},text:{text:"\u5168\u5C40\u53D8\u91CF",refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{imgSrc:"/logic/icons/assign-global.svg",backgroundColor:"red",config:{name:"\u5168\u5C40\u53D8\u91CF",type:"assign-global"}},ports:a.Tt,_groups:["assign"]}),new _.Z({shape:"ExtSharp",width:50,height:n,attrs:{body:{strokeWidth:1,stroke:"#ff9300",fill:"#ff9300"},image:{"xlink:href":"/logic/icons/assign-local.svg",width:30,x:8,y:10},text:{text:"\u5C40\u90E8\u53D8\u91CF",refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{imgSrc:"/logic/icons/assign-local.svg",config:{name:"\u5C40\u90E8\u53D8\u91CF",type:"assign-local"}},ports:a.Tt,_groups:["assign"]})];e&&e.length>0&&Array.prototype.push.apply(u,e);var C=E()(D.C.values());return{Nodes:u,Shapes:C}}},370:function(R,P,t){t.d(P,{S:function(){return n}});var p=t(90228),E=t.n(p),a=t(87999),D=t.n(a),_=t(25298),c=t.n(_),e=t(17069),l=t.n(e),i=t(33627),o=t(72591),n=function(){function u(){c()(this,u)}return l()(u,null,[{key:"getEnvJson",value:function(){var C=D()(E()().mark(function w(){return E()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,o.U2)("/api/runtime/env").then(function(r){return r.data.data}).then(function(r){return i.j.setModel(r.UI_CONFIG_MODEL),i.j.setEnv(JSON.stringify(r)),i.j.setApiUrlPrefix(r.API_GATEWAY_PREFIX),i.j.setReryApi(r.CUSTOM_RETRY_URL),i.j.setReryApi(r.CUSTOM_RETRY_URL),r}));case 1:case"end":return s.stop()}},w)}));function b(){return C.apply(this,arguments)}return b}()},{key:"getRemoteRuntimeConfig",value:function(){var C=D()(E()().mark(function w(){return E()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,o.v_)("/api/ide/remote-runtimes").then(function(r){return r.data}).then(function(r){return console.log("remote runtimes:",r.data),i.j.setRemoteRuntimes(JSON.stringify(r.data)),r}));case 1:case"end":return s.stop()}},w)}));function b(){return C.apply(this,arguments)}return b}()}]),u}()}}]);
