"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[395],{60395:function(re,H,v){v.r(H),v.d(H,{MultiSelectControlRenderer:function(){return le},SelectControlRenderer:function(){return ne},default:function(){return U}});var n=v(15767),Q=v(87363),M=v.n(Q),$=v(84875),P=v.n($),k=v(33170),Z=v.n(k),Y=v(66292),q=v.n(Y),p=v(42977),L=v(94391),ee=v(67199),te=v(45581),U=function(f){(0,n.ZT)(l,f);function l(t){var e=f.call(this,t)||this;return e.lastTerm="",e.fetchCancel=null,e.changeValue=e.changeValue.bind(e),e.lazyloadRemote=q()(e.loadRemote.bind(e),250,{trailing:!0,leading:!1}),e.inputRef=e.inputRef.bind(e),e}return l.prototype.componentDidUpdate=function(t){var e=this.props;(0,p.X1t)(e.autoComplete,e.data)&&(0,p.rMT)(t.autoComplete,e.autoComplete,t.data,e.data)&&this.lazyloadRemote(this.lastTerm)},l.prototype.componentWillUnmount=function(){this.unHook&&this.unHook(),this.fetchCancel=null},l.prototype.inputRef=function(t){this.input=t},l.prototype.focus=function(){var t,e;this.input&&((e=(t=this.input)===null||t===void 0?void 0:t.focus)===null||e===void 0||e.call(t))},l.prototype.getValue=function(t,e){e===void 0&&(e=[]);var o=this.props,i=o.joinValues,r=o.extractValue,d=o.delimiter,a=o.multiple,s=o.valueField,c=o.options,u=t;return(Array.isArray(t)?t:t?[t]:[]).forEach(function(h){var m=Z()(c,function(C){return C[s||"value"]==h[s||"value"]});m||e.push(h)}),i?a?u=Array.isArray(t)?t.map(function(h){return h[s||"value"]}).join(d):t?t[s||"value"]:"":u=u?u[s||"value"]:"":r&&(a?u=Array.isArray(t)?t.map(function(h){return h[s||"value"]}):t?[t[s||"value"]]:[]:u=u?u[s||"value"]:""),u},l.prototype.dispatchEvent=function(t,e){return e===void 0&&(e={}),(0,n.mG)(this,void 0,void 0,function(){var o,i,r,d,a,s,c,u;return(0,n.Jh)(this,function(h){switch(h.label){case 0:return o="on"+t.charAt(0).toUpperCase()+t.slice(1),i=this.props,r=i.dispatchEvent,d=i.options,a=i.value,s=i.multiple,c=i.selectedOptions,[4,r(t,(0,p.vXk)(this.props,{options:d,items:d,value:a,selectedItems:s?c:c[0]}))];case 1:return u=h.sent(),u!=null&&u.prevented?[2]:(this.props[o](e),[2])}})})},l.prototype.changeValue=function(t){return(0,n.mG)(this,void 0,void 0,function(){var e,o,i,r,d,a,s,c,u;return(0,n.Jh)(this,function(h){switch(h.label){case 0:return e=this.props,o=e.onChange,i=e.setOptions,r=e.options,d=e.data,a=e.dispatchEvent,s=[],c=this.getValue(t,s),s.length&&i(r.concat(s)),[4,a("change",(0,p.vXk)(this.props,{value:c,options:r,items:r,selectedItems:t}))];case 1:return u=h.sent(),u!=null&&u.prevented?[2]:(o==null||o(c),[2])}})})},l.prototype.loadRemote=function(t){var e;return(0,n.mG)(this,void 0,void 0,function(){var o,i,r,d,a,s,c,u,h,m,C,y,O=this;return(0,n.Jh)(this,function(g){switch(g.label){case 0:if(o=this.props,i=o.autoComplete,r=o.env,d=o.data,a=o.setOptions,s=o.setLoading,c=o.formInited,u=o.addHook,!r||!r.fetcher)throw new Error("fetcher is required");if(c===!1&&u)return this.unHook&&this.unHook(),[2,this.unHook=u(this.loadRemote.bind(this,t),"init")];if(this.lastTerm=t,h=(0,p.nW9)(d,{term:t,value:t}),!(0,p.X1t)(i,h))return[2,Promise.resolve({options:[]})];this.fetchCancel&&((e=this.fetchCancel)===null||e===void 0||e.call(this,"autoComplete request cancelled."),this.fetchCancel=null,s(!1)),s(!0),g.label=1;case 1:return g.trys.push([1,,3,4]),[4,r.fetcher(i,h,{cancelExecutor:function(T){return O.fetchCancel=T}})];case 2:return m=g.sent(),this.fetchCancel=null,C=m.data&&m.data.options||m.data||[],y=this.mergeOptions(C),a(y),[2,{options:y}];case 3:return s(!1),[7];case 4:return[2]}})})},l.prototype.mergeOptions=function(t){var e=this.props,o=e.selectedOptions,i=e.valueField,r=i===void 0?"value":i,d=(0,p.GRe)(t,void 0,r).concat();return Array.isArray(o)&&o.length&&o.forEach(function(a){Z()(d,function(s){return s[r]===a[r]})||d.push((0,n.pi)((0,n.pi)({},a),{hidden:!0}))}),d},l.prototype.renderMenu=function(t,e){var o=this.props,i=o.menuTpl,r=o.render,d=o.data,a=o.optionClassName,s=o.testIdBuilder;return r("menu/".concat(e.index),i,{showNativeTitle:!0,className:P()("Select-option-content",a),data:(0,p.nW9)((0,p.nW9)(d,e),t),testIdBuilder:s==null?void 0:s.getChild("option-"+t.value||0)})},l.prototype.reload=function(t,e){var o=this.props.reloadOptions;o&&o(t,e)},l.prototype.option2value=function(){},l.prototype.renderOtherMode=function(){var t=this.props,e=t.selectMode,o=(0,n._T)(t,["selectMode"]);return M().createElement(oe,(0,n.pi)({},o,{selectMode:e==="group"?"list":e}))},l.prototype.doAction=function(t,e,o){var i,r,d,a=this.props,s=a.resetValue,c=a.onChange,u=a.formStore,h=a.store,m=a.name,C=a.valueField,y=t==null?void 0:t.actionType;if(y==="clear")c==null||c("");else if(y==="reset"){var O=(d=(0,p.E04)((r=u==null?void 0:u.pristine)!==null&&r!==void 0?r:h==null?void 0:h.pristine,m))!==null&&d!==void 0?d:s,g=this.getValue((i={},i[C]=O!=null?O:"",i));c==null||c(g)}},l.prototype.handleOptionAdd=function(t,e,o,i){var r=this;t===void 0&&(t=-1),o===void 0&&(o=!1);var d=this.props,a=d.onAdd,s=d.autoComplete;a==null||a(t,e,o,function(){return(0,n.mG)(r,void 0,void 0,function(){return(0,n.Jh)(this,function(c){switch(c.label){case 0:return i==null||i(e),s?[4,this.loadRemote(this.lastTerm)]:[3,2];case 1:return c.sent(),[2,!1];case 2:return[2]}})})})},l.prototype.handleOptionEdit=function(t,e,o,i){var r=this,d=this.props,a=d.onEdit,s=d.autoComplete;a==null||a(t,e,o,function(){return(0,n.mG)(r,void 0,void 0,function(){return(0,n.Jh)(this,function(c){switch(c.label){case 0:return i==null||i(t),s?[4,this.loadRemote(this.lastTerm)]:[3,2];case 1:return c.sent(),[2,!1];case 2:return[2]}})})})},l.prototype.handleOptionDelete=function(t,e){var o=this,i=this.props,r=i.onDelete,d=i.autoComplete;r==null||r(t,function(){return(0,n.mG)(o,void 0,void 0,function(){return(0,n.Jh)(this,function(a){switch(a.label){case 0:return e==null||e(t),d?[4,this.loadRemote(this.lastTerm)]:[3,2];case 1:return a.sent(),[2,!1];case 2:return[2]}})})})},l.prototype.render=function(){var t=this,e=this.props,o=e.autoComplete,i=e.searchable,r=e.showInvalidMatch,d=e.options,a=e.className,s=e.popoverClassName,c=e.style,u=e.loading,h=e.value,m=e.selectedOptions,C=e.multi,y=e.multiple,O=e.placeholder,g=e.id,T=e.classPrefix,G=e.classnames,B=e.creatable,J=e.inline,_=e.noResultsText,j=e.render,W=e.menuTpl,S=e.borderMode,x=e.selectMode,b=e.env,D=e.mobileUI,V=e.overlay,w=e.filterOption,N=(0,n._T)(e,["autoComplete","searchable","showInvalidMatch","options","className","popoverClassName","style","loading","value","selectedOptions","multi","multiple","placeholder","id","classPrefix","classnames","creatable","inline","noResultsText","render","menuTpl","borderMode","selectMode","env","mobileUI","overlay","filterOption"]),F=this.props,R=F.classPrefix,A=F.themeCss;return _&&(_=j("noResultText",_)),M().createElement("div",{className:P()("".concat(T,"SelectControl"),a),style:c},["table","list","group","tree","chained","associated"].includes(x)?this.renderOtherMode():M().createElement(L.PhF,(0,n.pi)({},N,{onAdd:this.handleOptionAdd,onEdit:this.handleOptionEdit,onDelete:this.handleOptionDelete,className:P()((0,p.GwQ)((0,n.pi)((0,n.pi)({},this.props),{name:"selectControlClassName",id:g,themeCss:A}))),popoverClassName:P()(s,(0,p.GwQ)((0,n.pi)((0,n.pi)({},this.props),{name:"selectPopoverClassName",id:g,themeCss:A}))),mobileUI:D,popOverContainer:D?b==null?void 0:b.getModalContainer:N.popOverContainer||b.getModalContainer,borderMode:S,placeholder:O,multiple:y||C,ref:this.inputRef,value:m,options:d,filterOption:typeof w=="string"?(0,p.PqP)(w,"options","inputValue","option"):w,loadOptions:(0,p.X1t)(o)?this.lazyloadRemote:void 0,showInvalidMatch:r,creatable:B,searchable:i||!!o,onChange:this.changeValue,onBlur:function(I){return t.dispatchEvent("blur",I)},onFocus:function(I){return t.dispatchEvent("focus",I)},loading:u,noResultsText:_,renderMenu:W?this.renderMenu:void 0,overlay:V})),M().createElement(p.cWM,(0,n.pi)({},this.props,{config:{themeCss:A,classNames:[{key:"selectControlClassName",weights:{focused:{suf:".is-opened:not(.is-mobile)"},disabled:{suf:".is-disabled"}}},{key:"selectPopoverClassName",weights:{default:{suf:" .".concat(R,"Select-option")},hover:{suf:" .".concat(R,"Select-option.is-highlight")},focused:{inner:".".concat(R,"Select-option.is-active")}}}],id:g},env:b})))},l.defaultProps={clearable:!1,searchable:!1,multiple:!1,showInvalidMatch:!1},(0,n.gn)([p.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Object]),(0,n.w6)("design:returntype",void 0)],l.prototype,"renderMenu",null),(0,n.gn)([p.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Object,Boolean,Function]),(0,n.w6)("design:returntype",void 0)],l.prototype,"handleOptionAdd",null),(0,n.gn)([p.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Object,Boolean,Function]),(0,n.w6)("design:returntype",void 0)],l.prototype,"handleOptionEdit",null),(0,n.gn)([p.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Function]),(0,n.w6)("design:returntype",void 0)],l.prototype,"handleOptionDelete",null),(0,n.gn)([(0,te.i)(),(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[]),(0,n.w6)("design:returntype",void 0)],l.prototype,"render",null),l}(M().Component),oe=function(f){(0,n.ZT)(l,f);function l(){return f!==null&&f.apply(this,arguments)||this}return l.prototype.renderItem=function(t){var e=this.props,o=e.labelField,i=e.menuTpl,r=e.data,d=e.render;return i?d("option/".concat(t.value),i,{data:(0,p.nW9)(r,t)}):"".concat(t.scopeLabel||"").concat(t[o||"label"])},l.prototype.render=function(){var t,e=this.props,o=e.className,i=e.classnames,r=e.selectedOptions,d=e.sortable,a=e.loading,s=e.searchable,c=e.searchResultMode,u=e.showArrow,h=e.deferLoad,m=e.disabled,C=e.clearable,y=e.selectTitle,O=e.selectMode,g=e.multiple,T=e.columns,G=e.leftMode,B=e.borderMode,J=e.mobileUI,_=e.env,j=e.popOverContainer,W=e.maxTagCount,S=e.overflowTagPopover,x=e.placeholder,b=e.itemHeight,D=e.virtualThreshold,V=e.rightMode,w=e.loadingConfig,N=e.labelField,F=e.showInvalidMatch,R=e.checkAll,A=e.checkAllLabel,I=e.overlay,ie=e.valueField,K=this.props,E=K.options,X=K.leftOptions,z=K.leftDefaultValue;return O==="associated"&&E&&E.length&&E[0].leftOptions&&Array.isArray(E[0].children)&&(X=E[0].leftOptions,z=(t=E[0].leftDefaultValue)!==null&&t!==void 0?t:z,E=E[0].children),M().createElement(M().Fragment,null,M().createElement(L.p_i,{selectMode:O,className:o,value:r,disabled:m,clearable:C,options:E,onChange:this.handleChange,option2value:this.option2value,optionItemRender:this.renderItem,itemRender:this.renderItem,sortable:d,searchResultMode:c,onSearch:s?this.handleSearch:void 0,showArrow:u,onDeferLoad:h,selectTitle:y,multiple:g,columns:T,leftMode:G,rightMode:V,leftOptions:X,borderMode:B,mobileUI:J,popOverContainer:j||_.getModalContainer,maxTagCount:W,overflowTagPopover:S,placeholder:x,itemHeight:b,virtualThreshold:D,virtualListHeight:266,labelField:N,showInvalidMatch:F,checkAllLabel:A,checkAll:R,overlay:I,valueField:ie}),M().createElement(L.$jN,{overlay:!0,key:"info",show:a,loadingConfig:w}))},(0,n.gn)([p.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object]),(0,n.w6)("design:returntype",Object)],l.prototype,"renderItem",null),l}(ee.BaseTransferRenderer),ne=function(f){(0,n.ZT)(l,f);function l(){return f!==null&&f.apply(this,arguments)||this}return l=(0,n.gn)([(0,p.oZB)({type:"select"})],l),l}(U),le=function(f){(0,n.ZT)(l,f);function l(){return f!==null&&f.apply(this,arguments)||this}return l.defaultProps={multiple:!0},l=(0,n.gn)([(0,p.oZB)({type:"multi-select"})],l),l}(U)}}]);
