"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[5954,7110],{7110:function(be,J,b){b.r(J),b.d(J,{ColumnTogglerRenderer:function(){return le}});var n=b(15767),ie=b(87363),S=b.n(ie),Q=b(42977),G=b(94391),oe=b(48738),le=function(z){(0,n.ZT)(P,z);function P(){return z!==null&&z.apply(this,arguments)||this}return P.prototype.render=function(){var A=this.props,me=A.className,ye=A.store,c=A.render,N=A.classPrefix,U=A.classnames,se=A.tooltip,H=A.align,V=A.cols,q=A.toggleAllColumns,_=A.toggleToggle,ee=A.data,te=A.size,ge=A.popOverContainer,ne=(0,n._T)(A,["className","store","render","classPrefix","classnames","tooltip","align","cols","toggleAllColumns","toggleToggle","data","size","popOverContainer"]),X=ne.translate,de=ne.env;if(!V)return null;var C=V.filter(function(e){return(0,Q.pn4)(e.pristine||e,ee)&&e.toggable!==!1}),d=C.filter(function(e){return e.toggled!==!1});return S().createElement(oe.Z,(0,n.pi)({},ne,{render:c,tooltip:se||X("Table.columnsVisibility"),tooltipContainer:ge||de.getModalContainer,isActived:V.findIndex(function(e){return!e.toggled})!==-1,align:H!=null?H:"right",size:te||"sm",classnames:U,classPrefix:N,key:"columns-toggable",columns:V,activeToggaleColumns:d,data:ee}),C!=null&&C.length?S().createElement("li",{className:U("ColumnToggler-menuItem"),key:"selectAll",onClick:function(){q&&q((d==null?void 0:d.length)<=0)}},S().createElement(G.XZJ,{size:"sm",classPrefix:N,key:"checkall",checked:!!(d!=null&&d.length),partial:!!(d!=null&&d.length&&(d==null?void 0:d.length)!==(C==null?void 0:C.length))},X("Select.checkAll"))):null,C==null?void 0:C.map(function(e,t){return S().createElement("li",{className:U("ColumnToggler-menuItem"),key:"item"+(e.index||t),onClick:function(){_&&_(t)}},S().createElement(G.XZJ,{size:"sm",classPrefix:N,checked:e.toggled!==!1},e.title?c("tpl",e.title):e.label||null))}))},P=(0,n.gn)([(0,Q.Thl)({type:"column-toggler",name:"column-toggler"})],P),P}(S().Component)},55954:function(be,J,b){b.r(J),b.d(J,{TableRenderer:function(){return de},default:function(){return X}});var n=b(15767),ie=b(87363),S=b.n(ie),Q=b(61533),G=b(23293),oe=b(6663),le=b(32222),z=b.n(le),P=b(31223),A=b.n(P),me=b(25956),ye=b.n(me),c=b(42977),N=b(94391),U=b(53392),se=function(C){(0,n.ZT)(d,C);function d(e){var t=C.call(this,e)||this;return t.formItems=[],t.handleSubmit=t.handleSubmit.bind(t),t.handleAction=t.handleAction.bind(t),t}return d.prototype.buildSchema=function(){var e,t,r,a,i,o,s=this.props,l=s.searchable,p=s.sortable,u=s.name,g=s.label,f=s.translate,m=s.testIdBuilder,h;if(l===!0?h={title:"",controls:[{type:"text",name:u,placeholder:g,clearable:!0,testid:(e=m==null?void 0:m.getChild(u))===null||e===void 0?void 0:e.getTestIdValue()}]}:l&&(l.controls||l.tabs||l.fieldSet?h=(0,n.pi)((0,n.pi)({title:""},l),{controls:Array.isArray(l.controls)?l.controls.concat():void 0}):(l==null?void 0:l.type)==="form"?h=l:h={title:"",className:l.formClassName,controls:[(0,n.pi)({type:l.type||"text",name:l.name||u,testid:(t=m==null?void 0:m.getChild(l.name||u))===null||t===void 0?void 0:t.getTestIdValue(),placeholder:g},l)]}),h&&h.controls&&p&&h.controls.unshift({type:"hidden",name:"orderBy",value:u},{type:"button-group",name:"order",label:f("sort"),options:[{label:f("asc"),value:"asc"},{label:f("desc"),value:"desc"}]}),h){var y=[];(h.controls||h.body||[]).forEach(function(w){return w.name&&w.name!=="orderBy"&&w.name!=="order"&&y.push(w.name)}),this.formItems=y,h=(0,n.pi)((0,n.pi)({},h),{type:"form",wrapperComponent:"div",wrapWithPanel:!0,title:!1,testid:(r=m==null?void 0:m.getChild("form"))===null||r===void 0?void 0:r.getTestIdValue(),actions:[{type:"button",label:f("reset"),actionType:"clear-and-submit",testid:(a=m==null?void 0:m.getChild("btn-reset"))===null||a===void 0?void 0:a.getTestIdValue()},{type:"button",label:f("cancel"),actionType:"cancel",testid:(i=m==null?void 0:m.getChild("btn-cancel"))===null||i===void 0?void 0:i.getTestIdValue()},{label:f("search"),type:"submit",primary:!0,testid:(o=m==null?void 0:m.getChild("btn-search"))===null||o===void 0?void 0:o.getTestIdValue()}]})}return h||"error"},d.prototype.handleAction=function(e,t,r,a){return(0,n.mG)(this,void 0,void 0,function(){var i,o,s,l,p,u,g;return(0,n.Jh)(this,function(f){switch(f.label){case 0:return i=this.props,o=i.onAction,s=i.data,l=i.dispatchEvent,p=i.name,t.actionType==="cancel"||t.actionType==="close"?(a(),[2]):t.actionType==="reset"?(a(),this.handleReset(),[2]):(u=(0,n.pi)({},s),this.formItems.forEach(function(m){return(0,c.NI0)(u,m,void 0)}),[4,l("columnSearch",(0,c.nW9)(s,{searchName:p,searchValue:u}))]);case 1:return g=f.sent(),g!=null&&g.prevented?[2]:(o&&o(e,t,r),[2])}})})},d.prototype.handleReset=function(){return(0,n.mG)(this,void 0,void 0,function(){var e,t,r,a,i,o;return(0,n.Jh)(this,function(s){switch(s.label){case 0:return e=this.props,t=e.onSearch,r=e.data,a=e.name,i=(0,n.pi)({},r),this.formItems.forEach(function(l){return(0,c.NI0)(i,l,void 0)}),i.orderBy===a&&(i.orderBy="",i.order="asc"),o=t,o?[4,t(a,i)]:[3,2];case 1:o=s.sent(),s.label=2;case 2:return t&&t(i),[2]}})})},d.prototype.handleSubmit=function(e,t){return(0,n.mG)(this,void 0,void 0,function(){var r,a,i,o;return(0,n.Jh)(this,function(s){switch(s.label){case 0:return r=this.props,a=r.onSearch,i=r.name,e.order&&(e=(0,n.pi)((0,n.pi)({},e),{orderBy:i})),o=a,o?[4,a(i,e)]:[3,2];case 1:o=s.sent(),s.label=2;case 2:return t(),[2]}})})},d.prototype.isActive=function(){var e=this.props,t=e.data,r=e.name,a=e.orderBy;return a&&a===r||this.formItems.some(function(i){return t==null?void 0:t[i]})},d.prototype.render=function(){var e=this,t=this.props,r=t.render,a=t.name,i=t.data,o=t.searchable,s=t.order,l=t.orderBy,p=t.popOverContainer,u=t.classPrefix,g=t.classnames,f=t.testIdBuilder,m=this.buildSchema(),h=this.isActive();return S().createElement(N.MRL,{className:"".concat(u,"TableCell-searchBtn"),layerClassName:g("".concat(u,"TableCell-searchPopOver"),o.className),active:h,filterIcon:S().createElement(N.JO$,{icon:"search",className:"icon",iconContent:"table-search-icon",testIdBuilder:f==null?void 0:f.getChild("search-icon")}),popOverContainer:p||function(){return(0,Q.findDOMNode)(e)},filterDropdown:function(y){var w=y.setSelectedKeys,v=y.selectedKeys,R=y.confirm,x=y.clearFilters;return r("quick-search-form",m,{data:(0,n.pi)((0,n.pi)({},i),{orderBy:l,order:l&&l===a?s:""}),onSubmit:function(E){return e.handleSubmit(E,R)},onAction:function(E,F,T){e.handleAction(E,F,T,R)}})},testIdBuilder:f})},d}(S().Component),H=(0,U.Pi)(function(C){var d=C.store;return S().createElement(se,(0,n.pi)({},C,{data:d.query,orderBy:d.orderBy,order:d.order}))}),V=b(41313),q=b(15937),_=b(51967),ee=b(76581),te=b(29142),ge=function(C){(0,n.ZT)(d,C);function d(){var e=C!==null&&C.apply(this,arguments)||this;return e.propsNeedRemove=["title"],e}return d.defaultProps=(0,n.pi)((0,n.pi)({},te.pj.defaultProps),{wrapperComponent:"div"}),d=(0,n.gn)([(0,c.Thl)({type:"cell-field",name:"cell-field"}),(0,ee.v)(),(0,_.T)(),(0,q.p2)()],d),d}(te.pj),ne=b(7110),X=function(C){(0,n.ZT)(d,C);function d(e,t){var r=C.call(this,e)||this;r.renderedToolbars=[],r.subForms={},r.columns=[],r.reactions=[];var a=t;a.registerComponent(r);var i=e.store,o=e.columnsTogglable,s=e.columns,l=e.rowSelection,p=e.keyField,u=e.primaryField,g=e.canAccessSuperData;return i.update({columnsTogglable:o,columns:s,canAccessSuperData:g,rowSelectionKeyField:u||(l==null?void 0:l.keyField)||p}),d.syncRows(i,e,void 0)&&r.syncSelected(),r.columns=r.buildColumns(i.filteredColumns,[],[]),r.rowSelection=r.buildRowSelection(),r.expandable=r.buildExpandable(),r.reactions.push((0,G.U5)(function(){return i.currentSelectedRowKeys.join(",")},function(){r.rowSelection=r.buildRowSelection(),r.forceUpdate()})),r.reactions.push((0,G.U5)(function(){return i.currentExpandedKeys.join(",")},function(){r.expandable=r.buildExpandable(),r.forceUpdate()})),r.reactions.push((0,G.U5)(function(){return i.filteredColumns},function(){r.columns=r.buildColumns(i.filteredColumns,[],[]),r.forceUpdate()})),r}return d.prototype.componentWillUnmount=function(){var e=this.context;e.unRegisterComponent(this),this.reactions&&this.reactions.forEach(function(t){return t()})},d.prototype.syncSelected=function(){var e=this.props,t=e.store,r=e.onSelect;r&&r(t.selectedRows.map(function(a){return a.data}),t.unSelectedRows.map(function(a){return a.data}))},d.syncRows=function(e,t,r){var a,i=t.source,o=(0,c.v8S)(t,function(y){return y.items}),s=[],l=!1;if(Array.isArray(o)&&(!r||(0,c.v8S)(r,function(y){return y.items})!==o))l=!0,s=o;else if(typeof i=="string"){var p=(0,c.OgC)(i,t.data,"| raw"),u=r?(0,c.OgC)(i,r.data,"| raw"):null;u&&u===p?l=!1:Array.isArray(p)&&(l=!0,s=p)}l&&e.initRows(s,t.getEntryId,t.reUseRow,t.childrenColumnName);var g=[],f=e.keyField;Array.isArray(t.selected)?g=t.selected.map(function(y){return y[f]})||[]:t.rowSelection&&t.rowSelection.selectedRowKeysExpr?s.forEach(function(y,w){var v,R=(0,c.fz_)(((v=t.rowSelection)===null||v===void 0?void 0:v.selectedRowKeysExpr)||"",{record:y,rowIndex:w});R&&g.push(y[f])}):t.rowSelection&&t.rowSelection.selectedRowKeys&&(g=(0,n.ev)([],(0,n.CR)(t.rowSelection.selectedRowKeys),!1)),l&&g.length>0&&e.updateSelected(g);var m=[],h=t.primaryField||((a=t.expandable)===null||a===void 0?void 0:a.keyField)||t.keyField;return t.expandable&&t.expandable.expandedRowKeysExpr?s.forEach(function(y,w){var v,R=(0,c.fz_)(((v=t.expandable)===null||v===void 0?void 0:v.expandedRowKeysExpr)||"",{record:y,rowIndex:w});R&&m.push(y[h])}):t.expandable&&t.expandable.expandedRowKeys&&(m=(0,n.ev)([],(0,n.CR)(t.expandable.expandedRowKeys),!1)),l&&m.length>0&&e.updateExpanded(m,h),l},d.prototype.componentDidUpdate=function(e){var t,r,a,i=this.props,o=i.store;if((0,c.Vcl)(["orderBy","columnsTogglable","canAccessSuperData"],e,i,function(u){u.orderBy&&!i.onQuery&&delete u.orderBy,o.update(u,{resolveDefinitions:i.resolveDefinitions})}),(0,c.aGv)(["source","value","items"],e,i)||!i.value&&!i.items&&(i.data!==e.data||typeof i.source=="string"&&(0,c.SSQ)(i.source)))d.syncRows(o,i,e)&&this.syncSelected();else if((0,c.RBK)(e.selected,i.selected)){var s=o.keyField,l=o.selectedRows.map(function(u){return u[s]}).join(",");o.updateSelected(i.selected.map(function(u){return u[s]})||[]);var p=o.selectedRows.map(function(u){return u[s]}).join(",");l!==p&&this.syncSelected()}(0,c.aGv)(["columns"],e,i)&&o.update({columns:i.columns}),(0,c.aGv)(["rowSelection","selectable","multiple","maxKeepItemSelectionLength"],e,i)&&(this.rowSelection=this.buildRowSelection()),(0,c.aGv)(["query","pageField","perPageField"],e,i)&&o.updateQuery(i.query,void 0,i.pageField,i.perPageField,!0),(!A()((t=e==null?void 0:e.rowSelection)===null||t===void 0?void 0:t.keyField,(r=i.rowSelection)===null||r===void 0?void 0:r.keyField)||!A()(e.keyField,i.keyField))&&o.update({rowSelectionKeyField:i.primaryField||((a=i.rowSelection)===null||a===void 0?void 0:a.keyField)||i.keyField})},d.prototype.getPopOverContainer=function(){return(0,Q.findDOMNode)(this)},d.prototype.subFormRef=function(e,t,r){var a=this.props.quickEditFormRef;a&&a(e,t,r),this.subForms["".concat(t,"-").concat(r)]=e,e&&this.props.store.addForm(e.props.store,r)},d.prototype.reset=function(){var e=this,t=this.props.store;t.reset();var r=[];Object.keys(this.subForms).forEach(function(a){return e.subForms[a]&&r.push(e.subForms[a])}),r.forEach(function(a){return a.clearErrors()})},d.prototype.renderCellSchema=function(e,t){var r=this.props,a=r.render,i=r.store;if(e&&(0,c.Kn2)(e)){var o=e.width,s=e.children,l=e.title,p=(0,n._T)(e,["width","children","title"]);return a("cell-field",(0,n.pi)((0,n.pi)({},p),{title:l||p.label,type:"cell-field",column:p,data:t.data,name:e.name}),t)}return e},d.prototype.renderSchema=function(e,t,r){var a=this.props.render;if(t&&(0,c.Kn2)(t))return a(e||"field",(0,n.pi)((0,n.pi)({},t),{data:r==null?void 0:r.data}),r);if(Array.isArray(t)){var i=[];return t.forEach(function(o,s){return i.push(a(e||"field",(0,n.pi)((0,n.pi)({},o),{data:r==null?void 0:r.data}),(0,n.pi)((0,n.pi)({},r),{key:s})))}),i}return typeof t=="string"?(0,c.hXT)(t,r==null?void 0:r.data):t},d.prototype.buildColumns=function(e,t,r){var a=this,i=this.props,o=i.render,s=i.store,l=i.popOverContainer,p=i.canAccessSuperData,u=i.showBadge,g=i.itemBadge,f=i.data,m=i.classnames,h=i.env,y=i.testIdBuilder,w=[];return t=t,r=r,Array.isArray(e)&&e.forEach(function(v,R){return(0,n.mG)(a,void 0,void 0,function(){var x,E,F,T,B,W,re,I,Z,K,$,ae,D=this,ce,ue;return(0,n.Jh)(this,function(pe){switch(pe.label){case 0:return x=(0,n.pi)({},v),E=null,F=x.title||x.label,T=(0,n.pi)((0,n.pi)({},f),{popOverContainer:l||this.getPopOverContainer}),(0,c.Kn2)(v.title)?E=z()(v.title):typeof F=="string"&&(E={type:"plain",tpl:F}),(v.headerAlign||v.align)&&(E.align=v.headerAlign||v.align,E.className="flex-1"),B=function(M){var L,O=D.renderCellSchema(E,T),k=null;return v.remark&&(k=o("remark",{type:"remark",tooltip:v.remark,container:D.getPopOverContainer})),S().createElement("div",{key:R,className:m("Table-head-cell-wrapper",(L={},L["".concat(v.className)]=!!v.className,L["".concat(v.titleClassName)]=!!v.titleClassName,L)),style:{justifyContent:{right:"flex-end",center:"center"}[v.align]||"flex-start"}},O,k,M)},Object.assign(x,{title:B}),W=!!(!((ce=v.children)===null||ce===void 0)&&ce.length),re=(ue=v.canAccessSuperData)!==null&&ue!==void 0?ue:p,v.type&&Object.assign(x,{render:function(M,L,O,k,we){var Se={},he=s.getRowByIndex(O,(0,n.ev)([],(0,n.CR)(we||[]),!1))||{},Ce=y==null?void 0:y.getChild("row-".concat(O,"-cell-").concat(k)),Y={children:D.renderCellSchema(v,{data:he.locals,btnDisabled:s.dragging,popOverContainer:l||D.getPopOverContainer,quickEditFormRef:D.subFormRef,onQuickChange:function(j,Re,xe,Ee){D.handleQuickChange(he,j,Re,xe,Ee)},row:he,showBadge:u&&R===0,itemBadge:g,testIdBuilder:Ce}),props:Se};if(!W&&v.rowSpanExpr){var ve=+(0,c.hXT)(v.rowSpanExpr,{record:L,rowIndex:O,colIndex:k});ve&&(Y.props.rowSpan=ve,t.push({colIndex:k,rowIndex:O,rowSpan:ve}))}if(!W&&v.colSpanExpr){var fe=+(0,c.hXT)(v.colSpanExpr,{record:L,rowIndex:O,colIndex:k});fe&&(Y.props.colSpan=fe,r.push({colIndex:k,rowIndex:O,colSpan:fe}))}return t.forEach(function(j){k===j.colIndex&&O>j.rowIndex&&O<j.rowIndex+(j.rowSpan||0)&&(Y.props.rowSpan=0)}),r.forEach(function(j){O===j.rowIndex&&k>j.colIndex&&k<j.colIndex+(j.colSpan||0)&&(Y.props.colSpan=0)}),Y}}),v.searchable&&(x.filterDropdown=S().createElement(H,(0,n.pi)({},this.props,{popOverContainer:this.getPopOverContainer,name:v.name,searchable:v.searchable,onSearch:this.handleSearch,key:"th-search-"+R,testIdBuilder:y==null?void 0:y.getChild("head-search-".concat(R))}))),v.sortable&&(x.sorter=!0),v.filterable?v.filterable.options?(x.filters=v.filterable.options.map(function(M){return typeof M=="string"?{text:M,value:M}:{text:M.label,value:M.value}}),[3,4]):[3,1]:[3,4];case 1:return v.filterable.source?(I=v.filterable.source,(0,c.SSQ)(I)?(Z=(0,c.OgC)(I,f,"| raw"),x.filters=Z,[3,4]):[3,2]):[3,4];case 2:return(0,c.X1t)(I,f)?(K=(0,c._6r)(I),K.cache=3e3,[4,h.fetcher(K,f)]):[3,4];case 3:$=pe.sent(),ae=$.data&&$.data.options||[],x.filters=ae,pe.label=4;case 4:return W&&(x.children=this.buildColumns(v.children,t,r)),w.push(x),[2]}})})}),w},d.prototype.buildSummary=function(e,t){var r=this,a=[];return Array.isArray(t)&&t.forEach(function(i,o){(0,c.Kn2)(i)?a.push({colSpan:i.colSpan,fixed:i.fixed,cellClassName:i.cellClassName,render:function(s){return r.renderSchema(e,i,{data:s})}}):Array.isArray(i)&&(a[o]||a.push([]),i.forEach(function(s){a[o].push({colSpan:s.colSpan,fixed:s.fixed,cellClassName:s.cellClassName,render:function(l){return r.renderSchema(e,s,{data:l})}})}))}),a.length?a:null},d.prototype.rowClassName=function(e,t){var r=this.props,a=r.rowClassNameExpr,i=r.store,o=r.themeCss,s=r.id,l=r.rowClassName,p=[];l&&p.push(l),a&&p.push((0,c.hXT)(a,{record:e,rowIndex:t}));var u=i.getRowByIndex(t);return u!=null&&u.modified&&p.push("is-modified"),u!=null&&u.moved&&p.push("is-moved"),p.push((0,c.GwQ)((0,n.pi)((0,n.pi)({},this.props),{name:"tableRowClassname",id:s,themeCss:o}))),p.join(" ")},d.prototype.buildRowSelection=function(){var e=this,t=this.props,r=t.selectable,a=t.multiple,i=t.maxKeepItemSelectionLength,o=t.rowSelection,s=t.store,l=null;if(r)l={type:a===!1?"radio":"",selectedRowKeys:s.currentSelectedRowKeys,maxSelectedLength:i};else if(o){var p=o.selectedRowKeys,u=o.selections,g=(0,n._T)(o,["selectedRowKeys","selections"]);l=(0,n.pi)({selectedRowKeys:s.currentSelectedRowKeys,maxSelectedLength:i},g),l.getCheckboxProps=function(f,m){var h=e.props,y=h.rowSelection,w=h.maxKeepItemSelectionLength,v=h.store,R=y==null?void 0:y.disableOn;return{disabled:(R?(0,c.fz_)(R,{record:f,rowIndex:m}):!1)||w&&v.currentSelectedRowKeys.length>=w&&!v.currentSelectedRowKeys.includes(f[v.keyField])}},o.disableOn&&delete l.disableOn,u&&Array.isArray(u)&&(l.selections=[],u.forEach(function(f){l.selections.push({key:f.key,text:f.text,onSelect:function(m){var h=[];h=m.filter(function(y,w){return f.key==="all"?!0:f.key==="none"?!1:f.key==="invert"?!s.currentSelectedRowKeys.includes(y):f.key==="odd"?w%2===0:f.key==="even"?w%2!==0:!0}),s.updateSelected(h)}})}))}return l},d.prototype.expandedRowClassName=function(e,t){var r=this.props.expandable;return(0,c.hXT)(r==null?void 0:r.expandedRowClassNameExpr,{record:e,rowIndex:t})},d.prototype.expandedRowRender=function(e,t){var r=this.props.expandable;return this.renderSchema("expandableBody",(0,n.pi)({},r),{data:(0,n.pi)((0,n.pi)((0,n.pi)({},this.props.data),e),{rowIndex:t})})},d.prototype.rowExpandable=function(e,t,r){var a=this.props.expandable;return a!=null&&a.expandableOn?(0,c.fz_)(a.expandableOn,{record:e,rowIndex:t}):!1},d.prototype.buildExpandable=function(){var e=this.props,t=e.expandable,r=e.store,a=null;if(t){var i=t.expandedRowKeys,o=(0,n._T)(t,["expandedRowKeys"]);a=(0,n.pi)({expandedRowKeys:r.currentExpandedKeys},o),t.expandableOn&&(a.rowExpandable=this.rowExpandable,delete a.expandableOn),t&&t.type&&(a.expandedRowRender=this.expandedRowRender),t.expandedRowClassNameExpr&&(a.expandedRowClassName=this.expandedRowClassName,delete a.expandedRowClassNameExpr)}return a},d.prototype.reloadTarget=function(e,t){var r=this.context;r.reload(e,t)},d.prototype.handleSave=function(){return(0,n.mG)(this,void 0,void 0,function(){var e,t,r,a,i,o,s,l,p,u,g,f=this;return(0,n.Jh)(this,function(m){switch(m.label){case 0:return e=this.props,t=e.store,r=e.onSave,a=e.primaryField,i=e.keyField,t.modifiedRows.length?(o=[],Object.keys(this.subForms).forEach(function(h){return f.subForms[h]&&o.push(f.subForms[h])}),o.length?[4,Promise.all(o.map(function(h){return h.validate()}))]:[3,2]):[2];case 1:if(s=m.sent(),~s.indexOf(!1))return[2];m.label=2;case 2:return l=t.modifiedRows.map(function(h){return h.data}),p=t.modifiedRows.map(function(h){return h.path}),u=t.modifiedRows.map(function(h){return(0,c.e50)(h.data,h.pristine,[i,a])}),g=t.rows.filter(function(h){return!h.modified}).map(function(h){return h.data}),r?(r(l,u,p,g,t.modifiedRows.map(function(h){return h.pristine})),[2]):(this.handleQuickSave(l,u,p,g,t.modifiedRows.map(function(h){return h.pristine})),[2])}})})},d.prototype.handleQuickSave=function(e,t,r,a,i,o){var s=this,l=this.props,p=l.store,u=l.quickSaveApi,g=l.quickSaveItemApi,f=l.primaryField,m=l.keyField,h=l.env,y=l.messages,w=l.reload,v=l.dispatchEvent;if(Array.isArray(e)){if(!(0,c.X1t)(u)){h&&h.alert("Table2 quickSaveApi is required");return}var R=f||m,x=(0,c.nW9)(p.data,{rows:e,rowsDiff:t,indexes:r,rowsOrigin:i});e.length&&e[0].hasOwnProperty(R)&&(x.ids=e.map(function(T){return T[R]}).join(",")),a&&(x.unModifiedItems=a),p.saveRemote(u,x,{successMessage:y&&y.saveFailed,errorMessage:y&&y.saveSuccess}).then(function(){v("quickSaveSubmitted",x),w&&s.reloadTarget((0,c.u22)(w,x),x)}).catch(function(){})}else{if(!(0,c.X1t)(g)){h&&h.alert("Table2 quickSaveItemApi is required!");return}var E=(0,c.nW9)(p.data,{item:e,modified:t,origin:i}),F=(0,c.nW9)(E,e);p.saveRemote(g,F).then(function(){v("quickSaveSubmitted",F),w&&s.reloadTarget((0,c.u22)(w,E),E)}).catch(function(){o!=null&&o.resetOnFailed&&s.reset()})}},d.prototype.handleQuickChange=function(e,t,r,a,i){if((0,oe.fh)(e)){var o=this.props,s=o.onSave,l=o.onPristineChange,p=o.saveImmediately,u=o.primaryField,g=o.keyField,f=o.quickSaveItemApi;if(e.change(t,a),e.modified&&this.syncSelected(),a){l==null||l(e.data,e.path);return}if(!(!r&&!p)){if(r&&r.api){this.props.onAction&&this.props.onAction(null,{actionType:"ajax",api:r.api,reload:i==null?void 0:i.reload},e.locals);return}if(!s){this.handleQuickSave(f?e.data:[e.data],(0,c.e50)(e.data,e.pristine,[g,u]),[e.path],void 0,e.pristine,i);return}s(e.data,(0,c.e50)(e.data,e.pristine,[g,u]),e.path,void 0,e.pristine,i)}}},d.prototype.handleAction=function(e,t,r){var a=this.props.onAction;return a==null?void 0:a(e,t,r)},d.prototype.renderActions=function(e){var t=this,r=this.props,a=r.actions,i=r.render,o=r.store,s=r.classnames,l=r.data,p=r.columnsTogglable,u=r.dispatchEvent;a=Array.isArray(a)?a.concat():[];var g=(0,c.Kn2)(p)?p:{align:"left"};return o.toggable&&e==="header"&&!~this.renderedToolbars.indexOf("columns-toggler")&&a.push({type:"button",children:i("column-toggler",(0,n.pi)((0,n.pi)({},g),{type:"column-toggler"}),{cols:o.columnsData,toggleAllColumns:function(){o.toggleAllColumns(),u("columnToggled",(0,c.nW9)(l,{columns:o.columnsData.filter(function(f){return f.toggled})}))},toggleToggle:function(f){var m=o.columnsData[f];m.toggleToggle(),u("columnToggled",(0,c.nW9)(l,{columns:o.columnsData.filter(function(h){return h.toggled})}))}})}),Array.isArray(a)&&a.length?S().createElement("div",{className:s("Table-toolbar")},a.map(function(f,m){return i("action/".concat(m),(0,n.pi)({type:"button"},f),{onAction:t.handleAction,key:m,btnDisabled:o.dragging,data:o.getData(l)})})):null},d.prototype.handleSelected=function(e,t,r){return(0,n.mG)(this,void 0,void 0,function(){var a,i,o,s;return(0,n.Jh)(this,function(l){switch(l.label){case 0:return a=this.props,i=a.dispatchEvent,o=a.data,s=a.store,s.updateSelected(t),this.syncSelected(),[4,i("selectedChange",(0,c.nW9)(o,{selectedItems:e,unSelectedItems:r}))];case 1:return l.sent(),[2]}})})},d.prototype.handleSort=function(e){return(0,n.mG)(this,void 0,void 0,function(){var t,r,a,i,o;return(0,n.Jh)(this,function(s){switch(s.label){case 0:return t=this.props,r=t.dispatchEvent,a=t.data,i=t.onSort,[4,r("columnSort",(0,c.nW9)(a,{orderBy:e.orderBy,orderDir:e.orderDir}))];case 1:return o=s.sent(),o!=null&&o.prevented?[2,o==null?void 0:o.prevented]:(i&&i(e),[2])}})})},d.prototype.handleFilter=function(e){return(0,n.mG)(this,void 0,void 0,function(){var t,r,a,i,o;return(0,n.Jh)(this,function(s){switch(s.label){case 0:return t=this.props,r=t.dispatchEvent,a=t.data,i=t.onSearch,[4,r("columnFilter",(0,c.nW9)(a,e))];case 1:return o=s.sent(),o!=null&&o.prevented?[2,o==null?void 0:o.prevented]:(i&&i(e),[2])}})})},d.prototype.handleSearch=function(e,t){return(0,n.mG)(this,void 0,void 0,function(){var r,a,i,o,s,l,p;return(0,n.Jh)(this,function(u){switch(u.label){case 0:return r=this.props,a=r.data,i=r.dispatchEvent,o=r.store,s=r.onSearch,[4,i("columnSearch",(0,c.nW9)(a,{searchName:e,searchValue:t}))];case 1:return l=u.sent(),l!=null&&l.prevented?[2]:(o.updateQuery(t),s&&s((p={},p[e]=t[e],p)),[2])}})})},d.prototype.handleRowClick=function(e,t,r){return(0,n.mG)(this,void 0,void 0,function(){var a,i,o,s,l;return(0,n.Jh)(this,function(p){switch(p.label){case 0:return a=this.props,i=a.dispatchEvent,o=a.data,s=a.onRow,[4,i("rowClick",(0,c.nW9)(o,{item:t,index:r}))];case 1:return l=p.sent(),l!=null&&l.prevented?[2]:(t&&s&&s.onRowClick&&s.onRowClick(e,t,r),[2])}})})},d.prototype.handleRowDbClick=function(e,t,r){return(0,n.mG)(this,void 0,void 0,function(){var a,i,o,s,l;return(0,n.Jh)(this,function(p){switch(p.label){case 0:return a=this.props,i=a.dispatchEvent,o=a.data,s=a.onRow,[4,i("rowDbClick",(0,c.nW9)(o,{item:t,index:r}))];case 1:return l=p.sent(),l!=null&&l.prevented?[2,!1]:(t&&s&&s.onRowDbClick&&s.onRowDbClick(e,t,r),[2,!0])}})})},d.prototype.handleRowMouseEnter=function(e,t,r){var a;return(0,n.mG)(this,void 0,void 0,function(){var i,o,s,l,p;return(0,n.Jh)(this,function(u){switch(u.label){case 0:return(a=e==null?void 0:e.persist)===null||a===void 0||a.call(e),i=this.props,o=i.dispatchEvent,s=i.data,l=i.onRow,[4,o("rowMouseEnter",(0,c.nW9)(s,{item:t,index:r}))];case 1:return p=u.sent(),p!=null&&p.prevented?[2]:(t&&l&&l.onRowMouseEnter&&l.onRowMouseEnter(e,t,r),[2])}})})},d.prototype.handleRowMouseLeave=function(e,t,r){var a;return(0,n.mG)(this,void 0,void 0,function(){var i,o,s,l,p;return(0,n.Jh)(this,function(u){switch(u.label){case 0:return(a=e==null?void 0:e.persist)===null||a===void 0||a.call(e),i=this.props,o=i.dispatchEvent,s=i.data,l=i.onRow,[4,o("rowMouseLeave",(0,c.nW9)(s,{item:t,index:r}))];case 1:return p=u.sent(),p!=null&&p.prevented?[2]:(t&&l&&l.onRowMouseLeave&&l.onRowMouseLeave(e,t,r),[2])}})})},d.prototype.handleOrderChange=function(e,t,r){return(0,n.mG)(this,void 0,void 0,function(){var a,i;return(0,n.Jh)(this,function(o){return a=this.props.store,i=a.getRowByIndex(e,r),a.exchange(e,t,i),[2]})})},d.prototype.handleSaveOrder=function(){return(0,n.mG)(this,void 0,void 0,function(){var e,t,r,a,i,o,s,l;return(0,n.Jh)(this,function(p){switch(p.label){case 0:return e=this.props,t=e.store,r=e.onSaveOrder,a=e.data,i=e.dispatchEvent,o=t.movedRows.map(function(u){return u.data}),s=t.rows.map(function(u){return u.getDataWithModifiedChilden()}),[4,i("orderChange",(0,c.nW9)(a,{movedItems:o}))];case 1:return l=p.sent(),l!=null&&l.prevented?[2]:!r||!t.movedRows.length?[2]:(r(o,s),[2])}})})},d.prototype.doAction=function(e,t,r,a){var i=this;r===void 0&&(r=!1);var o=this.props,s=o.store,l=o.data,p=o.keyField,u=o.expandable,g=o.primaryField,f=e==null?void 0:e.actionType,m=s.keyField,h=s.getData(l).items||[];switch(f){case"selectAll":s.updateSelectedAll();break;case"clearAll":s.updateSelected([]);break;case"select":var y=[];h.forEach(function(F,T){var B=(0,c.fz_)((a==null?void 0:a.selected)||(a==null?void 0:a.selectedRowKeysExpr),{record:F,rowIndex:T});B&&y.push(F[m])}),s.updateSelected(y);break;case"expand":var w=g||(u==null?void 0:u.keyField)||p,v=[],R=[];if(a!=null&&a.value){var x=h.findIndex(function(F){return F[w]===a.value}),E=h[x];this.tableRef&&this.tableRef.isExpandableRow(E,x)&&(this.tableRef.isExpanded(E)?R.push(E):v.push(E))}else a!=null&&a.expandedRowsExpr&&h.forEach(function(F,T){var B=(0,c.fz_)(a==null?void 0:a.expandedRowsExpr,{record:F,rowIndex:T});B&&i.tableRef&&i.tableRef.isExpandableRow(F,T)&&(i.tableRef.isExpanded(F)?R.push(F):v.push(F))});v.length>0&&this.tableRef&&this.tableRef.onExpandRows(v),R.length>0&&this.tableRef&&this.tableRef.onCollapseRows(R);break;default:this.handleAction(void 0,e,l);break}},d.prototype.getRef=function(e){this.tableRef=e},d.prototype.renderTable=function(){var e=this.props,t=e.render,r=e.title,a=e.footer,i=e.rowSelection,o=e.selectable,s=e.multiple,l=e.columns,p=e.expandable,u=e.footSummary,g=e.headSummary,f=e.loading,m=e.classnames,h=e.placeholder,y=e.rowClassNameExpr,w=e.itemActions,v=e.keyField,R=e.primaryField,x=e.maxKeepItemSelectionLength,E=e.onRow,F=e.store,T=e.id,B=e.themeCss,W=(0,n._T)(e,["render","title","footer","rowSelection","selectable","multiple","columns","expandable","footSummary","headSummary","loading","classnames","placeholder","rowClassNameExpr","itemActions","keyField","primaryField","maxKeepItemSelectionLength","onRow","store","id","themeCss"]),re=void 0;if(w){var I=Array.isArray(w)?w.filter(function(K){return!K.hiddenOnHover}):[];if(!I.length)return null;re=function(K,$){return S().createElement("div",{className:m("Table-itemActions")},I.map(function(ae,D){return t("itemAction/".concat(D),(0,n.pi)((0,n.pi)({},ae),{isMenuItem:!0}),{key:D,item:K,data:K,rowIndex:$})}))}}var Z={data:this.props.data};return S().createElement(N.iA_,(0,n.pi)({},W,{headerClassName:(0,c.GwQ)((0,n.pi)((0,n.pi)({},this.props),{name:"tableHeadClassname",id:T,themeCss:B})),bodyClassname:(0,c.GwQ)((0,n.pi)((0,n.pi)({},this.props),{name:"tableBodyClassname",id:T,themeCss:B})),onRef:this.getRef,title:this.renderSchema("title",r,Z),footer:this.renderSchema("footer",a,Z),columns:this.columns,dataSource:F.dataSource,rowSelection:this.rowSelection,rowClassName:this.rowClassName,expandable:this.expandable,footSummary:this.buildSummary("footSummary",u),headSummary:this.buildSummary("headSummary",g),loading:this.renderSchema("loading",f,Z),placeholder:this.renderSchema("placeholder",h,Z),onSelect:this.handleSelected,onSelectAll:this.handleSelected,onSort:this.handleSort,onFilter:this.handleFilter,onDrag:this.handleOrderChange,itemActions:re,keyField:R||v,onRow:(0,n.pi)((0,n.pi)({},E),{onRowClick:this.handleRowClick,onRowDbClick:this.handleRowDbClick,onRowMouseEnter:this.handleRowMouseEnter,onRowMouseLeave:this.handleRowMouseLeave})}))},d.prototype.renderHeading=function(){var e=this.props,t=e.store,r=e.hideQuickSaveBtn,a=e.classnames,i=e.headingClassName,o=e.saveImmediately,s=e.quickSaveApi,l=e.translate,p=e.columns,u=!1;if(t.modifiedRows.length===1){var g=(p==null?void 0:p.map(function(h){var y;return!((y=h==null?void 0:h.quickEdit)===null||y===void 0)&&y.saveImmediately?h==null?void 0:h.name:""}).filter(function(h){return h}))||[],f=t.modifiedRows[0],m=(0,c.e50)(f.data,f.pristine);ye()(g,Object.keys(m)).length&&(u=!0)}return s&&!o&&!u&&t.modified&&!r||t.moved?S().createElement("div",{className:a("Table-heading",i),key:"heading"},!o&&t.modified&&!r&&!u?S().createElement("span",null,l("Table.modified",{modified:t.modified}),S().createElement("button",{type:"button",className:a("Button Button--size-xs Button--success m-l-sm"),onClick:this.handleSave},S().createElement(N.JO$,{icon:"check",className:"icon m-r-xs"}),l("Form.submit")),S().createElement("button",{type:"button",className:a("Button Button--size-xs Button--danger m-l-sm"),onClick:this.reset},S().createElement(N.JO$,{icon:"close",className:"icon m-r-xs"}),l("Table.discard"))):t.moved?S().createElement("span",null,l("Table.moved",{moved:t.moved}),S().createElement("button",{type:"button",className:a("Button Button--size-xs Button--success m-l-sm"),onClick:this.handleSaveOrder},S().createElement(N.JO$,{icon:"check",className:"icon m-r-xs"}),l("Form.submit")),S().createElement("button",{type:"button",className:a("Button Button--size-xs Button--danger m-l-sm"),onClick:this.reset},S().createElement(N.JO$,{icon:"close",className:"icon m-r-xs"}),l("Table.discard"))):""):null},d.prototype.render=function(){var e=this.props,t=e.classnames,r=e.style,a=e.store,i=e.themeCss,o=e.wrapperCustomStyle,s=e.id,l=e.env;this.renderedToolbars=[];var p=this.renderHeading();return S().createElement("div",{className:t("Table-render-wrapper",(0,c.GwQ)((0,n.pi)((0,n.pi)({},this.props),{name:"wrapperCustomStyle",id:s,themeCss:o})),{"Table--unsaved":!!a.modified||!!a.moved}),style:r},this.renderActions("header"),p,this.renderTable(),S().createElement(c.cWM,(0,n.pi)({},this.props,{config:{themeCss:i,classNames:[{key:"tableHeadClassname",weights:{default:{inner:".".concat(t("Table-table")," > thead > tr > th"),important:!0}}},{key:"tableHeadClassname",weights:{default:{inner:"> tr > th",important:!0}}},{key:"tableBodyClassname",weights:{default:{inner:"> tbody.".concat(t("Table-tbody")," > tr  td")},hover:{suf:"> tbody > tr",inner:"td",important:!0}}},{key:"tableRowClassname",weights:{default:{parent:".".concat(t("Table-table")," > tbody.").concat(t("Table-tbody")),inner:"td.".concat(t("Table-cell"))},hover:{parent:".".concat(t("Table-table")," > tbody.").concat(t("Table-tbody")),inner:"td.".concat(t("Table-cell"))}}}],wrapperCustomStyle:o,id:s},env:l})))},d.contextType=c.ZHe,d.propsList=["source","columnsTogglable","columns","items","rowSelection","expandable","sticky","itemBadge","popOverContainer","keyField","childrenColumnName","rowClassNameExpr","lineHeight","bordered","footer","maxKeepItemSelectionLength","keepItemSelectionOnPageChange","itemActions","headingClassName","footSummary","headSummary","saveImmediately","selectable","multiple","primaryField","hideQuickSaveBtn","selected","placeholder","autoFillHeight"],d.defaultProps={keyField:"id",canAccessSuperData:!1,lazyRenderAfter:100},(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[]),(0,n.w6)("design:returntype",void 0)],d.prototype,"getPopOverContainer",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Number,Number]),(0,n.w6)("design:returntype",void 0)],d.prototype,"subFormRef",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[]),(0,n.w6)("design:returntype",void 0)],d.prototype,"reset",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Number]),(0,n.w6)("design:returntype",void 0)],d.prototype,"rowClassName",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Number]),(0,n.w6)("design:returntype",void 0)],d.prototype,"expandedRowClassName",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Number]),(0,n.w6)("design:returntype",void 0)],d.prototype,"expandedRowRender",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Number,Array]),(0,n.w6)("design:returntype",void 0)],d.prototype,"rowExpandable",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[]),(0,n.w6)("design:returntype",Promise)],d.prototype,"handleSave",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Object,Array,Array,Object,Object]),(0,n.w6)("design:returntype",void 0)],d.prototype,"handleQuickSave",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Object,Object,Boolean,Object]),(0,n.w6)("design:returntype",void 0)],d.prototype,"handleQuickChange",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Object,Object]),(0,n.w6)("design:returntype",void 0)],d.prototype,"handleAction",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Array,Array,Array]),(0,n.w6)("design:returntype",Promise)],d.prototype,"handleSelected",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object]),(0,n.w6)("design:returntype",Promise)],d.prototype,"handleSort",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object]),(0,n.w6)("design:returntype",Promise)],d.prototype,"handleFilter",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[String,Object]),(0,n.w6)("design:returntype",Promise)],d.prototype,"handleSearch",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Object,Number]),(0,n.w6)("design:returntype",Promise)],d.prototype,"handleRowClick",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Object,Number]),(0,n.w6)("design:returntype",Promise)],d.prototype,"handleRowDbClick",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Object,Number]),(0,n.w6)("design:returntype",Promise)],d.prototype,"handleRowMouseEnter",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object,Object,Number]),(0,n.w6)("design:returntype",Promise)],d.prototype,"handleRowMouseLeave",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Number,Number,Array]),(0,n.w6)("design:returntype",Promise)],d.prototype,"handleOrderChange",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[]),(0,n.w6)("design:returntype",Promise)],d.prototype,"handleSaveOrder",null),(0,n.gn)([c.NjZ,(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[Object]),(0,n.w6)("design:returntype",void 0)],d.prototype,"getRef",null),d}(S().Component),de=function(C){(0,n.ZT)(d,C);function d(){return C!==null&&C.apply(this,arguments)||this}return d.prototype.receive=function(e,t){var r,a,i,o=this.context;if(!((r=this.props)===null||r===void 0)&&r.host)return(i=(a=this.props.host).receive)===null||i===void 0?void 0:i.call(a,e,t);if(t)return o.send(t,e)},d.prototype.reload=function(e,t,r){var a,i,o,s,l=this.context,p=(a=l==null?void 0:l.parent)===null||a===void 0?void 0:a.getComponents();if(!((i=this.props)===null||i===void 0)&&i.host)return(s=(o=this.props.host).reload)===null||s===void 0?void 0:s.call(o,e,t,r);if(e)return l.reload(e,r)},d.prototype.setData=function(e,t,r,a){var i;return(0,n.mG)(this,void 0,void 0,function(){var o,s,l,p,u,g,f,m,h;return(0,n.Jh)(this,function(y){switch(y.label){case 0:return o=this.props.store,s=o.data.rows.length,r===void 0?[3,1]:(l=(0,n.ev)([],(0,n.CR)(o.data.rows),!1),p=String(r).split(","),p.forEach(function(w){var v=Number(w);l.splice(v,1,e)}),[2,o.updateData({rows:l},void 0,t)]);case 1:if(a===void 0)return[3,6];u=(0,n.ev)([],(0,n.CR)(o.data.rows),!1),g=0,y.label=2;case 2:return g<s?(f=u[g],[4,(0,c.Cjz)(a,f)]):[3,5];case 3:m=y.sent(),m&&u.splice(g,1,e),y.label=4;case 4:return g++,[3,2];case 5:return[2,o.updateData({rows:u},void 0,t)];case 6:return h=(0,n.pi)((0,n.pi)({},e),{rows:(i=e.rows)!==null&&i!==void 0?i:e.items}),[2,o.updateData(h,void 0,t)]}})})},d.prototype.getData=function(){var e=this.props,t=e.store,r=e.data;return t.getData(r)},d=(0,n.gn)([(0,c.Thl)({type:"table2",storeType:c.QjV.name,name:"table2",isolateScope:!0})],d),d}(X)}}]);
