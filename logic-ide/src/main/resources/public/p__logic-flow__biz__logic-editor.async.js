"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[883],{98295:function(a_,A,e){e.r(A);var ne=e(25359),y=e.n(ne),se=e(93525),g=e.n(se),te=e(49811),ae=e.n(te),oe=e(57213),c=e.n(oe),re=e(54306),r=e.n(re),le=e(60341),O=e(83217),ie=e(72197),m=e(54145),P=e(51394),I=e(36267),a=e(87363),o_=e.n(a),ue=e(98306),de=e(5671),ce=e(14990),Ee=e(22465),ve=e(72237),me=e(93853),De=e(28110),ge=e(49228),Oe=e(79716),Pe=e(88090),pe=e(44174),Me=e(2325),p=e(48364),fe=e(44095),R=e(3619),Ce=e(7944),E=e(94744),Se=e(5726),he=e.n(Se),Te=e(79671),j=e(44132),Le=e(32126),s=e(33130),Be=function(){var Ue=(0,a.useState)({}),W=r()(Ue,2),u=W[0],M=W[1],xe=(0,a.useState)({}),K=r()(xe,2),Ae=K[0],ye=K[1],Ie=(0,a.useState)({}),b=r()(Ie,2),Re=b[0],je=b[1],We=(0,a.useState)(!0),J=r()(We,2),f=J[0],Ke=J[1],be=(0,a.useState)(!1),Z=r()(be,2),Je=Z[0],i=Z[1],Ze=(0,a.useState)("1"),N=r()(Ze,2),C=N[0],l_=N[1],Ne=(0,a.useState)(),G=r()(Ne,2),S=G[0],Ge=G[1],ze=(0,a.useState)([]),z=r()(ze,2),$e=z[0],we=z[1],Fe=(0,a.useState)([]),$=r()(Fe,2),He=$[0],Ye=$[1],Ve=(0,a.useState)(!1),w=r()(Ve,2),F=w[0],H=w[1],Qe=(0,a.useState)(!1),Y=r()(Qe,2),V=Y[0],h=Y[1],Xe=(0,a.useState)(new Map),Q=r()(Xe,2),D=Q[0],X=Q[1],ke=(0,ue.UO)(),T=ke.id,qe=new Pe.W;function k(_){window.document.title="["+_.name+"]:"+_.version}function q(){i(!0);var _=qe.graphToLogicItems(S,u);_.version=ee(),M(_),_e(_),k(_)}function ee(){return he()(Date.now()).format("YYYYMMDDHHmmss")}function _e(_){(0,p.az)(T,_.version,JSON.stringify(_)).then(function(n){i(!1),console.log("save logic"),console.log(_),n.status==200?(O.ZP.success("\u4FDD\u5B58\u6210\u529F"),console.log("save logic success")):(O.ZP.error("\u4FDD\u5B58\u5931\u8D25\uFF1A"+n.statusText),console.error("save logic error"))}).catch(function(n){i(!1),console.log("err"),console.log(n),O.ZP.error("\u4FDD\u5B58\u5931\u8D25")})}(0,a.useEffect)(function(){ye({jsTips:c()({},D)})},[D]);function e_(_){var n,o,t,v,l={};l._par=_.params,l._var=_.variables,X(c()(c()({},D),l));var B=E.y.getParamArrayByJson(JSON.parse((n=_.params)!==null&&n!==void 0?n:"{}")),d=E.y.getReturnArrayByJson(JSON.parse((o=_.returns)!==null&&o!==void 0?o:"{}")),U=E.y.getVariableArrayByJson(JSON.parse((t=_.variables)!==null&&t!==void 0?t:"{}")),t_=E.y.getEnvsArrayByJson(JSON.parse((v=_.envs)!==null&&v!==void 0?v:"{}")),x=c()(c()({},u),{},{params:B,returns:d,variables:U,envs:t_,log:_.log});x.version=ee(),M(x),_e(x)}function __(_){return L.apply(this,arguments)}function L(){return L=ae()(y()().mark(function _(n){var o,t;return y()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return o={},o._par=JSON.stringify(E.y.getJsonByParams(n.params)),o._var=JSON.stringify(E.y.getJsonByParams(n.variables)),l.next=5,Le.S.getEnvJson();case 5:t=l.sent,o._env=JSON.stringify(t),o._lastRet="{}",o._last=JSON.stringify({success:!0,msg:""}),X(o),i(!1);case 11:case"end":return l.stop()}},_)})),L.apply(this,arguments)}function n_(_){(0,p.qB)(_).then(function(n){var o=n.name,t=n.configJson;t.id=_,t.name=o,M(t),je(t==null?void 0:t.visualConfig),__(t),k(t)}).catch(function(n){i(!1),console.log("err"),console.log(n)})}(0,a.useEffect)(function(){(0,fe.m)(g()(Me.C.values())),i(!0),n_(T),(0,Oe.O)().then(function(_){Ye(_.Groups),we(_.Nodes)})},[]);var s_=(0,a.useCallback)(function(){return new de.bn.kS({attrs:{line:{targetMarker:"classic",stroke:C=="1"?"#000000":"#FF9900"}},zIndex:0,data:{type:C}})},[C]);return(0,s.jsx)("div",{children:(0,s.jsx)(ie.Z,{spinning:Je,children:(0,s.jsx)(le.l,{editorCtx:Ae,panelData:{Nodes:g()($e),Groups:[{name:"ctrl",title:"\u903B\u8F91\u63A7\u5236",graphHeight:360}].concat(g()(He))},showLeft:f,graphIns:S,toolElements:[(0,s.jsx)(m.ZP,{type:"text",icon:f?(0,s.jsx)(ce.Z,{}):(0,s.jsx)(Ee.Z,{}),onClick:function(){Ke(!f)},style:{fontSize:"16px",width:64,height:64}}),(0,s.jsx)(m.ZP,{icon:(0,s.jsx)(ve.Z,{}),type:"primary",onClick:function(){return q()},children:"\u4FDD\u5B58"}),(0,s.jsx)(Ce.Z,{open:F,values:c()({},u),setOpen:function(){H(!F)},onSubmit:e_,children:(0,s.jsx)(m.ZP,{onClick:function(){return H(!0)},icon:(0,s.jsx)(me.Z,{style:{color:"#1677ff"}}),children:"\u53C2\u6570"})}),(0,s.jsx)(Te.Z,{open:V,setOpen:function(){return h(!V)},values:{params:u==null?void 0:u.params},onSubmit:function(n,o){if(h(!1),u){var t=n.params,v=n.bizId,l=n.headers,B=n.bizStartCode;i(!0),(0,p.L7)(T,JSON.parse(t),v,B,o,JSON.parse(l)).then(function(d){d.data.code==0?(i(!1),P.Z.success({title:"\u6267\u884C\u6210\u529F",width:"1000px",closable:!0,content:(0,s.jsx)("div",{children:(0,s.jsx)(j.Z,{pageId:"debug-info",data:d.data})})})):(i(!1),P.Z.error({title:(0,s.jsx)("span",{children:d.data.msg}),width:"1200px",closable:!0,content:(0,s.jsx)("div",{children:(0,s.jsx)(j.Z,{pageId:"debug-info",data:d.data})})}))}).catch(function(d){i(!1);var U=d.response.data;P.Z.error({title:(0,s.jsx)("span",{children:U.msg}),width:"1200px",closable:!0})})}},children:(0,s.jsx)(m.ZP,{onClick:function(){h(!0)},icon:(0,s.jsx)(De.Z,{style:{color:"#1677ff"}}),children:"\u8C03\u8BD5"})}),(0,s.jsx)(m.ZP,{icon:(0,s.jsx)(ge.Z,{style:{color:"#1677ff"}}),onClick:function(){(0,R.V)(S)},children:"\u5E03\u5C40"}),(0,s.jsxs)(I.Z.Text,{strong:!0,style:{fontSize:"18px"},children:["[",u.name,"]"]}),(0,s.jsxs)(I.Z.Text,{children:["\u7248\u672C:",u.version]})],graphJson:Re,onGraphJsonEmpty:pe.n,createEdge:s_,edgeTools:["button-remove","vertices","segments"],onSave:function(){return q()},jsTipMap:D,autoLayout:function(n){return(0,R.V)(n)},onGraphInsChange:function(n){return Ge(n)}})})})};A.default=Be}}]);
