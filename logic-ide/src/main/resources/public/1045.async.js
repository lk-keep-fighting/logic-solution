"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[1045],{51045:function(H,V,m){m.r(V),m.d(V,{ChainedSelectControlRenderer:function(){return G},default:function(){return j}});var n=m(15767),x=m(87363),b=m.n(x),k=m(84875),D=m.n(k),_=m(42977),T=m(94391),F=m(45581),L=m(33170),W=m.n(L),K=m(82691),w=m.n(K),j=function(N){(0,n.ZT)(u,N);function u(t){var e=N.call(this,t)||this;return e.state={stack:[]},e.handleChange=e.handleChange.bind(e),e.loadMore=e.loadMore.bind(e),e}return u.prototype.componentDidMount=function(){var t,e,a=this.props.formInited;a||!this.props.addHook?this.loadMore():(e=(t=this.props).addHook)===null||e===void 0||e.call(t,this.loadMore,"init")},u.prototype.componentDidUpdate=function(t){var e=this.props;t.options!==e.options?this.setState({stack:[]}):e.formInited&&e.value!==t.value&&this.loadMore()},u.prototype.doAction=function(t,e,a){var o,h,c=this.props,g=c.resetValue,f=c.onChange,r=c.formStore,v=c.store,y=c.name,C=t==null?void 0:t.actionType;if(C==="clear")f("");else if(C==="reset"){var l=(h=(0,_.E04)((o=r==null?void 0:r.pristine)!==null&&o!==void 0?o:v==null?void 0:v.pristine,y))!==null&&h!==void 0?h:g;f(l!=null?l:"")}},u.prototype.array2value=function(t,e){e===void 0&&(e=!1);var a=this.props,o=a.delimiter,h=a.joinValues,c=a.extractValue,g=a.valueField;return e?h?t.join(o||","):t:h?t.join(o||","):c?t.map(function(f){return f[g||"value"]||f}):t},u.prototype.loadMore=function(){for(var t=this,e=this.props,a=e.value,o=e.delimiter,h=e.onChange,c=e.joinValues,g=e.extractValue,f=e.valueField,r=e.source,v=e.data,y=e.env,C=e.dispatchEvent,l=Array.isArray(a)?a.concat():a&&typeof a=="string"?a.split(o||","):[],i=0,d=this.state.stack.length;i<d&&l[i]&&this.state.stack[i].parentId==(c||g?l[i]:l[i][f||"value"]);)i++;if(!(!l[i]||!y||!(0,_.X1t)(r,v))){var p=c||g?l[i]:l[i][f||"value"],M=this.state.stack.concat();M.splice(i,M.length-i),M.push({parentId:p,loading:!0,options:[]}),this.setState({stack:M},function(){y.fetcher(r,(0,n.pi)((0,n.pi)({},v),{value:l,level:i+1,parentId:p,parent:l[i]})).then(function(s){return(0,n.mG)(t,void 0,void 0,function(){var P,A,E,O,B,I,S,R;return(0,n.Jh)(this,function(U){switch(U.label){case 0:return P=this.state.stack.concat(),A=s.data?s.data[f||"value"]:void 0,E=((I=s==null?void 0:s.data)===null||I===void 0?void 0:I.options)||((S=s==null?void 0:s.data)===null||S===void 0?void 0:S.items)||((R=s==null?void 0:s.data)===null||R===void 0?void 0:R.rows)||s.data||[],P.splice(i,P.length-i),typeof A=="undefined"?[3,2]:(l.splice(i+1,a.length-i-1),l.push(A),O=this.array2value(l,!0),[4,C("change",(0,_.vXk)(this.props,{value:O}))]);case 1:if(B=U.sent(),B!=null&&B.prevented)return[2];h(O),U.label=2;case 2:return P.push({options:E,parentId:p,loading:!1,visible:Array.isArray(E)&&!w()(E)}),this.setState({stack:P},this.loadMore),[2]}})})}).catch(function(s){!(r!=null&&r.silent)&&y.notify("error",s.message)})})}},u.prototype.handleChange=function(t,e){return(0,n.mG)(this,void 0,void 0,function(){var a,o,h,c,g,f,r,v,y,C,l,i,d;return(0,n.Jh)(this,function(p){switch(p.label){case 0:return a=this.props,o=a.value,h=a.delimiter,c=a.onChange,g=a.joinValues,f=a.extractValue,r=a.dispatchEvent,v=a.valueField,y=a.data,C=Array.isArray(o)?o.concat():o&&typeof o=="string"?o.split(h||","):[],C.splice(t,C.length-t),l=g?e[v||"value"]:e,l!==void 0&&C.push(l),i=this.array2value(C),[4,r("change",(0,_.vXk)(this.props,{value:i}))];case 1:return d=p.sent(),d!=null&&d.prevented?[2]:(c(i),[2])}})})},u.prototype.reload=function(t,e){var a=this.props.reloadOptions;a&&a(t,e)},u.prototype.renderStatic=function(t){t===void 0&&(t="-");var e=this.props,a=e.options,o=a===void 0?[]:a,h=e.labelField,c=e.valueField,g=e.classPrefix,f=e.classnames,r=e.className,v=e.value,y=e.delimiter,C=(0,n.ev)([{options:o,visible:!0}],(0,n.CR)(this.state.stack||[]),!1),l=Array.isArray(v)?v.concat():v&&typeof v=="string"?v.split(y||","):[];return(l==null?void 0:l.length)>0&&(t=l.map(function(i,d){var p,M=C[d]||{},s=M.options,P=M.visible;if(P===!1)return null;if(!s||!s.length)return i;var A=W()(s,function(E){return i===E[c||"value"]})||{};return(p=A[h||"label"])!==null&&p!==void 0?p:i}).filter(function(i){return i!=null}).join(" > ")),b().createElement("div",{className:f("".concat(g,"SelectStaticControl"),r)},t)},u.prototype.render=function(){var t=this,e=this.props,a=e.options,o=e.classPrefix,h=e.className,c=e.style,g=e.inline,f=e.loading,r=e.value,v=e.delimiter,y=e.joinValues,C=e.extractValue,l=e.multiple,i=e.mobileUI,d=e.env,p=e.testIdBuilder,M=e.popoverClassName,s=(0,n._T)(e,["options","classPrefix","className","style","inline","loading","value","delimiter","joinValues","extractValue","multiple","mobileUI","env","testIdBuilder","popoverClassName"]),P=Array.isArray(r)?r.concat():r&&typeof r=="string"?r.split(v||","):[],A=this.props,E=A.themeCss,O=A.id,B=this.state.stack.find(function(I){return I.loading});return b().createElement("div",{className:D()("".concat(o,"ChainedSelectControl"),h)},b().createElement(T.PhF,(0,n.pi)({},s,{mobileUI:i,popOverContainer:i?d==null?void 0:d.getModalContainer:s.popOverContainer||(d==null?void 0:d.getModalContainer),className:D()((0,_.GwQ)((0,n.pi)((0,n.pi)({},this.props),{name:"chainedSelectControlClassName",id:O,themeCss:E}))),popoverClassName:D()(M,(0,_.GwQ)((0,n.pi)((0,n.pi)({},this.props),{name:"chainedSelectPopoverClassName",id:O,themeCss:E}))),controlStyle:c,classPrefix:o,key:"base",testIdBuilder:p==null?void 0:p.getChild("base"),options:Array.isArray(a)?a:[],value:P[0],onChange:this.handleChange.bind(this,0),loading:f,inline:!0})),this.state.stack.map(function(I,S){var R=I.options,U=I.loading,Q=I.visible;return Q===!1||U?null:b().createElement(T.PhF,(0,n.pi)({},s,{mobileUI:i,popOverContainer:i?d.getModalContainer:s.popOverContainer||(d==null?void 0:d.getModalContainer),classPrefix:o,key:"x-".concat(S+1),testIdBuilder:p==null?void 0:p.getChild("x-".concat(S+1)),options:Array.isArray(R)?R:[],value:P[S+1],onChange:t.handleChange.bind(t,S+1),inline:!0,controlStyle:c,className:D()((0,_.GwQ)((0,n.pi)((0,n.pi)({},t.props),{name:"chainedSelectControlClassName",id:O,themeCss:E}))),popoverClassName:D()(M,(0,_.GwQ)((0,n.pi)((0,n.pi)({},t.props),{name:"chainedSelectPopoverClassName",id:O,themeCss:E})))}))}),B&&b().createElement(T.$jN,{size:"sm",className:D()("".concat(o,"ChainedSelectControl-spinner"))}),b().createElement(_.cWM,(0,n.pi)({},this.props,{config:{themeCss:E,classNames:[{key:"chainedSelectControlClassName",weights:{focused:{suf:".is-opened:not(.is-mobile)"},disabled:{suf:".is-disabled"}}},{key:"chainedSelectPopoverClassName",weights:{default:{suf:" .".concat(o,"Select-option")},hover:{suf:" .".concat(o,"Select-option.is-highlight")},focused:{inner:".".concat(o,"Select-option.is-active")}}}],id:O},env:d})))},u.defaultProps={clearable:!1,searchable:!1,multiple:!0},(0,n.gn)([(0,F.i)(),(0,n.w6)("design:type",Function),(0,n.w6)("design:paramtypes",[]),(0,n.w6)("design:returntype",void 0)],u.prototype,"render",null),u}(b().Component),G=function(N){(0,n.ZT)(u,N);function u(){return N!==null&&N.apply(this,arguments)||this}return u=(0,n.gn)([(0,_.oZB)({type:"chained-select",sizeMutable:!1})],u),u}(j)}}]);
