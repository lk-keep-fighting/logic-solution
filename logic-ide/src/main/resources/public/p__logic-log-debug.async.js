"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[5612],{28635:function($,y,e){e.d(y,{Z:function(){return x}});var F=e(56159),r=e(87363),b={icon:function(f,o){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:f}},{tag:"path",attrs:{d:"M512 140c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm193.4 225.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.3 0 19.9 5 25.9 13.3l71.2 98.8 157.2-218c6-8.4 15.7-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.4 12.7z",fill:o}},{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z",fill:f}}]}},name:"check-circle",theme:"twotone"},T=b,I=e(92335),A=function(f,o){return r.createElement(I.Z,(0,F.Z)({},f,{ref:o,icon:T}))},x=r.forwardRef(A)},79549:function($,y,e){e.d(y,{Z:function(){return x}});var F=e(56159),r=e(87363),b={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M288 421a48 48 0 1096 0 48 48 0 10-96 0zm352 0a48 48 0 1096 0 48 48 0 10-96 0zM512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm263 711c-34.2 34.2-74 61-118.3 79.8C611 874.2 562.3 884 512 884c-50.3 0-99-9.8-144.8-29.2A370.4 370.4 0 01248.9 775c-34.2-34.2-61-74-79.8-118.3C149.8 611 140 562.3 140 512s9.8-99 29.2-144.8A370.4 370.4 0 01249 248.9c34.2-34.2 74-61 118.3-79.8C413 149.8 461.7 140 512 140c50.3 0 99 9.8 144.8 29.2A370.4 370.4 0 01775.1 249c34.2 34.2 61 74 79.8 118.3C874.2 413 884 461.7 884 512s-9.8 99-29.2 144.8A368.89 368.89 0 01775 775zM512 533c-85.5 0-155.6 67.3-160 151.6a8 8 0 008 8.4h48.1c4.2 0 7.8-3.2 8.1-7.4C420 636.1 461.5 597 512 597s92.1 39.1 95.8 88.6c.3 4.2 3.9 7.4 8.1 7.4H664a8 8 0 008-8.4C667.6 600.3 597.5 533 512 533z"}}]},name:"frown",theme:"outlined"},T=b,I=e(92335),A=function(f,o){return r.createElement(I.Z,(0,F.Z)({},f,{ref:o,icon:T}))},x=r.forwardRef(A)},11397:function($,y,e){e.r(y),e.d(y,{default:function(){return me}});var F=e(54306),r=e.n(F),b=e(48364),T=e(28635),I=e(79549),A=e(72197),x=e(8051),N=e(4283),f=e(36267),o=e(87363),_=e(98306),ee=e(14990),ne=e(22465),U=e(5671),te=e(17696),oe=e(19227),ie=e(75476),le=e(1167),ae=e(22150),p=e(23360),W=e(54145),de=e(91711),re=e(58146),se=e(89147),ue=e(3619),ce=e(9976),ve=e(34957),B=e(94990),n=e(33130),fe=function(s){var C,E,j,R=(0,o.useState)(),w=r()(R,2),a=w[0],z=w[1],k=(0,o.useState)(),Z=r()(k,2),S=Z[0],O=Z[1],t=(0,o.useState)(!0),J=r()(t,2),v=J[0],L=J[1],Se=(0,o.useState)(),G=r()(Se,2),c=G[0],K=G[1],Ce=(0,o.useState)(),V=r()(Ce,2),m=V[0],ye=V[1],be=(0,o.useState)(),Y=r()(be,2),H=Y[0],je=Y[1],Ze=(0,o.useState)(),Q=r()(Ze,2),M=Q[0],X=Q[1],q=(0,o.useRef)();function Le(i,g,d,u){return{name:"button",args:{markup:[{tagName:"circle",selector:"button",attrs:{r:14,x:0,y:0,stroke:"#fe854f","stroke-width":5-d<1?1:5-d,fill:"white",cursor:"pointer"}},{tagName:"text",textContent:i,selector:"icon",attrs:{fill:"#fe854f","font-size":20-d<12?12:20-d,"text-anchor":"middle","pointer-events":"none",y:"0.3em"}}],x:(u-1)*28,y:0,onClick:function(l){var P=l.view,Te=P.cell;X(Te),L(!1),K(g)}}}}(0,o.useEffect)(function(){H&&(a==null||a.centerCell(H))},[H,a]),(0,o.useEffect)(function(){var i=a==null?void 0:a.getNodes().find(function(g){return g.id==s.nextId});i==null||i.attr("body/fill","red"),je(i)},[s.nextId]),(0,o.useEffect)(function(){var i;a==null||(i=a.getNodes().find(function(g){return g.id==s.nextId}))===null||i===void 0||i.attr("body/fill","red")},[a]),(0,o.useEffect)(function(){s.config&&O(s.config)},[s.config]),(0,o.useEffect)(function(){if(console.log("props.logicLog",s.logicLog),s.logicLog){var i=s.logicLog;ye(s.logicLog),a==null||a.fromJSON(S==null?void 0:S.visualConfig);var g,d={};i&&i.itemLogs&&(i.itemLogs.forEach(function(u,h){var l=a==null?void 0:a.getNodes().find(function(P){return P.id==u.config.id});console.log("\u9009\u4E2D\u7684\u8282\u70B9"),console.log(l),l&&(l.addTools({name:"boundary",args:{attrs:{stroke:"red",strokeWidth:1.5,rx:5,ry:5}}}),g=l),d[l==null?void 0:l.id]?d[l==null?void 0:l.id]+=1:d[l==null?void 0:l.id]=1,l==null||l.addTools(Le(h,u,h,d[l==null?void 0:l.id]))}),a==null||a.centerCell(g),K({}),X({}))}},[s.logicLog,a]),(0,o.useEffect)(function(){if(S){try{var i=(0,re.K)(),g=i.Shapes;(0,se.m)(g)}catch(u){console.error("\u6CE8\u518C\u8282\u70B9\u51FA\u9519\uFF1A"),console.error(u)}var d=new U.kJ({container:q.current,embedding:{enabled:!0,validate:function(h){return h.child.setData({hoverNode:h.parent}),!0}},mousewheel:{enabled:!0,modifiers:"ctrl",minScale:.5,maxScale:3},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:15}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,allowMulti:!0,snap:{radius:20},createEdge:function(){return new U.bn.kS({tools:[{name:"edge-editor",args:{attrs:{backgroundColor:"#fff"}}}],zIndex:0})},validateConnection:function(h){var l=h.targetMagnet;return!!l}},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5F95FF",stroke:"#5F95FF"}}}},background:{color:"#F2F7FA"},grid:!0});d.use(new le.H({enabled:!0,sharp:!0})).use(new te.A({enabled:!0})).use(new ie.Y({enabled:!0,multiple:!0,strict:!0,rubberband:!0,movable:!0,showNodeSelectionBox:!0,pointerEvents:"none"})).use(new ae.T({enabled:!0})).use(new oe.N),d.on("edge:dblclick",function(){}),d.on("edge:mouseenter",function(){}),d.on("edge:mouseleave",function(){}),d.on("node:moved",function(){}),d.on("node:mouseenter",function(){}),d.on("node:mouseleave",function(){}),d.on("node:added",function(){}),d.on("node:dblclick",function(u){var h=u.node}),d.on("blank:dblclick",function(u){var h=u.x,l=u.y}),d.fromJSON(S.visualConfig),(0,ue.V)(d),z(d)}},[S]);var Fe=[{key:"debug-node-input",label:"\u8282\u70B9\u5165\u51FA\u53C2",children:(0,n.jsxs)("div",{children:[(0,n.jsx)(B.Z,{formId:"debug-node-input",values:{returnData:c==null?void 0:c.returnData,body:c==null||(C=c.configInstance)===null||C===void 0?void 0:C.body},onSubmit:function(){}}),(0,n.jsx)(f.Z.Text,{style:{marginLeft:"15px"},copyable:{tooltips:["\u590D\u5236\u8282\u70B9\u7F16\u53F7","\u590D\u5236\u6210\u529F!"],text:M==null?void 0:M.id},children:"\u8282\u70B9\u7F16\u53F7"})]})},{key:"config",label:"\u8282\u70B9\u914D\u7F6E",children:(0,n.jsx)(ve.Z,{onSubmit:function(){},editNode:M})},{key:"configIns",label:"\u8282\u70B9\u5B9E\u4F8B",children:(0,n.jsx)(B.Z,{formId:(c==null||(E=c.config)===null||E===void 0?void 0:E.type)||"",values:c==null?void 0:c.configInstance,onSubmit:function(){}})},{key:"debug-context",label:"\u6267\u884C\u4E0A\u4E0B\u6587",children:(0,n.jsx)(B.Z,{formId:"debug-context",values:{varsJson:m==null?void 0:m.varsJson,paramsJson:m==null?void 0:m.paramsJson,varsJsonEnd:m==null?void 0:m.varsJsonEnd},onSubmit:function(){}})}];return(0,n.jsxs)(p.Z,{style:{margin:0,height:"100vh"},children:[(0,n.jsxs)(p.Z,{children:[(0,n.jsxs)(p.Z.Header,{style:{backgroundColor:"white",padding:0},children:[(j=s.btns)===null||j===void 0?void 0:j.map(function(i){return i}),(0,n.jsx)(W.ZP,{type:"text",icon:v?(0,n.jsx)(ee.Z,{}):(0,n.jsx)(ne.Z,{}),onClick:function(){L(!v)},style:{float:"right",right:"16px",fontSize:"16px",width:64,height:64}})]}),(0,n.jsx)(p.Z.Content,{className:"app-content",children:(0,n.jsx)(ce.Z,{ref:q})})]}),(0,n.jsxs)(p.Z.Sider,{theme:"light",collapsed:v,collapsedWidth:0,style:{overflow:"scroll"},width:500,children:[(0,n.jsx)(de.Z,{items:Fe,defaultActiveKey:"inout"}),(0,n.jsx)(W.ZP,{type:"text",onClick:function(){L(!v)},style:{position:"absolute",top:0,right:0,fontSize:"16px",width:64,height:64},children:"x"})]})]})},ge=fe;function he(D){window.document.title="-["+D.name+"]\u65E5\u5FD7"}var xe=function(){var s=(0,_.UO)(),C=s.id,E=(0,o.useState)(),j=r()(E,2),R=j[0],w=j[1],a=(0,o.useState)(!1),z=r()(a,2),k=z[0],Z=z[1],S=(0,o.useState)({}),O=r()(S,2),t=O[0],J=O[1];return(0,o.useEffect)(function(){Z(!0),t&&(0,b.Uh)(t.logicId,t.version).then(function(v){var L=v.configJson;w(L),Z(!1),he(L)}).catch(function(v){Z(!1),console.log("err"),console.log(v)})},[t]),(0,o.useEffect)(function(){C&&(0,b.yi)(C).then(function(v){debugger;v&&J(v)})},[C]),(0,n.jsx)("div",{children:(0,n.jsx)(A.Z,{spinning:k,children:(0,n.jsx)(ge,{btns:[(0,n.jsx)(x.Z,{type:"vertical"}),(0,n.jsx)(x.Z,{type:"vertical"}),(0,n.jsxs)("span",{children:["\u662F\u5426\u5B8C\u6210\uFF1A",t!=null&&t.isOver?(0,n.jsx)(T.Z,{twoToneColor:"#52c41a"}):(0,n.jsx)(I.Z,{twoToneColor:"red"})]}),(0,n.jsx)(x.Z,{type:"vertical"}),(0,n.jsxs)("span",{children:["\u5F85\u6267\u884C\uFF1A",t==null?void 0:t.nextName]}),(0,n.jsx)(x.Z,{type:"vertical"}),(0,n.jsxs)(N.Z,{children:["\u4E1A\u52A1\u6807\u8BC6\uFF1A",t==null?void 0:t.bizId,(0,n.jsx)(f.Z.Text,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F!"],text:t==null?void 0:t.bizId}})]}),(0,n.jsx)(x.Z,{type:"vertical"}),(0,n.jsx)("span",{style:{color:"red"},children:"\u6267\u884C\u7248\u672C\uFF1A"}),(0,n.jsxs)("span",{children:[t==null?void 0:t.version,(0,n.jsx)(f.Z.Text,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F!"],text:t==null?void 0:t.version}})]})],nextId:t==null?void 0:t.nextId,config:R,logicLog:t})})})},me=xe}}]);
