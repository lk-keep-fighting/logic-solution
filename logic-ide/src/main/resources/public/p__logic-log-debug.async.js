!(function(){"use strict";var Pe=Object.defineProperty,he=Object.defineProperties;var Me=Object.getOwnPropertyDescriptors;var Ee=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable;var Ce=(d,s)=>(s=Symbol[d])?s:Symbol.for("Symbol."+d);var De=(d,s,e)=>s in d?Pe(d,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):d[s]=e,ve=(d,s)=>{for(var e in s||(s={}))pe.call(s,e)&&De(d,e,s[e]);if(Ee)for(var e of Ee(s))be.call(s,e)&&De(d,e,s[e]);return d},fe=(d,s)=>he(d,Me(s));var le=function(d,s){this[0]=d,this[1]=s},ge=(d,s,e)=>{var h=(f,c,E,u)=>{try{var l=e[f](c),o=(c=l.value)instanceof le,i=l.done;Promise.resolve(o?c[0]:c).then(a=>o?h(f==="return"?f:"next",c[1]?{done:a.done,value:a.value}:a,E,u):E({value:a,done:i})).catch(a=>h("throw",a,E,u))}catch(a){u(a)}},r=f=>v[f]=c=>new Promise((E,u)=>h(f,c,E,u)),v={};return e=e.apply(d,s),v[Ce("asyncIterator")]=()=>v,r("next"),r("throw"),r("return"),v};(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[5612],{9565:function(d,s,e){e.d(s,{Z:function(){return l}});var h=e(58709),r=e(87363),v={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M632 888H392c-4.4 0-8 3.6-8 8v32c0 17.7 14.3 32 32 32h192c17.7 0 32-14.3 32-32v-32c0-4.4-3.6-8-8-8zM512 64c-181.1 0-328 146.9-328 328 0 121.4 66 227.4 164 284.1V792c0 17.7 14.3 32 32 32h264c17.7 0 32-14.3 32-32V676.1c98-56.7 164-162.7 164-284.1 0-181.1-146.9-328-328-328zm127.9 549.8L604 634.6V752H420V634.6l-35.9-20.8C305.4 568.3 256 484.5 256 392c0-141.4 114.6-256 256-256s256 114.6 256 256c0 92.5-49.4 176.3-128.1 221.8z"}}]},name:"bulb",theme:"outlined"},f=v,c=e(6481),E=function(i,a){return r.createElement(c.Z,(0,h.Z)({},i,{ref:a,icon:f}))},u=r.forwardRef(E),l=u},31336:function(d,s){const e=`

`,h=`
`,r=":",v=u=>(u!=null?u:"").trim()!=="";function f(){let u="";return new TransformStream({transform(l,o){u+=l;const i=u.split(e);i.slice(0,-1).forEach(a=>{v(a)&&o.enqueue(a)}),u=i[i.length-1]},flush(l){v(u)&&l.enqueue(u)}})}function c(){return new TransformStream({transform(u,l){const i=u.split(h).reduce((a,g)=>{const O=g.indexOf(r);if(O===-1)throw new Error(`The key-value separator "${r}" is not found in the sse line chunk!`);const C=g.slice(0,O);if(!v(C))return a;const U=g.slice(O+1);return fe(ve({},a),{[C]:U})},{});Object.keys(i).length!==0&&l.enqueue(i)}})}function E(u){const{readableStream:l,transformStream:o}=u;if(!(l instanceof ReadableStream))throw new Error("The options.readableStream must be an instance of ReadableStream.");const i=new TextDecoderStream,a=o?l.pipeThrough(i).pipeThrough(o):l.pipeThrough(i).pipeThrough(f()).pipeThrough(c());return a[Symbol.asyncIterator]=function(){return ge(this,null,function*(){const g=this.getReader();for(;;){const{done:O,value:C}=yield new le(g.read());if(O)break;C&&(yield C)}})},a}s.Z=E},30531:function(d,s,e){e.d(s,{B0:function(){return r.Z},FQ:function(){return v.F}});var h=e(85343),r=e(68784),v=e(30697)},68784:function(d,s,e){var h=e(26068),r=e.n(h),v=e(48305),f=e.n(v),c=e(950),E=e(87363),u=e.n(E),l=e(874),o=e.n(l),i=e(66345),a=e(94391),g=e(99294),O=e(42327),C=e(3044),U=e(21644),w=e(77201),M=e(30697),_=e(12146),j=e(33627),N=e(370),W=e(62086),K=function(p){var B=(0,E.useState)({type:"page"}),I=f()(B,2),F=I[0],V=I[1],x=(0,E.useState)(),$=f()(x,2),S=$[0],G=$[1],z=(0,E.useState)(),n=f()(z,2),Y=n[0],q=n[1],y="cxd",J="zh-CN";(0,E.useEffect)(function(){(0,_.m)(c.Z)},[]),(0,E.useEffect)(function(){p.pageId&&((0,g.UD)(p.pageId).then(function(P){V(P)}),N.S.getEnvJson().then(function(P){G(JSON.parse(j.j.getEnv()))}))},[p.pageId]);var Z=function(m,A){console.log("broadcast:",m,A),p.onBroadcast&&p.onBroadcast(m,A.data)};return(0,W.jsxs)("div",{children:[(0,W.jsx)(a.qRY,{theme:y,position:"top-right",locale:J},"toast"),(0,W.jsx)(a.wxo,{theme:y,locale:J},"alert"),(0,i.sYA)(F,{data:r()({envs:S},p.data),onBroadcast:Z},{fetcher:function(m){var A=m.url,L=m.method,b=m.data,X=m.responseType,D=m.config,ee=m.headers;return p.data&&p.data.runtime&&(A="/api/ide/papi/".concat(p.data.runtime).concat(A)),D=D||{},D.withCredentials=!0,X&&(D.responseType=X),D.cancelExecutor&&(D.cancelToken=new c.Z.CancelToken(D.cancelExecutor)),D.headers=ee||{},D.headers.Authorization||(D.headers.Authorization="Bearer "+M.F.getTokenFormLocal()),L!=="post"&&L!=="put"&&L!=="patch"?(b&&(D.params=b),c.Z[L](A,D)):(b&&b instanceof FormData?(D.headers=D.headers||{},D.headers["Content-Type"]="multipart/form-data"):b&&typeof b!="string"&&!(b instanceof Blob)&&!(b instanceof ArrayBuffer)&&(b=JSON.stringify(b),D.headers=D.headers||{},D.headers["Content-Type"]="application/json"),c.Z[L](A,b,D))},isCancel:function(m){return c.Z.isCancel(m)},copy:function(m){o()(m),a.Amu.success("\u5185\u5BB9\u5DF2\u590D\u5236\u5230\u7C98\u8D34\u677F")},theme:y,jumpTo:function(m,A){debugger;A.blank==!0?window.open(window.location.origin+window.location.pathname+"#"+m,"_blank"):window.location.hash=m}})]})};s.Z=K},76039:function(d,s,e){var h=e(90228),r=e.n(h),v=e(31759),f=e.n(v),c=e(87999),E=e.n(c),u=e(48305),l=e.n(u),o=e(75487),i=e.n(o),a=e(87363),g=e.n(a),O=e(63121),C=e(39710),U=e(82494),w=e(30531),M=e(99511),_=e(31336),j=e(62086),N=function(K){var T=K.logicLog,p=K.show,B=K.onClose,I=g().useState(""),F=l()(I,2),V=F[0],x=F[1],$=g().useState(),S=l()($,2),G=S[0],z=S[1],n=g().useState(""),Y=l()(n,2),q=Y[0],y=Y[1],J=g().useState(!1),Z=l()(J,2),P=Z[0],m=Z[1];(0,a.useEffect)(function(){p&&T&&(x(""),A(T))},[p,T]);function A(b){return L.apply(this,arguments)}function L(){return L=E()(r()().mark(function b(X){var D,ee,_e,ie,H,ne,Q,k,de,te,se,oe,ce,ae,me,ue,R,re;return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,m(!0),console.log("\u5F00\u59CB\u83B7\u53D6\u6570\u636E",X),D=X.itemLogs,ee=D.filter(function(Oe){return Oe.success==!1}),_e=ee[0],_e){t.next=11;break}return O.ZP.error("\u6CA1\u6709\u627E\u5230\u9519\u8BEF\u7684\u7EC4\u4EF6\u65E5\u5FD7"),m(!1),B&&B(),t.abrupt("return");case 11:if(ie=_e.msg,H=_e.config,z(H),ne=H.type,ne!="java"){t.next=24;break}return t.next=18,(0,M.kZ)(H);case 18:Q=t.sent,console.log("\u83B7\u53D6\u6E90\u7801",Q),k="",Q&&Q.sourceCode&&(k=Q.sourceCode),t.next=25;break;case 24:ne=="js"&&(k=H.script);case 25:return y(k),t.next=28,fetch("/api/ide/ai/chat/completions",{method:"post",body:JSON.stringify({model:"qwen2.5-coder:32b",stream:!0,messages:[{role:"system",content:'1\u3001\u62A5\u9519\u4FE1\u606F:"'.concat(ie,'";2\u3001\u62A5\u9519\u7684').concat(ne,"\u7EC4\u4EF6\u4EE3\u7801:```").concat(k,"```;\u3002\u5E2E\u6211\u6839\u636E\u4EE5\u4E0A\u4FE1\u606F\u7EFC\u5408\u5206\u6790\u62A5\u9519\u7684\u539F\u56E0\u3002\n")}]}),headers:{"Content-Type":"application/json",Accept:"text/event-stream","Cache-Control":"no-cache"}});case 28:de=t.sent,te="",se=!1,oe=!1,t.prev=32,ae=i()((0,_.Z)({readableStream:de.body}));case 34:return t.next=36,ae.next();case 36:if(!(se=!(me=t.sent).done)){t.next=46;break}ue=me.value,console.log("XStream chunk"),console.log(ue),R=JSON.parse(ue.data),typeof R=="string"&&(R=JSON.parse(R),console.log(f()(R))),R&&R.choices&&R.choices.length>0&&R.choices[0].delta&&R.choices[0].delta.content&&(re=R.choices[0].delta.content.toString(),console.log("newMsg:",re),console.log("curMsg:",te),te+=re,x(te));case 43:se=!1,t.next=34;break;case 46:t.next=52;break;case 48:t.prev=48,t.t0=t.catch(32),oe=!0,ce=t.t0;case 52:if(t.prev=52,t.prev=53,!(se&&ae.return!=null)){t.next=57;break}return t.next=57,ae.return();case 57:if(t.prev=57,!oe){t.next=60;break}throw ce;case 60:return t.finish(57);case 61:return t.finish(52);case 62:t.next=68;break;case 64:t.prev=64,t.t1=t.catch(0),console.error("\u8BF7\u6C42\u5931\u8D25:",t.t1),m(!1);case 68:case"end":return t.stop()}},b,null,[[0,64],[32,48,52,62],[53,,57,61]])})),L.apply(this,arguments)}return(0,j.jsx)(C.Z,{open:p,title:"AI\u8F85\u52A9\u5206\u6790(Beta)",width:1e3,footer:null,onCancel:function(){B&&B()},children:(0,j.jsxs)("div",{children:[(0,j.jsx)(w.B0,{pageId:"ai-debug-log",data:{message:T==null?void 0:T.message,content:V,code:q,config:G}}),(0,j.jsx)(U.Z,{style:{marginLeft:"10px"},spinning:P})]})})};s.Z=N},76394:function(d,s,e){e.r(s);var h=e(48305),r=e.n(h),v=e(99511),f=e(9565),c=e(42008),E=e(63637),u=e(63121),l=e(82494),o=e(90171),i=e(39765),a=e(58523),g=e(77154),O=e(87363),C=e.n(O),U=e(9413),w=e(36017),M=e(76039),_=e(62086);function j(W){window.document.title="-["+W.name+"]\u65E5\u5FD7"}var N=function(){var K=(0,U.UO)(),T=K.id,p=(0,O.useState)(),B=r()(p,2),I=B[0],F=B[1],V=(0,O.useState)(!1),x=r()(V,2),$=x[0],S=x[1],G=(0,O.useState)({}),z=r()(G,2),n=z[0],Y=z[1],q=(0,O.useState)(!1),y=r()(q,2),J=y[0],Z=y[1];return(0,O.useEffect)(function(){S(!0),n.logicId&&I==null&&(0,v.l)(n.logicId,n.version).then(function(P){if(P){var m=P;j(m),F(m)}else u.ZP.error("\u5BF9\u5E94\u7684\u903B\u8F91\u7248\u672C\u914D\u7F6E\u4E0D\u5B58\u5728\uFF01",3);S(!1)}).catch(function(P){S(!1),console.log("err"),console.log(P)})},[n]),(0,O.useEffect)(function(){T&&(0,v.yi)(T).then(function(P){debugger;P&&Y(P)})},[T]),(0,_.jsx)("div",{children:(0,_.jsxs)(l.Z,{spinning:$,children:[(0,_.jsx)(w.Z,{btns:[(0,_.jsx)(o.Z,{type:"vertical"}),(0,_.jsx)(i.ZP,{type:"primary",icon:(0,_.jsx)(f.Z,{}),onClick:function(){Z(!0)},children:"AI\u5206\u6790"}),(0,_.jsx)(o.Z,{type:"vertical"}),(0,_.jsxs)(a.Z,{children:[I==null?void 0:I.name,"[",n==null?void 0:n.logicId,(0,_.jsx)(g.Z.Text,{copyable:{tooltips:["\u590D\u5236\u7F16\u53F7","\u590D\u5236\u6210\u529F!"],text:n==null?void 0:n.logicId}}),"]"]}),(0,_.jsx)(o.Z,{type:"vertical"}),(0,_.jsxs)(a.Z,{children:["\u4E1A\u52A1\u6807\u8BC6\uFF1A",n==null?void 0:n.bizId,(0,_.jsx)(g.Z.Text,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F!"],text:n==null?void 0:n.bizId}})]}),(0,_.jsx)(o.Z,{type:"vertical"}),(0,_.jsxs)("span",{children:["\u662F\u5426\u5B8C\u6210\uFF1A",n!=null&&n.isOver?(0,_.jsx)(c.Z,{twoToneColor:"#52c41a"}):(0,_.jsx)(E.Z,{twoToneColor:"red"})]}),(0,_.jsx)(o.Z,{type:"vertical"}),(0,_.jsxs)("span",{children:["\u5F85\u6267\u884C\uFF1A",n==null?void 0:n.nextName]}),(0,_.jsx)(o.Z,{type:"vertical"}),(0,_.jsx)("span",{style:{color:"red"},children:"\u6267\u884C\u7248\u672C\uFF1A"}),(0,_.jsxs)("span",{children:[n==null?void 0:n.version,(0,_.jsx)(g.Z.Text,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F!"],text:n==null?void 0:n.version}})]}),(0,_.jsx)(o.Z,{type:"vertical"}),(0,_.jsx)(i.ZP,{type:"link",href:"/logic/index.html/#/assets/logic/i/".concat(n.logicId,"/edit"),target:"_blank",children:"\u8DF3\u8F6C\u8BBE\u8BA1"}),(0,_.jsx)(o.Z,{type:"vertical"}),(0,_.jsx)(i.ZP,{type:"link",href:"/logic/index.html/#/debug/logic/instance/".concat(n.logicId,"/").concat(n.bizId),target:"_blank",children:"\u8DF3\u8F6C\u5B9E\u4F8B"})],nextId:n==null?void 0:n.nextId,config:I,logicLog:n}),(0,_.jsx)(M.Z,{show:J,logicLog:n,onClose:function(){return Z(!1)}})]})})};s.default=N},370:function(d,s,e){e.d(s,{S:function(){return a}});var h=e(90228),r=e.n(h),v=e(87999),f=e.n(v),c=e(25298),E=e.n(c),u=e(17069),l=e.n(u),o=e(33627),i=e(72591),a=function(){function g(){E()(this,g)}return l()(g,null,[{key:"getEnvJson",value:function(){var O=f()(r()().mark(function U(){return r()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.abrupt("return",(0,i.U2)("/api/runtime/env").then(function(_){return _.data.data}).then(function(_){return o.j.setModel(_.UI_CONFIG_MODEL),o.j.setEnv(JSON.stringify(_)),o.j.setApiUrlPrefix(_.API_GATEWAY_PREFIX),o.j.setReryApi(_.CUSTOM_RETRY_URL),o.j.setReryApi(_.CUSTOM_RETRY_URL),_}));case 1:case"end":return M.stop()}},U)}));function C(){return O.apply(this,arguments)}return C}()},{key:"getRemoteRuntimeConfig",value:function(){var O=f()(r()().mark(function U(){return r()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.abrupt("return",(0,i.v_)("/api/ide/remote-runtimes").then(function(_){return _.data}).then(function(_){return console.log("remote runtimes:",_.data),o.j.setRemoteRuntimes(JSON.stringify(_.data)),_}));case 1:case"end":return M.stop()}},U)}));function C(){return O.apply(this,arguments)}return C}()}]),g}()}}]);
}());