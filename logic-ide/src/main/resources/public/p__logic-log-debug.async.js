!(function(){"use strict";var Pe=Object.defineProperty,pe=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var Ee=Object.getOwnPropertySymbols;var Me=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable;var Ce=(c,t)=>(t=Symbol[c])?t:Symbol.for("Symbol."+c);var ge=(c,t,e)=>t in c?Pe(c,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[t]=e,De=(c,t)=>{for(var e in t||(t={}))Me.call(t,e)&&ge(c,e,t[e]);if(Ee)for(var e of Ee(t))be.call(t,e)&&ge(c,e,t[e]);return c},ve=(c,t)=>pe(c,he(t));var re=function(c,t){this[0]=c,this[1]=t},fe=(c,t,e)=>{var p=(v,d,E,l)=>{try{var r=e[v](d),a=(d=r.value)instanceof re,u=r.done;Promise.resolve(a?d[0]:d).then(o=>a?p(v==="return"?v:"next",d[1]?{done:o.done,value:o.value}:o,E,l):E({value:o,done:u})).catch(o=>p("throw",o,E,l))}catch(o){l(o)}},i=v=>D[v]=d=>new Promise((E,l)=>p(v,d,E,l)),D={};return e=e.apply(c,t),D[Ce("asyncIterator")]=()=>D,i("next"),i("throw"),i("return"),D};(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[5612],{9565:function(c,t,e){e.d(t,{Z:function(){return r}});var p=e(58709),i=e(87363),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M632 888H392c-4.4 0-8 3.6-8 8v32c0 17.7 14.3 32 32 32h192c17.7 0 32-14.3 32-32v-32c0-4.4-3.6-8-8-8zM512 64c-181.1 0-328 146.9-328 328 0 121.4 66 227.4 164 284.1V792c0 17.7 14.3 32 32 32h264c17.7 0 32-14.3 32-32V676.1c98-56.7 164-162.7 164-284.1 0-181.1-146.9-328-328-328zm127.9 549.8L604 634.6V752H420V634.6l-35.9-20.8C305.4 568.3 256 484.5 256 392c0-141.4 114.6-256 256-256s256 114.6 256 256c0 92.5-49.4 176.3-128.1 221.8z"}}]},name:"bulb",theme:"outlined"},v=D,d=e(6481),E=function(u,o){return i.createElement(d.Z,(0,p.Z)({},u,{ref:o,icon:v}))},l=i.forwardRef(E),r=l},31336:function(c,t){const e=`

`,p=`
`,i=":",D=l=>(l!=null?l:"").trim()!=="";function v(){let l="";return new TransformStream({transform(r,a){l+=r;const u=l.split(e);u.slice(0,-1).forEach(o=>{D(o)&&a.enqueue(o)}),l=u[u.length-1]},flush(r){D(l)&&r.enqueue(l)}})}function d(){return new TransformStream({transform(l,r){const u=l.split(p).reduce((o,f)=>{const O=f.indexOf(i);if(O===-1)throw new Error(`The key-value separator "${i}" is not found in the sse line chunk!`);const C=f.slice(0,O);if(!D(C))return o;const U=f.slice(O+1);return ve(De({},o),{[C]:U})},{});Object.keys(u).length!==0&&r.enqueue(u)}})}function E(l){const{readableStream:r,transformStream:a}=l;if(!(r instanceof ReadableStream))throw new Error("The options.readableStream must be an instance of ReadableStream.");const u=new TextDecoderStream,o=a?r.pipeThrough(u).pipeThrough(a):r.pipeThrough(u).pipeThrough(v()).pipeThrough(d());return o[Symbol.asyncIterator]=function(){return fe(this,null,function*(){const f=this.getReader();for(;;){const{done:O,value:C}=yield new re(f.read());if(O)break;C&&(yield C)}})},o}t.Z=E},30531:function(c,t,e){e.d(t,{B0:function(){return i.Z},FQ:function(){return D.F}});var p=e(85343),i=e(68784),D=e(30697)},68784:function(c,t,e){var p=e(26068),i=e.n(p),D=e(48305),v=e.n(D),d=e(950),E=e(87363),l=e.n(E),r=e(874),a=e.n(r),u=e(66345),o=e(94391),f=e(99294),O=e(42327),C=e(3044),U=e(21644),w=e(77201),h=e(30697),_=e(12146),j=e(33627),J=e(370),W=e(62086),K=function(M){var B=(0,E.useState)({type:"page"}),I=v()(B,2),F=I[0],N=I[1],x=(0,E.useState)(),k=v()(x,2),S=k[0],V=k[1],$=(0,E.useState)(),n=v()($,2),G=n[0],q=n[1],y="cxd",z="zh-CN";(0,E.useEffect)(function(){(0,_.m)(d.Z)},[]),(0,E.useEffect)(function(){M.pageId&&((0,f.UD)(M.pageId).then(function(P){N(P)}),J.S.getEnvJson().then(function(P){V(JSON.parse(j.j.getEnv()))}))},[M.pageId]);var Z=function(m,A){console.log("broadcast:",m,A),M.onBroadcast&&M.onBroadcast(m,A.data)};return(0,W.jsxs)("div",{children:[(0,W.jsx)(o.qRY,{theme:y,position:"top-right",locale:z},"toast"),(0,W.jsx)(o.wxo,{theme:y,locale:z},"alert"),(0,u.sYA)(F,{data:i()({envs:S},M.data),onBroadcast:Z},{fetcher:function(m){var A=m.url,L=m.method,b=m.data,Y=m.responseType,g=m.config,ee=m.headers;return M.data&&M.data.runtime&&(A="/api/ide/papi/".concat(M.data.runtime).concat(A)),g=g||{},g.withCredentials=!0,Y&&(g.responseType=Y),g.cancelExecutor&&(g.cancelToken=new d.Z.CancelToken(g.cancelExecutor)),g.headers=ee||{},g.headers.Authorization||(g.headers.Authorization="Bearer "+h.F.getTokenFormLocal()),L!=="post"&&L!=="put"&&L!=="patch"?(b&&(g.params=b),d.Z[L](A,g)):(b&&b instanceof FormData?(g.headers=g.headers||{},g.headers["Content-Type"]="multipart/form-data"):b&&typeof b!="string"&&!(b instanceof Blob)&&!(b instanceof ArrayBuffer)&&(b=JSON.stringify(b),g.headers=g.headers||{},g.headers["Content-Type"]="application/json"),d.Z[L](A,b,g))},isCancel:function(m){return d.Z.isCancel(m)},copy:function(m){a()(m),o.Amu.success("\u5185\u5BB9\u5DF2\u590D\u5236\u5230\u7C98\u8D34\u677F")},theme:y,jumpTo:function(m,A){debugger;A.blank==!0?window.open(window.location.origin+window.location.pathname+"#"+m,"_blank"):window.location.hash=m}})]})};t.Z=K},76039:function(c,t,e){var p=e(90228),i=e.n(p),D=e(31759),v=e.n(D),d=e(87999),E=e.n(d),l=e(48305),r=e.n(l),a=e(75487),u=e.n(a),o=e(87363),f=e.n(o),O=e(63121),C=e(39710),U=e(82494),w=e(30531),h=e(99511),_=e(31336),j=e(62086),J=function(K){var T=K.logicLog,M=K.show,B=K.onClose,I=f().useState(""),F=r()(I,2),N=F[0],x=F[1],k=f().useState(),S=r()(k,2),V=S[0],$=S[1],n=f().useState(""),G=r()(n,2),q=G[0],y=G[1],z=f().useState(!1),Z=r()(z,2),P=Z[0],m=Z[1];(0,o.useEffect)(function(){M&&T&&(x(""),A(T))},[M,T]);function A(b){return L.apply(this,arguments)}function L(){return L=E()(i()().mark(function b(Y){var g,ee,_e,ue,X,ne,H,Q,ce,se,te,ae,de,oe,me,le,R,ie;return i()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(s.prev=0,m(!0),console.log("\u5F00\u59CB\u83B7\u53D6\u6570\u636E",Y),g=Y.itemLogs,ee=g.filter(function(Oe){return Oe.success==!1}),_e=ee[0],_e){s.next=11;break}return O.ZP.error("\u6CA1\u6709\u627E\u5230\u9519\u8BEF\u7684\u7EC4\u4EF6\u65E5\u5FD7"),m(!1),B&&B(),s.abrupt("return");case 11:if(ue=_e.msg,X=_e.config,$(X),ne=X.type,ne!="java"){s.next=24;break}return s.next=18,(0,h.kZ)(X);case 18:H=s.sent,console.log("\u83B7\u53D6\u6E90\u7801",H),Q="",H&&H.sourceCode&&(Q=H.sourceCode),s.next=25;break;case 24:ne=="js"&&(Q=X.script);case 25:return y(Q),s.next=28,fetch("/api/ide/ai/chat/completions",{method:"post",body:JSON.stringify({model:"qwen2.5-coder:32b",stream:!0,messages:[{role:"system",content:'1\u3001\u62A5\u9519\u4FE1\u606F:"'.concat(ue,'";2\u3001\u62A5\u9519\u7684').concat(ne,"\u7EC4\u4EF6\u4EE3\u7801:```").concat(Q,"```;\u3002\u5E2E\u6211\u6839\u636E\u4EE5\u4E0A\u4FE1\u606F\u7EFC\u5408\u5206\u6790\u62A5\u9519\u7684\u539F\u56E0\u3002\n")}]}),headers:{"Content-Type":"application/json",Accept:"text/event-stream","Cache-Control":"no-cache"}});case 28:ce=s.sent,se="",te=!1,ae=!1,s.prev=32,oe=u()((0,_.Z)({readableStream:ce.body}));case 34:return s.next=36,oe.next();case 36:if(!(te=!(me=s.sent).done)){s.next=46;break}le=me.value,console.log("XStream chunk"),console.log(le),R=JSON.parse(le.data),typeof R=="string"&&(R=JSON.parse(R),console.log(v()(R))),R&&R.choices&&R.choices.length>0&&R.choices[0].delta&&R.choices[0].delta.content&&(ie=R.choices[0].delta.content.toString(),console.log("newMsg:",ie),console.log("curMsg:",se),se+=ie,x(se));case 43:te=!1,s.next=34;break;case 46:s.next=52;break;case 48:s.prev=48,s.t0=s.catch(32),ae=!0,de=s.t0;case 52:if(s.prev=52,s.prev=53,!(te&&oe.return!=null)){s.next=57;break}return s.next=57,oe.return();case 57:if(s.prev=57,!ae){s.next=60;break}throw de;case 60:return s.finish(57);case 61:return s.finish(52);case 62:s.next=68;break;case 64:s.prev=64,s.t1=s.catch(0),console.error("\u8BF7\u6C42\u5931\u8D25:",s.t1),m(!1);case 68:case"end":return s.stop()}},b,null,[[0,64],[32,48,52,62],[53,,57,61]])})),L.apply(this,arguments)}return(0,j.jsx)(C.Z,{open:M,title:"AI\u8F85\u52A9\u5206\u6790(Beta)",width:1e3,footer:null,onCancel:function(){B&&B()},children:(0,j.jsxs)("div",{children:[(0,j.jsx)(w.B0,{pageId:"ai-debug-log",data:{message:T==null?void 0:T.message,content:N,code:q,config:V}}),(0,j.jsx)(U.Z,{style:{marginLeft:"10px"},spinning:P})]})})};t.Z=J},76394:function(c,t,e){e.r(t);var p=e(48305),i=e.n(p),D=e(99511),v=e(9565),d=e(42008),E=e(63637),l=e(63121),r=e(82494),a=e(90171),u=e(39765),o=e(58523),f=e(77154),O=e(87363),C=e.n(O),U=e(9413),w=e(36017),h=e(76039),_=e(62086);function j(W){window.document.title="-["+W.name+"]\u65E5\u5FD7"}var J=function(){var K=(0,U.UO)(),T=K.id,M=(0,O.useState)(),B=i()(M,2),I=B[0],F=B[1],N=(0,O.useState)(!1),x=i()(N,2),k=x[0],S=x[1],V=(0,O.useState)({}),$=i()(V,2),n=$[0],G=$[1],q=(0,O.useState)(!1),y=i()(q,2),z=y[0],Z=y[1];return(0,O.useEffect)(function(){S(!0),n.logicId&&I==null&&(0,D.l)(n.logicId,n.version).then(function(P){if(P){var m=P;j(m),F(m)}else l.ZP.error("\u5BF9\u5E94\u7684\u903B\u8F91\u7248\u672C\u914D\u7F6E\u4E0D\u5B58\u5728\uFF01",3);S(!1)}).catch(function(P){S(!1),console.log("err"),console.log(P)})},[n]),(0,O.useEffect)(function(){T&&(0,D.yi)(T).then(function(P){debugger;P&&G(P)})},[T]),(0,_.jsx)("div",{children:(0,_.jsxs)(r.Z,{spinning:k,children:[(0,_.jsx)(w.Z,{btns:[(0,_.jsx)(a.Z,{type:"vertical"}),(0,_.jsx)(u.ZP,{type:"primary",icon:(0,_.jsx)(v.Z,{}),onClick:function(){Z(!0)},children:"AI\u5206\u6790"}),(0,_.jsx)(a.Z,{type:"vertical"}),(0,_.jsxs)(o.Z,{children:[I==null?void 0:I.name,"[",n==null?void 0:n.logicId,(0,_.jsx)(f.Z.Text,{copyable:{tooltips:["\u590D\u5236\u7F16\u53F7","\u590D\u5236\u6210\u529F!"],text:n==null?void 0:n.logicId}}),"]"]}),(0,_.jsx)(a.Z,{type:"vertical"}),(0,_.jsxs)(o.Z,{children:["\u4E1A\u52A1\u6807\u8BC6\uFF1A",n==null?void 0:n.bizId,(0,_.jsx)(f.Z.Text,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F!"],text:n==null?void 0:n.bizId}})]}),(0,_.jsx)(a.Z,{type:"vertical"}),(0,_.jsxs)("span",{children:["\u662F\u5426\u5B8C\u6210\uFF1A",n!=null&&n.isOver?(0,_.jsx)(d.Z,{twoToneColor:"#52c41a"}):(0,_.jsx)(E.Z,{twoToneColor:"red"})]}),(0,_.jsx)(a.Z,{type:"vertical"}),(0,_.jsxs)("span",{children:["\u5F85\u6267\u884C\uFF1A",n==null?void 0:n.nextName]}),(0,_.jsx)(a.Z,{type:"vertical"}),(0,_.jsx)("span",{style:{color:"red"},children:"\u6267\u884C\u7248\u672C\uFF1A"}),(0,_.jsxs)("span",{children:[n==null?void 0:n.version,(0,_.jsx)(f.Z.Text,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F!"],text:n==null?void 0:n.version}})]}),(0,_.jsx)(a.Z,{type:"vertical"}),(0,_.jsx)(u.ZP,{type:"link",href:"/logic/index.html/#/assets/logic/i/".concat(n.logicId,"/edit"),target:"_blank",children:"\u8DF3\u8F6C\u8BBE\u8BA1"}),(0,_.jsx)(a.Z,{type:"vertical"}),(0,_.jsx)(u.ZP,{type:"link",href:"/logic/index.html/#/debug/logic/instance/".concat(n.logicId,"/").concat(n.bizId),target:"_blank",children:"\u8DF3\u8F6C\u5B9E\u4F8B"})],nextId:n==null?void 0:n.nextId,config:I,logicLog:n}),(0,_.jsx)(h.Z,{show:z,logicLog:n,onClose:function(){return Z(!1)}})]})})};t.default=J},370:function(c,t,e){e.d(t,{S:function(){return o}});var p=e(90228),i=e.n(p),D=e(87999),v=e.n(D),d=e(25298),E=e.n(d),l=e(17069),r=e.n(l),a=e(33627),u=e(72591),o=function(){function f(){E()(this,f)}return r()(f,null,[{key:"getEnvJson",value:function(){var O=v()(i()().mark(function U(){return i()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,u.U2)("/api/runtime/env").then(function(_){return _.data.data}).then(function(_){return a.j.setModel(_.UI_CONFIG_MODEL),a.j.setEnv(JSON.stringify(_)),a.j.setApiUrlPrefix(_.API_GATEWAY_PREFIX),a.j.setReryApi(_.CUSTOM_RETRY_URL),a.j.setReryApi(_.CUSTOM_RETRY_URL),_}));case 1:case"end":return h.stop()}},U)}));function C(){return O.apply(this,arguments)}return C}()},{key:"getRemoteRuntimeConfig",value:function(){var O=v()(i()().mark(function U(){return i()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,u.v_)("/api/ide/remote-runtimes").then(function(_){return _.data}).then(function(_){return console.log("remote runtimes:",_.data),a.j.setRemoteRuntimes(JSON.stringify(_.data)),_}));case 1:case"end":return h.stop()}},U)}));function C(){return O.apply(this,arguments)}return C}()}]),f}()}}]);
}());