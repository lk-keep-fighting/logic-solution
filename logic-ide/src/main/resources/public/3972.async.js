"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[3972],{73972:function(w,y,c){c.r(y),c.d(y,{IconSelectControlRenderer:function(){return N},default:function(){return I}});var t=c(15767),E=c(87363),a=c.n(E),S=c(84875),i=c.n(S),C=c(8427),d=c(42977),u=c(94391),_=c(66292),M=c.n(_),g=c(35917),I=function(m){(0,t.ZT)(o,m);function o(e){var n=m.call(this,e)||this;return n.state={activeTypeIndex:0,showModal:!1,tmpCheckIconId:null,searchValue:"",isRefreshLoading:!1},n.handleSearchValueChange=M()(n.handleSearchValueChange.bind(n),300),n}return o.prototype.getSvgName=function(e){var n;return typeof e=="string"?((n=/data-name="(.*?)"/.exec(e))===null||n===void 0?void 0:n[1])||"":(e==null?void 0:e.name)||(e==null?void 0:e.id)||""},o.prototype.getSvgId=function(e){var n;return typeof e=="string"?((n=/data-id="(.*?)"/.exec(e))===null||n===void 0?void 0:n[1])||"":(e==null?void 0:e.id)||""},o.prototype.getValueBySvg=function(e){var n;if(!e)return null;if(typeof e!="string")return(0,t.pi)((0,t.pi)({},e),{svg:(n=e.svg)===null||n===void 0?void 0:n.replace(/'/g,"")});var l=this.getSvgName(e),s=this.getSvgId(e);return{name:l,id:s,svg:e.replace(/'/g,"")}},o.prototype.handleClick=function(){this.props.disabled||this.toggleModel(!0)},o.prototype.handleClear=function(e){e.preventDefault(),e.stopPropagation(),this.props.onChange&&this.props.onChange("")},o.prototype.renderInputArea=function(){var e=this.props,n=e.classPrefix,l=e.disabled,s=e.value,p=e.placeholder,h=e.clearable,r=this.getValueBySvg(s);return a().createElement("div",{className:i()("".concat(n,"IconSelectControl-input-area"))},a().createElement("div",{className:i()("".concat(n,"IconSelectControl-input-icon-show"))},a().createElement(u.JO$,{icon:r==null?void 0:r.svg,className:"icon"})),a().createElement("span",{className:i()("".concat(n,"IconSelectControl-input-icon-id"))},r==null?void 0:r.name),h&&!l&&r?a().createElement("a",{onClick:this.handleClear,className:i()("".concat(n,"IconSelectControl-clear"))},a().createElement(u.JO$,{icon:"input-clear",className:"icon"})):null,!r&&p&&a().createElement("span",{className:i()("".concat(n,"IconSelectControl-input-icon-placeholder"))},p)||null)},o.prototype.handleIconTypeClick=function(e,n){this.setState({activeTypeIndex:n})},o.prototype.renderIconTypes=function(){var e=this,n=this.props.classPrefix,l=g.svgIcons.map(function(s){return{id:s.groupId,label:s.name}});return a().createElement("ul",{className:i()("".concat(n,"IconSelectControl-type-list"))},l.map(function(s,p){return a().createElement("li",{key:s.id,onClick:function(){return e.handleIconTypeClick(s,p)},className:i()({active:p===e.state.activeTypeIndex})},s.label)}))},o.prototype.handleConfirm=function(){var e=this.state.tmpCheckIconId;if(this.props.returnSvg){var n=e&&e.svg||"";n=n.replace(/<svg/,'<svg data-name="'.concat(e==null?void 0:e.name,'" data-id="').concat(e==null?void 0:e.id,'"')),this.props.noSize&&(n=n.replace(/width=".*?"/,"").replace(/height=".*?"/,"")),this.props.onChange&&this.props.onChange(n)}else this.props.onChange&&this.props.onChange(e&&e.id?(0,t.pi)((0,t.pi)({},e),{id:"svg-"+e.id}):"");this.toggleModel(!1)},o.prototype.handleLocalUpload=function(e){return(0,t.mG)(this,void 0,void 0,function(){return(0,t.Jh)(this,function(n){return this.props.onChange&&this.props.onChange(e),this.toggleModel(!1),[2]})})},o.prototype.handleClickIconInModal=function(e){var n;this.setState({tmpCheckIconId:(e==null?void 0:e.id)===((n=this.state.tmpCheckIconId)===null||n===void 0?void 0:n.id)?null:e})},o.prototype.renderIconList=function(e){var n=this,l=this.props,s=l.classPrefix,p=l.noDataTip,h=l.translate;return!e||!e.length?a().createElement("p",{className:i()("".concat(s,"IconSelectControl-icon-list-empty"))},h(p)):a().createElement("ul",{className:i()("".concat(s,"IconSelectControl-icon-list"))},e.map(function(r,f){var v;return a().createElement("li",{key:r.id},a().createElement("div",{className:i()("".concat(s,"IconSelectControl-icon-list-item"),{active:((v=n.state.tmpCheckIconId)===null||v===void 0?void 0:v.id)===r.id}),onClick:function(){return n.handleClickIconInModal(r)}},a().createElement("svg",null,a().createElement("use",{xlinkHref:"#".concat(r.id)})),a().createElement("div",{className:i()("".concat(s,"IconSelectControl-icon-list-item-info"))},a().createElement("p",{className:i()("".concat(s,"IconSelectControl-icon-list-item-info-name"))},r.name))))}))},o.prototype.handleSearchValueChange=function(e){this.setState({searchValue:e})},o.prototype.handleRefreshIconList=function(){return(0,t.mG)(this,void 0,void 0,function(){var e,n;return(0,t.Jh)(this,function(l){switch(l.label){case 0:if(e=g.refreshIconList,!(e&&typeof e=="function"))return[3,5];l.label=1;case 1:return l.trys.push([1,3,4,5]),this.setState({isRefreshLoading:!0}),[4,Promise.resolve(e())];case 2:return l.sent(),[3,5];case 3:return n=l.sent(),console.error(n),[3,5];case 4:return this.setState({isRefreshLoading:!1}),[7];case 5:return[2]}})})},o.prototype.renderModalContent=function(){var e=this.props,n=e.render,l=e.classPrefix,s=e.loadingConfig,p=e.funcSchema,h=e.funcCom,r=this.getIconsByType(),f=this.state.searchValue,v=f?(0,C.Lu)(r,f,{keys:["name"],threshold:C.Lu.rankings.CONTAINS}):r;return a().createElement(a().Fragment,null,a().createElement(u.Rj2,{className:i()("".concat(l,"IconSelectControl-Modal-search")),mini:!1,clearable:!0,onChange:this.handleSearchValueChange}),g.refreshIconList&&n("refresh-btn",{type:"button",icon:"fa fa-refresh"},{className:i()("".concat(l,"IconSelectControl-Modal-refresh")),onClick:this.handleRefreshIconList})||null,h?a().createElement("div",{className:i()("".concat(l,"IconSelectControl-Modal-func"))},a().createElement(h,{onUpload:this.handleLocalUpload})):null,a().createElement("div",{className:i()("".concat(l,"IconSelectControl-Modal-content"))},a().createElement(u.$jN,{size:"lg",loadingConfig:s,overlay:!0,key:"info",show:this.state.isRefreshLoading}),a().createElement("div",{className:i()("".concat(l,"IconSelectControl-Modal-content-aside"))},this.renderIconTypes()),a().createElement("div",{className:i()("".concat(l,"IconSelectControl-Modal-content-main"))},this.renderIconList(v))))},o.prototype.getIconsByType=function(){return(g==null?void 0:g.svgIcons.length)&&g.svgIcons[this.state.activeTypeIndex].children||[]},o.prototype.toggleModel=function(e){var n=this.props.value,l=typeof n=="string"?this.getValueBySvg(n):n;if(e===void 0){this.setState({showModal:!this.state.showModal,searchValue:""});return}this.setState({showModal:e,tmpCheckIconId:e&&(l!=null&&l.id)?(0,t.pi)((0,t.pi)({},l),{id:String(l.id).replace(/^svg-/,"")}):null,searchValue:""})},o.prototype.render=function(){var e=this,n=this.props,l=n.className,s=n.style,p=n.classPrefix,h=n.disabled,r=n.translate;return a().createElement("div",{className:i()(l,"".concat(p,"IconSelectControl"),{"is-focused":this.state.showModal,"is-disabled":h})},a().createElement("div",{className:i()("".concat(p,"IconSelectControl-input")),onClick:this.handleClick},this.renderInputArea()),a().createElement(u.u_l,{show:this.state.showModal,closeOnOutside:!0,closeOnEsc:!0,size:"lg",overlay:!0,onHide:function(){return e.toggleModel(!1)}},a().createElement(u.u_l.Header,{onClose:function(){return e.toggleModel(!1)}},r("IconSelect.choice")),a().createElement(u.u_l.Body,null,this.renderModalContent()),a().createElement(u.u_l.Footer,null,a().createElement(u.zxk,{type:"button",className:"m-l",onClick:function(){return e.toggleModel(!1)}},r("cancel")),a().createElement(u.zxk,{type:"button",level:"primary",onClick:this.handleConfirm},r("confirm")))))},o.defaultProps={noDataTip:"placeholder.noData",clearable:!0},(0,t.gn)([d.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[]),(0,t.w6)("design:returntype",void 0)],o.prototype,"handleClick",null),(0,t.gn)([d.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[Object]),(0,t.w6)("design:returntype",void 0)],o.prototype,"handleClear",null),(0,t.gn)([d.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[]),(0,t.w6)("design:returntype",void 0)],o.prototype,"renderInputArea",null),(0,t.gn)([d.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[Object,Number]),(0,t.w6)("design:returntype",void 0)],o.prototype,"handleIconTypeClick",null),(0,t.gn)([d.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[]),(0,t.w6)("design:returntype",void 0)],o.prototype,"renderIconTypes",null),(0,t.gn)([d.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[]),(0,t.w6)("design:returntype",void 0)],o.prototype,"handleConfirm",null),(0,t.gn)([d.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[String]),(0,t.w6)("design:returntype",Promise)],o.prototype,"handleLocalUpload",null),(0,t.gn)([d.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[Array]),(0,t.w6)("design:returntype",void 0)],o.prototype,"renderIconList",null),(0,t.gn)([d.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[]),(0,t.w6)("design:returntype",Promise)],o.prototype,"handleRefreshIconList",null),(0,t.gn)([d.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[]),(0,t.w6)("design:returntype",void 0)],o.prototype,"renderModalContent",null),(0,t.gn)([d.NjZ,(0,t.w6)("design:type",Function),(0,t.w6)("design:paramtypes",[Boolean]),(0,t.w6)("design:returntype",void 0)],o.prototype,"toggleModel",null),o}(a().PureComponent),N=function(m){(0,t.ZT)(o,m);function o(){return m!==null&&m.apply(this,arguments)||this}return o=(0,t.gn)([(0,d.xJW)({type:"icon-select"})],o),o}(I)}}]);
