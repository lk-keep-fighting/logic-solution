"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[4639],{64639:function(ce,X,N){N.r(X),N.d(X,{ComboControlRenderer:function(){return oe},KVControlRenderer:function(){return de},KVSControlRenderer:function(){return ue},default:function(){return W}});var o=N(15767),q=N(87363),v=N.n(q),H=N(61533),fe=N.n(H),ee=N(32222),G=N.n(ee),h=N(42977),L=N(94391),te=N(65861),ae=N(33170),Z=N.n(ae),ne=N(34736),$=N.n(ne),k=N(6663),ie=N(69143),re=N.n(ie),le=N(31223),se=N.n(le);function Q(S,m){return m.reduce(function(t,e){return t[e]=(0,h.H_J)(e,S),t},{})}var W=function(S){(0,o.ZT)(m,S);function m(t){var e=S.call(this,t)||this;e.subFormDefaultValues=[],e.keys=[],e.toDispose=[],e.id=(0,h.M8z)(),e.refsMap={},e.makeFormRef=$()(function(d){return function(r){return e.formRef(r,d)}}),e.memoizedFormatValue=$()(function(d,r,c,f,u){return(0,h.nW9)((0,h.ktx)(u,(0,o.pi)({index:f,__index:f},u)),(0,o.pi)((0,o.pi)({},c),Array.isArray(r)?Q(u,r):null))},function(d,r,c,f,u){return Array.isArray(r)?JSON.stringify([c,f,u,Q(u,r)]):JSON.stringify(d?[c,f]:[c,f,u])}),e.handleChange=e.handleChange.bind(e),e.handleRadioChange=e.handleRadioChange.bind(e),e.handleSingleFormChange=e.handleSingleFormChange.bind(e),e.handleSingleFormInit=e.handleSingleFormInit.bind(e),e.handleFormInit=e.handleFormInit.bind(e),e.handleAction=e.handleAction.bind(e),e.addItem=e.addItem.bind(e),e.deleteItem=e.deleteItem.bind(e),e.dragTipRef=e.dragTipRef.bind(e),e.flush=e.flush.bind(e),e.handleComboTypeChange=e.handleComboTypeChange.bind(e),e.handleSubFormValid=e.handleSubFormValid.bind(e),e.defaultValue=(0,o.pi)({},t.scaffold);var i=t.store,a=t.value,n=t.multiple,l=t.formItem,s=t.addHook;return i.config({multiple:n,minLength:e.resolveVariableProps(t,"minLength"),maxLength:e.resolveVariableProps(t,"maxLength"),length:e.getValueAsArray(t).length}),l&&(0,k.fh)(l)&&l.setSubStore(i),s&&e.toDispose.push(s(e.flush,"flush")),e}return m.prototype.componentDidUpdate=function(t){var e=this.props;if((0,h.aGv)(["minLength","maxLength","value"],t,e)||this.resolveVariableProps(t,"minLength")!==this.resolveVariableProps(e,"minLength")||this.resolveVariableProps(t,"maxLength")!==this.resolveVariableProps(e,"maxLength")){var i=e.store,a=e.multiple,n=this.getValueAsArray(e);i.config({multiple:a,minLength:this.resolveVariableProps(e,"minLength"),maxLength:this.resolveVariableProps(e,"maxLength"),length:n.length}),i.activeKey>=n.length&&i.setActiveKey(Math.max(0,n.length-1)),e.value!==t.value&&!t.formInited&&this.subFormDefaultValues.length&&(this.subFormDefaultValues=this.subFormDefaultValues.map(function(l,s){return(0,o.pi)((0,o.pi)({},l),{values:n[s]})}))}},m.prototype.componentWillUnmount=function(){var t,e,i,a,n=this.props.formItem;n&&(0,k.fh)(n)&&n.setSubStore(null),this.toDispose.forEach(function(l){return l()}),this.toDispose=[],(e=(t=this.memoizedFormatValue.cache).clear)===null||e===void 0||e.call(t),(a=(i=this.makeFormRef.cache).clear)===null||a===void 0||a.call(i)},m.prototype.resolveVariableProps=function(t,e){var i={minLength:0,maxLength:1/0},a=t[e];if(!a)return i[e];if(typeof a=="string")if((0,h.SSQ)(a)){var n=(0,h.OgC)(a,t.data,"| raw");a=typeof n=="number"&&n>=0?n:i[e]}else{var l=parseInt(a,10);a=isNaN(l)?i[e]:l}return a},m.prototype.doAction=function(t,e,i,a){var n,l,s,d;i===void 0&&(i=!1);var r=t==null?void 0:t.actionType,c=this.props,f=c.onChange,u=c.resetValue,g=c.formStore,p=c.store,y=c.name;if(r==="addItem")this.addItemValue((n=a==null?void 0:a.item)!==null&&n!==void 0?n:{});else if(r==="clear")f("");else if(r==="reset"){var b=(d=(0,h.E04)((l=g==null?void 0:g.pristine)!==null&&l!==void 0?l:(s=p==null?void 0:p.parentStore)===null||s===void 0?void 0:s.pristine,y))!==null&&d!==void 0?d:u;f(b!=null?b:"")}},m.prototype.addItemValue=function(t){var e=this.props,i=e.flat,a=e.joinValues,n=e.addattop,l=e.delimiter,s=e.disabled,d=e.submitOnChange;if(!s){var r=this.getValueAsArray();n===!0?(this.keys.unshift((0,h.M8z)()),r.unshift(t)):(r.push(t),this.keys.push((0,h.M8z)())),i&&a&&(r=r.join(l||",")),this.props.onChange(r,d,!0)}},m.prototype.getValueAsArray=function(t){t===void 0&&(t=this.props);var e=t.flat,i=t.joinValues,a=t.delimiter,n=t.type,l=t.formItem,s=t.getValue();return i&&e&&typeof s=="string"?s=s.split(a||","):Array.isArray(s)?s=s.concat():s=[],s},m.prototype.addItemWith=function(t){var e,i,a=this.props,n=a.flat,l=a.joinValues,s=a.addattop,d=a.delimiter,r=a.scaffold,c=a.disabled,f=a.submitOnChange;if(!c){var u=this.getValueAsArray();u.push(n?(i=(e=t.scaffold)!==null&&e!==void 0?e:r)!==null&&i!==void 0?i:"":(0,o.pi)({},t.scaffold||r)),this.keys.push((0,h.M8z)()),n&&l&&(u=u.join(d||",")),s===!0&&(this.keys.unshift(this.keys.pop()),u.unshift(u.pop())),this.props.onChange(u,f,!0)}},m.prototype.addItem=function(){return(0,o.mG)(this,void 0,void 0,function(){var t,e,i,a,n,l,s,d,r,c,f,u,g;return(0,o.Jh)(this,function(p){switch(p.label){case 0:return t=this.props,e=t.flat,i=t.joinValues,a=t.addattop,n=t.delimiter,l=t.scaffold,s=t.disabled,d=t.submitOnChange,r=t.dispatchEvent,c=t.store,s?[2]:(f=this.getValueAsArray(),[4,r("add",(0,h.vXk)(this.props,{value:e&&i?f.join(n||","):G()(f)}))]);case 1:return u=p.sent(),u!=null&&u.prevented?[2]:(f.push(e?l!=null?l:"":(0,o.pi)({},l)),this.keys.push((0,h.M8z)()),e&&i&&(f=f.join(n||",")),g=this.keys.length-1,a===!0&&(this.keys.unshift(this.keys.pop()),f.unshift(f.pop()),g=0),c.setActiveKey(g),this.props.onChange(f,d,!0),[2])}})})},m.prototype.deleteItem=function(t){var e,i;return(0,o.mG)(this,void 0,void 0,function(){var a,n,l,s,d,r,c,f,u,g,p,y,b,C,A,E,V;return(0,o.Jh)(this,function(I){switch(I.label){case 0:return a=this.props,n=a.flat,l=a.joinValues,s=a.delimiter,d=a.disabled,r=a.deleteApi,c=a.deleteConfirmText,f=a.data,u=a.env,g=a.translate,p=a.dispatchEvent,y=a.submitOnChange,d?[2]:(b=this.getValueAsArray(),C=(0,h.nW9)(f,b[t]),[4,p("delete",(0,h.vXk)(this.props,{key:t,value:n&&l?b.join(s||","):G()(b),item:b[t]}))]);case 1:return A=I.sent(),A!=null&&A.prevented?[2]:(0,h.X1t)(r,C)?[4,u.confirm(c?(0,h.hXT)(c,C):g("deleteConfirm"))]:[3,4];case 2:return E=I.sent(),E?[4,u.fetcher(r,C)]:[2];case 3:if(V=I.sent(),!V.ok)return!(r!=null&&r.silent)&&u.notify("error",(i=(e=r==null?void 0:r.messages)===null||e===void 0?void 0:e.failed)!==null&&i!==void 0?i:g("deleteFailed")),[2];I.label=4;case 4:return this.keys.splice(t,1),b.splice(t,1),n&&l&&(b=b.join(s||",")),this.props.onChange(b,y,!0),[2]}})})},m.prototype.handleChange=function(t,e,i){var a,n,l,s,d=i.index,r=this.props,c=r.flat,f=r.store,u=r.joinValues,g=r.delimiter,p=r.disabled,y=r.submitOnChange,b=r.type,C=r.syncFields,A=r.name;if(!p){Array.isArray(C)&&C.forEach(function(O){A!=null&&A.startsWith(O)&&(t=(0,o.pi)({},t),(0,h.HKA)(t,A))});var E=this.getValueAsArray();if(E[d]=c?t.flat:(0,o.pi)({},t),c&&u&&(E=E.join(g||",")),b==="input-kv"){var V=!1,I={};try{for(var D=(0,o.XA)(E),_=D.next();!_.done;_=D.next()){var B=_.value;I[B.key]?V=!0:I[B.key]=!0}}catch(O){a={error:O}}finally{try{_&&!_.done&&(n=D.return)&&n.call(D)}finally{if(a)throw a.error}}V||this.props.onChange(E,y,!0)}else if(b==="input-kvs"){var V=!1,I={};try{for(var M=(0,o.XA)(E),T=M.next();!T.done;T=M.next()){var B=T.value;"_key"in B&&(I[B._key]?V=!0:I[B._key]=!0)}}catch(P){l={error:P}}finally{try{T&&!T.done&&(s=M.return)&&s.call(M)}finally{if(l)throw l.error}}V||this.props.onChange(E,y,!0)}else this.props.onChange(E,y,!0);f.forms.forEach(function(O){return(0,k.fh)(O)&&O.items.forEach(function(x){return x.unique&&x.syncOptions(void 0,O.data)})})}},m.prototype.handleRadioChange=function(t,e){var i=e.index,a=e.name,n=e.trueValue,l=n===void 0?!0:n,s=e.falseValue,d=s===void 0?!1:s,r=this.props,c=r.onChange,f=r.submitOnChange,u=r.multiple,g=r.disabled;if(!(!u||g||!a)){var p=this.getValueAsArray();if(!(!Array.isArray(p)||p.length<2||!re()(p[0])))return p=p.map(function(y,b){var C;return(0,o.pi)((0,o.pi)({},y),(C={},C[a]=b===i?l:d,C))}),c(p,f,!0),!1}},m.prototype.handleSingleFormChange=function(t){this.props.value===null&&se()(this.defaultValue,t)||this.props.onChange((0,o.pi)({},t),this.props.submitOnChange,!0)},m.prototype.handleSubFormValid=function(t,e){var i=e.index,a=this.props.store;a.setMemberValid(t,i)},m.prototype.handleFormInit=function(t,e){var i,a=e.index,n=this.props,l=n.syncDefaultValue,s=n.flat,d=n.joinValues,r=n.delimiter,c=n.formInited,f=n.onChange,u=n.submitOnChange,g=n.setPrinstineValue,p=n.formItem,y=n.name,b=n.syncFields;if(Array.isArray(b)&&b.forEach(function(E){y!=null&&y.startsWith(E)&&(t=(0,o.pi)({},t),(0,h.HKA)(t,y))}),p!=null&&p.validated&&((i=this.subForms[a])===null||i===void 0||i.validate(!0,!1,!1)),this.subFormDefaultValues.push({index:a,values:t,setted:!1}),!(l===!1||this.subFormDefaultValues.length!==this.subForms.filter(function(E){return E!==void 0}).length)){var C=this.getValueAsArray(),A=!1;this.subFormDefaultValues=this.subFormDefaultValues.map(function(E){var V=E.index,I=E.values,D=E.setted,_=s?I.flat:(0,o.pi)({},I);return!D&&(0,h.RjM)(C[V],_)&&(C[V]=s?I.flat:(0,o.pi)({},I),A=!0),{index:V,values:I,setted:!0}}),A&&(s&&d&&(C=C.join(r||",")),c?f(C,u,!0):g(C))}},m.prototype.handleSingleFormInit=function(t){var e=this.props,i=e.syncDefaultValue,a=e.setPrinstineValue,n=e.value,l=e.nullable;i!==!1&&!l&&(0,h.RjM)(n,t)&&a((0,o.pi)({},t))},m.prototype.handleAction=function(t,e){var i=this.props.onAction;if(e.actionType==="delete"){e.index!==void 0&&this.deleteItem(e.index);return}i&&i.apply(null,arguments)},m.prototype.validate=function(){var t=this,e=this.props,i=e.messages,a=e.nullable,n=e.value,l=e.translate,s=e.store,d=e.flat,r=this.getValueAsArray(),c=this.resolveVariableProps(this.props,"minLength"),f=this.resolveVariableProps(this.props,"maxLength");if(c&&(!Array.isArray(r)||r.length<c))return l(i&&i.minLengthValidateFailed||"Combo.minLength",{minLength:c});if(f&&Array.isArray(r)&&r.length>f)return l(i&&i.maxLengthValidateFailed||"Combo.maxLength",{maxLength:f});if(a&&!n)return;if(r.length){var u=this.subForms;return Promise.all(r.map(function(g,p){return(0,o.mG)(t,void 0,void 0,function(){var y,b,C,A,E,V,I,D,_,B,M,T;return(0,o.Jh)(this,function(O){switch(O.label){case 0:return y=u[p],y?[2,y.validate(!0,!1,!1)]:[3,1];case 1:if(b=u[Object.keys(u)[0]],!b)return[3,10];C=b.props.store,A=!1,O.label=2;case 2:O.trys.push([2,7,8,9]),E=(0,o.XA)(C.items),V=E.next(),O.label=3;case 3:return V.done?[3,6]:(I=V.value,D=(0,k.d9)(I),_=d?g:(0,h.E04)(g,I.name,!1),I.extraName&&!d&&(_=[(0,h.E04)(g,I.name,!1),(0,h.E04)(g,I.extraName,!1)]),D.changeTmpValue(_,"dataChanged"),[4,D.validate(g)]);case 4:if(A=O.sent(),(0,k.ob)(D),A===!1)return[3,6];O.label=5;case 5:return V=E.next(),[3,3];case 6:return[3,9];case 7:return B=O.sent(),M={error:B},[3,9];case 8:try{V&&!V.done&&(T=E.return)&&T.call(E)}finally{if(M)throw M.error}return[7];case 9:return s.setMemberValid(A,p),[2,A];case 10:return[2]}})})})).then(function(g){if(~g.indexOf(!1))return l(i&&i.validateFailed||"validateFailed")})}else if(this.subForms.length)return Promise.all(this.subForms.map(function(g){return g.validate(!0,!1,!1)})).then(function(g){if(~g.indexOf(!1))return l(i&&i.validateFailed||"validateFailed")})},m.prototype.flush=function(){return(0,o.mG)(this,void 0,void 0,function(){return(0,o.Jh)(this,function(t){switch(t.label){case 0:return[4,Promise.all(this.subForms.map(function(e){return e.flush()}))];case 1:return t.sent(),[2]}})})},m.prototype.dragTipRef=function(t){!this.dragTip&&t?this.initDragging():this.dragTip&&!t&&this.destroyDragging(),this.dragTip=t},m.prototype.initDragging=function(){var t=this,e=this.props.classPrefix,i=this.props.submitOnChange,a=(0,H.findDOMNode)(this);this.sortable=new te.ZP(a.querySelector(".".concat(e,"Combo-items")),{group:"combo-".concat(this.id),animation:150,handle:".".concat(e,"Combo-itemDrager"),ghostClass:"".concat(e,"Combo-item--dragging"),onEnd:function(n){if(n.newIndex!==n.oldIndex){var l=n.to;n.oldIndex<l.childNodes.length-1?l.insertBefore(n.item,l.childNodes[n.oldIndex>n.newIndex?n.oldIndex+1:n.oldIndex]):l.appendChild(n.item);var s=t.props.value;if(Array.isArray(s)){var d=s.concat();d.splice(n.newIndex,0,d.splice(n.oldIndex,1)[0]),t.keys.splice(n.newIndex,0,t.keys.splice(n.oldIndex,1)[0]),t.props.onChange(d,i,!0),t.props.dispatchEvent("dragEnd",(0,h.vXk)(t.props,{item:d[n.newIndex],value:d,index:n.newIndex,oldValue:s,oldIndex:n.oldIndex}))}}}})},m.prototype.destroyDragging=function(){this.sortable&&this.sortable.destroy()},Object.defineProperty(m.prototype,"subForms",{get:function(){var t=this;return Object.keys(this.refsMap).map(function(e){return parseInt(e,10)}).sort().map(function(e){return t.refsMap[e]})},enumerable:!1,configurable:!0}),m.prototype.formRef=function(t,e){if(e===void 0&&(e=0),t){for(;t&&t.getWrappedInstance;)t=t.getWrappedInstance();this.refsMap[e]=t}else{var i=this.refsMap[e];this.subFormDefaultValues=this.subFormDefaultValues.filter(function(a){var n=a.index;return n!==e}),delete this.refsMap[e]}},m.prototype.formatValue=function(t,e){e===void 0&&(e=-1);var i=this.props,a=i.flat,n=i.data,l=i.strictMode,s=i.syncFields;return a&&(t={flat:t}),t=t||this.defaultValue,this.memoizedFormatValue(l!==!1,s,t,e,n)},m.prototype.pickCondition=function(t){var e=this.props.conditions;return Z()(e,function(i){return i.test&&(0,h.fz_)(i.test,t)})},m.prototype.handleComboTypeChange=function(t,e){var i=this.props,a=i.multiple,n=i.onChange,l=i.value,s=i.flat,d=i.submitOnChange,r=this.props.conditions,c=Z()(r,function(u){return u.label===e.label});if(c)if(a){var f=this.getValueAsArray();f.splice(t,1,(0,o.pi)({},(0,h.buJ)(c.scaffold||{},f[t]))),n(f,d,!0)}else n((0,o.pi)({},(0,h.buJ)(c.scaffold||{},l)),d,!0)},m.prototype.handleTabSelect=function(t){return(0,o.mG)(this,void 0,void 0,function(){var e,i,a,n,l,s,d,r,c;return(0,o.Jh)(this,function(f){switch(f.label){case 0:return e=this.props,i=e.store,a=e.data,n=e.name,l=e.value,s=e.dispatchEvent,d={key:t,item:l[t]},[4,s("tabsChange",(0,h.nW9)(a,n?(0,o.pi)((0,o.pi)({},d),(c={},c[n]=l,c)):d))];case 1:return r=f.sent(),r!=null&&r.prevented?[2]:(i.setActiveKey(t),[2])}})})},m.prototype.setNull=function(t){t.preventDefault();var e=this.props.onChange;e(null),this.subForms.forEach(function(i){i.clearErrors()})},m.prototype.renderPlaceholder=function(){var t=this.props,e=t.placeholder,i=t.translate;return v().createElement("span",{className:"text-muted"},i(e||"placeholder.noData"))},m.prototype.renderTabsMode=function(){var t=this,e=this.props,i=e.classPrefix,a=e.classnames,n=e.tabsStyle,l=e.formClassName,s=e.render,d=e.disabled,r=e.store,c=e.flat,f=e.subFormMode,u=e.addButtonText,g=e.addable,p=e.removable,y=e.typeSwitchable,b=e.itemRemovableOn,C=e.delimiter,A=e.canAccessSuperData,E=e.addIcon,V=e.deleteIcon,I=e.tabsLabelTpl,D=e.conditions,_=e.changeImmediately,B=e.addBtnText,M=e.static,T=e.translate,O=e.testIdBuilder,x=this.props.items,P=this.props.value;c&&typeof P=="string"&&(P=P.split(C||","));var j=r.removable!==!1&&!d&&p!==!1;return Array.isArray(P)||(P=[]),v().createElement(L.mQc,{addBtnText:T(B||"add"),className:"ComboTabs",mode:n,activeKey:r.activeKey,onSelect:this.handleTabSelect,testIdBuilder:O,additionBtns:!d&&g!==!1&&r.addable?v().createElement("li",{className:a("Tabs-link ComboTabs-addLink")},this.renderAddBtn()):null},P.map(function(R,F){var z=t.formatValue(R,F),U=O==null?void 0:O.getChild("tab-".concat(F)),K=null,Y=void 0;j&&(!b||(0,h.fz_)(b,R)!==!1)&&(Y=v().createElement("div",(0,o.pi)({onClick:t.deleteItem.bind(t,F),key:"delete",className:a("Combo-tab-delBtn ".concat(r.removable?"":"is-disabled")),"data-tooltip":T("delete"),"data-position":"bottom"},U==null?void 0:U.getChild("delBtn").getTestId()),V?v().createElement("i",{className:V}):v().createElement(L.JO$,{icon:"status-close",className:"icon"}))),Array.isArray(D)&&D.length&&(K=t.pickCondition(z),x=K?K.items:void 0);var w=c&&x?[(0,o.pi)((0,o.pi)({},x&&x[0]),{name:"flat"})]:x,me=Array.isArray(w)&&w.some(function(J){return J.unique});return t.keys[F]||t.keys.splice(F,0,(0,h.M8z)()),v().createElement(L.OK9,{title:(0,h.hXT)(I||T("{{index}}",{index:z.index+1}),z),key:t.keys[F],toolbar:Y,eventKey:F,mountOnEnter:!me,unmountOnExit:!1,className:r.memberValidMap[F]===!1?"has-error":"",tabClassName:r.memberValidMap[F]===!1?"has-error":"",testIdBuilder:U},K&&y!==!1?v().createElement("div",{className:a("Combo-itemTag")},v().createElement("label",null,T("Combo.type")),v().createElement(L.PhF,{onChange:t.handleComboTypeChange.bind(t,F),options:D.map(function(J){return{label:J.label,value:J.label}}),value:K.label,clearable:!1})):null,v().createElement("div",{className:a("Combo-itemInner")},w?t.renderItems(w,z,F,R):v().createElement(L.Vp1,{level:"warning",className:"m-b-none"},T("Combo.invalidData"))))}))},m.prototype.renderDelBtn=function(t,e){var i=this;if(this.props.static)return null;var a=this.props,n=a.classPrefix,l=a.classnames,s=a.render,d=a.store,r=a.deleteIcon,c=a.translate,f=a.itemRemovableOn,u=a.disabled,g=a.removable,p=a.deleteBtn,y=a.mobileUI,b=a.data,C=a.testIdBuilder,A=C==null?void 0:C.getChild("delete-btn-".concat(e)),E=d.removable!==!1&&!u&&g!==!1;return E&&(!f||(0,h.fz_)(f,t)!==!1)?(0,h.Kn2)(p)?s("delete-btn",(0,o.pi)((0,o.pi)({},p),{type:"button",className:l("Combo-delController",p?p.className:""),testIdBuilder:A,onClick:function(V){if(!p.onClick){i.deleteItem(e);return}var I=p.onClick;typeof I=="string"&&(I=(0,h.S0D)(p.onClick,"e","index","props"));var D=I(V,e,i.props);D&&D.then?D.then(function(){i.deleteItem(e)}):i.deleteItem(e)}}),{data:(0,h.ktx)(b,{index:e})}):typeof p=="string"?s("delete-btn",{type:"button",className:l("Combo-delController"),label:p,onClick:this.deleteItem.bind(this,e),testIdBuilder:A}):v().createElement("a",(0,o.pi)({onClick:this.deleteItem.bind(this,e),key:"delete",className:l("Combo-delBtn ".concat(d.removable?"":"is-disabled")),"data-tooltip":y?null:c("delete"),"data-position":"bottom"},A==null?void 0:A.getTestId()),r?v().createElement("i",{className:r}):v().createElement(L.JO$,{icon:"status-close",className:"icon"})):null},m.prototype.renderAddBtn=function(){var t=this;if(this.props.static)return null;var e=this.props,i=e.classPrefix,a=e.classnames,n=e.render,l=e.addButtonClassName,s=e.store,d=e.addButtonText,r=e.addBtn,c=e.addable,f=e.addIcon,u=e.conditions,g=e.translate,p=e.tabsMode,y=e.testIdBuilder,b=Array.isArray(u)&&u.length,C=y==null?void 0:y.getChild("add-button");return v().createElement(v().Fragment,null,s.addable&&c!==!1&&(b?n("add-button",{type:"dropdown-button",icon:f?v().createElement(L.JO$,{icon:"plus-fine",className:"icon"}):"",label:g(d||"add"),level:"info",size:"sm",closeOnClick:!0,btnClassName:l,testIdBuilder:C},{buttons:u==null?void 0:u.map(function(A){return{label:A.label,onClick:function(E){return t.addItemWith(A),!1}}})}):p?v().createElement("a",{onClick:this.addItem},f?v().createElement(L.JO$,{icon:"plus-fine",className:"icon"}):null,v().createElement("span",null,g(d||"add"))):(0,h.Kn2)(r)?n("add-button",(0,o.pi)((0,o.pi)({},r),{type:"button",testIdBuilder:C,onClick:function(){return t.addItem()}})):v().createElement(L.zxk,{className:a("Combo-addBtn",l),onClick:this.addItem,testIdBuilder:C},f?v().createElement(L.JO$,{icon:"plus-fine",className:"icon"}):null,v().createElement("span",null,g(d||"add")))))},m.prototype.renderMultipe=function(){var t=this;if(this.props.tabsMode)return this.renderTabsMode();var e=this.props,i=e.classPrefix,a=e.classnames,n=e.multiLine,l=e.disabled,s=e.flat,d=e.draggable,r=e.draggableTip,c=e.typeSwitchable,f=e.delimiter,u=e.dragIcon,g=e.noBorder,p=e.conditions,y=e.placeholder,b=e.translate,C=e.itemClassName,A=e.itemsWrapperClassName,E=e.static,V=e.mobileUI,I=e.store,D=this.props.items,_=this.props.value;return s&&typeof _=="string"&&(_=_.split(f||",")),v().createElement("div",{className:a("Combo Combo--multi",{"is-mobile":V},n?"Combo--ver":"Combo--hor",g?"Combo--noBorder":"",l?"is-disabled":"",!E&&!l&&d&&Array.isArray(_)&&_.length>1?"is-draggable":"")},v().createElement("div",{className:a("Combo-items",A)},Array.isArray(_)&&_.length?_.map(function(B,M,T){var O=t.renderDelBtn(B,M),x=t.formatValue(B,M),P=null;Array.isArray(p)&&p.length&&(P=t.pickCondition(x),D=P?P.items:void 0);var j=s&&D?[(0,o.pi)((0,o.pi)({},D&&D[0]),{name:"flat"})]:D;return t.keys[M]||t.keys.splice(M,1,(0,h.M8z)()),v().createElement("div",{className:a("Combo-item",C,I.memberValidMap[M]===!1?"has-error":""),key:t.keys[M]},!E&&!l&&d&&T.length>1?v().createElement("div",{className:a("Combo-itemDrager")},v().createElement("a",{key:"drag","data-tooltip":b("Combo.dragDropSort"),"data-position":"bottom"},u?v().createElement("i",{className:u}):v().createElement(L.JO$,{icon:"drag-bar",className:"icon"}))):null,P&&c!==!1?v().createElement("div",{className:a("Combo-itemTag")},v().createElement("label",null,b("Combo.type")),v().createElement(L.PhF,{onChange:t.handleComboTypeChange.bind(t,M),options:p.map(function(R){return{label:R.label,value:R.label}}),value:P.label,clearable:!1})):null,v().createElement("div",{className:a("Combo-itemInner")},j?t.renderItems(j,x,M,B):v().createElement(L.Vp1,{level:"warning",className:"m-b-none"},b("Combo.invalidData"))),O)}):y?v().createElement("div",{className:a("Combo-placeholder")},b(y)):null),!E&&!l?v().createElement("div",{className:a("Combo-toolbar")},this.renderAddBtn(),d?v().createElement("span",{className:a("Combo-dragableTip"),ref:this.dragTipRef},Array.isArray(_)&&_.length>1?b(r):""):null):null)},m.prototype.renderSingle=function(){var t=this.props,e=t.conditions,i=t.classnames,a=t.value,n=t.multiLine,l=t.noBorder,s=t.disabled,d=t.typeSwitchable,r=t.nullable,c=t.translate,f=t.itemClassName,u=t.mobileUI,g=t.store,p=this.props.items,y=(0,h.Kn2)(a)?this.formatValue(a):this.formatValue(this.defaultValue),b=null;return Array.isArray(e)&&e.length&&(b=this.pickCondition(y),p=b?b.items:void 0),v().createElement("div",{className:i("Combo Combo--single",{"is-mobile":u},n?"Combo--ver":"Combo--hor",l?"Combo--noBorder":"",s?"is-disabled":"")},v().createElement("div",{className:i("Combo-item",f,g.memberValidMap[0]===!1?"has-error":"")},b&&d!==!1?v().createElement("div",{className:i("Combo-itemTag")},v().createElement("label",null,c("Combo.type")),v().createElement(L.PhF,{onChange:this.handleComboTypeChange.bind(this,0),options:e.map(function(C){return{label:C.label,value:C.label}}),value:b.label,clearable:!1})):null,v().createElement("div",{className:i("Combo-itemInner")},p?this.renderItems(p,y):v().createElement(L.Vp1,{level:"warning",className:"m-b-none"},c("Combo.invalidData")))),a&&r?v().createElement("a",{className:i("Combo-setNullBtn"),href:"#",onClick:this.setNull},c("clear")):null)},m.prototype.renderItems=function(t,e,i,a){var n=this.props,l=n.classnames,s=n.formClassName,d=n.render,r=n.multiLine,c=n.disabled,f=n.canAccessSuperData,u=n.multiple,g=n.tabsMode,p=n.subFormMode,y=n.subFormHorizontal,b=n.changeImmediately,C=n.lazyLoad,A=n.translate,E=n.static,V=n.testIdBuilder,I=n.updatePristineAfterStoreDataReInit,D=Array.isArray(t)?t.map(function(_,B){var M=i!==void 0&&i>=0?"-".concat(i):"",T="item-".concat(_.testid||_.id||B)+M;return(0,o.pi)((0,o.pi)({},_),{testIdBuilder:V==null?void 0:V.getChild(T)})}):t;if(u){if(u&&i!==void 0&&i>=0)return d("multiple/".concat(i),{type:"form",body:D,wrapperComponent:"div",wrapWithPanel:!1,mode:g||r?p:"row",horizontal:y,className:l("Combo-form",s)},(0,o.pi)((0,o.pi)({index:i,disabled:c,static:E,data:e,originData:a,onChange:this.handleChange,onInit:this.handleFormInit,onAction:this.handleAction,onRadioChange:this.handleRadioChange,ref:this.makeFormRef(i),onValidChange:this.handleSubFormValid,canAccessSuperData:f,lazyChange:!b,formLazyChange:!1,value:void 0,formItemValue:void 0,formStore:void 0},g?{}:{lazyLoad:C}),{updatePristineAfterStoreDataReInit:I!=null?I:!1}))}else return d("single",{type:"form",body:D,wrapperComponent:"div",wrapWithPanel:!1,mode:r?p||"normal":"row",horizontal:y,className:l("Combo-form",s)},{index:0,disabled:c,static:E,data:e,originData:a,onChange:this.handleSingleFormChange,ref:this.makeFormRef(0),onValidChange:this.handleSubFormValid,onInit:this.handleSingleFormInit,canAccessSuperData:f,lazyChange:!b,formLazyChange:!1,value:void 0,formItemValue:void 0,formStore:void 0,updatePristineAfterStoreDataReInit:I!=null?I:!1});return v().createElement(v().Fragment,null)},m.prototype.renderStatic=function(t){return t===void 0&&(t="-"),this.props.render("static-input-kv",{type:"json"},this.props)},m.prototype.render=function(){var t=this.props,e=t.type,i=t.formInited,a=t.multiple,n=t.className,l=t.style,s=t.classPrefix,d=t.classnames,r=t.static,c=t.staticSchema;return r&&(c||["input-kv","input-kvs"].includes(e))?this.renderStatic():i||typeof i=="undefined"?v().createElement("div",{className:d("ComboControl",n)},a?this.renderMultipe():this.renderSingle()):null},m.defaultProps={minLength:0,maxLength:1/0,multiple:!1,multiLine:!1,addButtonClassName:"",formClassName:"",subFormMode:"normal",draggableTip:"",addButtonText:"add",canAccessSuperData:!1,addIcon:!0,dragIcon:"",deleteIcon:"",tabsMode:!1,tabsStyle:"",placeholder:"placeholder.empty",itemClassName:"",itemsWrapperClassName:""},m.propsList=["minLength","maxLength","multiple","multiLine","addButtonClassName","subFormMode","draggableTip","addButtonText","draggable","scaffold","canAccessSuperData","addIcon","dragIcon","deleteIcon","noBorder","conditions","tabsMode","tabsStyle","lazyLoad","changeImmediately","strictMode","items","conditions","messages","formStore","itemClassName","itemsWrapperClassName"],(0,o.gn)([h.NjZ,(0,o.w6)("design:type",Function),(0,o.w6)("design:paramtypes",[Number]),(0,o.w6)("design:returntype",Promise)],m.prototype,"handleTabSelect",null),(0,o.gn)([h.NjZ,(0,o.w6)("design:type",Function),(0,o.w6)("design:paramtypes",[Object]),(0,o.w6)("design:returntype",void 0)],m.prototype,"setNull",null),m}(v().Component),oe=function(S){(0,o.ZT)(m,S);function m(){return S!==null&&S.apply(this,arguments)||this}return m.prototype.setData=function(t,e,i,a){return(0,o.mG)(this,void 0,void 0,function(){var n,l,s,d,r,c,f,u,g,p;return(0,o.Jh)(this,function(y){switch(y.label){case 0:return n=this.props,l=n.multiple,s=n.onChange,d=n.submitOnChange,l?(r=(0,o.ev)([],(0,o.CR)(this.getValueAsArray()),!1),c=r.length,i===void 0?[3,1]:(f=String(i).split(","),f.forEach(function(b){var C=Number(b);r.splice(C,1,(0,o.pi)((0,o.pi)({},r[C]),t))}),s==null||s(r,d,!0),[3,7])):[3,8];case 1:if(a===void 0)return[3,6];u=0,y.label=2;case 2:return u<c?(g=r[u],[4,(0,h.Cjz)(a,g)]):[3,5];case 3:p=y.sent(),p&&r.splice(u,1,(0,o.pi)((0,o.pi)({},r[u]),t)),y.label=4;case 4:return u++,[3,2];case 5:return s==null||s(r,d,!0),[3,7];case 6:s==null||s(t,d,!0),y.label=7;case 7:return[3,9];case 8:s==null||s(t,d,!0),y.label=9;case 9:return[2]}})})},m=(0,o.gn)([(0,h.xJW)({type:"combo",storeType:h.tlN.name,extendsData:!1,shouldComponentUpdate:function(t,e){return(0,h.SSQ)(t.maxLength)&&(0,h.OgC)(e.maxLength,e.data)!==(0,h.OgC)(t.maxLength,t.data)||(0,h.SSQ)(t.minLength)&&(0,h.OgC)(e.minLength,e.data)!==(0,h.OgC)(t.minLength,t.data)}})],m),m}(W),de=function(S){(0,o.ZT)(m,S);function m(){return S!==null&&S.apply(this,arguments)||this}return m=(0,o.gn)([(0,h.xJW)({type:"input-kv",storeType:h.tlN.name,extendsData:!1})],m),m}(W),ue=function(S){(0,o.ZT)(m,S);function m(){return S!==null&&S.apply(this,arguments)||this}return m=(0,o.gn)([(0,h.xJW)({type:"input-kvs",storeType:h.tlN.name,extendsData:!1})],m),m}(W)}}]);
