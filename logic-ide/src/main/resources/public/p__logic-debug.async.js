"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[2262],{34622:function($e,R,t){t.r(R),t.d(R,{default:function(){return Le}});var Q=t(54306),u=t.n(Q),De=t(25359),ze=t(49811),X=t(8049),w=t(14990),q=t(22465),G=t(5671),_=t(17696),ee=t(19227),te=t(75476),ne=t(1167),oe=t(22150),P=t(40767),Z=t(95812),S=t(58856),p=t(22983),ie=t(39092),B=t(75904),le=t(18725),i=t(87363),se=t.n(i),re=t(72107),ae=t(23620),de=t(58146),ue=t(89147),ce=t(3619),ge=t(9976),ve=t(34957),e=t(33130),Me=se().createContext({logic:new re.Iz("")}),fe=function(a){var g,T=(0,i.useState)(),j=u()(T,2),n=j[0],O=j[1],$=(0,i.useState)(),F=u()($,2),m=F[0],x=F[1],D=(0,i.useState)(!0),I=u()(D,2),y=I[0],C=I[1],z=(0,i.useState)(),N=u()(z,2),s=N[0],E=N[1],f=(0,i.useState)(),h=u()(f,2),d=h[0],Ze=h[1],pe=(0,i.useState)(),W=u()(pe,2),M=W[0],be=W[1],Fe=(0,i.useState)(),H=u()(Fe,2),Ie=H[0],K=H[1],Ne=(0,i.useState)(),U=u()(Ne,2),Ee=U[0],Te=U[1],k=(0,i.useRef)(),V=function(v){var r=v.node;K(r);var o=d==null?void 0:d.itemLogs.find(function(c){return c.config.id==r.id});E(o)};(0,i.useEffect)(function(){M&&(n==null||n.centerCell(M))},[M,n]),(0,i.useEffect)(function(){console.log("play curItemLog",s)},[s]),(0,i.useEffect)(function(){var l=n==null?void 0:n.getNodes().find(function(v){return v.id==a.nextId});l==null||l.attr("body/fill","red"),be(l)},[a.nextId]),(0,i.useEffect)(function(){var l;n==null||(l=n.getNodes().find(function(v){return v.id==a.nextId}))===null||l===void 0||l.attr("body/fill","red")},[n]),(0,i.useEffect)(function(){a.config&&x(a.config)},[a.config]),(0,i.useEffect)(function(){var l,v;console.log("props.debugLogs",a.debugLogs),((l=a.debugLogs)===null||l===void 0?void 0:l.length)>0&&setInterval(Ae,2e3);var r=[];a&&((v=a.debugLogs)===null||v===void 0||v.forEach(function(o){var c,L;r.push({children:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("span",{style:{cursor:"pointer",fontWeight:o.id==(d==null?void 0:d.id)?"bolder":"normal",color:o.id==(d==null?void 0:d.id)?"#52c41a":"black"},onClick:function(){Ze(o),console.log(o),n==null||n.fromJSON(m==null?void 0:m.visualConfig);var Y;o.itemLogs.forEach(function(Be){var A=n==null?void 0:n.getNodes().find(function(Oe){return Oe.id==Be.config.id});console.log("fill node"),console.log(A),A&&(A.addTools({name:"boundary",args:{attrs:{stroke:"red",strokeWidth:4,fillOpacity:.2}}}),Y=A)}),n==null||n.centerCell(Y),E({}),K({})},children:[(0,e.jsx)("p",{children:(c=o.itemLogs[0])===null||c===void 0?void 0:c.config.name}),((L=a.logicIns)===null||L===void 0?void 0:L.version)==o.version?(0,e.jsx)("p",{}):(0,e.jsx)("p",{children:(0,e.jsxs)(P.Z,{children:[(0,e.jsx)(Z.Z.Paragraph,{style:{color:"red"},children:"\u7248\u672C\u53F7:"}),(0,e.jsxs)(Z.Z.Paragraph,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F!"],text:o.version},children:[o.version,(0,e.jsx)(Z.Z.Link,{style:{margin:"5px"},href:"#/assets/logic/i/".concat(o.logicId,"/view/").concat(o.version),target:"_blank",children:(0,e.jsx)(X.Z,{})})]})]})}),(0,e.jsxs)("p",{children:["\u4E1A\u52A1\u6807\u8BC6\uFF1A",o.bizId]}),(0,e.jsx)("p",{children:o.serverTime}),(0,e.jsx)("p",{children:o.message})]})}),color:o.success?"green":"red"})})),Te(r)},[a.debugLogs,a.logicIns,n]),(0,i.useEffect)(function(){if(m){try{var l=(0,de.K)(),v=l.Shapes;(0,ue.m)(v)}catch(o){console.error("\u6CE8\u518C\u8282\u70B9\u51FA\u9519\uFF1A"),console.error(o)}var r=new G.kJ({container:k.current,embedding:{enabled:!0,validate:function(c){return c.child.setData({hoverNode:c.parent}),!0}},mousewheel:{enabled:!0,modifiers:"ctrl",minScale:.5,maxScale:3},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:15}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,allowMulti:!0,snap:{radius:20},createEdge:function(){return new G.bn.kS({tools:[{name:"edge-editor",args:{attrs:{backgroundColor:"#fff"}}}],zIndex:0})},validateConnection:function(c){var L=c.targetMagnet;return!!L}},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5F95FF",stroke:"#5F95FF"}}}},background:{color:"#F2F7FA"},grid:!0});r.use(new ne.H({enabled:!0,sharp:!0})).use(new _.A({enabled:!0})).use(new te.Y({enabled:!0,multiple:!0,strict:!0,rubberband:!0,movable:!0,showNodeSelectionBox:!0,pointerEvents:"none"})).use(new oe.T({enabled:!0})).use(new ee.N),r.on("edge:dblclick",function(){}),r.on("edge:mouseenter",function(){}),r.on("edge:mouseleave",function(){}),r.on("node:moved",function(){}),r.on("node:mouseenter",function(){}),r.on("node:mouseleave",function(){}),r.on("node:added",function(){}),r.on("node:dblclick",function(o){var c=o.node;C(!1)}),r.on("blank:dblclick",function(o){var c=o.x,L=o.y}),r.fromJSON(m.visualConfig),(0,ce.V)(r),O(r)}},[m]),(0,i.useEffect)(function(){n==null||n.off("node:click",V),n==null||n.on("node:click",V)},[d]);var Ae=function(){},Pe=[{key:"1",label:"\u65E5\u5FD7",children:(0,e.jsx)(ae.gcu,{src:s,levelExpand:0})},{key:"2",label:"\u8282\u70B9\u914D\u7F6E",children:(0,e.jsx)(ve.Z,{onSubmit:function(){},editNode:Ie})}];return(0,e.jsxs)(S.Z,{style:{margin:0,height:"100vh"},children:[(0,e.jsxs)(S.Z.Sider,{theme:"light",collapsedWidth:0,width:300,style:{overflow:"auto",height:"100vh",position:"fixed",left:0,top:0,bottom:0,borderRight:"0.5px solid"},children:[(0,e.jsx)(p.Z,{children:"\u72B6\u6001\u53D8\u66F4\u8BB0\u5F55"}),(0,e.jsx)(ie.Z,{style:{height:"100%"},items:Ee})]}),(0,e.jsxs)(S.Z,{style:{marginLeft:300},children:[(0,e.jsxs)(S.Z.Header,{style:{backgroundColor:"white",padding:0},children:[(0,e.jsxs)(P.Z,{direction:"horizontal",style:{},children:[(0,e.jsx)(p.Z,{type:"vertical"}),(g=a.btns)===null||g===void 0?void 0:g.map(function(l){return l})]}),(0,e.jsx)(B.ZP,{type:"text",icon:y?(0,e.jsx)(w.Z,{}):(0,e.jsx)(q.Z,{}),onClick:function(){C(!y)},style:{float:"right",right:"16px",fontSize:"16px",width:64,height:64}})]}),(0,e.jsx)(S.Z.Content,{className:"app-content",children:(0,e.jsx)(ge.Z,{ref:k})})]}),(0,e.jsxs)(S.Z.Sider,{theme:"light",collapsed:y,collapsedWidth:0,style:{overflow:"scroll"},width:500,children:[(0,e.jsx)(le.Z,{items:Pe,defaultActiveKey:"1"}),(0,e.jsx)(B.ZP,{type:"text",onClick:function(){C(!y)},style:{position:"absolute",top:0,right:0,fontSize:"16px",width:64,height:64},children:"x"})]})]})},he=fe,b=t(48364),xe=t(47829),me=t(28635),Se=t(79549),je=t(52615),ye=t(98306),Re=null,Ce=function(){var a=(0,ye.UO)(),g=a.id,T=(0,i.useState)(),j=u()(T,2),n=j[0],O=j[1],$=(0,i.useState)(!1),F=u()($,2),m=F[0],x=F[1],D=(0,i.useState)([]),I=u()(D,2),y=I[0],C=I[1],z=(0,i.useState)(),N=u()(z,2),s=N[0],E=N[1];return(0,i.useEffect)(function(){x(!0),g&&(0,b.m9)(g).then(function(f){f&&(E(f),x(!0),(0,b.b9)(f.logicId,f.version).then(function(h){var d=h;d.id=g,O(d),x(!1)}).catch(function(h){x(!1),console.log("err"),console.log(h)}))})},[g]),(0,i.useEffect)(function(){s&&(0,b.gC)(s).then(function(f){f&&C(f)})},[s]),(0,e.jsx)("div",{children:(0,e.jsx)(je.Z,{spinning:m,children:(0,e.jsx)(he,{btns:[(0,e.jsxs)(B.ZP,{onClick:function(){x(!0),(0,b.m9)(g).then(function(h){h&&(E(h),(0,b.gC)(h).then(function(d){d&&C(d),x(!1)})),x(!1)})},children:[(0,e.jsx)(xe.Z,{}),"\u5237\u65B0\u8BB0\u5F55"]}),(0,e.jsx)(p.Z,{type:"vertical"}),(0,e.jsxs)("span",{children:["\u662F\u5426\u5B8C\u6210\uFF1A",s!=null&&s.isOver?(0,e.jsx)(me.Z,{twoToneColor:"#52c41a"}):(0,e.jsx)(Se.Z,{twoToneColor:"red"})]}),(0,e.jsx)(p.Z,{type:"vertical"}),(0,e.jsxs)("span",{children:["\u5F85\u6267\u884C\uFF1A",s==null?void 0:s.nextName]}),(0,e.jsx)(p.Z,{type:"vertical"}),(0,e.jsxs)(P.Z,{children:[(0,e.jsx)(Z.Z.Paragraph,{style:{color:"red"},children:"\u6267\u884C\u7248\u672C:"}),(0,e.jsx)(Z.Z.Paragraph,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F!"]},children:s==null?void 0:s.version})]})],nextId:s==null?void 0:s.nextId,config:n,logicIns:s,debugLogs:y})})})},Le=Ce}}]);
