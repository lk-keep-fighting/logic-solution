"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[2262],{19435:function(je,$,e){e.d($,{O:function(){return le},A:function(){return Q.Z}});var Q=e(28576),I=e(54306),h=e.n(I),b=e(8049),X=e(14990),R=e(22465),w=e(5671),F=e(17696),N=e(19227),f=e(75476),k=e(1167),q=e(22150),A=e(40767),P=e(38243),L=e(58856),D=e(22983),_=e(39092),H=e(75904),ee=e(18725),r=e(87363),ne=e.n(r),te=e(10486),oe=e(14232),ae=e(37555),re=e(59998),G=e(72107),ie=e(88287),J=e(23620),t=e(33130),ue=ne().createContext({logic:new G.Iz("")}),u=function(d){var M,C=(0,r.useState)(),l=h()(C,2),n=l[0],v=l[1],O=(0,r.useState)(),a=h()(O,2),y=a[0],se=a[1],W=(0,r.useState)(!1),K=h()(W,2),Z=K[0],ve=K[1],U=(0,r.useState)(!0),V=h()(U,2),T=V[0],B=V[1],Y=(0,r.useState)(),c=h()(Y,2),E=c[0],m=c[1],j=(0,r.useState)(),p=h()(j,2),x=p[0],Le=p[1],Ze=(0,r.useState)(),ge=h()(Ze,2),de=ge[0],pe=ge[1],Fe=(0,r.useState)(),he=h()(Fe,2),Te=he[0],me=he[1],Ie=(0,r.useState)(),xe=h()(Ie,2),be=xe[0],Ae=xe[1],Se=(0,r.useRef)(),Ce=function(S){var s=S.node;me(s);var o=x==null?void 0:x.itemLogs.find(function(g){return g.config.id==s.id});m(o)};(0,r.useEffect)(function(){de&&(n==null||n.centerCell(de))},[de,n]),(0,r.useEffect)(function(){console.log("play curItemLog",E)},[E]),(0,r.useEffect)(function(){var i=n==null?void 0:n.getNodes().find(function(S){return S.id==d.nextId});i==null||i.attr("body/fill","red"),pe(i)},[d.nextId]),(0,r.useEffect)(function(){var i;n==null||(i=n.getNodes().find(function(S){return S.id==d.nextId}))===null||i===void 0||i.attr("body/fill","red")},[n]),(0,r.useEffect)(function(){d.config&&se(d.config)},[d.config]),(0,r.useEffect)(function(){var i,S;console.log("props.debugLogs",d.debugLogs),((i=d.debugLogs)===null||i===void 0?void 0:i.length)>0&&setInterval(Oe,2e3);var s=[];d&&((S=d.debugLogs)===null||S===void 0||S.forEach(function(o){var g,z;s.push({children:(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("span",{style:{cursor:"pointer",fontWeight:o.id==(x==null?void 0:x.id)?"bolder":"normal",color:o.id==(x==null?void 0:x.id)?"#52c41a":"black"},onClick:function(){Le(o),console.log(o),n==null||n.fromJSON(y==null?void 0:y.visualConfig);var ye;o.itemLogs.forEach(function(ze){var ce=n==null?void 0:n.getNodes().find(function(Ne){return Ne.id==ze.config.id});ce&&(ce.attr("body/fill","#52c41a"),ye=ce)}),n==null||n.centerCell(ye),m({}),me({})},children:[(0,t.jsx)("p",{children:(g=o.itemLogs[0])===null||g===void 0?void 0:g.config.name}),((z=d.logicIns)===null||z===void 0?void 0:z.version)==o.version?(0,t.jsx)("p",{}):(0,t.jsx)("p",{children:(0,t.jsxs)(A.Z,{children:[(0,t.jsx)(P.Z.Paragraph,{style:{color:"red"},children:"\u7248\u672C\u53F7:"}),(0,t.jsxs)(P.Z.Paragraph,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F!"],text:o.version},children:[o.version,(0,t.jsx)(P.Z.Link,{style:{margin:"5px"},href:"#/assets/logic/i/".concat(o.logicId,"/view/").concat(o.version),target:"_blank",children:(0,t.jsx)(b.Z,{})})]})]})}),(0,t.jsxs)("p",{children:["\u4E1A\u52A1\u6807\u8BC6\uFF1A",o.bizId]}),(0,t.jsx)("p",{children:o.serverTime}),(0,t.jsx)("p",{children:o.message})]})}),color:o.success?"green":"red"})})),Ae(s)},[d.debugLogs,d.logicIns,n,x]),(0,r.useEffect)(function(){if(y){try{var i=(0,te.K)(),S=i.Shapes;(0,oe.m)(S)}catch(o){console.error("\u6CE8\u518C\u8282\u70B9\u51FA\u9519\uFF1A"),console.error(o)}var s=new w.kJ({container:Se.current,embedding:{enabled:!0,validate:function(g){return g.child.setData({hoverNode:g.parent}),!0}},mousewheel:{enabled:!0,modifiers:"ctrl",minScale:.5,maxScale:3},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:15}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,allowMulti:!0,snap:{radius:20},createEdge:function(){return new w.bn.kS({tools:[{name:"edge-editor",args:{attrs:{backgroundColor:"#fff"}}}],zIndex:0})},validateConnection:function(g){var z=g.targetMagnet;return!!z}},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5F95FF",stroke:"#5F95FF"}}}},background:{color:"#F2F7FA"},grid:!0});s.use(new k.H({enabled:!0,sharp:!0})).use(new F.A({enabled:!0})).use(new f.Y({enabled:!0,multiple:!0,strict:!0,rubberband:!0,movable:!0,showNodeSelectionBox:!0,pointerEvents:"none"})).use(new q.T({enabled:!0})).use(new N.N),s.on("edge:dblclick",function(){}),s.on("edge:mouseenter",function(){}),s.on("edge:mouseleave",function(){}),s.on("node:moved",function(){}),s.on("node:mouseenter",function(){}),s.on("node:mouseleave",function(){}),s.on("node:added",function(){}),s.on("node:dblclick",function(o){var g=o.node;B(!1)}),s.on("blank:dblclick",function(o){var g=o.x,z=o.y}),s.fromJSON(y.visualConfig),(0,re.V)(s),v(s)}},[y]),(0,r.useEffect)(function(){n==null||n.off("node:click",Ce),n==null||n.on("node:click",Ce)},[x]);var Oe=function(){},Ee=[{key:"1",label:"\u65E5\u5FD7",children:(0,t.jsx)(J.gcu,{src:E})},{key:"2",label:"\u8282\u70B9\u914D\u7F6E",children:(0,t.jsx)(ie.Z,{editNode:Te,configSchemaProvider:d.configSchemaProvider})}];return(0,t.jsxs)(L.Z,{style:{margin:0,height:"100vh"},children:[(0,t.jsxs)(L.Z.Sider,{theme:"light",collapsedWidth:0,width:300,style:{overflow:"auto",height:"100vh",position:"fixed",left:0,top:0,bottom:0,borderRight:"0.5px solid"},children:[(0,t.jsx)(D.Z,{children:"\u6700\u8FD1\u8BF7\u6C42"}),(0,t.jsx)(_.Z,{style:{height:"100%"},items:be})]}),(0,t.jsxs)(L.Z,{style:{marginLeft:300},children:[(0,t.jsxs)(L.Z.Header,{style:{backgroundColor:"white",padding:0},children:[(0,t.jsxs)(A.Z,{direction:"horizontal",style:{},children:[(0,t.jsx)(D.Z,{type:"vertical"}),(M=d.btns)===null||M===void 0?void 0:M.map(function(i){return i})]}),(0,t.jsx)(H.ZP,{type:"text",icon:T?(0,t.jsx)(X.Z,{}):(0,t.jsx)(R.Z,{}),onClick:function(){B(!T)},style:{float:"right",right:"16px",fontSize:"16px",width:64,height:64}})]}),(0,t.jsx)(L.Z.Content,{className:"app-content",children:(0,t.jsx)(ae.Z,{ref:Se})})]}),(0,t.jsxs)(L.Z.Sider,{theme:"light",collapsed:T,collapsedWidth:0,style:{overflow:"scroll"},title:"ddd",width:500,children:[(0,t.jsx)(H.ZP,{type:"text",onClick:function(){B(!T)},style:{float:"right",fontSize:"16px",width:64,height:64},children:"x"}),(0,t.jsx)(ee.Z,{items:Ee,defaultActiveKey:"1"})]})]})},le=u},48669:function(je,$,e){e.r($),e.d($,{default:function(){return M}});var Q=e(54306),I=e.n(Q),h=e(25359),b=e.n(h),X=e(49811),R=e.n(X),w=e(19435),F=e(48364),N=e(56159),f=e(87363),k={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"},q=k,A=e(45288),P=function(l,n){return f.createElement(A.Z,(0,N.Z)({},l,{ref:n,icon:q}))},L=f.forwardRef(P),D={icon:function(l,n){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:l}},{tag:"path",attrs:{d:"M512 140c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm193.4 225.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.3 0 19.9 5 25.9 13.3l71.2 98.8 157.2-218c6-8.4 15.7-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.4 12.7z",fill:n}},{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z",fill:l}}]}},name:"check-circle",theme:"twotone"},_=D,H=function(l,n){return f.createElement(A.Z,(0,N.Z)({},l,{ref:n,icon:_}))},ee=f.forwardRef(H),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M288 421a48 48 0 1096 0 48 48 0 10-96 0zm352 0a48 48 0 1096 0 48 48 0 10-96 0zM512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm263 711c-34.2 34.2-74 61-118.3 79.8C611 874.2 562.3 884 512 884c-50.3 0-99-9.8-144.8-29.2A370.4 370.4 0 01248.9 775c-34.2-34.2-61-74-79.8-118.3C149.8 611 140 562.3 140 512s9.8-99 29.2-144.8A370.4 370.4 0 01249 248.9c34.2-34.2 74-61 118.3-79.8C413 149.8 461.7 140 512 140c50.3 0 99 9.8 144.8 29.2A370.4 370.4 0 01775.1 249c34.2 34.2 61 74 79.8 118.3C874.2 413 884 461.7 884 512s-9.8 99-29.2 144.8A368.89 368.89 0 01775 775zM512 533c-85.5 0-155.6 67.3-160 151.6a8 8 0 008 8.4h48.1c4.2 0 7.8-3.2 8.1-7.4C420 636.1 461.5 597 512 597s92.1 39.1 95.8 88.6c.3 4.2 3.9 7.4 8.1 7.4H664a8 8 0 008-8.4C667.6 600.3 597.5 533 512 533z"}}]},name:"frown",theme:"outlined"},ne=r,te=function(l,n){return f.createElement(A.Z,(0,N.Z)({},l,{ref:n,icon:ne}))},oe=f.forwardRef(te),ae=e(52615),re=e(75904),G=e(22983),ie=e(40767),J=e(38243),t=e(70517),ue=e(98306),u=e(33130),le=function(){var C=R()(b()().mark(function l(n){var v;return b()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.Z.get("/setting/node-form/".concat(n,".json"));case 2:return v=a.sent,console.log(v.data),a.abrupt("return",v.data);case 5:case"end":return a.stop()}},l)}));return function(n){return C.apply(this,arguments)}}(),fe=function(){var C=R()(b()().mark(function l(n){var v;return b()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.Z.get("/setting/node-log/".concat(n,".json")).catch(function(y){return y});case 2:if(v=a.sent,console.log(v.data),!v.data){a.next=8;break}return a.abrupt("return",v.data);case 8:return a.next=10,t.Z.get("/setting/node-log/_def.json");case 10:return a.abrupt("return",a.sent.data);case 11:case"end":return a.stop()}},l)}));return function(n){return C.apply(this,arguments)}}(),d=function(){var l=(0,ue.UO)(),n=l.id,v=(0,f.useState)(),O=I()(v,2),a=O[0],y=O[1],se=(0,f.useState)(!1),W=I()(se,2),K=W[0],Z=W[1],ve=(0,f.useState)([]),U=I()(ve,2),V=U[0],T=U[1],B=(0,f.useState)(),Y=I()(B,2),c=Y[0],E=Y[1];return(0,f.useEffect)(function(){Z(!0),n&&(0,F.m9)(n).then(function(m){m&&(E(m),Z(!0),(0,F.b9)(m.logicId,m.version).then(function(j){var p=j;p.id=n,y(p),Z(!1)}).catch(function(j){Z(!1),console.log("err"),console.log(j)}))})},[n]),(0,f.useEffect)(function(){c&&(0,F.gC)(c).then(function(m){m&&T(m)})},[c]),(0,u.jsx)("div",{children:(0,u.jsx)(ae.Z,{spinning:K,children:(0,u.jsx)(w.O,{btns:[(0,u.jsxs)(re.ZP,{onClick:function(){Z(!0),(0,F.m9)(n).then(function(j){j&&(E(j),(0,F.gC)(j).then(function(p){p&&T(p),Z(!1)})),Z(!1)})},children:[(0,u.jsx)(L,{}),"\u5237\u65B0\u8BF7\u6C42"]}),(0,u.jsx)(G.Z,{type:"vertical"}),(0,u.jsxs)("span",{children:["\u662F\u5426\u5B8C\u6210\uFF1A",c!=null&&c.isOver?(0,u.jsx)(ee,{twoToneColor:"#52c41a"}):(0,u.jsx)(oe,{twoToneColor:"red"})]}),(0,u.jsx)(G.Z,{type:"vertical"}),(0,u.jsxs)(ie.Z,{children:[(0,u.jsx)(J.Z.Paragraph,{style:{color:"red"},children:"\u6267\u884C\u7248\u672C:"}),(0,u.jsx)(J.Z.Paragraph,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F!"]},children:c==null?void 0:c.version})]})],nextId:c==null?void 0:c.nextId,config:a,logicIns:c,configSchemaProvider:le,itemLogSchemaProvider:fe,debugLogs:V})})})},M=d}}]);
