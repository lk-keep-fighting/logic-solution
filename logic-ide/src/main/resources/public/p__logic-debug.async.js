"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[2262],{34622:function(De,M,t){t.r(M),t.d(M,{default:function(){return pe}});var X=t(54306),c=t.n(X),ze=t(25359),Je=t(49811),w=t(8049),q=t(14990),_=t(22465),R=t(5671),ee=t(17696),te=t(19227),ne=t(75476),oe=t(1167),ie=t(22150),G=t(4283),L=t(36267),j=t(23360),C=t(8051),le=t(87155),$=t(54145),se=t(91711),l=t(87363),ae=t.n(l),re=t(72107),de=t(58146),ue=t(89147),ce=t(3619),ve=t(9976),ge=t(34957),fe=t(62835),e=t(33130),Me=ae().createContext({logic:new re.Iz("")}),he=function(r){var g,b,I=(0,l.useState)(),F=c()(I,2),n=F[0],D=F[1],E=(0,l.useState)(),T=c()(E,2),d=T[0],z=T[1],A=(0,l.useState)(!0),B=c()(A,2),y=B[0],N=B[1],O=(0,l.useState)(),o=c()(O,2),u=o[0],f=o[1],m=(0,l.useState)(),S=c()(m,2),h=S[0],Le=S[1],Ze=(0,l.useState)(),H=c()(Ze,2),J=H[0],Ie=H[1],Fe=(0,l.useState)(),K=c()(Fe,2),Ne=K[0],U=K[1],Ee=(0,l.useState)(),k=c()(Ee,2),Te=k[0],Ae=k[1],V=(0,l.useRef)(),Y=function(x){var a=x.node;U(a);var i=h==null?void 0:h.itemLogs.find(function(v){return v.config.id==a.id});f(i)};(0,l.useEffect)(function(){J&&(n==null||n.centerCell(J))},[J,n]),(0,l.useEffect)(function(){console.log("play curItemLog",u)},[u]),(0,l.useEffect)(function(){var s=n==null?void 0:n.getNodes().find(function(x){return x.id==r.nextId});s==null||s.attr("body/fill","red"),Ie(s)},[r.nextId]),(0,l.useEffect)(function(){var s;n==null||(s=n.getNodes().find(function(x){return x.id==r.nextId}))===null||s===void 0||s.attr("body/fill","red")},[n]),(0,l.useEffect)(function(){r.config&&z(r.config)},[r.config]),(0,l.useEffect)(function(){var s,x;console.log("props.debugLogs",r.debugLogs),((s=r.debugLogs)===null||s===void 0?void 0:s.length)>0&&setInterval(Be,2e3);var a=[];r&&((x=r.debugLogs)===null||x===void 0||x.forEach(function(i){var v,p;a.push({children:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("span",{style:{cursor:"pointer",fontWeight:i.id==(h==null?void 0:h.id)?"bolder":"normal",color:i.id==(h==null?void 0:h.id)?"#52c41a":"black"},onClick:function(){Le(i),n==null||n.fromJSON(d==null?void 0:d.visualConfig);var Q;i.itemLogs.forEach(function(Pe){var P=n==null?void 0:n.getNodes().find(function($e){return $e.id==Pe.config.id});console.log("fill node"),console.log(P),P&&(P.addTools({name:"boundary",args:{attrs:{stroke:"red",strokeWidth:4,fillOpacity:.2}}}),Q=P)}),n==null||n.centerCell(Q),f({}),U({})},children:[(0,e.jsx)("p",{children:(v=i.itemLogs[0])===null||v===void 0?void 0:v.config.name}),(0,e.jsx)("p",{children:i.serverTime}),((p=r.logicIns)===null||p===void 0?void 0:p.version)==i.version?(0,e.jsx)("p",{}):(0,e.jsx)("p",{children:(0,e.jsxs)(G.Z,{children:[(0,e.jsx)(L.Z.Paragraph,{style:{color:"red"},children:"\u7248\u672C\u53F7:"}),(0,e.jsxs)(L.Z.Paragraph,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F!"],text:i.version},children:[i.version,(0,e.jsx)(L.Z.Link,{style:{margin:"5px"},href:"#/assets/logic/i/".concat(i.logicId,"/view/").concat(i.version),target:"_blank",children:(0,e.jsx)(w.Z,{})})]})]})}),(0,e.jsx)("p",{children:i.message})]})}),color:i.success?"green":"red"})})),Ae(a)},[r.debugLogs,r.logicIns,n,h]),(0,l.useEffect)(function(){if(d){try{var s=(0,de.K)(),x=s.Shapes;(0,ue.m)(x)}catch(i){console.error("\u6CE8\u518C\u8282\u70B9\u51FA\u9519\uFF1A"),console.error(i)}var a=new R.kJ({container:V.current,embedding:{enabled:!0,validate:function(v){return v.child.setData({hoverNode:v.parent}),!0}},mousewheel:{enabled:!0,modifiers:"ctrl",minScale:.5,maxScale:3},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:15}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,allowMulti:!0,snap:{radius:20},createEdge:function(){return new R.bn.kS({tools:[{name:"edge-editor",args:{attrs:{backgroundColor:"#fff"}}}],zIndex:0})},validateConnection:function(v){var p=v.targetMagnet;return!!p}},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5F95FF",stroke:"#5F95FF"}}}},background:{color:"#F2F7FA"},grid:!0});a.use(new oe.H({enabled:!0,sharp:!0})).use(new ee.A({enabled:!0})).use(new ne.Y({enabled:!0,multiple:!0,strict:!0,rubberband:!0,movable:!0,showNodeSelectionBox:!0,pointerEvents:"none"})).use(new ie.T({enabled:!0})).use(new te.N),a.on("edge:dblclick",function(){}),a.on("edge:mouseenter",function(){}),a.on("edge:mouseleave",function(){}),a.on("node:moved",function(){}),a.on("node:mouseenter",function(){}),a.on("node:mouseleave",function(){}),a.on("node:added",function(){}),a.on("node:dblclick",function(i){var v=i.node;N(!1)}),a.on("blank:dblclick",function(i){var v=i.x,p=i.y}),a.fromJSON(d.visualConfig),(0,ce.V)(a),D(a)}},[d]),(0,l.useEffect)(function(){n==null||n.off("node:click",Y),n==null||n.on("node:click",Y)},[h]);var Be=function(){},Oe=[{key:"inout",label:"\u5165\u51FA\u53C2",children:(0,e.jsx)(fe.Z,{formId:"debug-log",values:{returnData:u==null?void 0:u.returnData,paramsJson:u==null?void 0:u.paramsJson,body:u==null||(g=u.configInstance)===null||g===void 0?void 0:g.body},onSubmit:function(){}})},{key:"config",label:"\u8282\u70B9\u914D\u7F6E",children:(0,e.jsx)(ge.Z,{onSubmit:function(){},editNode:Ne})}];return(0,e.jsxs)(j.Z,{style:{margin:0,height:"100vh"},children:[(0,e.jsxs)(j.Z.Sider,{theme:"light",collapsedWidth:0,width:300,style:{overflow:"auto",height:"100vh",position:"fixed",left:0,top:0,bottom:0,borderRight:"0.5px solid"},children:[(0,e.jsx)(C.Z,{children:"\u72B6\u6001\u53D8\u66F4\u8BB0\u5F55"}),(0,e.jsx)(le.Z,{style:{height:"100%"},items:Te})]}),(0,e.jsxs)(j.Z,{style:{marginLeft:300},children:[(0,e.jsxs)(j.Z.Header,{style:{backgroundColor:"white",padding:0},children:[(b=r.btns)===null||b===void 0?void 0:b.map(function(s){return s}),(0,e.jsx)($.ZP,{type:"text",icon:y?(0,e.jsx)(q.Z,{}):(0,e.jsx)(_.Z,{}),onClick:function(){N(!y)},style:{float:"right",right:"16px",fontSize:"16px",width:64,height:64}})]}),(0,e.jsx)(j.Z.Content,{className:"app-content",children:(0,e.jsx)(ve.Z,{ref:V})})]}),(0,e.jsxs)(j.Z.Sider,{theme:"light",collapsed:y,collapsedWidth:0,style:{overflow:"scroll"},width:500,children:[(0,e.jsx)(se.Z,{items:Oe,defaultActiveKey:"inout"}),(0,e.jsx)($.ZP,{type:"text",onClick:function(){N(!y)},style:{position:"absolute",top:0,right:0,fontSize:"16px",width:64,height:64},children:"x"})]})]})},xe=he,Z=t(48364),me=t(47829),Se=t(28635),ye=t(79549),je=t(72197),Ce=t(98306),Re=null,be=function(){var r=(0,Ce.UO)(),g=r.id,b=(0,l.useState)(),I=c()(b,2),F=I[0],n=I[1],D=(0,l.useState)(!1),E=c()(D,2),T=E[0],d=E[1],z=(0,l.useState)([]),A=c()(z,2),B=A[0],y=A[1],N=(0,l.useState)(),O=c()(N,2),o=O[0],u=O[1];return(0,l.useEffect)(function(){d(!0),g&&(0,Z.m9)(g).then(function(f){f&&(u(f),d(!0),(0,Z.b9)(f.logicId,f.version).then(function(m){var S=m;S.id=g,n(S),d(!1)}).catch(function(m){d(!1),console.log("err"),console.log(m)}))})},[g]),(0,l.useEffect)(function(){o&&(0,Z.gC)(o).then(function(f){f&&y(f)})},[o]),(0,e.jsx)("div",{children:(0,e.jsx)(je.Z,{spinning:T,children:(0,e.jsx)(xe,{btns:[(0,e.jsx)(C.Z,{type:"vertical"}),(0,e.jsxs)($.ZP,{type:"primary",onClick:function(){d(!0),(0,Z.m9)(g).then(function(m){m&&(u(m),(0,Z.gC)(m).then(function(S){S&&y(S),d(!1)})),d(!1)})},children:[(0,e.jsx)(me.Z,{}),"\u5237\u65B0\u8BB0\u5F55"]}),(0,e.jsx)(C.Z,{type:"vertical"}),(0,e.jsxs)("span",{children:["\u662F\u5426\u5B8C\u6210\uFF1A",o!=null&&o.isOver?(0,e.jsx)(Se.Z,{twoToneColor:"#52c41a"}):(0,e.jsx)(ye.Z,{twoToneColor:"red"})]}),(0,e.jsx)(C.Z,{type:"vertical"}),(0,e.jsxs)("span",{children:["\u5F85\u6267\u884C\uFF1A",o==null?void 0:o.nextName]}),(0,e.jsx)(C.Z,{type:"vertical"}),(0,e.jsxs)(G.Z,{children:["\u4E1A\u52A1\u6807\u8BC6\uFF1A",o==null?void 0:o.bizId,(0,e.jsx)(L.Z.Text,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F!"],text:o==null?void 0:o.bizId}})]}),(0,e.jsx)(C.Z,{type:"vertical"}),(0,e.jsx)("span",{style:{color:"red"},children:"\u6267\u884C\u7248\u672C\uFF1A"}),(0,e.jsxs)("span",{children:[o==null?void 0:o.version,(0,e.jsx)(L.Z.Text,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F!"],text:o==null?void 0:o.version}})]})],nextId:o==null?void 0:o.nextId,config:F,logicIns:o,debugLogs:B})})})},pe=be}}]);
