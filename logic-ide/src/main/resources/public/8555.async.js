"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[8555],{60341:function(B,C,e){e.d(C,{l:function(){return h.Z}});var h=e(93797)},44174:function(B,C,e){e.d(C,{n:function(){return O}});var h=e(12490),m=e(57213),A=e.n(m),g=50,p=50,E={body:{}},y={"wati-for-continu":{shape:"circle",ports:h.Tt,width:g,height:p,attrs:{body:A()(A()({},E.body),{},{fill:"white"}),text:{text:"\u4EA4\u4E92\u70B9"}},markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}],data:{config:{type:"wait-for-continue"}}},js:{shape:"ExtSharp",ports:h.Tt,attrs:{image:{width:15,x:2,y:2,"xlink:href":"/logic/icons/code.svg"},text:{text:"js\u811A\u672C",fontSize:14}},data:{config:{type:"js"}}},java:{shape:"ExtSharp",ports:h.Tt,attrs:{image:{width:15,x:2,y:2,"xlink:href":"/logic/icons/java.svg"},text:{text:"java\u65B9\u6CD5",fontSize:14}},data:{config:{type:"java"}}},switch:{shape:"ExtSharp",width:50,height:p,ports:h.Tt,label:"switch",attrs:{image:{"xlink:href":"/logic/icons/switch.svg",width:45,x:1,y:2},text:{text:"switch",fontSize:14,refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}}}};function O(v){var _=v.createNode({shape:"circle",label:"start",width:50,height:50,attrs:{body:{}},ports:h.Hi,data:{config:{type:"start"}}});v.addNode(_)}function f(v,_){var s=LogicItemSharpMapping[_.type];if(s){s.data={config:_};var d=v.createNode(s);d.setAttrByPath("text/text",_.name),v.addNode(d)}}},94744:function(B,C,e){e.d(C,{y:function(){return _}});var h=e(37635),m=e.n(h),A=e(21140),g=e.n(A),p=e(63466),E=e.n(p),y=e(72107),O=e(52510),f=e.n(O),v=E()(function s(d){g()(this,s),f()(this,"concept","EnvParam"),f()(this,"name",void 0),f()(this,"description",void 0),f()(this,"typeAnnotation",void 0),f()(this,"required",!1),f()(this,"defaultValue",void 0),this.name=d}),_=function(){function s(){g()(this,s)}return E()(s,null,[{key:"valueToTypeAnnotaion",value:function(t){var o=this,n={concept:y.Ld.TypeAnnotation,typeKind:"primitive",typeName:"string",defaultValue:t};if(Array.isArray(t))n.typeName="array";else{var a=m()(t);switch(a){case"boolean":n.typeKind="primitive",n.typeName="boolean";break;case"number":n.typeKind="primitive",n.typeName="number";break;case"string":n.typeKind="primitive",n.typeName="string";break;case"object":t==null?n.typeName="null":t instanceof Date?(n.typeKind="primitive",n.typeName="date"):t instanceof RegExp?(n.typeKind="primitive",n.typeName="regexp"):t instanceof Function?(n.typeKind="primitive",n.typeName="function"):(n.typeKind="anonymousStructure",n.typeName="object",n.properties=[],Object.keys(t).map(function(r){var i,u=t[r],l=o.valueToTypeAnnotaion(u),c=new y.X0(r);c.typeAnnotation=l,c.defaultValue=u,(i=n.properties)===null||i===void 0||i.push(c)}));break;default:n.typeKind="unknown",n.typeName=a;break}}return n}},{key:"typeAnnotaionToValue",value:function(t){var o,n,a=this,r;switch(t.typeName){case"array":r=(o=t.defaultValue)!==null&&o!==void 0?o:[];break;case"boolean":r=t.defaultValue?t.defaultValue=="true":!1;break;case"number":r=parseFloat(t.defaultValue);break;case"null":r=null;break;case"date":r=new Date(t.defaultValue);break;case"regexp":r=new RegExp(t.defaultValue);break;case"object":r={},(n=t.properties)===null||n===void 0||n.forEach(function(i){r[i.name]=a.typeAnnotaionToValue(i.typeAnnotation)});break;case"string":case"function":default:r=t.defaultValue;break}return r}},{key:"getParamArrayByJson",value:function(t){var o=[];return t&&Object.keys(t).forEach(function(n){var a=new y.dO(n);a.typeAnnotation=s.valueToTypeAnnotaion(t[n]),a.defaultValue=t[n],o.push(a)}),o}},{key:"getReturnArrayByJson",value:function(t){var o=[];return t&&Object.keys(t).forEach(function(n){var a=new y.z1(n);a.typeAnnotation=s.valueToTypeAnnotaion(t[n]),a.defaultValue=t[n],o.push(a)}),o}},{key:"getVariableArrayByJson",value:function(t){var o=[];return t&&Object.keys(t).forEach(function(n){var a=new y._w(n);a.typeAnnotation=s.valueToTypeAnnotaion(t[n]),a.defaultValue=t[n],o.push(a)}),o}},{key:"getEnvsArrayByJson",value:function(t){var o=[];return t&&Object.keys(t).forEach(function(n){var a=new v(n);a.typeAnnotation=s.valueToTypeAnnotaion(t[n]),a.defaultValue=t[n],o.push(a)}),o}},{key:"getJsonByParams",value:function(t){var o=this,n={};return t==null||t.forEach(function(a){n[a.name]=a.typeAnnotation?o.typeAnnotaionToValue(a.typeAnnotation):a.defaultValue}),n}}]),s}()},44132:function(B,C,e){var h=e(57213),m=e.n(h),A=e(54306),g=e.n(A),p=e(70517),E=e(90010),y=e.n(E),O=e(23620),f=e(2069),v=e(87363),_=e.n(v),s=e(12472),d=e(33358),t=e(49500),o=e(16123),n=e(78057),a=e(69078),r=e(98896),i=e(31837),u=e(32126),l=e(33130),c=function(D){var M=(0,v.useState)({type:"page"}),T=g()(M,2),S=T[0],K=T[1],W=(0,v.useState)(),I=g()(W,2),V=I[0],Z=I[1],G=(0,v.useState)(),N=g()(G,2),z=N[0],Y=N[1],j="cxd",J="zh-CN";return(0,v.useEffect)(function(){(0,r.m)(p.Z)},[]),(0,v.useEffect)(function(){D.pageId&&((0,s.UD)(D.pageId).then(function(L){K(L)}),u.S.getEnvJson().then(function(L){Z(JSON.parse(i.j.getEnv()))}))},[D.pageId]),(0,l.jsxs)("div",{children:[(0,l.jsx)(f.qR,{theme:j,position:"top-right",locale:J},"toast"),(0,l.jsx)(f.wx,{theme:j,locale:J},"alert"),(0,O.sYA)(S,{data:m()({envs:V},D.data)},{fetcher:function(b){var U=b.url,F=b.method,x=b.data,w=b.responseType,P=b.config,$=b.headers;return D.data&&D.data.runtime&&(U="/papi/".concat(D.data.runtime).concat(U)),P=P||{},P.withCredentials=!0,w&&(P.responseType=w),P.cancelExecutor&&(P.cancelToken=new p.Z.CancelToken(P.cancelExecutor)),P.headers=$||{},P.headers.Authorization||(P.headers.Authorization="Bearer "+a.F.getTokenFormLocal()),F!=="post"&&F!=="put"&&F!=="patch"?(x&&(P.params=x),p.Z[F](U,P)):(x&&x instanceof FormData?(P.headers=P.headers||{},P.headers["Content-Type"]="multipart/form-data"):x&&typeof x!="string"&&!(x instanceof Blob)&&!(x instanceof ArrayBuffer)&&(x=JSON.stringify(x),P.headers=P.headers||{},P.headers["Content-Type"]="application/json"),p.Z[F](U,x,P))},isCancel:function(b){return p.Z.isCancel(b)},copy:function(b){y()(b),f.Am.success("\u5185\u5BB9\u5DF2\u590D\u5236\u5230\u7C98\u8D34\u677F")},theme:j,jumpTo:function(b,U){debugger;U.blank==!0?window.open(window.location.origin+window.location.pathname+"#"+b,"_blank"):window.location.hash=b}})]})};C.Z=c},7944:function(B,C,e){var h=e(54306),m=e.n(h),A=e(94990),g=e(94744),p=e(51394),E=e(83217),y=e(87363),O=e.n(y),f=e(33130),v=function(s){var d,t=(0,y.useState)({}),o=m()(t,2),n=o[0],a=o[1];(0,y.useEffect)(function(){var i=s.values,u=i.params,l=i.variables,c=i.envs,R=i.returns,D=i.log;a({params:JSON.stringify(g.y.getJsonByParams(u)),variables:JSON.stringify(g.y.getJsonByParams(l)),returns:JSON.stringify(g.y.getJsonByParams(R)),envs:JSON.stringify(g.y.getJsonByParams(c)),log:D})},[s.values]);var r=(0,y.useCallback)(function(i){try{return JSON.parse(i),!0}catch(u){return!1}},[]);return(0,f.jsxs)("span",{children:[s.children,(0,f.jsx)(p.Z,{open:(d=s.open)!==null&&d!==void 0?d:!1,title:"\u53C2\u6570\u914D\u7F6E\uFF08\u901A\u8FC7json\u683C\u5F0F\u58F0\u660E\uFF09",width:1e3,footer:!1,onCancel:function(){return s==null?void 0:s.setOpen(!1)},children:(0,f.jsx)(A.Z,{formId:"logic-setting",values:n,onSubmit:function(u){console.log("\u63D0\u4EA4\u53C2\u6570"),console.log(u);var l=!1;Object.keys(u).forEach(function(c){var R=u[c];if(!r(R)){var D=c==="params"?"\u5165\u53C2":c==="variables"?"\u5C40\u90E8\u53D8\u91CF":c==="returns"?"\u8FD4\u56DE\u53C2\u6570":"\u73AF\u5883\u53D8\u91CF";switch(c){case"params":return E.ZP.error("\u5165\u53C2json\u683C\u5F0F\u9519\u8BEF"),l=!0,!1;break;case"variables":return E.ZP.error("\u5C40\u90E8\u53D8\u91CFjson\u683C\u5F0F\u9519\u8BEF"),l=!0,!1;break;case"returns":return E.ZP.error("\u8FD4\u56DE\u53C2\u6570json\u683C\u5F0F\u9519\u8BEF"),l=!0,!1;break;case"ens":return E.ZP.error("\u73AF\u5883\u53D8\u91CFjson\u683C\u5F0F\u9519\u8BEF"),l=!0,!1;break;default:break}}}),l||(s!=null&&s.onSubmit&&s.onSubmit(u),s==null||s.setOpen(!1))}})})]})};C.Z=v},79671:function(B,C,e){var h=e(94990),m=e(94744),A=e(83217),g=e(51394),p=e(73529),E=e(87363),y=e.n(E),O=e(33130),f=function(_){var s,d=(0,p.cI)();(0,E.useEffect)(function(){var n=_.values.params;d.setValues({params:JSON.stringify(m.y.getJsonByParams(n))})},[_.values]);var t=(0,E.useCallback)(function(n){try{return JSON.parse(n),!0}catch(a){return!1}},[]);function o(n){var a=!1;Object.keys(n).forEach(function(r){var i=n[r];if(["params","headers"].indexOf(r)>-1&&!t(i)){var u=r==="params"?"\u5165\u53C2":"\u8BF7\u6C42\u5934";return A.ZP.error("".concat(u,"json\u683C\u5F0F\u9519\u8BEF")),a=!0,!1}}),a||(_!=null&&_.onSubmit&&_.onSubmit(n,n.debugType),_==null||_.setOpen(!1))}return(0,O.jsxs)("span",{children:[_.children,(0,O.jsx)(g.Z,{open:(s=_.open)!==null&&s!==void 0?s:!1,title:"\u53C2\u6570\u914D\u7F6E\uFF08\u901A\u8FC7json\u683C\u5F0F\u58F0\u660E\uFF09",width:1e3,footer:!1,onCancel:function(){return _==null?void 0:_.setOpen(!1)},children:(0,O.jsx)(h.Z,{formId:"logic-debug-input",onSubmit:o})})]})};C.Z=f},88090:function(B,C,e){e.d(C,{W:function(){return d}});var h=e(57213),m=e.n(h),A=e(21140),g=e.n(A),p=e(63466),E=e.n(p),y=e(83217),O=e(72107),f=null;function v(t,o,n,a){var r,i,u=t.data.config,l=u.type,c=n.flatMap(function(T){return T.source.cell===t.id?o[T.target.cell]:[]}),R=t.attrs,D=new O.Du((r=t.id)!==null&&r!==void 0?r:"",l);if(D=m()(m()({},u),{},{id:t.id,name:R==null||(i=R.text)===null||i===void 0?void 0:i.text}),!(a.findIndex(function(T){return T.id===D.id})>-1)&&(a.push(D),c.length!==0))switch(l){default:if(c.length>1||D.type==="switch"){var M;console.log((M=t.data)===null||M===void 0?void 0:M.config),console.log(c),D.branches=[],c.forEach(function(T){var S,K,W,I;console.log((S=T.data)===null||S===void 0?void 0:S.config),(K=D.branches)===null||K===void 0||K.push({when:(W=T.data)===null||W===void 0||(I=W.config)===null||I===void 0?void 0:I.case,nextId:T.id}),v(o[T.id],o,n,a)})}else D.nextId=c[0].id,v(o[c[0].id],o,n,a);break}}function _(t,o){var n=new O.Iz(t),a=[],r=[],i={},u=void 0;if(o.forEach(function(l){var c=l.id||"";l.shape==="edge"?a.push(l):(i[c]=l,r.push(l),l.data.config.type==="start"&&(u=l))}),!u){y.ZP.error("\u672A\u53D1\u73B0\u5F00\u59CB\u8282\u70B9\uFF0C\u8BF7\u914D\u7F6E\uFF01");return}return v(u,i,a,n.items),console.log("logic.items"),console.log(n.items),n}function s(t){var o=[],n=[];return t.items.forEach(function(a){var r={id:a.id,shape:a.type,size:{width:80,height:40},data:{config:a},attrs:{text:{text:a.name}}};if(o.push(r),a.branches&&a.branches.length>0)a.branches.forEach(function(u){var l={shape:"edge",source:{cell:a.id},target:{cell:u.nextId},labels:[{position:.5,attrs:{label:{text:u.when}}}]};n.push(l)});else if(a.nextId){var i={shape:"edge",source:{cell:a.id},target:{cell:a.nextId}};n.push(i)}}),{nodes:o,edges:n}}var d=function(){function t(){g()(this,t)}return E()(t,[{key:"graphToLogicItems",value:function(n,a){var r=_(a==null?void 0:a.id,n==null?void 0:n.getCells());return r.visualConfig=n==null?void 0:n.toJSON(),m()(m()({},a),{},{visualConfig:r.visualConfig,items:r.items})}},{key:"logicToGraphJson",value:function(n){var a=s(n);return a}}]),t}()},79716:function(B,C,e){e.d(C,{O:function(){return s}});var h=e(25359),m=e.n(h),A=e(49811),g=e.n(A),p=e(70517),E=e(9364),y=e(12490),O=e(42651),f={buildGroup:function(o,n,a,r){var i=Number.parseInt(n/2),u=n%2==0;return{name:o,title:a,graphHeight:(u?i:i+1)*(r||70)+10}}},v=f;function _(t){return t.length>7?"".concat(t.substring(0,7),`\r
`).concat(t.substring(7)):t}function s(t){return d.apply(this,arguments)}function d(){return d=g()(m()().mark(function t(o){var n,a;return m()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n=[],a="/api/ide/asset/v1/logic-item/readFromCode",o&&(a="/papi/".concat(o,"/api/ide/asset/v1/logic-item/readFromCode")),i.abrupt("return",Promise.all([(0,E.K)(),p.Z.get(a)]).then(function(u){if(console.log("getPanelData"),u[1].status==200){var l=u[1].data.data;Object.keys(l).forEach(function(c,R){var D=v.buildGroup(c,l[c].length,c);n.push(D),l[c].sort(function(M,T){return M.order?M.order.localeCompare(T.order):1}).forEach(function(M){u[0].Nodes.push(new O.Z({shape:M.shape?M.shape:"ExtShape"+(R%3==0?"1":R%3==1?"2":"3"),ports:y.Tt,attrs:{image:{width:15,x:2,y:2,"xlink:href":"/logic/icons/java.svg"},text:{text:_(M.name),fontSize:12}},data:{config:M.logicItem},_groups:[M.group]}))})})}return{Nodes:u[0].Nodes,Groups:n}}));case 4:case"end":return i.stop()}},t)})),d.apply(this,arguments)}},32126:function(B,C,e){e.d(C,{S:function(){return _}});var h=e(25359),m=e.n(h),A=e(49811),g=e.n(A),p=e(21140),E=e.n(p),y=e(63466),O=e.n(y),f=e(31837),v=e(57475),_=function(){function s(){E()(this,s)}return O()(s,null,[{key:"getEnvJson",value:function(){var d=g()(m()().mark(function o(){return m()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,v.U2)("/api/runtime/env").then(function(r){return r.data.data}).then(function(r){return f.j.setModel(r.UI_CONFIG_MODEL),f.j.setEnv(JSON.stringify(r)),f.j.setApiUrlPrefix(r.API_GATEWAY_PREFIX),f.j.setReryApi(r.CUSTOM_RETRY_URL),f.j.setReryApi(r.CUSTOM_RETRY_URL),r}));case 1:case"end":return a.stop()}},o)}));function t(){return d.apply(this,arguments)}return t}()},{key:"getRemoteRuntimeConfig",value:function(){var d=g()(m()().mark(function o(){return m()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,v.v_)("/api/ide/remote-runtimes").then(function(r){return r.data}).then(function(r){return console.log("remote runtimes:",r.data),f.j.setRemoteRuntimes(JSON.stringify(r.data)),r}));case 1:case"end":return a.stop()}},o)}));function t(){return d.apply(this,arguments)}return t}()}]),s}()}}]);
