"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[2485],{7899:function(Y,x,e){e.d(x,{E:function(){return je},Z:function(){return Ge}});var _=e(48305),a=e.n(_),s=e(17069),c=e(25298),l=e(82092),d=e(87363),D=e.n(d),m=e(91505),u=e(54231),E=e(81376),v=e(61943),R=e(90541),j=e(66508),Z=e(37348),B=e(31964),z=e(54337),O=e(63121),b=e(67703),U=e(58523),p=e(39765),f=e(89202),n=e(62086);function g(H){return(0,n.jsxs)("div",{style:{margin:0,height:"95vh",overflowY:"scroll"},children:[(0,n.jsx)(f.Z,{isStatic:H.isStatic,editNode:H.editNode,jsTipMap:H.jsTipMap,onSubmit:H.onSubmit}),H!=null&&H.isCollapsed?"":(0,n.jsx)(p.ZP,{type:"text",style:{position:"absolute",top:10,right:15,fontSize:20,textAlign:"center"},onClick:function(){H==null||H.onClear()},children:"x"})]})}var S=g,M=e(66839),re=e(26068),le=e.n(re),T=e(15451),h=function(t,r){var I,N,V,te,X,F=r.getData(),ce=r.getPosition(),me=t.getNodes();if(console.log("dealGraphNodeWhenAddedFromPanel called for node type:",F==null||(I=F.config)===null||I===void 0?void 0:I.type,"Node ID:",r.id,"Current nodes count:",me.length),r.getData().__processed){console.log("Node already processed, skipping:",r.id);return}r.setData(le()(le()({},F),{},{__processed:!0}));var k;if(["ExtSharp","polygon"].indexOf(r.shape)>-1&&F!=null&&F.config&&F.config.type)switch(F.config.type){case"switch":var de=200,ie=t.addNode({shape:"switch",position:ce,width:de,height:40,ports:T.Tt,data:r.data,attrs:{body:{stroke:"#8f8f8f",strokeWidth:1,fill:"#fff",rx:6,ry:6}}});t.removeNode(r);var fe=t.addNode({shape:"switch-case",position:{y:ce.y+100,x:ce.x-de/2},width:120,height:40,ports:T.Tt,data:{config:{type:"switch-case"}}}),Ce=t.addNode({shape:"switch-default",position:{y:ce.y+100,x:ce.x+de},width:120,height:40,ports:T.Tt,data:{config:{type:"switch-default"}}}),Te=t.addEdge({source:ie,sourcePort:(N=ie.ports.items.find(function(A){return A.group=="bottom"}))===null||N===void 0?void 0:N.id,target:fe,targetPort:(V=fe.ports.items.find(function(A){return A.group=="top"}))===null||V===void 0?void 0:V.id,zIndex:0}),Oe=t.addEdge({source:ie,sourcePort:(te=ie.ports.items.find(function(A){return A.group=="bottom"}))===null||te===void 0?void 0:te.id,target:Ce,targetPort:(X=Ce.ports.items.find(function(A){return A.group=="top"}))===null||X===void 0?void 0:X.id,zIndex:0});k=ie;break;case"switch-case":var xe=t.createNode({shape:"switch-case",position:r.position(),width:120,height:40,ports:T.Tt,data:r.data});t.removeNode(r),t.addNode(xe),k=xe;break;case"switch-default":var Se=t.createNode({shape:"switch-default",position:r.position(),width:120,height:40,ports:T.Tt,data:r.data});t.removeNode(r),t.addNode(Se),k=Se;break;case"switch-cases":var ye=t.createNode({shape:"switch-cases",position:r.position(),width:120,height:50,ports:T.Tt,data:r.data});t.removeNode(r),t.addNode(ye),k=ye;break;case"string":var se=t.createNode({shape:"string",position:r.position(),width:100,height:50,ports:T.Tt,data:r.data});t.removeNode(r),t.addNode(se),k=se;break;case"num":var Ne=t.createNode({shape:"num",position:r.position(),width:100,height:50,ports:T.Tt,data:r.data});t.removeNode(r),t.addNode(Ne),k=Ne;break;case"assign-global":var L=t.createNode({shape:"assign-global",position:r.position(),width:150,height:40,ports:T.Tt,data:r.data});t.removeNode(r),t.addNode(L),k=L;break;case"assign-local":var $=t.createNode({shape:"assign-local",position:r.position(),width:150,height:40,ports:T.Tt,data:r.data});t.removeNode(r),t.addNode($),k=$;break;default:break}if(["\u5DE5\u5E8F\u7EC4"].indexOf(r.getAttrByPath("text/text"))>-1&&(r.zIndex=-1),console.log("node:added"),k&&me.length==1){var ne,P;t.addEdge({source:me[0],sourcePort:(ne=me[0].ports.items.find(function(A){return A.group=="bottom"}))===null||ne===void 0?void 0:ne.id,target:k,targetPort:(P=k)===null||P===void 0||(P=P.ports)===null||P===void 0||(P=P.items)===null||P===void 0||(P=P.find(function(A){return A.group=="top"}))===null||P===void 0?void 0:P.id,zIndex:0})}},G=e(54397),J=e(65494),ae=e(60963),he=e(57946),ue=e(82494),be=e(42553),De=e(90504),Ie=e(74096),Be=e(18695),ve=e(98601),Ue=e(17660),Ae=e(4071),ge=e(16820),We=e(6771),Ke=e(91116),Fe=e(95817),Ze=function(t){var r=t.data,I=r.backgroundColor,N=r.imgSrc,V=r.config,te=_objectSpread({},V),X=te.name,F=te.type;return _jsx("div",{style:{width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"white",border:"2px solid",display:"flex",alignItems:"center",justifyContent:"center"},children:X})},Me=function(t){var r=t.node.data,I=r.backgroundColor,N=r.imgSrc,V=r.config,te=le()({},V),X=te.name,F=te.type;return console.log(te),(0,n.jsxs)("div",{style:{width:"100px",height:"50px",border:"1px solid #8f8f8f",borderRadius:"5px",backgroundColor:I||"white",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",padding:"8px",gap:"8px"},children:[(0,n.jsx)("img",{src:N||"/logic/icons/".concat(F,".svg"),style:{width:"25px",height:"25px",flexShrink:0}}),(0,n.jsx)("div",{style:{flex:1,fontSize:"12px",wordWrap:"break-word",textAlign:"left",overflow:"hidden"},children:X})]})},ke=function(t){var r=t.node,I=r.data.config.type,N=r.shape;switch(console.log("props",t),N){case ve.j.wait:return(0,n.jsx)(Ue.U,{node:t.node});case ve.j.waitForContinue:return(0,n.jsx)(Ae.g,{node:t.node});case ve.j.subLogic:return(0,n.jsx)(ge.a,{node:t.node});case"ExtShape1":return(0,n.jsx)(We.m,{node:t.node});case"ExtShape2":return(0,n.jsx)(Ke.j,{node:t.node});case"ExtShape3":return(0,n.jsx)(Fe.b,{node:t.node});default:return(0,n.jsx)(Me,{node:t.node})}},Re=ae.Z.Panel,y=he.Z.Search,C=function(t){var r,I=t.node,N=t.graph,V=t.dnd,te=t.onNodeAdd,X=(0,d.useRef)(null),F=String(((r=I.getNodeConfig().attrs)===null||r===void 0||(r=r.text)===null||r===void 0?void 0:r.text)||I.getNodeConfig().data.config.name),ce=I.getNodeConfig();(0,d.useEffect)(function(){if(X.current&&N&&V){var k=N.createNode(I.getNodeConfig()),de=function(fe){fe.preventDefault(),fe.stopPropagation(),V.start(k,fe)};return X.current.addEventListener("mousedown",de),function(){X.current&&X.current.removeEventListener("mousedown",de);try{N.getNodes().includes(k)&&N.removeNode(k)}catch(ie){}}}},[I,N,V,te]);var me=function(){return(0,n.jsx)("div",{style:{width:"100px",height:"50px",transformOrigin:"center",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,n.jsx)(d.Suspense,{fallback:(0,n.jsx)(ue.Z,{size:"small"}),children:(0,n.jsx)(ke,{node:ce})})})};return(0,n.jsx)(be.Z,{title:F,placement:"top",children:(0,n.jsx)("div",{ref:X,className:"custom-node-item",draggable:!0,children:me()})})},W=function(t){var r=t.graph,I=t.nodes,N=t.groups,V=t.onNodeAdd,te=(0,d.useState)(""),X=a()(te,2),F=X[0],ce=X[1],me=(0,d.useState)(["ctrl","assign"]),k=a()(me,2),de=k[0],ie=k[1],fe=(0,d.useState)(),Ce=a()(fe,2),Te=Ce[0],Oe=Ce[1];(0,d.useEffect)(function(){if(r){var L=new J.q({target:r,scaled:!1,validateNode:function(ne){var P;return console.log("DND validateNode called for node type:",(P=ne.getData())===null||P===void 0||(P=P.config)===null||P===void 0?void 0:P.type),setTimeout(function(){var A;console.log("Processing DND drop for node:",(A=ne.getData())===null||A===void 0||(A=A.config)===null||A===void 0?void 0:A.type),h(r,ne),V==null||V(ne)},0),!0}});return Oe(L),function(){L.dispose()}}},[r,V]);var xe=(0,d.useMemo)(function(){var L={};return N.forEach(function($){L[$.name]=I.filter(function(ne){var P;return(P=ne.getGroups())===null||P===void 0?void 0:P.includes($.name)})}),L},[I,N]),Se=(0,d.useMemo)(function(){if(!F.trim())return xe;var L={};return Object.keys(xe).forEach(function($){var ne=xe[$].filter(function(P){var A,Ee,_e=P.getNodeConfig(),ze=String(((A=P.getNodeConfig().attrs)===null||A===void 0||(A=A.text)===null||A===void 0?void 0:A.text)||""),we=F.toLowerCase();return String(ze).toLowerCase().includes(we)||(((Ee=_e.data)===null||Ee===void 0||(Ee=Ee.config)===null||Ee===void 0?void 0:Ee.name)||"").toLowerCase().includes(we)});ne.length>0&&(L[$]=ne)}),L},[xe,F]);(0,d.useEffect)(function(){N.length>0&&de.length===0&&ie([])},[N]);var ye=de.length===N.length,se=function(){ie(ye?[]:N.map(function($){return $.name}))};if(!r||!Te)return(0,n.jsx)("div",{children:"Loading..."});var Ne=Object.keys(Se).some(function(L){return Se[L].length>0});return(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:"custom-node-panel",children:[(0,n.jsx)("div",{className:"panel-header",children:(0,n.jsxs)("div",{className:"header-row",children:[(0,n.jsx)(y,{placeholder:"\u641C\u7D22\u8282\u70B9",allowClear:!0,value:F,onChange:function($){return ce($.target.value)},className:"search-input"}),(0,n.jsx)(be.Z,{title:ye?"\u6536\u8D77\u5168\u90E8":"\u5C55\u5F00\u5168\u90E8",children:(0,n.jsx)(p.ZP,{type:"text",icon:ye?(0,n.jsx)(Ie.Z,{}):(0,n.jsx)(Be.Z,{}),onClick:se})})]})}),(0,n.jsx)("div",{className:"panel-content",children:Ne?(0,n.jsx)(ae.Z,{activeKey:de,onChange:function($){return ie($)},ghost:!0,size:"small",children:N.map(function(L){var $=Se[L.name]||[];return $.length===0?null:(0,n.jsx)(Re,{header:(0,n.jsx)("span",{children:L.title||L.name}),className:"group-panel",children:(0,n.jsx)("div",{className:"nodes-grid",children:$.map(function(ne,P){return(0,n.jsx)(C,{node:ne,graph:r,dnd:Te,onNodeAdd:V},"".concat(L.name,"-").concat(P))})})},L.name)})}):(0,n.jsx)(De.Z,{description:"\u672A\u627E\u5230\u8282\u70B9",image:De.Z.PRESENTED_IMAGE_SIMPLE,style:{marginTop:40}})})]})})},ee=W,Q=null,je=D().createContext({jsTips:{}}),K=function(t,r){for(var I=0,N=t.length;I<N;I+=1)t[I].style.visibility=r?"visible":"hidden"},$e=function(t){var r,I=(0,d.useState)(),N=a()(I,2),V=N[0],te=N[1],X=(0,d.useState)(!t.showLeft),F=a()(X,2),ce=F[0],me=F[1],k=(0,d.useState)(!t.showRight),de=a()(k,2),ie=de[0],fe=de[1],Ce=(0,d.useState)(t.panelData),Te=a()(Ce,2),Oe=Te[0],xe=Te[1],Se=(0,d.useState)(),ye=a()(Se,2),se=ye[0],Ne=ye[1],L=(0,d.useState)(),$=a()(L,2),ne=$[0],P=$[1],A=(0,d.useState)(t.graphIns),Ee=a()(A,2),_e=Ee[0],ze=Ee[1];(0,d.useEffect)(function(){try{var oe;if((oe=t.panelData)!==null&&oe!==void 0&&oe.Shapes){var o;(o=t.panelData)===null||o===void 0||o.Shapes.forEach(function(i){console.log("\u56FE\u5185\u90E8\u6CE8\u518C\u65B0\u8282\u70B9:"+i.name),m.kJ.registerNode(i.name,i.config,!0)})}}catch(i){console.error("\u6CE8\u518C\u8282\u70B9\u51FA\u9519\uFF1A"),console.error(i)}},[(r=t.panelData)===null||r===void 0?void 0:r.Shapes]),(0,d.useEffect)(function(){_e&&(_e.options.connecting.createEdge=t.createEdge)},[t.createEdge]),(0,d.useEffect)(function(){se&&we(se)},[se]),(0,d.useEffect)(function(){if(_e&&t.graphJson)try{_e.fromJSON(t.graphJson),_e.centerContent()}catch(oe){O.ZP.error("\u56FE\u6570\u636E\u6709\u8BEF\uFF0C\u5DF2\u5FFD\u7565"),console.error(oe),console.log(t.graphJson)}},[t.graphJson]),(0,d.useEffect)(function(){me(!(t!=null&&t.showLeft))},[t.showLeft]);function we(oe){if(console.log("initGraph"),!!oe){var o=t.graphIns;return o||(o=new m.kJ({container:oe,embedding:{enabled:!0,findParent:function(w){var q=w.node,pe=q.getBBox();return this.getNodes().filter(function(Pe){var Le=Pe.getData();if(Le&&Le.parent){var Ve=Pe.getBBox();return pe.isIntersectWithRect(Ve)}return!1})}},mousewheel:{enabled:!0,modifiers:"ctrl",minScale:.5,maxScale:3},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:15}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,allowMulti:!0,snap:{radius:20},createEdge:t.createEdge,validateConnection:function(w){var q=w.targetMagnet;return!!q}},background:{color:"#fff"},grid:!0})),o.use(new j.H({enabled:!0,sharp:!0})).use(new E.A({enabled:!0})).use(new R.Y({enabled:!0,multiple:!0,strict:!0,rubberband:!0,movable:!0,showNodeSelectionBox:!0,pointerEvents:"none"})).use(new Z.T({enabled:!0})).use(new v.N).use(new u.T({enabled:!0})).use(new B.D).use(new G.w({resizing:{enabled:!0,minWidth:50,maxWidth:0,minHeight:50,maxHeight:0,orthogonal:!1,restrict:!1,preserveAspectRatio:!1}})).use(new z.a({container:ne})),o.on("edge:dblclick",function(i){var w=i.cell}),o.on("edge:change:router",function(i){console.log("edge:change:router")}),o.on("edge:mouseenter",function(i){var w=i.cell;t.edgeTools&&t.edgeTools.forEach(function(q){switch(q){case"edge-editor":break;case"button-remove":w.addTools([{name:"button-remove",args:{distance:-10}}]);break;case"segments":w.addTools(["segments"]);break;case"vertices":w.addTools(["vertices"]);break;default:break}})}),o.on("edge:mouseleave",function(i){var w=i.cell;w.removeTools()}),o.on("node:mouseenter",function(i){var w,q=i.cell;((w=q.data)===null||w===void 0||(w=w.config)===null||w===void 0?void 0:w.type)!="start"&&(q.addTools([{name:"button-remove",args:{x:"100%",y:0,offset:{x:-10,y:10}}}]),q.setData({selected:!0}));var pe=se==null?void 0:se.querySelectorAll(".x6-port-body");K(pe,!0)}),o.on("node:mouseleave",function(i){var w=i.cell;w.setData({selected:!1}),w.removeTools();var q=se==null?void 0:se.querySelectorAll(".x6-port-body");K(q,!1)}),o.on("node:click",function(i){var w=i.e,q=i.x,pe=i.y,Pe=i.node,Le=i.view;Pe.removeTools(),te(Pe)}),o.on("node:added",function(i){var w=i.node,q=i.index,pe=i.options;h(o,w)}),o.on("node:dblclick",function(i){var w=i.e,q=i.x,pe=i.y,Pe=i.node,Le=i.view;fe(!1),te(Pe)}),o.bindKey(["meta+c","ctrl+c"],function(){var i=o.getSelectedCells();return i.length&&o.copy(i,{useLocalStorage:!0}),!1}),o.bindKey(["meta+v","ctrl+v"],function(){debugger;if(!o.isClipboardEmpty({useLocalStorage:!0})){var i=o.paste({offset:32,useLocalStorage:!0});o.cleanSelection(),o.select(i)}return!1}),o.bindKey(["meta+x","ctrl+x"],function(){var i=o.getSelectedCells();return i.length&&o.cut(i),!1}),o.bindKey(["meta+z","ctrl+z"],function(){return o.canUndo()&&o.undo(),!1}),o.bindKey(["meta+shift+z","ctrl+shift+z"],function(){return o.canRedo()&&o.redo(),!1}),o.bindKey("backspace",function(){var i=o.getSelectedCells();o.removeCells(i)}),o.bindKey("delete",function(){var i=o.getSelectedCells();o.removeCells(i)}),o.on("blank:click",function(i){var w=i.e,q=i.x,pe=i.y;console.log("blank:click",q,pe),fe(!0)}),o.on("blank:dblclick",function(i){var w=i.e,q=i.x,pe=i.y;console.log("blank:dbclick",q,pe),t.autoLayout&&t.autoLayout(o)}),o.bindKey(["ctrl+1","meta+1"],function(){var i=o.zoom();i<1.5&&o.zoom(.1)}),o.bindKey(["ctrl+2","meta+2"],function(){var i=o.zoom();i>.5&&o.zoom(-.1)}),ze(o),t.graphJson&&Object.keys(t.graphJson).length>0?o.fromJSON(t.graphJson):t.onGraphJsonEmpty&&t.onGraphJsonEmpty(o),t.onGraphInsChange&&t.onGraphInsChange(o),o.centerContent(),o}}(0,d.useEffect)(function(){xe(t.panelData)},[t.panelData]);function Je(){t.onSave&&_e&&t.onSave(_e)}var He=(0,d.useMemo)(function(){if(t.toolElements){var oe;return(0,n.jsx)(b.Z.Header,{style:{padding:0,backgroundColor:"white"},children:(0,n.jsx)(U.Z,{style:{height:"50px"},children:(oe=t.toolElements)===null||oe===void 0?void 0:oe.map(function(o){return o})})})}else return(0,n.jsx)("span",{})},[t.toolElements]);return(0,n.jsx)(je.Provider,{value:t.editorCtx||{jsTips:{}},children:(0,n.jsxs)(b.Z,{style:{height:"100vh",width:"100%",margin:0},children:[He,(0,n.jsxs)(b.Z,{style:{height:"100vh"},children:[(0,n.jsx)(b.Z.Sider,{theme:"light",collapsed:ce,collapsedWidth:0,width:250,children:!ce&&Oe&&(0,n.jsx)(ee,{graph:_e,nodes:Oe.Nodes||[],groups:Oe.Groups||[],onNodeAdd:function(o){console.log("Node added:",o)}})}),(0,n.jsxs)(b.Z.Content,{className:"app-content",children:[(0,n.jsx)(M.Z,{ref:function(o){return Ne(o)}}),(0,n.jsx)("div",{className:"app-minimap",ref:function(o){return o&&P(o)}})]}),(0,n.jsx)(b.Z.Sider,{style:{background:"transparent"},collapsed:ie,collapsedWidth:0,width:600,children:(0,n.jsx)(S,{isStatic:t.isStatic,editNode:V,onSubmit:Je,jsTipMap:t.jsTipMap,onClear:function(){fe(!0)},isCollapsed:ie})})]})]})})},Ge=$e},66839:function(Y,x,e){e.d(x,{Z:function(){return c}});var _=e(87363),a=e(62086),s=(0,_.forwardRef)(function(l,d){return(0,a.jsx)("div",{className:"drag-graph",ref:d})}),c=s},89202:function(Y,x,e){var _=e(26068),a=e.n(_),s=e(48305),c=e.n(s),l=e(85343),d=e(87363),D=e.n(d),m=e(62086);x.Z=function(u){var E,v=(0,d.useState)(""),R=c()(v,2),j=R[0],Z=R[1],B=(0,d.useState)({}),z=c()(B,2),O=z[0],b=z[1],U=function(f){var n,g,S;if(u.isStatic){console.warn("\u9759\u6001\u5C55\u793A\u6A21\u5F0F\uFF0C\u63D0\u4EA4\u672A\u751F\u6548");return}(n=u.editNode)===null||n===void 0||n.setAttrByPath("text/text",f.name);var M=(g=u.editNode)===null||g===void 0?void 0:g.data.config;f.type=="switch-cases"&&f.caseItems&&(f.cases=f.caseItems.map(function(re){return re.value})),u.editNode&&(console.log("update graph data",f),u.editNode.setData(a()(a()({},u.editNode.data),{},{config:a()(a()({},M),f)}),{overwrite:!0})),console.log("submit---props.editNode.data.config"),console.log((S=u.editNode)===null||S===void 0?void 0:S.data.config),u==null||u.onSubmit()};return(0,d.useEffect)(function(){if(u.editNode&&u.editNode.data){var p=u.editNode.data.config||{};Z(u.editNode.data.configSchema||p.type)}},[u.editNode]),(0,d.useEffect)(function(){var p;if((p=u.editNode)!==null&&p!==void 0&&p.data){var f,n,g=((f=u.editNode)===null||f===void 0?void 0:f.data.config)||{},S=a()({},g),M=(n=u.editNode)===null||n===void 0?void 0:n.attrs;M&&M.text&&M.text.text&&(S.name=M.text.text),b(S)}},[(E=u.editNode)===null||E===void 0?void 0:E.data]),(0,m.jsx)(l.Z,{isStatic:u.isStatic,formId:j,values:a()({},O),onSubmit:U,jsTipMap:u.jsTipMap})}},15451:function(Y,x,e){e.d(x,{Tt:function(){return _}});var _={groups:{top:{position:"top",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}},zIndex:1},bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}},left:{position:"left",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}}}},items:[{group:"top"},{group:"right"},{group:"bottom"},{group:"left"}]},a={groups:{right:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}},zIndex:1}},items:[{group:"right"}]},s={groups:{bottom:{position:"bottom",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:1,fill:"#fff",style:{visibility:"hidden"}}},zIndex:1}},items:[{group:"bottom"}]}},98601:function(Y,x,e){e.d(x,{L:function(){return _},j:function(){return a}});var _=function(s){return s.TypeAnnotation="TypeAnnotation",s.Structure="Structure",s.StructureProperty="StructureProperty",s.TypeParam="TypeParam",s.Variable="Variable",s.Logic="Logic",s.LogicItem="LogicItem",s}({}),a=function(s){return s.start="start",s.end="end",s.switch="switch",s.switchCase="switch-case",s.switchDef="switch-def",s.http="http",s.subLogic="sub-logic",s.js="js",s.wait="wait",s.waitForContinue="wait-for-continue",s}({})},85343:function(Y,x,e){e.d(x,{Z:function(){return le}});var _=e(26068),a=e.n(_),s=e(48305),c=e.n(s),l=e(87363),d=e.n(l),D=e(99294),m=e(950),u=e(874),E=e.n(u),v=e(66345),R=e(94391),j=e(31759),Z=e.n(j),B=function T(h){if(h=h==null)return h;var G="{";return Object.keys(h).forEach(function(J){var ae=h[J];G+="".concat(J,":"),Array.isArray(ae)?G+="[],":Z()(ae)=="object"?G+=T(ae)+",":typeof ae=="string"?G+="'".concat(ae,"',"):G+="".concat(ae,",")}),G+="}",G},z=function(h,G){var J="";G&&(Object.keys(G).forEach(function(he){var ue=G[he];J+="".concat(he,":"),Array.isArray(ue)?J+="[],":Z()(ue)=="object"?J+=B(ue)+",":typeof ue=="string"?J+="'".concat(ue,"',"):J+="".concat(ue,",")}),J=J.substring(0,J.length-1));var ae="const ".concat(h,"={").concat(J,"}");return ae},O=e(42327),b=e(3044),U=e(21644),p=e(30697),f=e(7899),n=e(12146),g=e(62086),S=function(h){var G=(0,l.useContext)(f.E),J=(0,l.useState)(h==null?void 0:h.config),ae=c()(J,2),he=ae[0],ue=ae[1],be=(0,l.useState)(h==null?void 0:h.values),De=c()(be,2),Ie=De[0],Be=De[1],ve=G==null?void 0:G.jsTips,Ue=(0,l.useState)(),Ae=c()(Ue,2),ge=Ae[0],We=Ae[1];function Ke(y,C,W){y==="formSubmited"?(console.log("\u5185\u90E8\u8868\u5355\u63D0\u4EA4\u4E86",W),h.onSubmit(W)):console.log("\u5185\u90E8\u8868\u5355\u89E6\u53D1\u4E86Broadcast",W)}(0,l.useEffect)(function(){(0,n.m)(m.Z)},[]),(0,l.useEffect)(function(){if(h.config&&h.config.body){var y,C=h.config.body[0];(y=C.body)===null||y===void 0||y.forEach(function(ee){Re(ee)});var W=ge==null?void 0:ge.getComponentByName("page1.form1");W==null||W.props.store.clear(),ue(h.config)}},[h.config]),(0,l.useEffect)(function(){var y=ge==null?void 0:ge.getComponentByName("page1.form1");y==null||y.props.store.clear(),y==null||y.props.store.setValues(h.values)},[he]),(0,l.useEffect)(function(){var y=ge==null?void 0:ge.getComponentByName("page1.form1");y==null||y.props.store.clear(),y==null||y.props.store.setValues(h.values),Be(h.values)},[h.values]);var Fe=(0,l.useState)(),Ze=c()(Fe,2),Me=Ze[0],ke=Ze[1];function Re(y){y.type=="editor"&&y.language=="javascript"?y.editorDidMount=function(C,W){return ke(W),ve&&Object.keys(ve).forEach(function(ee){var Q=z(ee,JSON.parse(ve[ee]));W==null||W.languages.typescript.javascriptDefaults.addExtraLib(Q,"".concat(ee,".ts"))}),function(){try{var ee,Q;console.log("effect dispose"),C==null||C.dispose(),C==null||(ee=C.current)===null||ee===void 0||ee.dispose(),W==null||(Q=W.current)===null||Q===void 0||Q.dispose()}catch(je){console.error("error in findEditorItem"),console.error(je)}}}:y.body&&y.body.forEach(function(C){Re(C)})}return(0,l.useEffect)(function(){ve&&Object.keys(ve).forEach(function(y){var C=z(y,JSON.parse(ve[y]));Me==null||Me.languages.typescript.javascriptDefaults.addExtraLib(C,"".concat(y,".ts"))})},[ve]),(0,g.jsxs)("div",{children:[(0,g.jsx)(R.qRY,{theme:"cxd",position:"top-right",locale:"zh-CN"},"toast"),(0,g.jsx)(R.wxo,{theme:"cxd",locale:"zh-CN"},"alert"),(0,v.sYA)(he,{onBroadcast:Ke,data:Ie,scopeRef:function(C){return We(C)}},{fetcher:function(C){var W=C.url,ee=C.method,Q=C.data,je=C.responseType,K=C.config,$e=C.headers;return K=K||{},K.withCredentials=!0,je&&(K.responseType=je),K.cancelExecutor&&(K.cancelToken=new m.Z.CancelToken(K.cancelExecutor)),K.headers=$e||{},K.headers.Authorization||(K.headers.Authorization="Bearer "+p.F.getTokenFormLocal()),ee!=="post"&&ee!=="put"&&ee!=="patch"?(Q&&(K.params=Q),m.Z[ee](W,K)):(Q&&Q instanceof FormData?(K.headers=K.headers||{},K.headers["Content-Type"]="multipart/form-data"):Q&&typeof Q!="string"&&!(Q instanceof Blob)&&!(Q instanceof ArrayBuffer)&&(Q=JSON.stringify(Q),K.headers=K.headers||{},K.headers["Content-Type"]="application/json"),m.Z[ee](W,Q,K))},isCancel:function(C){return m.Z.isCancel(C)},copy:function(C){E()(C),R.Amu.success("\u5185\u5BB9\u5DF2\u590D\u5236\u5230\u7C98\u8D34\u677F")},theme:"cxd",jumpTo:function(C,W){debugger;W.blank==!0?window.open(window.location.origin+window.location.pathname+"#"+C,"_blank"):window.location.hash=C}})]})},M=d().memo(S),re=function(h){var G=(0,l.useState)({type:"page"}),J=c()(G,2),ae=J[0],he=J[1];return(0,l.useEffect)(function(){if(h.formId){var ue=h.formId;(0,D.CD)(ue).then(function(be){h.isStatic,he(be)}).catch(function(be){console.log(be),(0,D.CD)(h.formId).then(function(De){he(De)})})}},[h.formId]),(0,g.jsx)("div",{children:(0,g.jsx)(M,a()(a()({},h),{},{config:ae}))})},le=re},12146:function(Y,x,e){e.d(x,{m:function(){return l}});var _=e(90228),a=e.n(_),s=e(87999),c=e.n(s);function l(D){return d.apply(this,arguments)}function d(){return d=c()(a()().mark(function D(m){return a()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:m.interceptors.response.use(function(v){return console.log("axios response"),console.log(v),v&&v.data?(console.log("--\u8BF7\u6C42\u672A\u62A5\u9519\uFF0C\u9002\u914Dstatus=0"),v.data.error||(v.data.error={code:0}),v.data.code==500&&(v.data.error={code:500,message:v.data.msg}),v.data.data&&v.data.data.records&&(v.data.data.items=v.data.data.records),v):(console.log("--\u8FD4\u56DE\u6570\u636E\u4E3A\u7A7A\uFF0C\u5224\u65AD\u4E3A\u5F02\u5E38"),console.log(v.data),Promise.reject(new Error(v.data.message)))},function(v){if(console.log("\u6355\u6349axios error"),console.log(v),v.response&&v.response.data){var R,j=v.response;return console.log("--data\u6709\u8FD4\u56DE\u503C\uFF0C\u5224\u5B9A\u4E3A\u4E1A\u52A1\u5F02\u5E38\uFF0C\u7EE7\u7EED\u8FD4\u56DEresponse,\u9002\u914Dstatus=500\uFF01"),((R=v.response.data.error)===null||R===void 0?void 0:R.code)==0&&(v.response.data.error.code=500),console.log(j),j}return Promise.reject(v)});case 1:case"end":return E.stop()}},D)})),d.apply(this,arguments)}},30697:function(Y,x,e){e.d(x,{F:function(){return _}});var _={getTokenFormLocal:function(){return localStorage.getItem("token")},setTokenToLocal:function(s){return localStorage.setItem("token",s)}}},76996:function(Y,x,e){var _=e(35979),a=e(87363),s=e.n(a),c=e(62086),l=function(D){var m=D.text,u=D.children;return(0,c.jsx)("div",{style:{},children:m?(0,c.jsx)(_.Z.Ribbon,{text:m,children:u}):u})};x.Z=l},48834:function(Y,x,e){e.d(x,{r:function(){return d}});var _=e(91141),a=e(57946),s=e(68096),c=e(76996),l=e(62086),d=function(m){var u,E,v,R,j=m.node,Z=(u=j.data.config)===null||u===void 0?void 0:u.name,B=(E=j.data.config)===null||E===void 0?void 0:E.type,z=(v=j.data.config)===null||v===void 0?void 0:v.memo,O=(R=j.data.config)===null||R===void 0?void 0:R.tranGroupId,b=j.data.imgSrc,U=j.data.text,p=j.data.backgroundColor;return(0,l.jsx)(_.Z,{content:z?(0,l.jsx)(a.Z.TextArea,{style:{width:300,height:200},readOnly:!0,value:z}):"",trigger:"click",mouseLeaveDelay:0,children:(0,l.jsxs)("div",{className:s.Z.customNode,style:{width:"100%",height:"100%",border:"1px solid #8f8f8f",borderRadius:"5px",position:"relative",overflow:"hidden",backgroundColor:p||"white"},children:[(0,l.jsx)("img",{src:b||"/logic/icons/".concat(B,".svg"),style:{width:16,height:16,position:"absolute",top:0,left:5,margin:0}}),(0,l.jsx)(c.Z,{text:O,children:(0,l.jsx)("div",{style:{marginTop:12,whiteSpace:"pre-wrap",padding:0,fontSize:"12px",wordWrap:"break-word",textAlign:"left",lineHeight:"1.2"},children:Z||U})})]})})}},6771:function(Y,x,e){e.d(x,{m:function(){return l}});var _=e(87363),a=e.n(_),s=e(48834),c=e(62086),l=function(D){var m=D.node;return m.data.backgroundColor="#ffcc00",(0,_.useEffect)(function(){},[]),(0,c.jsx)(s.r,{node:m})}},91116:function(Y,x,e){e.d(x,{j:function(){return l}});var _=e(87363),a=e.n(_),s=e(48834),c=e(62086),l=function(D){var m=D.node;return m.data.backgroundColor="#87CEEB",(0,_.useEffect)(function(){},[]),(0,c.jsx)(s.r,{node:m})}},95817:function(Y,x,e){e.d(x,{b:function(){return l}});var _=e(87363),a=e.n(_),s=e(48834),c=e(62086),l=function(D){var m=D.node;return m.data.backgroundColor="#FFF8DC",(0,_.useEffect)(function(){},[]),(0,c.jsx)(s.r,{node:m})}},16820:function(Y,x,e){e.d(x,{a:function(){return d}});var _=e(91141),a=e(57946),s={subprocess:"subprocess___rgQx3",subprocessSide:"subprocessSide___GBqcU",left:"left___xf_PM",right:"right___UskL0",subprocessText:"subprocessText___RwlaI",async:"async___oFSgI"},c=e(76996),l=e(62086),d=function(m){var u,E,v,R,j,Z=m.node,B=(u=Z.data.config)===null||u===void 0?void 0:u.name,z=(E=Z.data.config)===null||E===void 0?void 0:E.async,O=(v=Z.data.config)===null||v===void 0?void 0:v.type,b=(R=Z.data.config)===null||R===void 0?void 0:R.memo,U=(j=Z.data.config)===null||j===void 0?void 0:j.tranGroupId,p="";return(0,l.jsx)(_.Z,{content:b?(0,l.jsx)(a.Z.TextArea,{style:{width:300,height:200},readOnly:!0,value:b}):"",trigger:"click",mouseLeaveDelay:0,children:(0,l.jsx)(c.Z,{text:U,children:(0,l.jsx)("div",{style:{width:"100%",minHeight:"50px",minWidth:"90px"},children:(0,l.jsxs)("div",{className:s.subprocess,children:[(0,l.jsxs)("div",{className:s.subprocessText,children:[B||p,z?(0,l.jsx)("div",{className:s.async,children:"\u5F02\u6B65\u6267\u884C"}):""]}),(0,l.jsx)("div",{className:s.left}),(0,l.jsx)("div",{className:s.right})]})})})})}},4071:function(Y,x,e){e.d(x,{g:function(){return c}});var _=e(91141),a=e(57946),s=e(62086),c=function(d){var D,m,u=d.node,E=(D=u.data.config)===null||D===void 0?void 0:D.memo;return(0,s.jsx)(_.Z,{content:E?(0,s.jsx)(a.Z.TextArea,{style:{width:300,height:200},readOnly:!0,value:E}):"",trigger:"click",mouseLeaveDelay:0,children:(0,s.jsx)("div",{style:{fontSize:"12px",width:"50px",height:"50px",borderRadius:"50%",backgroundColor:"white",border:"2px solid",display:"flex",alignItems:"center",justifyContent:"center"},children:((m=u.data)===null||m===void 0?void 0:m.config.name)||"\u4EA4\u4E92\u70B9"})})}},17660:function(Y,x,e){e.d(x,{U:function(){return l}});var _=e(91141),a=e(57946),s=e(68096),c=e(62086),l=function(D){var m,u,E=D.node,v=(m=E.data.config)===null||m===void 0?void 0:m.name,R=(u=E.data.config)===null||u===void 0?void 0:u.memo,j="",Z="",B="";return(0,c.jsxs)(_.Z,{content:R?(0,c.jsx)(a.Z.TextArea,{style:{width:300,height:200},readOnly:!0,value:R}):"",trigger:"click",mouseLeaveDelay:0,children:[(0,c.jsx)("div",{className:s.Z.customNode,style:{width:"100%",height:"100%",border:"1px solid #8f8f8f",borderRadius:"5px",backgroundColor:B!=null&&B.includes("#")?B:"",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:(0,c.jsx)("img",{src:j||"/logic/icons/delay.svg",style:{width:"30px",height:"30px",margin:0}})}),(0,c.jsx)("div",{style:{fontSize:"12px",marginTop:"1px",textAlign:"center"},children:Z||""})]})}},99294:function(Y,x,e){e.d(x,{CD:function(){return Z},UD:function(){return R},n4:function(){return z},wx:function(){return b}});var _=e(90228),a=e.n(_),s=e(87999),c=e.n(s),l=e(33627),d=e(25298),D=e.n(d),m=e(17069),u=e.n(m),E=e(72591),v=function(){function p(){D()(this,p)}return u()(p,null,[{key:"getAssetFromDb",value:function(){var f=c()(a()().mark(function g(S,M){var re;return a()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,(0,E.U2)("/api/ide/settings/asset/".concat(S,"/").concat(M));case 2:return re=T.sent.data,T.abrupt("return",JSON.parse(re.data.config));case 4:case"end":return T.stop()}},g)}));function n(g,S){return f.apply(this,arguments)}return n}()},{key:"saveAssetToDb",value:function(){var f=c()(a()().mark(function g(S,M,re){return a()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.abrupt("return",(0,E.v_)("/api/ide/settings/asset/".concat(S,"/").concat(M),re));case 1:case"end":return T.stop()}},g)}));function n(g,S,M){return f.apply(this,arguments)}return n}()},{key:"getRemoteAssetFromDb",value:function(){var f=c()(a()().mark(function g(S,M,re){var le;return a()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,E.U2)("/api/ide/papi/".concat(S,"/api/ide/settings/asset/").concat(M,"/").concat(re));case 2:return le=h.sent.data,h.abrupt("return",JSON.parse(le.data.config));case 4:case"end":return h.stop()}},g)}));function n(g,S,M){return f.apply(this,arguments)}return n}()},{key:"saveRemoteAssetToDb",value:function(){var f=c()(a()().mark(function g(S,M,re,le){return a()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,E.v_)("/api/ide/papi/".concat(S,"/api/ide/settings/asset/").concat(M,"/").concat(re),le));case 1:case"end":return h.stop()}},g)}));function n(g,S,M,re){return f.apply(this,arguments)}return n}()}]),p}();function R(p){return j.apply(this,arguments)}function j(){return j=c()(a()().mark(function p(f){return a()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(l.j.getModel()!="db"){g.next=4;break}return g.abrupt("return",v.getAssetFromDb("page",f));case 4:return g.next=6,(0,E.U2)("/logic/setting/pages/".concat(f,".json"));case 6:return g.abrupt("return",g.sent.data);case 7:case"end":return g.stop()}},p)})),j.apply(this,arguments)}function Z(p){return B.apply(this,arguments)}function B(){return B=c()(a()().mark(function p(f){return a()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(l.j.getModel()!="db"){g.next=4;break}return g.abrupt("return",v.getAssetFromDb("form",f));case 4:return g.next=6,(0,E.U2)("/logic/setting/forms/".concat(f,".json"));case 6:return g.abrupt("return",g.sent.data);case 7:case"end":return g.stop()}},p)})),B.apply(this,arguments)}function z(p,f){return O.apply(this,arguments)}function O(){return O=c()(a()().mark(function p(f,n){return a()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(l.j.getModel()!="db"){S.next=4;break}return S.abrupt("return",v.getAssetFromDb(f,n));case 4:return S.next=6,(0,E.U2)("/logic/setting/".concat(f,"s/").concat(n,".json"));case 6:return S.abrupt("return",S.sent.data);case 7:case"end":return S.stop()}},p)})),O.apply(this,arguments)}function b(p,f,n){return U.apply(this,arguments)}function U(){return U=c()(a()().mark(function p(f,n,g){return a()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(l.j.getModel()!="db"){M.next=2;break}return M.abrupt("return",v.saveAssetToDb(f,n,g));case 2:case"end":return M.stop()}},p)})),U.apply(this,arguments)}},72591:function(Y,x,e){e.d(x,{U2:function(){return m},gz:function(){return E},v_:function(){return Z}});var _=e(90228),a=e.n(_),s=e(26068),c=e.n(s),l=e(87999),d=e.n(l),D=e(950);function m(O,b){return u.apply(this,arguments)}function u(){return u=d()(a()().mark(function O(b,U){return a()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",D.Z.get(b,z(U)));case 1:case"end":return f.stop()}},O)})),u.apply(this,arguments)}function E(O,b,U){return v.apply(this,arguments)}function v(){return v=d()(a()().mark(function O(b,U,p){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",D.Z.put(b,U,z(p)));case 1:case"end":return n.stop()}},O)})),v.apply(this,arguments)}function R(O,b){return j.apply(this,arguments)}function j(){return j=_asyncToGenerator(_regeneratorRuntime().mark(function O(b,U){return _regeneratorRuntime().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",axios.delete(b,z(U)));case 1:case"end":return f.stop()}},O)})),j.apply(this,arguments)}function Z(O,b,U){return B.apply(this,arguments)}function B(){return B=d()(a()().mark(function O(b,U,p){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",D.Z.post(b,U,z(p)));case 1:case"end":return n.stop()}},O)})),B.apply(this,arguments)}function z(O){var b={"Content-Type":"application/json;charset=UTF-8"};return localStorage.getItem("token")&&(b.Authorization="Bearer "+localStorage.getItem("token")),c()(c()({},O),{},{headers:c()(c()({},b),O==null?void 0:O.headers)})}},68096:function(Y,x){x.Z={customNode:"customNode___zxYMy",input:"input___oBweR",switchNode:"switchNode___PXP4B"}}}]);
