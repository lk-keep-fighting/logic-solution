"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[9088],{42651:function(O,N,t){t.d(N,{Z:function(){return x}});var C=t(21140),r=t.n(C),p=t(63466),u=t.n(p),o=t(52510),f=t.n(o),x=function(){function c(s){r()(this,c),f()(this,"_nodeConfig",void 0),f()(this,"_groups",void 0),this._nodeConfig=JSON.parse(JSON.stringify(s)),this._nodeConfig._groups&&(this._groups=this._nodeConfig._groups)}return u()(c,[{key:"getNodeConfig",value:function(){return this._nodeConfig}},{key:"getGroups",value:function(){return this._groups}},{key:"setLabel",value:function(n){this._nodeConfig.attrs&&(this._nodeConfig.attrs.text.text=n)}},{key:"setGroups",value:function(n){this._groups=n}},{key:"setConfigSchemel",value:function(n){this._nodeConfig.data?(this._nodeConfig.data.configSchema=n,this._nodeConfig.data.config={type:n}):this._nodeConfig.data={configSchema:n,config:{type:n}}}},{key:"setConfigData",value:function(n){this._nodeConfig.data?this._nodeConfig.data.config=n:this._nodeConfig.data={config:n}}}]),c}()},3619:function(O,N,t){t.d(N,{V:function(){return r}});var C=t(17600),r=function(o){var f,x=o.getSelectedCells(),c=[],s=[];if(x&&x.length>2){x.forEach(function(e){e.isNode()?c.push(e):s.push(e)}),f=new C.Vq({type:"dagre",begin:[c[0].getPosition().x,c[0].getPosition().y],ranker:"network-simplex",rankdir:"TB",ranksep:20,nodeSize:50,controlPoints:!0}),o.getEdges().forEach(function(e){var d=e.getSourceCellId(),v=0,L=e.getTargetCellId(),w=0;c.find(function(y){return y.id===d})&&v++,c.find(function(y){return y.id===L})&&w++,v>0&&w>0&&s.push(e)});debugger;var n=f.layout({nodes:c,edges:s}),m=n.nodes,b=m===void 0?[]:m;c.forEach(function(e){var d=b.find(function(v){return v.id===e.id});d.x-=e.size().width/2,d.y-=e.size().height/2,e.position(d.x,d.y)})}else{f=new C.Vq({type:"dagre",begin:[400,100],ranker:"network-simplex",rankdir:"TB",ranksep:20,nodeSize:50,align:"DL",controlPoints:!0}),c=o.getNodes(),s=o.getEdges();var P=f.layout({nodes:c,edges:s}),S=P.nodes,D=S===void 0?[]:S;c.forEach(function(e){var d=D.find(function(v){return v.id===e.id});d.x-=e.size().width/2,d.y-=e.size().height/2,e.position(d.x,d.y)})}},p=function(o,f){debugger;var x=new DagreLayout({type:"dagre",begin:[400,100],ranker:"tight-tree",rankdir:"TB",ranksep:20,nodeSize:50,controlPoints:!0}),c=x.layout({nodes:o,edges:f}),s=c.nodes,n=s===void 0?[]:s;o.forEach(function(m){var b=n.find(function(P){return P.id===m.id});b.x-=m.size().width/2,b.y-=m.size().height/2,m.position(b.x,b.y)})}},89147:function(O,N,t){t.d(N,{m:function(){return S}});var C=t(5671),r=t(95812),p=t(53914),u={customNode:"customNode___zxYMy",input:"input___oBweR",switchNode:"switchNode___PXP4B"},o=t(33130),f=function(e){return(0,o.jsx)("div",{className:u.customNode,children:(0,o.jsx)(p.Z,{className:"input",value:e==null?void 0:e.data,width:80})})},x=t(371),c=function(e){return(0,o.jsx)("div",{className:styles.customNode,children:(0,o.jsx)(x.Z,{className:"input",value:e==null?void 0:e.data,width:80})})},s=t(57213),n=t.n(s),m=function(e){var d,v,L,w=e.node,y=(d=w.data.config)===null||d===void 0?void 0:d.name,M=y||"case";return(0,o.jsxs)("div",{className:u.customNode,children:[(0,o.jsx)("span",{children:"case"}),(0,o.jsx)(p.Z,{addonAfter:y,className:"input",value:w==null||(v=w.data)===null||v===void 0||(L=v.config)===null||L===void 0?void 0:L.case,width:150,onChange:function(B){var I=w.data;w.setData(n()(n()({},I),{},{config:n()(n()({},I.config),{},{case:B.target.value})}))}})]})},b=function(e){var d,v=e.node;return(0,o.jsx)("div",{className:u.customNode,children:(0,o.jsx)(p.Z,{addonBefore:"switch",className:"input",value:(d=v.data)===null||d===void 0?void 0:d.config.condition,onChange:function(w){var y=v.data;v.setData(n()(n()({},y),{},{config:n()(n()({},y.config),{},{condition:w.target.value})}))},width:100})})},P=function(e){return(0,o.jsx)("div",{className:u.customNode,children:(0,o.jsx)("div",{style:{textAlign:"center",fontSize:"15px"},children:"default"})})};function S(D){D.forEach(function(e){console.log("\u6CE8\u518C\u65B0\u8282\u70B9:"+e.name),C.kJ.registerNode(e.name,e.config,!0)}),(0,r.z2)({shape:"string",component:f}),(0,r.z2)({shape:"num",component:c}),(0,r.z2)({shape:"switch",component:b}),(0,r.z2)({shape:"switch-case",component:m}),(0,r.z2)({shape:"switch-default",component:P})}},9364:function(O,N,t){t.d(N,{K:function(){return o}});var C=t(57213),r=t.n(C),p=t(12490),u=t(42651);function o(f,x,c){var s=50,n=50,m={body:{}},b=[new u.Z({shape:"circle",width:s,height:n,attrs:{body:r()(r()({},m.body),{},{fill:"white"}),text:{text:"\u5F00\u59CB",fontSize:12}},markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}],ports:p.Tt,data:{config:{type:"start"}},_groups:["ctrl"]}),new u.Z({shape:"circle",width:s,height:n,attrs:{body:r()(r()({},m.body),{},{fill:"white"}),text:{text:"\u4EA4\u4E92\u70B9",fontSize:12}},markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}],ports:p.Tt,data:{config:{type:"wait-for-continue"}},_groups:["ctrl"]}),new u.Z({shape:"ExtSharp",attrs:{text:{text:"http\u8BF7\u6C42"},image:{"xlink:href":"/icons/http.svg",width:20,x:2,y:2}},data:{config:{type:"http",method:"POST"}},ports:p.Tt,_groups:["biz"]}),new u.Z({shape:"ExtSharp",ports:p.Tt,attrs:{image:{width:15,x:2,y:2,"xlink:href":"/icons/code.svg"},text:{text:"js\u811A\u672C"}},data:{config:{type:"js"}},_groups:["biz"]}),new u.Z({shape:"ExtSharp",ports:p.Tt,attrs:{image:{width:15,x:2,y:2,"xlink:href":"/icons/java.svg"},text:{text:"java\u65B9\u6CD5"}},data:{config:{type:"java"}},_groups:["biz"]}),new u.Z({shape:"ExtSharp",ports:p.Tt,attrs:{image:{width:15,x:2,y:2,"xlink:href":"/icons/CarbonSubflowLocal.svg"},text:{text:"\u590D\u7528\u903B\u8F91"}},data:{config:{type:"sub-logic"}},_groups:["biz"]}),new u.Z({shape:"ExtSharp",width:50,height:n,label:"switch",attrs:{image:{"xlink:href":"/icons/switch.svg",width:45,x:1,y:2},text:{text:"switch",refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"switch"}},ports:p.Tt,_groups:["ctrl"]}),new u.Z({shape:"ExtSharp",width:s,height:n,attrs:{image:{"xlink:href":"/icons/text.svg",width:30,x:8,y:10},text:{text:"case",refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"switch-case"}},ports:p.Tt,_groups:["ctrl"]}),new u.Z({shape:"ExtSharp",width:50,height:n,attrs:{image:{"xlink:href":"/icons/text.svg",width:30,x:8,y:10},text:{text:"default",refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"switch-default"}},ports:p.Tt,_groups:["ctrl"]}),new u.Z({shape:"ExtSharp",width:s,height:n,attrs:{image:{"xlink:href":"/icons/delay.svg",width:30,x:8,y:10},text:{text:"\u7B49\u5F85",refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"wait",timeout:"2000"}},ports:p.Tt,_groups:["ctrl"]})];return f&&f.length>0&&Array.prototype.push.apply(b,f),{Nodes:b}}},48364:function(O,N,t){t.d(N,{Uh:function(){return B},az:function(){return S},gC:function(){return v},m9:function(){return e},qB:function(){return n},yi:function(){return w}});var C=t(25359),r=t.n(C),p=t(49811),u=t.n(p),o=t(57475),f=t(5726),x=t.n(f);function c(_){return s.apply(this,arguments)}function s(){return s=_asyncToGenerator(_regeneratorRuntime().mark(function _(l){return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",post("/api/ide/pub/logic/dev-to-test".concat(l)));case 1:case"end":return a.stop()}},_)})),s.apply(this,arguments)}function n(_){return m.apply(this,arguments)}function m(){return m=u()(r()().mark(function _(l){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,o.U2)("/api/ide/logic/".concat(l)).then(function(g){var i,h=(i=g.data)===null||i===void 0?void 0:i.data;return h.configJson=JSON.parse(h.configJson),h}));case 1:case"end":return a.stop()}},_)})),m.apply(this,arguments)}function b(_){return P.apply(this,arguments)}function P(){return P=_asyncToGenerator(_regeneratorRuntime().mark(function _(l){return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",get("/api/ide/logic/".concat(l,"/config")).then(function(g){var i;return(i=g.data)===null||i===void 0?void 0:i.data}));case 1:case"end":return a.stop()}},_)})),P.apply(this,arguments)}function S(_,l,E){return D.apply(this,arguments)}function D(){return D=u()(r()().mark(function _(l,E,a){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,o.gz)("/api/ide/logic/edit/".concat(l),{version:E,configJson:a,updateTime:x()().format("YYYY-MM-DD HH:mm:ss")}));case 1:case"end":return i.stop()}},_)})),D.apply(this,arguments)}function e(_){return d.apply(this,arguments)}function d(){return d=u()(r()().mark(function _(l){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,o.U2)("/api/ide/logic-instance/".concat(l)).then(function(g){var i=g.data.data;return i}));case 1:case"end":return a.stop()}},_)})),d.apply(this,arguments)}function v(_){return L.apply(this,arguments)}function L(){return L=u()(r()().mark(function _(l){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,o.v_)("/api/ide/logic-logs",{filters:[{dataIndex:"logicId",values:[l.logicId],type:"="},{dataIndex:"bizId",values:[l.bizId],type:"="}],pageSize:1e3,orderBy:[{dataIndex:"id",desc:!0}]}).then(function(g){var i=g.data.data.records;return i&&i.map(function(h){h.itemLogs&&(h.itemLogs=JSON.parse(h.itemLogs))}),i}));case 1:case"end":return a.stop()}},_)})),L.apply(this,arguments)}function w(_){return y.apply(this,arguments)}function y(){return y=u()(r()().mark(function _(l){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,o.v_)("/api/ide/logic-logs",{filters:[{dataIndex:"id",values:[l],type:"="}],pageSize:1e3}).then(function(g){var i=g.data.data.records;return i&&i.length>0&&i[0].itemLogs&&(i[0].itemLogs=JSON.parse(i[0].itemLogs)),i[0]}));case 1:case"end":return a.stop()}},_)})),y.apply(this,arguments)}function M(_,l){return T.apply(this,arguments)}function T(){return T=_asyncToGenerator(_regeneratorRuntime().mark(function _(l,E){return _regeneratorRuntime().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",post("/api/ide/logic-baks",{filters:[{dataIndex:"id",values:[l],type:"="},{dataIndex:"version",values:[E],type:"="}]}).then(function(i){var h=i.data.data.records[0].configJson,k=JSON.parse(h);return k}));case 1:case"end":return g.stop()}},_)})),T.apply(this,arguments)}function B(_,l){return I.apply(this,arguments)}function I(){return I=u()(r()().mark(function _(l,E){return r()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",(0,o.v_)("/api/ide/logic-baks",{filters:[{dataIndex:"id",values:[l],type:"="},{dataIndex:"version",values:[E],type:"="}]}).then(function(i){var h=i.data.data.records[0],k=h.configJson;return h.configJson=JSON.parse(k),h.configJson.id=h.id,h.configJson.name=h.name,h}));case 1:case"end":return g.stop()}},_)})),I.apply(this,arguments)}}}]);
