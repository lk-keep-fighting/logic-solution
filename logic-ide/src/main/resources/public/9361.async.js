"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[9361],{99361:function(Ae,B,v){v.r(B),v.d(B,{TreeSelectControlRenderer:function(){return G},default:function(){return K}});var i=v(15767),Z=v(87363),m=v.n(Z),d=v(42977),T=v(94391),S=v(8427),X=v(66292),x=v.n(X),M=v(61533),Ve=v.n(M),H=v(45581),K=function(b){(0,i.ZT)(r,b);function r(e){var t=b.call(this,e)||this;return t.container=m().createRef(),t.input=m().createRef(),t.cache={},t.targetRef=function(n){return t.target=n?(0,M.findDOMNode)(n):null},t.sourceLoaded=!1,t.state={inputValue:"",tempValue:"",isOpened:!1},t.open=t.open.bind(t),t.close=t.close.bind(t),t.handleChange=t.handleChange.bind(t),t.handleTempChange=t.handleTempChange.bind(t),t.handleConfirm=t.handleConfirm.bind(t),t.clearValue=t.clearValue.bind(t),t.handleFocus=t.handleFocus.bind(t),t.handleBlur=t.handleBlur.bind(t),t.handleKeyPress=t.handleKeyPress.bind(t),t.handleInputChange=x()(t.handleInputChange.bind(t),150,{trailing:!0,leading:!1}),t.handleInputKeyDown=t.handleInputKeyDown.bind(t),t.loadRemote=x()(t.loadRemote.bind(t),250,{trailing:!0,leading:!1}),t}return r.prototype.componentDidMount=function(){this.loadRemote("")},r.prototype.componentWillUnmount=function(){this.sourceLoaded=!1},r.prototype.open=function(e){this.props.disabled||this.setState({isOpened:!0},e)},r.prototype.close=function(){var e=this;this.setState({isOpened:!1,inputValue:this.props.multiple?this.state.inputValue:""},function(){return e.loadRemote(e.state.inputValue)})},r.prototype.resolveOptions=function(){var e=this.props,t=e.options,n=e.searchable,o=e.autoComplete;return!(0,d.X1t)(o)&&n&&this.state.inputValue?this.filterOptions(t,this.state.inputValue):t},r.prototype.resolveOption=function(e,t){var n=this;return(0,d.hEs)(e,function(o){var a=n.props.valueField||"value",l=(0,d.rIu)(o,a)?o[a]:"";return l===t})},r.prototype.handleFocus=function(e){var t=this.props,n=t.dispatchEvent,o=t.value,a=this.resolveOptions(),l=this.resolveOption(a,o);n("focus",(0,d.vXk)(this.props,{value:o,item:l,items:a}))},r.prototype.handleBlur=function(e){var t=this.props,n=t.dispatchEvent,o=t.value,a=this.resolveOptions(),l=this.resolveOption(a,o);n("blur",(0,d.vXk)(this.props,{value:o,item:l,items:a}))},r.prototype.handleKeyPress=function(e){e.key===" "&&e.shiftKey&&(this.handleOutClick(e),e.preventDefault())},r.prototype.validate=function(){var e=this.props,t=e.value,n=e.minLength,o=e.maxLength,a=e.delimiter,l=Array.isArray(t)?t:(t?String(t):"").split(a||",");if(n&&l.length<n)return"\u5DF2\u9009\u62E9\u6570\u91CF\u4F4E\u4E8E\u8BBE\u5B9A\u7684\u6700\u5C0F\u4E2A\u6570".concat(n,"\uFF0C\u8BF7\u9009\u62E9\u66F4\u591A\u7684\u9009\u9879\u3002");if(o&&l.length>o)return"\u5DF2\u9009\u62E9\u6570\u91CF\u8D85\u51FA\u8BBE\u5B9A\u7684\u6700\u5927\u4E2A\u6570".concat(o,"\uFF0C\u8BF7\u53D6\u6D88\u9009\u62E9\u8D85\u51FA\u7684\u9009\u9879\u3002")},r.prototype.removeItem=function(e,t){var n=this.props,o=n.selectedOptions,a=n.joinValues,l=n.extractValue,s=n.delimiter,u=n.valueField,h=n.onChange,f=n.disabled;if(t&&t.stopPropagation(),!f){var p=o.concat();p.splice(e,1);var c=p;a?c=p.map(function(g){return g[u||"value"]}).join(s||","):l&&(c=p.map(function(g){return g[u||"value"]})),h(c)}},r.prototype.handleChange=function(e){var t=this,n=this.props.multiple;n||this.close(),this.setState({inputValue:""},function(){return t.resultChangeEvent(e)})},r.prototype.handleTempChange=function(e){this.setState({tempValue:e})},r.prototype.handleConfirm=function(){var e=this;this.close(),this.setState({inputValue:""},function(){return e.resultChangeEvent(e.state.tempValue)})},r.prototype.handleInputChange=function(e){var t=this,n=this.props,o=n.autoComplete,a=n.data;this.setState({inputValue:e},(0,d.X1t)(o,a)?function(){return t.loadRemote(t.state.inputValue)}:void 0)},r.prototype.handleInputKeyDown=function(e){var t=this.state.inputValue,n=this.props,o=n.multiple,a=n.selectedOptions;e.key==="Backspace"&&!t&&a.length&&o&&this.removeItem(a.length-1)},r.prototype.resetValue=function(){var e,t,n=this.props,o=n.onChange,a=n.resetValue,l=n.formStore,s=n.store,u=n.name,h=(t=(0,d.E04)((e=l==null?void 0:l.pristine)!==null&&e!==void 0?e:s==null?void 0:s.pristine,u))!==null&&t!==void 0?t:a;o(h)},r.prototype.clearValue=function(){var e=this.props,t=e.onChange,n=e.resetValue;t(typeof n=="undefined"?"":n)},r.prototype.filterOptions=function(e,t){var n=this,o=this.props,a=o.labelField,l=o.valueField;return e.map(function(s){if(s=(0,i.pi)({},s),s.visible=!!(0,S.Lu)([s],t,{keys:[a||"label",l||"value"],threshold:S.Lu.rankings.CONTAINS}).length,!s.visible&&s.children){s.children=n.filterOptions(s.children,t);var u=s.children.filter(function(h){return h.visible}).length;s.visible=!!u}return s.visible&&(s.collapsed=!1),s})},r.prototype.loadRemote=function(e){return(0,i.mG)(this,void 0,void 0,function(){var t,n,o,a,l,s,u,f,p,h,f,p;return(0,i.Jh)(this,function(c){switch(c.label){case 0:if(t=this.props,n=t.autoComplete,o=t.env,a=t.data,l=t.setOptions,s=t.setLoading,u=t.source,!(0,d.X1t)(n,a)||!e&&(0,d.X1t)(u)&&!this.sourceLoaded)return this.sourceLoaded=!0,[2];if(!o||!o.fetcher)throw new Error("fetcher is required");if(this.cache[e]||~e.indexOf("'"))return f=this.cache[e]||[],p=this.mergeOptions(f),l(p),[2,Promise.resolve({options:p})];s(!0),c.label=1;case 1:return c.trys.push([1,,3,4]),[4,o.fetcher(n,(0,i.pi)((0,i.pi)({},a),{term:e,value:e}))];case 2:return h=c.sent(),f=h.data&&h.data.options||h.data||[],this.cache[e]=f,p=this.mergeOptions(f),l(p),[2,{options:p}];case 3:return s(!1),[7];case 4:return[2]}})})},r.prototype.mergeOptions=function(e){var t=this.props.selectedOptions,n=(0,d.GRe)(e).concat();return Array.isArray(t)&&t.length&&t.forEach(function(o){(0,d.hEs)(n,function(a){return a.value==o.value})||n.push((0,i.pi)({},o))}),n},r.prototype.reload=function(e,t){var n=this.props.reloadOptions;n&&n(e,t)},r.prototype.handleOutClick=function(e){e.defaultPrevented||this.setState({isOpened:!0})},r.prototype.handleResultChange=function(e){var t=this.props,n=t.joinValues,o=t.extractValue,a=t.delimiter,l=t.valueField,s=t.multiple,u=Array.isArray(e)?e.concat():[];if(!s&&!u.length){this.resultChangeEvent("");return}(n||o)&&(u=e.map(function(h){return h[l||"value"]})),n&&(u=u.join(a||",")),this.resultChangeEvent(u)},r.prototype.doAction=function(e,t,n){var o,a,l,s,u;e.actionType==="clear"?this.clearValue():e.actionType==="reset"?this.resetValue():e.actionType==="add"?this.addItemFromAction((o=e.args)===null||o===void 0?void 0:o.item,(a=e.args)===null||a===void 0?void 0:a.parentValue):e.actionType==="edit"?this.editItemFromAction((l=e.args)===null||l===void 0?void 0:l.item,(s=e.args)===null||s===void 0?void 0:s.originValue):e.actionType==="delete"?this.deleteItemFromAction((u=e.args)===null||u===void 0?void 0:u.value):e.actionType==="reload"&&this.reload()},r.prototype.addItemFromAction=function(e,t){var n=this.props,o=n.onAdd,a=n.options,l=n.valueField,s=(0,d.L$8)(a,function(u){var h=l||"value",f=(0,d.rIu)(u,h)?u[h]:"";return f===t})||[];o&&o(s.concat(0),e,!0)},r.prototype.editItemFromAction=function(e,t){var n=this.props,o=n.onEdit,a=n.options,l=this.resolveOption(a,t);o&&l&&o((0,i.pi)((0,i.pi)({},e),{originValue:t}),l,!0)},r.prototype.deleteItemFromAction=function(e){var t=this.props,n=t.onDelete,o=t.options,a=this.resolveOption(o,e);n&&a&&n(a)},r.prototype.resultChangeEvent=function(e){return(0,i.mG)(this,void 0,void 0,function(){var t,n,o,a,l,s;return(0,i.Jh)(this,function(u){switch(u.label){case 0:return t=this.props,n=t.onChange,o=t.dispatchEvent,a=this.resolveOptions(),l=this.resolveOption(a,e),[4,o("change",(0,d.vXk)(this.props,{value:e,item:l,items:this.resolveOptions()}))];case 1:return s=u.sent(),s!=null&&s.prevented?[2]:(n&&n(e),[2])}})})},r.prototype.handleNodeClick=function(e){return(0,i.mG)(this,void 0,void 0,function(){var t,n,o,a;return(0,i.Jh)(this,function(l){switch(l.label){case 0:return t=this.props,n=t.dispatchEvent,o=t.data,[4,n("itemClick",(0,d.nW9)(o,{item:e}))];case 1:return a=l.sent(),a!=null&&a.prevented?[2]:[2]}})})},r.prototype.renderOptionItem=function(e,t){var n=this.props,o=n.menuTpl,a=n.render,l=n.data;return a("option/".concat(t.index),o,{data:(0,d.nW9)((0,d.nW9)(l,(0,i.pi)({},t)),e)})},r.prototype.renderItem=function(e){var t=this.props,n=t.labelField,o=t.options,a=t.hideNodePathLabel;if(a)return e[n||"label"];var l=(0,d.kSg)(o,e,!0);return"".concat(l?l.map(function(s){return"".concat(s[n||"label"])}).join(" / "):e[n||"label"])},r.prototype.domRef=function(e){this.treeRef=e},r.prototype.renderOuter=function(){var e=this.props,t=e.value,n=e.enableNodePath,o=e.pathSeparator,a=o===void 0?"/":o,l=e.disabled,s=e.joinValues,u=e.extractValue,h=e.delimiter,f=e.placeholder,p=e.options,c=e.multiple,g=e.valueField,_=e.initiallyOpen,O=e.unfoldedLevel,E=e.withChildren,w=e.rootLabel,y=e.cascade,V=e.rootValue,P=e.showIcon,D=e.showRadio,I=e.popOverContainer,L=e.onlyChildren,C=e.onlyLeaf,R=e.classPrefix,j=e.optionsPlaceholder,N=e.searchable,F=e.autoComplete,A=e.maxLength,J=e.minLength,$=e.labelField,z=e.deferField,Q=e.nodePath,Y=e.onAdd,q=e.creatable,ee=e.createTip,te=e.addControls,ne=e.onEdit,ie=e.editable,oe=e.editTip,ae=e.editControls,re=e.removable,le=e.removeTip,se=e.onDelete,de=e.rootCreatable,ue=e.rootCreateTip,W=e.translate,pe=e.deferLoad,he=e.expandTreeOptions,ce=e.selfDisabledAffectChildren,ve=e.showOutline,me=e.autoCheckChildren,fe=e.autoCancelParent,ge=e.hideRoot,Ce=e.virtualThreshold,U=e.itemHeight,ye=e.menuTpl,be=e.enableDefaultIcon,k=e.mobileUI,Oe=e.testIdBuilder,Ee=e.nodeBehavior,Te=e.itemActions,_e=e.classnames,we=e.id,Ie=e.themeCss,Fe=!(0,d.X1t)(F)&&N&&this.state.inputValue?this.filterOptions(p,this.state.inputValue):p;return m().createElement(T.mpN,{classPrefix:R,onRef:this.domRef,onlyChildren:L,onHandleNodeClick:this.handleNodeClick,onlyLeaf:C,labelField:$,valueField:g,deferField:z,disabled:l,onChange:k?this.handleTempChange:this.handleChange,joinValues:s,extractValue:u,delimiter:h,placeholder:W(j),options:Fe,highlightTxt:this.state.inputValue,multiple:c,initiallyOpen:_,unfoldedLevel:O,withChildren:E,autoCheckChildren:me,autoCancelParent:fe,rootLabel:W(w),rootValue:V,showIcon:P,showRadio:D,showOutline:ve,cascade:y,foldedField:"collapsed",hideRoot:ge,value:t||"",nodePath:Q,enableNodePath:n,pathSeparator:a,maxLength:A,minLength:J,onAdd:Y,creatable:q,createTip:ee,rootCreatable:de,rootCreateTip:ue,onEdit:ne,editable:ie,editTip:oe,removable:re,removeTip:le,onDelete:se,bultinCUD:!te&&!ae,onDeferLoad:pe,onExpandTree:he,selfDisabledAffectChildren:ce,virtualThreshold:Ce,itemHeight:(0,d.He2)(U)>0?(0,d.He2)(U):void 0,itemRender:ye?this.renderOptionItem:void 0,enableDefaultIcon:be,mobileUI:k,nodeBehavior:Ee,itemActionsRender:Te?this.renderItemActions:void 0,actionClassName:_e((0,d.GwQ)((0,i.pi)((0,i.pi)({},this.props),{name:"actionControlClassName",id:we,themeCss:Ie}))),testIdBuilder:Oe})},r.prototype.renderItemActions=function(e,t){var n=this.props,o=n.itemActions,a=n.data,l=n.render;return l("action/".concat(t.index),o||"",{data:(0,d.nW9)((0,d.nW9)(a,(0,i.pi)({},t)),e)})},r.prototype.render=function(){var e=this,t=this.props,n=t.className,o=t.style,a=t.disabled,l=t.inline,s=t.loading,u=t.multiple,h=t.value,f=t.clearable,p=t.classPrefix,c=t.classnames,g=t.searchable,_=t.autoComplete,O=t.selectedOptions,E=t.placeholder,w=t.popOverContainer,y=t.mobileUI,V=t.maxTagCount,P=t.overflowTagPopover,D=t.translate,I=t.env,L=t.loadingConfig,C=t.testIdBuilder,R=t.wrapperCustomStyle,j=t.id,N=t.themeCss,F=this.state.isOpened,A=u?O:O.length?this.renderItem(O[0]):"";return m().createElement(m().Fragment,null,m().createElement("div",(0,i.pi)({ref:this.container,className:c("TreeSelectControl",n)},C==null?void 0:C.getTestId()),m().createElement(T.AlT,{popOverContainer:w||I.getModalContainer,maxTagCount:V,overflowTagPopover:P,disabled:a,ref:this.targetRef,placeholder:D(E!=null?E:"placeholder.empty"),inputPlaceholder:"",className:c("TreeSelect",{"TreeSelect--inline":l,"TreeSelect--single":!u,"TreeSelect--multi":u,"TreeSelect--searchable":g||(0,d.X1t)(_),"is-opened":this.state.isOpened,"is-disabled":a}),result:A,onResultClick:this.handleOutClick,value:this.state.inputValue,onChange:this.handleInputChange,onResultChange:this.handleResultChange,itemRender:this.renderItem,onKeyPress:this.handleKeyPress,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeyDown:this.handleInputKeyDown,clearable:f,allowInput:!y&&(g||(0,d.X1t)(_))&&(u||!A),hasDropDownArrow:!0,readOnly:y,mobileUI:y,testIdBuilder:C==null?void 0:C.getChild("result-box")},s?m().createElement(T.$jN,{loadingConfig:L,size:"sm"}):void 0),!y&&F?m().createElement(d.aVW,{container:w||function(){return e.container.current},target:function(){return e.target},show:!0},m().createElement(d.v$m,{classPrefix:p,className:"".concat(p,"TreeSelect-popover"),style:{minWidth:this.target?this.target.offsetWidth:void 0},onHide:this.close,overlay:!0},this.renderOuter())):null,y?m().createElement(T.N4A,{container:I.getModalContainer,className:c("".concat(p,"TreeSelect-popup")),isShow:F,onHide:this.close,showConfirm:!0,onConfirm:this.handleConfirm},this.renderOuter()):null),m().createElement(d.cWM,(0,i.pi)({},this.props,{config:{wrapperCustomStyle:R,id:j,themeCss:N,classNames:[{key:"actionControlClassName"}]},env:I})))},r.defaultProps={hideRoot:!0,placeholder:"Select.placeholder",optionsPlaceholder:"placeholder.noData",multiple:!1,clearable:!0,rootLabel:"Tree.root",rootValue:"",showIcon:!0,joinValues:!0,extractValue:!1,delimiter:",",resetValue:"",hideNodePathLabel:!1,enableNodePath:!1,pathSeparator:"/",selfDisabledAffectChildren:!0},(0,i.gn)([d.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",void 0)],r.prototype,"handleOutClick",null),(0,i.gn)([d.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Array]),(0,i.w6)("design:returntype",void 0)],r.prototype,"handleResultChange",null),(0,i.gn)([d.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object,Object]),(0,i.w6)("design:returntype",void 0)],r.prototype,"addItemFromAction",null),(0,i.gn)([d.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object,Object]),(0,i.w6)("design:returntype",void 0)],r.prototype,"editItemFromAction",null),(0,i.gn)([d.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",void 0)],r.prototype,"deleteItemFromAction",null),(0,i.gn)([d.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",Promise)],r.prototype,"resultChangeEvent",null),(0,i.gn)([d.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",Promise)],r.prototype,"handleNodeClick",null),(0,i.gn)([d.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object,Object]),(0,i.w6)("design:returntype",void 0)],r.prototype,"renderOptionItem",null),(0,i.gn)([d.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",void 0)],r.prototype,"renderItem",null),(0,i.gn)([d.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object]),(0,i.w6)("design:returntype",void 0)],r.prototype,"domRef",null),(0,i.gn)([d.NjZ,(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[Object,Object]),(0,i.w6)("design:returntype",void 0)],r.prototype,"renderItemActions",null),(0,i.gn)([(0,H.i)(),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",void 0)],r.prototype,"render",null),r}(m().Component),G=function(b){(0,i.ZT)(r,b);function r(){return b!==null&&b.apply(this,arguments)||this}return r=(0,i.gn)([(0,d.oZB)({type:"tree-select"})],r),r}(K)}}]);
