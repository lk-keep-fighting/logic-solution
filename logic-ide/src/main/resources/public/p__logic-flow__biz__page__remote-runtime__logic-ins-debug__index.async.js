"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[2583],{78686:function(Ce,F,e){e.d(F,{Z:function(){return oe}});var G=e(54306),f=e.n(G),H=e(8049),b=e(14990),V=e(22465),N=e(5671),X=e(17696),Y=e(19227),C=e(75476),k=e(1167),W=e(22150),p=e(4283),m=e(36267),L=e(23360),Q=e(8051),l=e(87155),U=e(54145),w=e(91711),a=e(87363),j=e.n(a),Z=e(72107),I=e(9364),q=e(44095),K=e(3619),ee=e(9976),ne=e(34957),M=e(94990),n=e(33130),re=j().createContext({logic:new Z.Iz("")}),te=function(v){var E,T,P,le=(0,a.useState)(),A=f()(le,2),d=A[0],R=A[1],t=(0,a.useState)(),_=f()(t,2),g=_[0],D=_[1],S=(0,a.useState)(!0),B=f()(S,2),O=B[0],se=B[1],je=(0,a.useState)(),ce=f()(je,2),u=ce[0],de=ce[1],ye=(0,a.useState)(),ve=f()(ye,2),r=ve[0],be=ve[1],Le=(0,a.useState)(),ge=f()(Le,2),ae=ge[0],Ie=ge[1],De=(0,a.useState)(),fe=f()(De,2),J=fe[0],ue=fe[1],Ze=(0,a.useState)(),he=f()(Ze,2),Pe=he[0],Oe=he[1],me=(0,a.useRef)(),_e=function(h){var s=h.node;ue(s);var o=r==null?void 0:r.itemLogs.find(function(x){return x.config.id==s.id});de(o)};function pe(i,h,s,o){return{name:"button",args:{markup:[{tagName:"circle",selector:"button",attrs:{r:14,x:0,y:0,stroke:h.success?"#52C41A":"red","stroke-width":5-s<1?1:5-s,fill:"white",cursor:"pointer"}},{tagName:"text",textContent:i,selector:"icon",attrs:{"font-size":20-s<12?12:20-s,"text-anchor":"middle","pointer-events":"none",y:"0.3em"}}],x:(o-1)*28,y:0,onClick:function(y){var xe=y.view,$=xe.cell;ue($),se(!1),de(h)}}}}(0,a.useEffect)(function(){ae&&(d==null||d.centerCell(ae))},[ae,d]),(0,a.useEffect)(function(){console.log("select curItemLog",u)},[u]),(0,a.useEffect)(function(){var i=d==null?void 0:d.getNodes().find(function(h){return h.id==v.nextId});i==null||i.attr("body/fill","red"),Ie(i)},[v.nextId]),(0,a.useEffect)(function(){var i;d==null||(i=d.getNodes().find(function(h){return h.id==v.nextId}))===null||i===void 0||i.attr("body/fill","red")},[d]),(0,a.useEffect)(function(){v.config&&D(v.config)},[v.config]),(0,a.useEffect)(function(){var i,h;console.log("props.debugLogs",v.debugLogs),((i=v.debugLogs)===null||i===void 0?void 0:i.length)>0&&setInterval(Me,2e3);var s=[];v&&((h=v.debugLogs)===null||h===void 0||h.forEach(function(o){var x,y;s.push({children:(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("span",{style:{cursor:"pointer",fontWeight:o.id==(r==null?void 0:r.id)?"bolder":"normal",color:o.id==(r==null?void 0:r.id)?"#52c41a":"black"},onClick:function(){be(o),d==null||d.fromJSON(g==null?void 0:g.visualConfig);var $,z={};o.itemLogs.forEach(function(Ee,Se){var c=d==null?void 0:d.getNodes().find(function(Ae){return Ae.id==Ee.config.id});console.log("\u9009\u4E2D\u7684\u8282\u70B9"),console.log(c),c&&(c.addTools({name:"boundary",args:{attrs:{stroke:"red",strokeWidth:1.5,rx:5,ry:5}}}),$=c),z[c==null?void 0:c.id]?z[c==null?void 0:c.id]+=1:z[c==null?void 0:c.id]=1,c==null||c.addTools(pe(Se,Ee,Se,z[c==null?void 0:c.id]))}),d==null||d.centerCell($),de({}),ue({})},children:[(0,n.jsx)("p",{children:(x=o.itemLogs[0])===null||x===void 0?void 0:x.config.name}),(0,n.jsx)("p",{children:o.serverTime}),((y=v.logicIns)===null||y===void 0?void 0:y.version)==o.version?(0,n.jsx)("p",{}):(0,n.jsx)("p",{children:(0,n.jsxs)(p.Z,{children:[(0,n.jsx)(m.Z.Paragraph,{style:{color:"red"},children:"\u7248\u672C\u53F7:"}),(0,n.jsxs)(m.Z.Paragraph,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F!"],text:o.version},children:[o.version,(0,n.jsx)(m.Z.Link,{style:{margin:"5px"},href:"#/assets/logic/i/".concat(o.logicId,"/view/").concat(o.version),target:"_blank",children:(0,n.jsx)(H.Z,{})})]})]})}),(0,n.jsx)("p",{children:o.message})]})}),color:o.success?"green":"red"})})),Oe(s)},[v.debugLogs,v.logicIns,d,r]),(0,a.useEffect)(function(){if(g){try{var i=(0,I.K)(),h=i.Shapes;(0,q.m)(h)}catch(o){console.error("\u6CE8\u518C\u8282\u70B9\u51FA\u9519\uFF1A"),console.error(o)}var s=new N.kJ({container:me.current,embedding:{enabled:!0,validate:function(x){return x.child.setData({hoverNode:x.parent}),!0}},mousewheel:{enabled:!0,modifiers:"ctrl",minScale:.5,maxScale:3},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:15}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,allowMulti:!0,snap:{radius:20},createEdge:function(){return new N.bn.kS({tools:[{name:"edge-editor",args:{attrs:{backgroundColor:"#fff"}}}],zIndex:0})},validateConnection:function(x){var y=x.targetMagnet;return!!y}},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5F95FF",stroke:"#5F95FF"}}}},background:{color:"#F2F7FA"},grid:!0});s.use(new k.H({enabled:!0,sharp:!0})).use(new X.A({enabled:!0})).use(new C.Y({enabled:!0,multiple:!0,strict:!0,rubberband:!0,movable:!0,showNodeSelectionBox:!0,pointerEvents:"none"})).use(new W.T({enabled:!0})).use(new Y.N),s.on("edge:dblclick",function(){}),s.on("edge:mouseenter",function(){}),s.on("edge:mouseleave",function(){}),s.on("node:moved",function(){}),s.on("node:mouseenter",function(){}),s.on("node:mouseleave",function(){}),s.on("node:added",function(){}),s.on("node:dblclick",function(o){var x=o.node}),s.on("blank:dblclick",function(o){var x=o.x,y=o.y}),s.fromJSON(g.visualConfig),(0,K.V)(s),R(s)}},[g]);var Me=function(){},Te=[{key:"debug-node-input",label:"\u8282\u70B9\u5165\u51FA\u53C2",children:(0,n.jsxs)("div",{children:[(0,n.jsx)(M.Z,{formId:"debug-node-input",values:{success:u==null?void 0:u.success,msg:u==null?void 0:u.msg,returnData:u==null?void 0:u.returnData,body:u==null||(E=u.configInstance)===null||E===void 0?void 0:E.body},onSubmit:function(){}}),(0,n.jsx)(m.Z.Text,{style:{marginLeft:"15px"},copyable:{tooltips:["\u590D\u5236\u8282\u70B9\u7F16\u53F7","\u590D\u5236\u6210\u529F!"],text:J==null?void 0:J.id},children:"\u8282\u70B9\u7F16\u53F7"})]})},{key:"config",label:"\u8282\u70B9\u914D\u7F6E",children:(0,n.jsx)("div",{children:(0,n.jsx)(ne.Z,{onSubmit:function(){},editNode:J})})},{key:"configIns",label:"\u8282\u70B9\u5B9E\u4F8B",children:(0,n.jsx)(M.Z,{formId:(u==null||(T=u.config)===null||T===void 0?void 0:T.type)||"",values:u==null?void 0:u.configInstance,onSubmit:function(){}})},{key:"debug-context",label:"\u6267\u884C\u4E0A\u4E0B\u6587",children:(0,n.jsx)(M.Z,{formId:"debug-context",values:{varsJson:r==null?void 0:r.varsJson,paramsJson:r==null?void 0:r.paramsJson,varsJsonEnd:r==null?void 0:r.varsJsonEnd},onSubmit:function(){}})}];return(0,n.jsxs)(L.Z,{style:{margin:0,height:"100vh"},children:[(0,n.jsxs)(L.Z.Sider,{theme:"light",collapsedWidth:0,width:260,style:{overflow:"auto",height:"100vh",position:"fixed",left:0,top:0,bottom:0,borderRight:"0.5px solid"},children:[(0,n.jsx)(Q.Z,{children:"\u6267\u884C\u8BB0\u5F55"}),(0,n.jsx)(l.Z,{style:{height:"100%"},items:Pe})]}),(0,n.jsxs)(L.Z,{style:{marginLeft:260},children:[(0,n.jsxs)(L.Z.Header,{style:{backgroundColor:"white",padding:0},children:[(P=v.btns)===null||P===void 0?void 0:P.map(function(i){return i}),(0,n.jsx)(U.ZP,{type:"text",icon:O?(0,n.jsx)(b.Z,{}):(0,n.jsx)(V.Z,{}),onClick:function(){se(!O)},style:{float:"right",right:"16px",fontSize:"16px",width:64,height:64}})]}),(0,n.jsx)(L.Z.Content,{className:"app-content",children:(0,n.jsx)(ee.Z,{ref:me})})]}),(0,n.jsxs)(L.Z.Sider,{theme:"light",collapsed:O,collapsedWidth:0,style:{overflow:"scroll"},width:500,children:[(0,n.jsx)(w.Z,{items:Te,defaultActiveKey:"inout"}),(0,n.jsx)(U.ZP,{type:"text",onClick:function(){se(!O)},style:{position:"absolute",top:0,right:0,fontSize:"16px",width:64,height:64},children:"x"})]})]})},oe=te},48341:function(Ce,F,e){e.r(F);var G=e(54306),f=e.n(G),H=e(78686),b=e(48364),V=e(47829),N=e(28635),X=e(79549),Y=e(72197),C=e(8051),k=e(54145),W=e(4283),p=e(36267),m=e(87363),L=e.n(m),Q=e(98306),l=e(33130);function U(a,j){window.document.title=">["+(a==null?void 0:a.name)+"]\u5B9E\u4F8B:"+(j==null?void 0:j.bizId)}var w=function(){var j=(0,Q.UO)(),Z=j.id,I=j.runtime,q=(0,m.useState)(),K=f()(q,2),ee=K[0],ne=K[1],M=(0,m.useState)(""),n=f()(M,2),re=n[0],te=n[1],oe=(0,m.useState)(!1),ie=f()(oe,2),v=ie[0],E=ie[1],T=(0,m.useState)([]),P=f()(T,2),le=P[0],A=P[1],d=(0,m.useState)(),R=f()(d,2),t=R[0],_=R[1];return(0,m.useEffect)(function(){E(!0),Z&&(0,b.ni)(I,Z).then(function(g){if(g){var D=g;_(g),E(!0),(0,b.oX)(I,g.logicId,g.version).then(function(S){var B=S.configJson,O=S.name;te(O),ne(B),U(B,D),E(!1)}).catch(function(S){E(!1),console.log("err"),console.log(S)})}})},[Z]),(0,m.useEffect)(function(){t&&(0,b.rE)(I,t).then(function(g){g&&A(g)})},[t]),(0,l.jsx)("div",{children:(0,l.jsx)(Y.Z,{spinning:v,children:(0,l.jsx)(H.Z,{btns:[(0,l.jsx)(C.Z,{type:"vertical"}),(0,l.jsxs)(k.ZP,{type:"primary",onClick:function(){E(!0),(0,b.ni)(I,Z).then(function(D){D&&(_(D),(0,b.rE)(I,D).then(function(S){S&&A(S),E(!1)})),E(!1)})},children:[(0,l.jsx)(V.Z,{}),"\u5237\u65B0\u8BB0\u5F55"]}),(0,l.jsx)(C.Z,{type:"vertical"}),(0,l.jsxs)("span",{children:["\u662F\u5426\u5B8C\u6210\uFF1A",t!=null&&t.isOver?(0,l.jsx)(N.Z,{twoToneColor:"#52c41a"}):(0,l.jsx)(X.Z,{twoToneColor:"red"})]}),(0,l.jsx)(C.Z,{type:"vertical"}),(0,l.jsxs)("span",{children:["\u5F85\u6267\u884C\uFF1A",t==null?void 0:t.nextName]}),(0,l.jsx)(C.Z,{type:"vertical"}),(0,l.jsxs)(W.Z,{children:["\u4E1A\u52A1\u6807\u8BC6\uFF1A",t==null?void 0:t.bizId,(0,l.jsx)(p.Z.Text,{copyable:{tooltips:["\u590D\u5236\u6807\u8BC6","\u590D\u5236\u6210\u529F!"],text:t==null?void 0:t.bizId}})]}),(0,l.jsx)(C.Z,{type:"vertical"}),(0,l.jsx)(W.Z,{children:re}),(0,l.jsx)(p.Z.Text,{copyable:{tooltips:["\u590D\u5236\u7F16\u53F7","\u590D\u5236\u6210\u529F!"],text:t==null?void 0:t.logicId}}),(0,l.jsx)(C.Z,{type:"vertical"}),(0,l.jsx)("span",{style:{color:"red"},children:"\u6267\u884C\u7248\u672C\uFF1A"}),(0,l.jsxs)("span",{children:[t==null?void 0:t.version,(0,l.jsx)(p.Z.Text,{copyable:{tooltips:["\u590D\u5236\u7248\u672C\u53F7","\u590D\u5236\u6210\u529F!"],text:t==null?void 0:t.version}})]})],nextId:t==null?void 0:t.nextId,config:ee,logicIns:t,debugLogs:le})})})};F.default=w}}]);
