"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[4185],{42651:function(P,S,t){t.d(S,{Z:function(){return l}});var E=t(21140),r=t.n(E),f=t(63466),m=t.n(f),a=t(52510),x=t.n(a),l=function(){function c(s){r()(this,c),x()(this,"_nodeConfig",void 0),x()(this,"_groups",void 0),this._nodeConfig=JSON.parse(JSON.stringify(s)),this._nodeConfig._groups&&(this._groups=this._nodeConfig._groups)}return m()(c,[{key:"getNodeConfig",value:function(){return this._nodeConfig}},{key:"getGroups",value:function(){return this._groups}},{key:"setLabel",value:function(o){this._nodeConfig.attrs&&(this._nodeConfig.attrs.text.text=o)}},{key:"setGroups",value:function(o){this._groups=o}},{key:"setConfigSchemel",value:function(o){this._nodeConfig.data?(this._nodeConfig.data.configSchema=o,this._nodeConfig.data.config={type:o}):this._nodeConfig.data={configSchema:o,config:{type:o}}}},{key:"setConfigData",value:function(o){this._nodeConfig.data?this._nodeConfig.data.config=o:this._nodeConfig.data={config:o}}}]),c}()},3619:function(P,S,t){t.d(S,{V:function(){return r}});var E=t(17600),r=function(a){var x,l=a.getSelectedCells(),c=[],s=[];if(l&&l.length>2){l.forEach(function(e){e.isNode()?c.push(e):s.push(e)}),x=new E.Vq({type:"dagre",begin:[c[0].getPosition().x,c[0].getPosition().y],ranker:"network-simplex",rankdir:"TB",ranksep:20,nodeSize:50,controlPoints:!0}),a.getEdges().forEach(function(e){var d=e.getSourceCellId(),y=0,L=e.getTargetCellId(),C=0;c.find(function(D){return D.id===d})&&y++,c.find(function(D){return D.id===L})&&C++,y>0&&C>0&&s.push(e)});debugger;var o=x.layout({nodes:c,edges:s}),p=o.nodes,b=p===void 0?[]:p;c.forEach(function(e){var d=b.find(function(y){return y.id===e.id});d.x-=e.size().width/2,d.y-=e.size().height/2,e.position(d.x,d.y)})}else{x=new E.Vq({type:"dagre",begin:[400,100],ranker:"network-simplex",rankdir:"TB",ranksep:20,nodeSize:50,align:"DL",controlPoints:!0}),c=a.getNodes(),s=a.getEdges();var v=x.layout({nodes:c,edges:s}),k=v.nodes,w=k===void 0?[]:k;c.forEach(function(e){var d=w.find(function(y){return y.id===e.id});d.x-=e.size().width/2,d.y-=e.size().height/2,e.position(d.x,d.y)})}},f=function(a,x){debugger;var l=new DagreLayout({type:"dagre",begin:[400,100],ranker:"tight-tree",rankdir:"TB",ranksep:20,nodeSize:50,controlPoints:!0}),c=l.layout({nodes:a,edges:x}),s=c.nodes,o=s===void 0?[]:s;a.forEach(function(p){var b=o.find(function(v){return v.id===p.id});b.x-=p.size().width/2,b.y-=p.size().height/2,p.position(b.x,b.y)})}},89147:function(P,S,t){t.d(S,{m:function(){return k}});var E=t(5671),r=t(95812),f=t(53914),m={customNode:"customNode___zxYMy",input:"input___oBweR",switchNode:"switchNode___PXP4B"},a=t(33130),x=function(e){return(0,a.jsx)("div",{className:m.customNode,children:(0,a.jsx)(f.Z,{className:"input",value:e==null?void 0:e.data,width:80})})},l=t(371),c=function(e){return(0,a.jsx)("div",{className:styles.customNode,children:(0,a.jsx)(l.Z,{className:"input",value:e==null?void 0:e.data,width:80})})},s=t(57213),o=t.n(s),p=function(e){var d,y,L,C=e.node,D=(d=C.data.config)===null||d===void 0?void 0:d.name,z=D||"case";return(0,a.jsxs)("div",{className:m.customNode,children:[(0,a.jsx)("span",{children:"case"}),(0,a.jsx)(f.Z,{addonAfter:D,className:"input",value:C==null||(y=C.data)===null||y===void 0||(L=y.config)===null||L===void 0?void 0:L.case,width:150,onChange:function(B){var I=C.data;C.setData(o()(o()({},I),{},{config:o()(o()({},I.config),{},{case:B.target.value})}))}})]})},b=function(e){var d,y=e.node;return(0,a.jsx)("div",{className:m.customNode,children:(0,a.jsx)(f.Z,{addonBefore:"switch",className:"input",value:(d=y.data)===null||d===void 0?void 0:d.config.condition,onChange:function(C){var D=y.data;y.setData(o()(o()({},D),{},{config:o()(o()({},D.config),{},{condition:C.target.value})}))},width:100})})},v=function(e){return(0,a.jsx)("div",{className:m.customNode,children:(0,a.jsx)("div",{style:{textAlign:"center",fontSize:"15px"},children:"default"})})};function k(w){w.forEach(function(e){console.log("\u6CE8\u518C\u65B0\u8282\u70B9:"+e.name),E.kJ.registerNode(e.name,e.config,!0)}),(0,r.z2)({shape:"string",component:x}),(0,r.z2)({shape:"num",component:c}),(0,r.z2)({shape:"switch",component:b}),(0,r.z2)({shape:"switch-case",component:p}),(0,r.z2)({shape:"switch-default",component:v})}},58146:function(P,S,t){t.d(S,{K:function(){return c}});var E=t(57213),r=t.n(E),f=t(12490),m=50,a=50,x=[{name:"ExtSharp",config:{width:100,height:a,attrs:{body:{rx:6,ry:6,stroke:"#5F95FF",strokeWidth:1,fill:"rgba(95,149,255,0.05)",refWidth:1,refHeight:1},image:{refX:2,refY:0},text:{refX:4,refY:20,fontSize:12,"text-anchor":"start"}},markup:[{tagName:"rect",selector:"body"},{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]}}],l=t(42651);function c(s,o,p){var b=50,v=50,k={body:{}},w=[new l.Z({shape:"circle",width:b,height:v,attrs:{body:r()(r()({},k.body),{},{fill:"white"}),text:{text:"\u4EA4\u4E92\u70B9"}},markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}],ports:f.Tt,data:{config:{type:"wait-for-continue"}},_groups:["global"]}),new l.Z({shape:"circle",label:"end",width:b,height:v,attrs:{body:r()(r()({},k.body),{},{fill:"#d9d9d9"}),text:{text:"end"}},markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}],ports:f.Tt,data:{config:{type:"end"}},_groups:["global"]}),new l.Z({shape:"ExtSharp",attrs:{text:{text:"http\u8BF7\u6C42",fontSize:14},image:{"xlink:href":"/icons/http.svg",width:20,x:2,y:2}},data:{config:{type:"http",method:"POST"}},ports:f.Tt,_groups:["biz"]}),new l.Z({shape:"ExtSharp",ports:f.Tt,attrs:{image:{width:15,x:2,y:2,"xlink:href":"/icons/code.svg"},text:{text:"js\u811A\u672C",fontSize:14}},data:{config:{type:"js"}},_groups:["biz"]}),new l.Z({shape:"ExtSharp",ports:f.Tt,attrs:{image:{width:15,x:2,y:2,"xlink:href":"/icons/java.svg"},text:{text:"java\u65B9\u6CD5",fontSize:14}},data:{config:{type:"java"}},_groups:["biz"]}),new l.Z({shape:"ExtSharp",ports:f.Tt,attrs:{image:{width:15,x:2,y:2,"xlink:href":"/icons/CarbonSubflowLocal.svg"},text:{text:"\u590D\u7528\u903B\u8F91",fontSize:14}},data:{config:{type:"sub-logic"}},_groups:["biz"]}),new l.Z({shape:"ExtSharp",width:50,height:v,label:"switch",attrs:{image:{"xlink:href":"/icons/switch.svg",width:45,x:1,y:2},text:{text:"switch",fontSize:14,refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"switch"}},ports:f.Tt,_groups:["ctrl"]}),new l.Z({shape:"ExtSharp",width:b,height:v,attrs:{image:{"xlink:href":"/icons/text.svg",width:30,x:8,y:10},text:{text:"case",fontSize:14,refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"switch-case"}},ports:f.Tt,_groups:["ctrl"]}),new l.Z({shape:"ExtSharp",width:50,height:v,attrs:{image:{"xlink:href":"/icons/text.svg",width:30,x:8,y:10},text:{text:"default",fontSize:14,refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"switch-default"}},ports:f.Tt,_groups:["ctrl"]}),new l.Z({shape:"ExtSharp",width:b,height:v,attrs:{image:{"xlink:href":"/icons/delay.svg",width:30,x:8,y:10},text:{text:"\u7B49\u5F85",fontSize:14,refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"wait",timeout:"2000"}},ports:f.Tt,_groups:["ctrl"]})];s&&s.length>0&&Array.prototype.push.apply(w,s);var e=[{name:"global",title:"\u5168\u5C40\u8282\u70B9",graphHeight:110},{name:"ctrl",title:"\u903B\u8F91\u63A7\u5236",graphHeight:220},{name:"biz",title:"\u4E1A\u52A1\u8C03\u7528",graphHeight:220}];o&&o.length>0&&Array.prototype.push.apply(e,o);var d=x;return p&&p.length>0&&Array.prototype.push.apply(d,p),{Shapes:d,Nodes:w,Groups:e}}},48364:function(P,S,t){t.d(S,{Uh:function(){return B},az:function(){return k},gC:function(){return y},m9:function(){return e},qB:function(){return o},yi:function(){return C}});var E=t(25359),r=t.n(E),f=t(49811),m=t.n(f),a=t(57475),x=t(5726),l=t.n(x);function c(u){return s.apply(this,arguments)}function s(){return s=_asyncToGenerator(_regeneratorRuntime().mark(function u(_){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",post("/api/ide/pub/logic/dev-to-test".concat(_)));case 1:case"end":return n.stop()}},u)})),s.apply(this,arguments)}function o(u){return p.apply(this,arguments)}function p(){return p=m()(r()().mark(function u(_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,a.U2)("/api/ide/logic/".concat(_)).then(function(g){var i,h=(i=g.data)===null||i===void 0?void 0:i.data;return h.configJson=JSON.parse(h.configJson),h}));case 1:case"end":return n.stop()}},u)})),p.apply(this,arguments)}function b(u){return v.apply(this,arguments)}function v(){return v=_asyncToGenerator(_regeneratorRuntime().mark(function u(_){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",get("/api/ide/logic/".concat(_,"/config")).then(function(g){var i;return(i=g.data)===null||i===void 0?void 0:i.data}));case 1:case"end":return n.stop()}},u)})),v.apply(this,arguments)}function k(u,_,N){return w.apply(this,arguments)}function w(){return w=m()(r()().mark(function u(_,N,n){return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,a.gz)("/api/ide/logic/edit/".concat(_),{version:N,configJson:n,updateTime:l()().format("YYYY-MM-DD HH:mm:ss")}));case 1:case"end":return i.stop()}},u)})),w.apply(this,arguments)}function e(u){return d.apply(this,arguments)}function d(){return d=m()(r()().mark(function u(_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,a.U2)("/api/ide/logic-instance/".concat(_)).then(function(g){var i=g.data.data;return i}));case 1:case"end":return n.stop()}},u)})),d.apply(this,arguments)}function y(u){return L.apply(this,arguments)}function L(){return L=m()(r()().mark(function u(_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,a.v_)("/api/ide/logic-logs",{filters:[{dataIndex:"logicId",values:[_.logicId],type:"="},{dataIndex:"bizId",values:[_.bizId],type:"="}],pageSize:1e3,orderBy:[{dataIndex:"id",desc:!0}]}).then(function(g){var i=g.data.data.records;return i&&i.map(function(h){h.itemLogs&&(h.itemLogs=JSON.parse(h.itemLogs))}),i}));case 1:case"end":return n.stop()}},u)})),L.apply(this,arguments)}function C(u){return D.apply(this,arguments)}function D(){return D=m()(r()().mark(function u(_){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,a.v_)("/api/ide/logic-logs",{filters:[{dataIndex:"id",values:[_],type:"="}],pageSize:1e3}).then(function(g){var i=g.data.data.records;return i&&i.length>0&&i[0].itemLogs&&(i[0].itemLogs=JSON.parse(i[0].itemLogs)),i[0]}));case 1:case"end":return n.stop()}},u)})),D.apply(this,arguments)}function z(u,_){return T.apply(this,arguments)}function T(){return T=_asyncToGenerator(_regeneratorRuntime().mark(function u(_,N){return _regeneratorRuntime().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",post("/api/ide/logic-baks",{filters:[{dataIndex:"id",values:[_],type:"="},{dataIndex:"version",values:[N],type:"="}]}).then(function(i){var h=i.data.data.records[0].configJson,j=JSON.parse(h);return j}));case 1:case"end":return g.stop()}},u)})),T.apply(this,arguments)}function B(u,_){return I.apply(this,arguments)}function I(){return I=m()(r()().mark(function u(_,N){return r()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",(0,a.v_)("/api/ide/logic-baks",{filters:[{dataIndex:"id",values:[_],type:"="},{dataIndex:"version",values:[N],type:"="}]}).then(function(i){var h=i.data.data.records[0],j=h.configJson;return h.configJson=JSON.parse(j),h.configJson.id=h.id,h.configJson.name=h.name,h}));case 1:case"end":return g.stop()}},u)})),I.apply(this,arguments)}}}]);
