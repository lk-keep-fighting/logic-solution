"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[3742],{42008:function(T,w,e){e.d(w,{Z:function(){return d}});var x=e(58709),_=e(87363),g={icon:function(i,s){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:i}},{tag:"path",attrs:{d:"M512 140c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm193.4 225.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.3 0 19.9 5 25.9 13.3l71.2 98.8 157.2-218c6-8.4 15.7-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.4 12.7z",fill:s}},{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z",fill:i}}]}},name:"check-circle",theme:"twotone"},S=g,n=e(6481),h=function(i,s){return _.createElement(n.Z,(0,x.Z)({},i,{ref:s,icon:S}))},v=_.forwardRef(h),d=v},63637:function(T,w,e){e.d(w,{Z:function(){return d}});var x=e(58709),_=e(87363),g={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M288 421a48 48 0 1096 0 48 48 0 10-96 0zm352 0a48 48 0 1096 0 48 48 0 10-96 0zM512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm263 711c-34.2 34.2-74 61-118.3 79.8C611 874.2 562.3 884 512 884c-50.3 0-99-9.8-144.8-29.2A370.4 370.4 0 01248.9 775c-34.2-34.2-61-74-79.8-118.3C149.8 611 140 562.3 140 512s9.8-99 29.2-144.8A370.4 370.4 0 01249 248.9c34.2-34.2 74-61 118.3-79.8C413 149.8 461.7 140 512 140c50.3 0 99 9.8 144.8 29.2A370.4 370.4 0 01775.1 249c34.2 34.2 61 74 79.8 118.3C874.2 413 884 461.7 884 512s-9.8 99-29.2 144.8A368.89 368.89 0 01775 775zM512 533c-85.5 0-155.6 67.3-160 151.6a8 8 0 008 8.4h48.1c4.2 0 7.8-3.2 8.1-7.4C420 636.1 461.5 597 512 597s92.1 39.1 95.8 88.6c.3 4.2 3.9 7.4 8.1 7.4H664a8 8 0 008-8.4C667.6 600.3 597.5 533 512 533z"}}]},name:"frown",theme:"outlined"},S=g,n=e(6481),h=function(i,s){return _.createElement(n.Z,(0,x.Z)({},i,{ref:s,icon:S}))},v=_.forwardRef(h),d=v},12119:function(T,w,e){e.d(w,{Z:function(){return v}});var x=e(25298),_=e.n(x),g=e(17069),S=e.n(g),n=e(82092),h=e.n(n),v=function(){function d(c){_()(this,d),h()(this,"_nodeConfig",void 0),h()(this,"_groups",void 0),this._nodeConfig=JSON.parse(JSON.stringify(c)),this._nodeConfig._groups&&(this._groups=this._nodeConfig._groups)}return S()(d,[{key:"getNodeConfig",value:function(){return this._nodeConfig}},{key:"getGroups",value:function(){return this._groups}},{key:"setLabel",value:function(i){this._nodeConfig.attrs&&(this._nodeConfig.attrs.text.text=i)}},{key:"setGroups",value:function(i){this._groups=i}},{key:"setConfigSchemel",value:function(i){this._nodeConfig.data?(this._nodeConfig.data.configSchema=i,this._nodeConfig.data.config={type:i}):this._nodeConfig.data={configSchema:i,config:{type:i}}}},{key:"setConfigData",value:function(i){this._nodeConfig.data?this._nodeConfig.data.config=i:this._nodeConfig.data={config:i}}}]),d}()},36017:function(T,w,e){e.d(w,{Z:function(){return re}});var x=e(48305),_=e.n(x),g=e(8674),S=e(16020),n=e(91505),h=e(81376),v=e(61943),d=e(90541),c=e(66508),i=e(37348),s=e(77154),y=e(90171),E=e(67703),j=e(39765),N=e(12315),o=e(87363),m=e(8250),k=e(89732),z=e(83359),Z=e(66839),A=e(89202),B=e(85343),u=e(62086),de=function(C){var R,U,F,W,K,J,$,Y,V,ce=(0,o.useState)(),Q=_()(ce,2),f=Q[0],ue=Q[1],ge=(0,o.useState)(),q=_()(ge,2),L=q[0],fe=q[1],_e=(0,o.useState)(!0),ee=_()(_e,2),O=ee[0],G=ee[1],he=(0,o.useState)(),te=_()(he,2),t=te[0],oe=te[1],ve=(0,o.useState)(),ne=_()(ve,2),D=ne[0],me=ne[1],pe=(0,o.useState)(),ie=_()(pe,2),H=ie[0],xe=ie[1],ye=(0,o.useState)(),se=_()(ye,2),M=se[0],ae=se[1],le=(0,o.useRef)();function Ce(a,b,r,p){return{name:"button",args:{markup:[{tagName:"circle",selector:"button",attrs:{r:14,x:0,y:0,stroke:b.success?"#52C41A":"red","stroke-width":5-r<1?1:5-r,fill:"white",cursor:"pointer"}},{tagName:"text",textContent:a,selector:"icon",attrs:{"font-size":20-r<12?12:20-r,"text-anchor":"middle","pointer-events":"none",y:"0.3em"}}],x:(p-1)*28,y:0,onClick:function(l){var X=l.view,P=X.cell;ae(P),G(!1),oe(b)}}}}(0,o.useEffect)(function(){H&&(f==null||f.centerCell(H))},[H,f]),(0,o.useEffect)(function(){var a=f==null?void 0:f.getNodes().find(function(b){return b.id==C.nextId});a==null||a.attr("body/fill","red"),xe(a)},[C.nextId]),(0,o.useEffect)(function(){var a;f==null||(a=f.getNodes().find(function(b){return b.id==C.nextId}))===null||a===void 0||a.attr("body/fill","red")},[f]),(0,o.useEffect)(function(){C.config&&fe(C.config)},[C.config]),(0,o.useEffect)(function(){if(console.log("props.logicLog",C.logicLog),C.logicLog){var a=C.logicLog;me(C.logicLog),f==null||f.fromJSON(L==null?void 0:L.visualConfig);var b,r={};a&&a.itemLogs&&(a.itemLogs.forEach(function(p,I){var l=f==null?void 0:f.getNodes().find(function(X){var P;return X.id==((P=p.config)===null||P===void 0?void 0:P.id)});console.log("\u9009\u4E2D\u7684\u8282\u70B9"),console.log(l),l&&(l.addTools({name:"boundary",args:{attrs:{stroke:"red",strokeWidth:1.5,rx:5,ry:5}}}),b=l),r[l==null?void 0:l.id]?r[l==null?void 0:l.id]+=1:r[l==null?void 0:l.id]=1,l==null||l.addTools(Ce(I,p,I,r[l==null?void 0:l.id]))}),b&&(f==null||f.centerCell(b)),oe({}),ae({}))}},[C.logicLog,f]),(0,o.useEffect)(function(){if(L){try{var a=(0,m.K)(),b=a.Shapes;(0,k.m)(b)}catch(p){console.error("\u6CE8\u518C\u8282\u70B9\u51FA\u9519\uFF1A"),console.error(p)}var r=new n.kJ({container:le.current,embedding:{enabled:!0,validate:function(I){return I.child.setData({hoverNode:I.parent}),!0}},mousewheel:{enabled:!0,modifiers:"ctrl",minScale:.5,maxScale:3},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:15}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,allowMulti:!0,snap:{radius:20},createEdge:function(){return new n.bn.kS({tools:[{name:"edge-editor",args:{attrs:{backgroundColor:"#fff"}}}],zIndex:0})},validateConnection:function(I){var l=I.targetMagnet;return!!l}},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5F95FF",stroke:"#5F95FF"}}}},background:{color:"#F2F7FA"},grid:!0});r.use(new c.H({enabled:!0,sharp:!0})).use(new h.A({enabled:!0})).use(new d.Y({enabled:!0,multiple:!0,strict:!0,rubberband:!0,movable:!0,showNodeSelectionBox:!0,pointerEvents:"none"})).use(new i.T({enabled:!0})).use(new v.N),r.on("edge:dblclick",function(){}),r.on("edge:mouseenter",function(){}),r.on("edge:mouseleave",function(){}),r.on("node:moved",function(){}),r.on("node:mouseenter",function(){}),r.on("node:mouseleave",function(){}),r.on("node:added",function(){}),r.on("node:dblclick",function(p){var I=p.node}),r.on("blank:dblclick",function(p){var I=p.x,l=p.y}),r.fromJSON(L.visualConfig),(0,z.V)(r),ue(r)}},[L]);var be=[{key:"debug-node-input",label:"\u8282\u70B9\u5165\u51FA\u53C2",children:(0,u.jsxs)("div",{children:[(t==null||(R=t.configInstance)===null||R===void 0?void 0:R.type)=="sub-logic"?(0,u.jsxs)("div",{children:[(0,u.jsxs)(s.Z.Text,{style:{margin:"15px"},copyable:{tooltips:["","\u590D\u5236\u6210\u529F!"],text:t==null||(U=t.configInstance)===null||U===void 0?void 0:U.objectId},children:["\u5B50\u903B\u8F91\u65E5\u5FD7:",(0,u.jsx)("a",{target:"_blank",href:"#/debug/logic-log/i/".concat(t==null||(F=t.configInstance)===null||F===void 0?void 0:F.objectId),children:t==null||(W=t.configInstance)===null||W===void 0?void 0:W.objectId})]}),(0,u.jsx)(y.Z,{})]}):"",(0,u.jsx)(B.Z,{formId:"debug-node-input",values:{success:t==null?void 0:t.success,msg:t==null?void 0:t.msg,returnData:t==null?void 0:t.returnData,body:t==null||(K=t.configInstance)===null||K===void 0?void 0:K.body,bizId:t==null||(J=t.configInstance)===null||J===void 0?void 0:J.bizId,logicId:t==null||($=t.configInstance)===null||$===void 0?void 0:$.url},onSubmit:function(){}}),(0,u.jsx)(s.Z.Text,{style:{marginLeft:"15px"},copyable:{tooltips:["\u590D\u5236\u8282\u70B9\u7F16\u53F7","\u590D\u5236\u6210\u529F!"],text:M==null?void 0:M.id},children:"\u8282\u70B9\u7F16\u53F7"})]})},{key:"config",label:"\u8282\u70B9\u914D\u7F6E",children:(0,u.jsx)(A.Z,{onSubmit:function(){},editNode:M})},{key:"configIns",label:"\u8282\u70B9\u5B9E\u4F8B",children:(0,u.jsx)("div",{children:(0,u.jsx)(B.Z,{formId:(t==null||(Y=t.config)===null||Y===void 0?void 0:Y.type)||"",values:t==null?void 0:t.configInstance,onSubmit:function(){}})})},{key:"debug-context",label:"\u6267\u884C\u4E0A\u4E0B\u6587",children:(0,u.jsx)(B.Z,{formId:"debug-context",values:{varsJson:D==null?void 0:D.varsJson,paramsJson:D==null?void 0:D.paramsJson,varsJsonEnd:D==null?void 0:D.varsJsonEnd},onSubmit:function(){}})}];return(0,u.jsxs)(E.Z,{style:{margin:0,height:"100vh"},children:[(0,u.jsxs)(E.Z,{children:[(0,u.jsxs)(E.Z.Header,{style:{backgroundColor:"white",padding:0},children:[(V=C.btns)===null||V===void 0?void 0:V.map(function(a){return a}),(0,u.jsx)(j.ZP,{type:"text",icon:O?(0,u.jsx)(g.Z,{}):(0,u.jsx)(S.Z,{}),onClick:function(){G(!O)},style:{float:"right",right:"16px",fontSize:"16px",width:64,height:64}})]}),(0,u.jsx)(E.Z.Content,{className:"app-content",children:(0,u.jsx)(Z.Z,{ref:le})})]}),(0,u.jsxs)(E.Z.Sider,{theme:"light",collapsed:O,collapsedWidth:0,style:{overflow:"scroll"},width:500,children:[(0,u.jsx)(N.Z,{items:be,defaultActiveKey:"inout"}),(0,u.jsx)(j.ZP,{type:"text",onClick:function(){G(!O)},style:{position:"absolute",top:0,right:0,fontSize:"16px",width:64,height:64},children:"x"})]})]})},re=de},83359:function(T,w,e){e.d(w,{V:function(){return _}});var x=e(1973),_=function(n){var h,v=n.getSelectedCells(),d=[],c=[];if(v&&v.length>2){v.forEach(function(o){o.isNode()?d.push(o):c.push(o)}),h=new x.Vq({type:"dagre",begin:[d[0].getPosition().x,d[0].getPosition().y],ranker:"tight-tree",rankdir:"TB",ranksep:20,nodeSize:50,controlPoints:!0}),n.getEdges().forEach(function(o){var m=o.getSourceCellId(),k=0,z=o.getTargetCellId(),Z=0;d.find(function(A){return A.id===m})&&k++,d.find(function(A){return A.id===z})&&Z++,k>0&&Z>0&&c.push(o)});var i=h.layout({nodes:d,edges:c}),s=i.nodes,y=s===void 0?[]:s;d.forEach(function(o){var m=y.find(function(k){return k.id===o.id});m&&(m.x-=o.size().width/2,m.y-=o.size().height/2,o.position(m.x,m.y))})}else{h=new x.Vq({type:"dagre",begin:[400,100],ranker:"network-simplex",rankdir:"TB",ranksep:20,nodeSize:50,align:"DL",controlPoints:!0}),d=n.getNodes(),c=n.getEdges();var E=h.layout({nodes:d,edges:c}),j=E.nodes,N=j===void 0?[]:j;d.forEach(function(o){var m=N.find(function(k){return k.id===o.id});m&&(m.x-=o.size().width/2,m.y-=o.size().height>40?20:o.size().height/2,o.position(m.x,m.y))})}},g=function(n,h){debugger;var v=new DagreLayout({type:"dagre",begin:[400,100],ranker:"tight-tree",rankdir:"TB",ranksep:20,nodeSize:50,controlPoints:!0}),d=v.layout({nodes:n,edges:h}),c=d.nodes,i=c===void 0?[]:c;n.forEach(function(s){var y=i.find(function(E){return E.id===s.id});y&&(y.x-=s.size().width/2,y.y-=s.size().height/2,s.position(y.x,y.y))})}},8250:function(T,w,e){e.d(w,{K:function(){return h}});var x=e(15558),_=e.n(x),g=e(15451),S=e(72920),n=e(12119);function h(v,d,c){var i=50,s=50,y=[new n.Z({shape:"wait-for-continue",width:i,height:s,ports:g.Tt,data:{config:{type:"wait-for-continue",name:"\u4EA4\u4E92\u70B9"}},_groups:["ctrl"]}),new n.Z({shape:"wait",width:i,height:s,attrs:{image:{"xlink:href":"/logic/icons/delay.svg"}},data:{config:{type:"wait",name:"\u7B49\u5F85",timeout:"2000"}},ports:g.Tt,_groups:["ctrl"]}),new n.Z({shape:"ExtSharp",width:50,height:s,label:"switch\u5224\u65AD",attrs:{image:{"xlink:href":"/logic/icons/switch.svg",width:45,x:1,y:2},body:{strokeWidth:0},text:{text:"switch\u5224\u65AD",refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"switch",name:"\u6761\u4EF6\u5224\u65AD"}},ports:g.Tt,_groups:["ctrl"]}),new n.Z({shape:"ExtSharp",width:i,height:s,attrs:{body:{strokeWidth:0},image:{"xlink:href":"/logic/icons/text.svg",width:30,x:8,y:10},text:{text:"case",refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"switch-case",name:"\u6761\u4EF6\u5206\u652F"}},ports:g.Tt,_groups:["ctrl"]}),new n.Z({shape:"ExtSharp",width:i,height:s,attrs:{body:{strokeWidth:0},image:{"xlink:href":"/logic/icons/texts.svg",width:30,x:8,y:10}},data:{config:{type:"switch-cases",name:"\u591A\u6761\u4EF6\u5206\u652F"}},ports:g.Tt,_groups:["ctrl"]}),new n.Z({shape:"ExtSharp",width:50,height:s,attrs:{body:{strokeWidth:0},image:{"xlink:href":"/logic/icons/text.svg",width:30,x:8,y:10}},data:{config:{type:"switch-default",name:"\u9ED8\u8BA4\u5206\u652F"}},ports:g.Tt,_groups:["ctrl"]}),new n.Z({shape:"http",width:100,height:s,text:"http\u8BF7\u6C42",data:{config:{type:"http",name:"http\u8BF7\u6C42",method:"POST"}},ports:g.Tt,_groups:["ctrl"]}),new n.Z({shape:"js",width:100,height:s,ports:g.Tt,imgSrc:"/logic/icons/code.svg",text:"js\u811A\u672C",data:{config:{name:"js\u811A\u672C",type:"js"}},_groups:["ctrl"]}),new n.Z({shape:"java",ports:g.Tt,width:100,height:s,attrs:{image:{"xlink:href":"/icons/java.svg",width:20,x:2,y:2},text:{text:"java\u65B9\u6CD5",fontSize:14}},text:"java\u65B9\u6CD5",data:{config:{name:"java\u65B9\u6CD5",type:"java"}},_groups:["ctrl"]}),new n.Z({shape:"sub-logic",ports:g.Tt,width:100,height:s,data:{config:{name:"\u590D\u7528\u903B\u8F91",type:"sub-logic"}},_groups:["ctrl"]}),new n.Z({shape:"ExtSharp",width:50,height:s,attrs:{image:{"xlink:href":"/logic/icons/assign-global.svg",width:30,x:8,y:10},text:{text:"\u5168\u5C40\u53D8\u91CF",refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{imgSrc:"/logic/icons/assign-global.svg",backgroundColor:"red",config:{name:"\u5168\u5C40\u53D8\u91CF",type:"assign-global"}},ports:g.Tt,_groups:["assign"]}),new n.Z({shape:"ExtSharp",width:50,height:s,attrs:{body:{strokeWidth:1,stroke:"#ff9300",fill:"#ff9300"},image:{"xlink:href":"/logic/icons/assign-local.svg",width:30,x:8,y:10},text:{text:"\u5C40\u90E8\u53D8\u91CF",refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{imgSrc:"/logic/icons/assign-local.svg",config:{name:"\u5C40\u90E8\u53D8\u91CF",type:"assign-local"}},ports:g.Tt,_groups:["assign"]})];v&&v.length>0&&Array.prototype.push.apply(y,v);var E=_()(S.C.values());return{Nodes:y,Shapes:E}}}}]);
