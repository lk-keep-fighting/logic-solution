"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[7021],{28635:function(O,w,e){e.d(w,{Z:function(){return o}});var b=e(56159),c=e(87363),E={icon:function(t,i){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:t}},{tag:"path",attrs:{d:"M512 140c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm193.4 225.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.3 0 19.9 5 25.9 13.3l71.2 98.8 157.2-218c6-8.4 15.7-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.4 12.7z",fill:i}},{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z",fill:t}}]}},name:"check-circle",theme:"twotone"},m=E,n=e(92335),f=function(t,i){return c.createElement(n.Z,(0,b.Z)({},t,{ref:i,icon:m}))},o=c.forwardRef(f)},79549:function(O,w,e){e.d(w,{Z:function(){return o}});var b=e(56159),c=e(87363),E={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M288 421a48 48 0 1096 0 48 48 0 10-96 0zm352 0a48 48 0 1096 0 48 48 0 10-96 0zM512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm263 711c-34.2 34.2-74 61-118.3 79.8C611 874.2 562.3 884 512 884c-50.3 0-99-9.8-144.8-29.2A370.4 370.4 0 01248.9 775c-34.2-34.2-61-74-79.8-118.3C149.8 611 140 562.3 140 512s9.8-99 29.2-144.8A370.4 370.4 0 01249 248.9c34.2-34.2 74-61 118.3-79.8C413 149.8 461.7 140 512 140c50.3 0 99 9.8 144.8 29.2A370.4 370.4 0 01775.1 249c34.2 34.2 61 74 79.8 118.3C874.2 413 884 461.7 884 512s-9.8 99-29.2 144.8A368.89 368.89 0 01775 775zM512 533c-85.5 0-155.6 67.3-160 151.6a8 8 0 008 8.4h48.1c4.2 0 7.8-3.2 8.1-7.4C420 636.1 461.5 597 512 597s92.1 39.1 95.8 88.6c.3 4.2 3.9 7.4 8.1 7.4H664a8 8 0 008-8.4C667.6 600.3 597.5 533 512 533z"}}]},name:"frown",theme:"outlined"},m=E,n=e(92335),f=function(t,i){return c.createElement(n.Z,(0,b.Z)({},t,{ref:i,icon:m}))},o=c.forwardRef(f)},42651:function(O,w,e){e.d(w,{Z:function(){return o}});var b=e(21140),c=e.n(b),E=e(63466),m=e.n(E),n=e(52510),f=e.n(n),o=function(){function r(t){c()(this,r),f()(this,"_nodeConfig",void 0),f()(this,"_groups",void 0),this._nodeConfig=JSON.parse(JSON.stringify(t)),this._nodeConfig._groups&&(this._groups=this._nodeConfig._groups)}return m()(r,[{key:"getNodeConfig",value:function(){return this._nodeConfig}},{key:"getGroups",value:function(){return this._groups}},{key:"setLabel",value:function(i){this._nodeConfig.attrs&&(this._nodeConfig.attrs.text.text=i)}},{key:"setGroups",value:function(i){this._groups=i}},{key:"setConfigSchemel",value:function(i){this._nodeConfig.data?(this._nodeConfig.data.configSchema=i,this._nodeConfig.data.config={type:i}):this._nodeConfig.data={configSchema:i,config:{type:i}}}},{key:"setConfigData",value:function(i){this._nodeConfig.data?this._nodeConfig.data.config=i:this._nodeConfig.data={config:i}}}]),r}()},3619:function(O,w,e){e.d(w,{V:function(){return c}});var b=e(17600),c=function(n){var f,o=n.getSelectedCells(),r=[],t=[];if(o&&o.length>2){o.forEach(function(d){d.isNode()?r.push(d):t.push(d)}),f=new b.Vq({type:"dagre",begin:[r[0].getPosition().x,r[0].getPosition().y],ranker:"network-simplex",rankdir:"TB",ranksep:20,nodeSize:50,controlPoints:!0}),n.getEdges().forEach(function(d){var y=d.getSourceCellId(),k=0,Z=d.getTargetCellId(),M=0;r.find(function(P){return P.id===y})&&k++,r.find(function(P){return P.id===Z})&&M++,k>0&&M>0&&t.push(d)});debugger;var i=f.layout({nodes:r,edges:t}),D=i.nodes,h=D===void 0?[]:D;r.forEach(function(d){var y=h.find(function(k){return k.id===d.id});y.x-=d.size().width/2,y.y-=d.size().height/2,d.position(y.x,y.y)})}else{f=new b.Vq({type:"dagre",begin:[400,100],ranker:"network-simplex",rankdir:"TB",ranksep:20,nodeSize:50,align:"DL",controlPoints:!0}),r=n.getNodes(),t=n.getEdges();var p=f.layout({nodes:r,edges:t}),I=p.nodes,g=I===void 0?[]:I;r.forEach(function(d){var y=g.find(function(k){return k.id===d.id});y.x-=d.size().width/2,y.y-=d.size().height/2,d.position(y.x,y.y)})}},E=function(n,f){debugger;var o=new DagreLayout({type:"dagre",begin:[400,100],ranker:"tight-tree",rankdir:"TB",ranksep:20,nodeSize:50,controlPoints:!0}),r=o.layout({nodes:n,edges:f}),t=r.nodes,i=t===void 0?[]:t;n.forEach(function(D){var h=i.find(function(p){return p.id===D.id});h.x-=D.size().width/2,h.y-=D.size().height/2,D.position(h.x,h.y)})}},44703:function(O,w,e){e.d(w,{Z:function(){return te}});var b=e(54306),c=e.n(b),E=e(14990),m=e(22465),n=e(5671),f=e(17696),o=e(19227),r=e(75476),t=e(1167),i=e(22150),D=e(36267),h=e(23360),p=e(54145),I=e(91711),g=e(87363),d=e(9364),y=e(44095),k=e(3619),Z=e(9976),M=e(34957),P=e(94990),v=e(33130),ee=function(C){var z,B,U,ne=(0,g.useState)(),K=c()(ne,2),u=K[0],oe=K[1],ie=(0,g.useState)(),J=c()(ie,2),A=J[0],ae=J[1],se=(0,g.useState)(!0),Y=c()(se,2),N=Y[0],R=Y[1],re=(0,g.useState)(),V=c()(re,2),_=V[0],G=V[1],le=(0,g.useState)(),H=c()(le,2),T=H[0],de=H[1],ue=(0,g.useState)(),X=c()(ue,2),F=X[0],ce=X[1],ge=(0,g.useState)(),$=c()(ge,2),j=$[0],Q=$[1],q=(0,g.useRef)();function _e(a,S,l,x){return{name:"button",args:{markup:[{tagName:"circle",selector:"button",attrs:{r:14,x:0,y:0,stroke:S.success?"#52C41A":"red","stroke-width":5-l<1?1:5-l,fill:"white",cursor:"pointer"}},{tagName:"text",textContent:a,selector:"icon",attrs:{"font-size":20-l<12?12:20-l,"text-anchor":"middle","pointer-events":"none",y:"0.3em"}}],x:(x-1)*28,y:0,onClick:function(s){var W=s.view,he=W.cell;Q(he),R(!1),G(S)}}}}(0,g.useEffect)(function(){F&&(u==null||u.centerCell(F))},[F,u]),(0,g.useEffect)(function(){var a=u==null?void 0:u.getNodes().find(function(S){return S.id==C.nextId});a==null||a.attr("body/fill","red"),ce(a)},[C.nextId]),(0,g.useEffect)(function(){var a;u==null||(a=u.getNodes().find(function(S){return S.id==C.nextId}))===null||a===void 0||a.attr("body/fill","red")},[u]),(0,g.useEffect)(function(){C.config&&ae(C.config)},[C.config]),(0,g.useEffect)(function(){if(console.log("props.logicLog",C.logicLog),C.logicLog){var a=C.logicLog;de(C.logicLog),u==null||u.fromJSON(A==null?void 0:A.visualConfig);var S,l={};a&&a.itemLogs&&(a.itemLogs.forEach(function(x,L){var s=u==null?void 0:u.getNodes().find(function(W){return W.id==x.config.id});console.log("\u9009\u4E2D\u7684\u8282\u70B9"),console.log(s),s&&(s.addTools({name:"boundary",args:{attrs:{stroke:"red",strokeWidth:1.5,rx:5,ry:5}}}),S=s),l[s==null?void 0:s.id]?l[s==null?void 0:s.id]+=1:l[s==null?void 0:s.id]=1,s==null||s.addTools(_e(L,x,L,l[s==null?void 0:s.id]))}),u==null||u.centerCell(S),G({}),Q({}))}},[C.logicLog,u]),(0,g.useEffect)(function(){if(A){try{var a=(0,d.K)(),S=a.Shapes;(0,y.m)(S)}catch(x){console.error("\u6CE8\u518C\u8282\u70B9\u51FA\u9519\uFF1A"),console.error(x)}var l=new n.kJ({container:q.current,embedding:{enabled:!0,validate:function(L){return L.child.setData({hoverNode:L.parent}),!0}},mousewheel:{enabled:!0,modifiers:"ctrl",minScale:.5,maxScale:3},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:15}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,allowMulti:!0,snap:{radius:20},createEdge:function(){return new n.bn.kS({tools:[{name:"edge-editor",args:{attrs:{backgroundColor:"#fff"}}}],zIndex:0})},validateConnection:function(L){var s=L.targetMagnet;return!!s}},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5F95FF",stroke:"#5F95FF"}}}},background:{color:"#F2F7FA"},grid:!0});l.use(new t.H({enabled:!0,sharp:!0})).use(new f.A({enabled:!0})).use(new r.Y({enabled:!0,multiple:!0,strict:!0,rubberband:!0,movable:!0,showNodeSelectionBox:!0,pointerEvents:"none"})).use(new i.T({enabled:!0})).use(new o.N),l.on("edge:dblclick",function(){}),l.on("edge:mouseenter",function(){}),l.on("edge:mouseleave",function(){}),l.on("node:moved",function(){}),l.on("node:mouseenter",function(){}),l.on("node:mouseleave",function(){}),l.on("node:added",function(){}),l.on("node:dblclick",function(x){var L=x.node}),l.on("blank:dblclick",function(x){var L=x.x,s=x.y}),l.fromJSON(A.visualConfig),(0,k.V)(l),oe(l)}},[A]);var fe=[{key:"debug-node-input",label:"\u8282\u70B9\u5165\u51FA\u53C2",children:(0,v.jsxs)("div",{children:[(0,v.jsx)(P.Z,{formId:"debug-node-input",values:{success:_==null?void 0:_.success,msg:_==null?void 0:_.msg,returnData:_==null?void 0:_.returnData,body:_==null||(z=_.configInstance)===null||z===void 0?void 0:z.body},onSubmit:function(){}}),(0,v.jsx)(D.Z.Text,{style:{marginLeft:"15px"},copyable:{tooltips:["\u590D\u5236\u8282\u70B9\u7F16\u53F7","\u590D\u5236\u6210\u529F!"],text:j==null?void 0:j.id},children:"\u8282\u70B9\u7F16\u53F7"})]})},{key:"config",label:"\u8282\u70B9\u914D\u7F6E",children:(0,v.jsx)(M.Z,{onSubmit:function(){},editNode:j})},{key:"configIns",label:"\u8282\u70B9\u5B9E\u4F8B",children:(0,v.jsx)(P.Z,{formId:(_==null||(B=_.config)===null||B===void 0?void 0:B.type)||"",values:_==null?void 0:_.configInstance,onSubmit:function(){}})},{key:"debug-context",label:"\u6267\u884C\u4E0A\u4E0B\u6587",children:(0,v.jsx)(P.Z,{formId:"debug-context",values:{varsJson:T==null?void 0:T.varsJson,paramsJson:T==null?void 0:T.paramsJson,varsJsonEnd:T==null?void 0:T.varsJsonEnd},onSubmit:function(){}})}];return(0,v.jsxs)(h.Z,{style:{margin:0,height:"100vh"},children:[(0,v.jsxs)(h.Z,{children:[(0,v.jsxs)(h.Z.Header,{style:{backgroundColor:"white",padding:0},children:[(U=C.btns)===null||U===void 0?void 0:U.map(function(a){return a}),(0,v.jsx)(p.ZP,{type:"text",icon:N?(0,v.jsx)(E.Z,{}):(0,v.jsx)(m.Z,{}),onClick:function(){R(!N)},style:{float:"right",right:"16px",fontSize:"16px",width:64,height:64}})]}),(0,v.jsx)(h.Z.Content,{className:"app-content",children:(0,v.jsx)(Z.Z,{ref:q})})]}),(0,v.jsxs)(h.Z.Sider,{theme:"light",collapsed:N,collapsedWidth:0,style:{overflow:"scroll"},width:500,children:[(0,v.jsx)(I.Z,{items:fe,defaultActiveKey:"inout"}),(0,v.jsx)(p.ZP,{type:"text",onClick:function(){R(!N)},style:{position:"absolute",top:0,right:0,fontSize:"16px",width:64,height:64},children:"x"})]})]})},te=ee},9364:function(O,w,e){e.d(w,{K:function(){return r}});var b=e(93525),c=e.n(b),E=e(57213),m=e.n(E),n=e(12490),f=e(2325),o=e(42651);function r(t,i,D){var h=50,p=50,I={body:{}},g=[new o.Z({shape:"circle",width:h,height:p,attrs:{body:m()(m()({},I.body),{},{fill:"white"}),text:{text:"\u5F00\u59CB",fontSize:12}},markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}],ports:n.Tt,data:{config:{type:"start"}},_groups:["ctrl"]}),new o.Z({shape:"circle",width:h,height:p,attrs:{body:m()(m()({},I.body),{},{fill:"white"}),text:{text:"\u4EA4\u4E92\u70B9",fontSize:12}},markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}],ports:n.Tt,data:{config:{type:"wait-for-continue"}},_groups:["ctrl"]}),new o.Z({shape:"ExtSharp",width:50,height:p,label:"switch",attrs:{image:{"xlink:href":"/logic/icons/switch.svg",width:45,x:1,y:2},text:{text:"switch",refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"switch"}},ports:n.Tt,_groups:["ctrl"]}),new o.Z({shape:"ExtSharp",width:h,height:p,attrs:{image:{"xlink:href":"/logic/icons/text.svg",width:30,x:8,y:10},text:{text:"case",refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"switch-case"}},ports:n.Tt,_groups:["ctrl"]}),new o.Z({shape:"ExtSharp",width:50,height:p,attrs:{image:{"xlink:href":"/logic/icons/text.svg",width:30,x:8,y:10},text:{text:"default",refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"switch-default"}},ports:n.Tt,_groups:["ctrl"]}),new o.Z({shape:"ExtSharp",width:h,height:p,attrs:{image:{"xlink:href":"/logic/icons/delay.svg",width:30,x:8,y:10},text:{text:"\u7B49\u5F85",refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"wait",timeout:"2000"}},ports:n.Tt,_groups:["ctrl"]}),new o.Z({shape:"ExtSharp",body:{rx:6,ry:6,fill:"#0484fb",stroke:"#0484fb",strokeWidth:1,refWidth:1,refHeight:1},attrs:{text:{text:"http\u8BF7\u6C42"},image:{"xlink:href":"/logic/icons/http.svg",width:20,x:2,y:2}},data:{config:{type:"http",method:"POST"}},ports:n.Tt,_groups:["ctrl"]}),new o.Z({shape:"ExtSharp",ports:n.Tt,attrs:{image:{width:15,x:2,y:2,"xlink:href":"/logic/icons/code.svg"},text:{text:"js\u811A\u672C"}},data:{config:{type:"js"}},_groups:["ctrl"]}),new o.Z({shape:"ExtSharp",ports:n.Tt,attrs:{image:{width:15,x:2,y:2,"xlink:href":"/logic/icons/java.svg"},text:{text:"java\u65B9\u6CD5"}},data:{config:{type:"java"}},_groups:["ctrl"]}),new o.Z({shape:"ExtSharp",ports:n.Tt,attrs:{image:{width:15,x:2,y:2,"xlink:href":"/logic/icons/CarbonSubflowLocal.svg"},text:{text:"\u590D\u7528\u903B\u8F91"}},data:{config:{type:"sub-logic"}},_groups:["ctrl"]})];t&&t.length>0&&Array.prototype.push.apply(g,t);var d=c()(f.C.values());return{Nodes:g,Shapes:d}}}}]);
