(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[1415],{12345:function(qe,pt,oe){"use strict";oe.d(pt,{Z:function(){return be}});var ee=oe(56920),Zt=oe(87363),At={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M176 511a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0zm280 0a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"ellipsis",theme:"outlined"},nt=At,jt=oe(9462),bt=function(Vn,Ot){return Zt.createElement(jt.Z,(0,ee.Z)({},Vn,{ref:Ot,icon:nt}))},be=Zt.forwardRef(bt)},53301:function(qe,pt,oe){"use strict";oe.d(pt,{Qt:function(){return jt},Uw:function(){return nt},fJ:function(){return At},ly:function(){return bt},oN:function(){return Je}});var ee=oe(27183),Zt=oe(92599);const At=new ee.E4("antSlideUpIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1}}),nt=new ee.E4("antSlideUpOut",{"0%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0}}),jt=new ee.E4("antSlideDownIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1}}),bt=new ee.E4("antSlideDownOut",{"0%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0}}),be=new ee.E4("antSlideLeftIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1}}),_n=new ee.E4("antSlideLeftOut",{"0%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0}}),Vn=new ee.E4("antSlideRightIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1}}),Ot=new ee.E4("antSlideRightOut",{"0%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0}}),Bt={"slide-up":{inKeyframes:At,outKeyframes:nt},"slide-down":{inKeyframes:jt,outKeyframes:bt},"slide-left":{inKeyframes:be,outKeyframes:_n},"slide-right":{inKeyframes:Vn,outKeyframes:Ot}},Je=(hn,Rt)=>{const{antCls:yr}=hn,er=`${yr}-${Rt}`,{inKeyframes:Er,outKeyframes:Cn}=Bt[Rt];return[(0,Zt.R)(er,Er,Cn,hn.motionDurationMid),{[`
      ${er}-enter,
      ${er}-appear
    `]:{transform:"scale(0)",transformOrigin:"0% 0%",opacity:0,animationTimingFunction:hn.motionEaseOutQuint,["&-prepare"]:{transform:"scale(1)"}},[`${er}-leave`]:{animationTimingFunction:hn.motionEaseInQuint}}]}},91711:function(qe,pt,oe){"use strict";oe.d(pt,{Z:function(){return Gu}});var ee=oe(87363),Zt=oe(60859),At=oe(12345),nt=oe(56920),jt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M176 474h672q8 0 8 8v60q0 8-8 8H176q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},bt=jt,be=oe(9462),_n=function(C,Se){return ee.createElement(be.Z,(0,nt.Z)({},C,{ref:Se,icon:bt}))},Vn=ee.forwardRef(_n),Ot=oe(84875),Bt=oe.n(Ot),Je=oe(25940),hn=oe(93914),Rt=oe(90885),yr=oe(91744),er=oe(48385),Er=oe(96608),Cn=oe(28922),tr=oe(79681),Nr=(0,ee.createContext)(null),$r=ee.forwardRef(function(S,C){var Se=S.prefixCls,Ce=S.className,Ge=S.style,Oe=S.id,tt=S.active,it=S.tabKey,xt=S.children;return ee.createElement("div",{id:Oe&&"".concat(Oe,"-panel-").concat(it),role:"tabpanel",tabIndex:tt?0:-1,"aria-labelledby":Oe&&"".concat(Oe,"-tab-").concat(it),"aria-hidden":!tt,style:Ge,className:Bt()(Se,tt&&"".concat(Se,"-active"),Ce),ref:C},xt)}),go=$r,ro=["key","forceRender","style","className"];function bi(S){var C=S.id,Se=S.activeKey,Ce=S.animated,Ge=S.tabPosition,Oe=S.destroyInactiveTabPane,tt=ee.useContext(Nr),it=tt.prefixCls,xt=tt.tabs,Lt=Ce.tabPane,ln="".concat(it,"-tabpane");return ee.createElement("div",{className:Bt()("".concat(it,"-content-holder"))},ee.createElement("div",{className:Bt()("".concat(it,"-content"),"".concat(it,"-content-").concat(Ge),(0,Je.Z)({},"".concat(it,"-content-animated"),Lt))},xt.map(function(Mt){var nn=Mt.key,Xt=Mt.forceRender,rn=Mt.style,mn=Mt.className,Sn=(0,er.Z)(Mt,ro),gn=nn===Se;return ee.createElement(tr.ZP,(0,nt.Z)({key:nn,visible:gn,forceRender:Xt,removeOnLeave:!!Oe,leavedClassName:"".concat(ln,"-hidden")},Ce.tabPaneMotion),function(Mn,dn){var Yn=Mn.style,Fn=Mn.className;return ee.createElement(go,(0,nt.Z)({},Sn,{prefixCls:ln,id:C,tabKey:nn,animated:Lt,active:gn,style:(0,hn.Z)((0,hn.Z)({},rn),Yn),className:Bt()(mn,Fn),ref:dn}))})})))}var yo=oe(59816),ct=oe(92291),ar=oe(84036),jn=oe(75586),On={width:0,height:0,left:0,top:0};function Xe(S,C,Se){return(0,ee.useMemo)(function(){for(var Ce,Ge=new Map,Oe=C.get((Ce=S[0])===null||Ce===void 0?void 0:Ce.key)||On,tt=Oe.left+Oe.width,it=0;it<S.length;it+=1){var xt=S[it].key,Lt=C.get(xt);if(!Lt){var ln;Lt=C.get((ln=S[it-1])===null||ln===void 0?void 0:ln.key)||On}var Mt=Ge.get(xt)||(0,hn.Z)({},Lt);Mt.right=tt-Mt.left-Mt.width,Ge.set(xt,Mt)}return Ge},[S.map(function(Ce){return Ce.key}).join("_"),C,Se])}function Te(S,C){var Se=ee.useRef(S),Ce=ee.useState({}),Ge=(0,Rt.Z)(Ce,2),Oe=Ge[1];function tt(it){var xt=typeof it=="function"?it(Se.current):it;xt!==Se.current&&C(xt,Se.current),Se.current=xt,Oe({})}return[Se.current,tt]}var ke=.1,$e=.01,ft=20,st=Math.pow(.995,ft);function tn(S,C){var Se=(0,ee.useState)(),Ce=(0,Rt.Z)(Se,2),Ge=Ce[0],Oe=Ce[1],tt=(0,ee.useState)(0),it=(0,Rt.Z)(tt,2),xt=it[0],Lt=it[1],ln=(0,ee.useState)(0),Mt=(0,Rt.Z)(ln,2),nn=Mt[0],Xt=Mt[1],rn=(0,ee.useState)(),mn=(0,Rt.Z)(rn,2),Sn=mn[0],gn=mn[1],Mn=(0,ee.useRef)();function dn(Qt){var yn=Qt.touches[0],on=yn.screenX,wt=yn.screenY;Oe({x:on,y:wt}),window.clearInterval(Mn.current)}function Yn(Qt){if(Ge){Qt.preventDefault();var yn=Qt.touches[0],on=yn.screenX,wt=yn.screenY;Oe({x:on,y:wt});var kt=on-Ge.x,sn=wt-Ge.y;C(kt,sn);var Tn=Date.now();Lt(Tn),Xt(Tn-xt),gn({x:kt,y:sn})}}function Fn(){if(Ge&&(Oe(null),gn(null),Sn)){var Qt=Sn.x/nn,yn=Sn.y/nn,on=Math.abs(Qt),wt=Math.abs(yn);if(Math.max(on,wt)<ke)return;var kt=Qt,sn=yn;Mn.current=window.setInterval(function(){if(Math.abs(kt)<$e&&Math.abs(sn)<$e){window.clearInterval(Mn.current);return}kt*=st,sn*=st,C(kt*ft,sn*ft)},ft)}}var qt=(0,ee.useRef)();function bn(Qt){var yn=Qt.deltaX,on=Qt.deltaY,wt=0,kt=Math.abs(yn),sn=Math.abs(on);kt===sn?wt=qt.current==="x"?yn:on:kt>sn?(wt=yn,qt.current="x"):(wt=on,qt.current="y"),C(-wt,-wt)&&Qt.preventDefault()}var zn=(0,ee.useRef)(null);zn.current={onTouchStart:dn,onTouchMove:Yn,onTouchEnd:Fn,onWheel:bn},ee.useEffect(function(){function Qt(kt){zn.current.onTouchStart(kt)}function yn(kt){zn.current.onTouchMove(kt)}function on(kt){zn.current.onTouchEnd(kt)}function wt(kt){zn.current.onWheel(kt)}return document.addEventListener("touchmove",yn,{passive:!1}),document.addEventListener("touchend",on,{passive:!1}),S.current.addEventListener("touchstart",Qt,{passive:!1}),S.current.addEventListener("wheel",wt),function(){document.removeEventListener("touchmove",yn),document.removeEventListener("touchend",on)}},[])}var Kt=oe(42471);function fn(S){var C=(0,ee.useState)(0),Se=(0,Rt.Z)(C,2),Ce=Se[0],Ge=Se[1],Oe=(0,ee.useRef)(0),tt=(0,ee.useRef)();return tt.current=S,(0,Kt.o)(function(){var it;(it=tt.current)===null||it===void 0||it.call(tt)},[Ce]),function(){Oe.current===Ce&&(Oe.current+=1,Ge(Oe.current))}}function Wr(S){var C=(0,ee.useRef)([]),Se=(0,ee.useState)({}),Ce=(0,Rt.Z)(Se,2),Ge=Ce[1],Oe=(0,ee.useRef)(typeof S=="function"?S():S),tt=fn(function(){var xt=Oe.current;C.current.forEach(function(Lt){xt=Lt(xt)}),C.current=[],Oe.current=xt,Ge({})});function it(xt){C.current.push(xt),tt()}return[Oe.current,it]}var Ar={width:0,height:0,left:0,top:0,right:0};function Hr(S,C,Se,Ce,Ge,Oe,tt){var it=tt.tabs,xt=tt.tabPosition,Lt=tt.rtl,ln,Mt,nn;return["top","bottom"].includes(xt)?(ln="width",Mt=Lt?"right":"left",nn=Math.abs(Se)):(ln="height",Mt="top",nn=-Se),(0,ee.useMemo)(function(){if(!it.length)return[0,0];for(var Xt=it.length,rn=Xt,mn=0;mn<Xt;mn+=1){var Sn=S.get(it[mn].key)||Ar;if(Sn[Mt]+Sn[ln]>nn+C){rn=mn-1;break}}for(var gn=0,Mn=Xt-1;Mn>=0;Mn-=1){var dn=S.get(it[Mn].key)||Ar;if(dn[Mt]<nn){gn=Mn+1;break}}return gn>=rn?[0,0]:[gn,rn]},[S,C,Ce,Ge,Oe,nn,xt,it.map(function(Xt){return Xt.key}).join("_"),Lt])}function Hi(S){var C;return S instanceof Map?(C={},S.forEach(function(Se,Ce){C[Ce]=Se})):C=S,JSON.stringify(C)}var sr="TABS_DQ";function Zi(S){return String(S).replace(/"/g,sr)}function xi(S,C,Se,Ce){return!(!Se||Ce||S===!1||S===void 0&&(C===!1||C===null))}function wi(S,C){var Se=S.prefixCls,Ce=S.editable,Ge=S.locale,Oe=S.style;return!Ce||Ce.showAdd===!1?null:ee.createElement("button",{ref:C,type:"button",className:"".concat(Se,"-nav-add"),style:Oe,"aria-label":(Ge==null?void 0:Ge.addAriaLabel)||"Add tab",onClick:function(it){Ce.onEdit("add",{event:it})}},Ce.addIcon||"+")}var ii=ee.forwardRef(wi),ji=ee.forwardRef(function(S,C){var Se=S.position,Ce=S.prefixCls,Ge=S.extra;if(!Ge)return null;var Oe,tt={};return(0,yr.Z)(Ge)==="object"&&!ee.isValidElement(Ge)?tt=Ge:tt.right=Ge,Se==="right"&&(Oe=tt.right),Se==="left"&&(Oe=tt.left),Oe?ee.createElement("div",{className:"".concat(Ce,"-extra-content"),ref:C},Oe):null}),ai=ji,si=oe(63504),nr=oe(21614),Rr=oe(83251);function ui(S,C){var Se=S.prefixCls,Ce=S.id,Ge=S.tabs,Oe=S.locale,tt=S.mobile,it=S.moreIcon,xt=it===void 0?"More":it,Lt=S.moreTransitionName,ln=S.style,Mt=S.className,nn=S.editable,Xt=S.tabBarGutter,rn=S.rtl,mn=S.removeAriaLabel,Sn=S.onTabClick,gn=S.getPopupContainer,Mn=S.popupClassName,dn=(0,ee.useState)(!1),Yn=(0,Rt.Z)(dn,2),Fn=Yn[0],qt=Yn[1],bn=(0,ee.useState)(null),zn=(0,Rt.Z)(bn,2),Qt=zn[0],yn=zn[1],on="".concat(Ce,"-more-popup"),wt="".concat(Se,"-dropdown"),kt=Qt!==null?"".concat(on,"-").concat(Qt):null,sn=Oe==null?void 0:Oe.dropdownAriaLabel;function Tn(un,kn){un.preventDefault(),un.stopPropagation(),nn.onEdit("remove",{key:kn,event:un})}var Gr=ee.createElement(nr.ZP,{onClick:function(kn){var Cr=kn.key,Pr=kn.domEvent;Sn(Cr,Pr),qt(!1)},prefixCls:"".concat(wt,"-menu"),id:on,tabIndex:-1,role:"listbox","aria-activedescendant":kt,selectedKeys:[Qt],"aria-label":sn!==void 0?sn:"expanded dropdown"},Ge.map(function(un){var kn=un.closable,Cr=un.disabled,Pr=un.closeIcon,wr=un.key,eo=un.label,so=xi(kn,Pr,nn,Cr);return ee.createElement(nr.sN,{key:wr,id:"".concat(on,"-").concat(wr),role:"option","aria-controls":Ce&&"".concat(Ce,"-panel-").concat(wr),disabled:Cr},ee.createElement("span",null,eo),so&&ee.createElement("button",{type:"button","aria-label":mn||"remove",tabIndex:0,className:"".concat(wt,"-menu-item-remove"),onClick:function(pr){pr.stopPropagation(),Tn(pr,wr)}},Pr||nn.removeIcon||"\xD7"))}));function Qr(un){for(var kn=Ge.filter(function(so){return!so.disabled}),Cr=kn.findIndex(function(so){return so.key===Qt})||0,Pr=kn.length,wr=0;wr<Pr;wr+=1){Cr=(Cr+un+Pr)%Pr;var eo=kn[Cr];if(!eo.disabled){yn(eo.key);return}}}function Jr(un){var kn=un.which;if(!Fn){[Rr.Z.DOWN,Rr.Z.SPACE,Rr.Z.ENTER].includes(kn)&&(qt(!0),un.preventDefault());return}switch(kn){case Rr.Z.UP:Qr(-1),un.preventDefault();break;case Rr.Z.DOWN:Qr(1),un.preventDefault();break;case Rr.Z.ESC:qt(!1);break;case Rr.Z.SPACE:case Rr.Z.ENTER:Qt!==null&&Sn(Qt,un);break}}(0,ee.useEffect)(function(){var un=document.getElementById(kt);un&&un.scrollIntoView&&un.scrollIntoView(!1)},[Qt]),(0,ee.useEffect)(function(){Fn||yn(null)},[Fn]);var xr=(0,Je.Z)({},rn?"marginRight":"marginLeft",Xt);Ge.length||(xr.visibility="hidden",xr.order=1);var Po=Bt()((0,Je.Z)({},"".concat(wt,"-rtl"),rn)),Fo=tt?null:ee.createElement(si.Z,{prefixCls:wt,overlay:Gr,trigger:["hover"],visible:Ge.length?Fn:!1,transitionName:Lt,onVisibleChange:qt,overlayClassName:Bt()(Po,Mn),mouseEnterDelay:.1,mouseLeaveDelay:.1,getPopupContainer:gn},ee.createElement("button",{type:"button",className:"".concat(Se,"-nav-more"),style:xr,tabIndex:-1,"aria-hidden":"true","aria-haspopup":"listbox","aria-controls":on,id:"".concat(Ce,"-more"),"aria-expanded":Fn,onKeyDown:Jr},xt));return ee.createElement("div",{className:Bt()("".concat(Se,"-nav-operations"),Mt),style:ln,ref:C},Fo,ee.createElement(ii,{prefixCls:Se,locale:Oe,editable:nn}))}var Yi=ee.memo(ee.forwardRef(ui),function(S,C){return C.tabMoving});function ci(S){var C,Se=S.prefixCls,Ce=S.id,Ge=S.active,Oe=S.tab,tt=Oe.key,it=Oe.label,xt=Oe.disabled,Lt=Oe.closeIcon,ln=S.closable,Mt=S.renderWrapper,nn=S.removeAriaLabel,Xt=S.editable,rn=S.onClick,mn=S.onFocus,Sn=S.style,gn="".concat(Se,"-tab"),Mn=xi(ln,Lt,Xt,xt);function dn(qt){xt||rn(qt)}function Yn(qt){qt.preventDefault(),qt.stopPropagation(),Xt.onEdit("remove",{key:tt,event:qt})}var Fn=ee.createElement("div",{key:tt,"data-node-key":Zi(tt),className:Bt()(gn,(C={},(0,Je.Z)(C,"".concat(gn,"-with-remove"),Mn),(0,Je.Z)(C,"".concat(gn,"-active"),Ge),(0,Je.Z)(C,"".concat(gn,"-disabled"),xt),C)),style:Sn,onClick:dn},ee.createElement("div",{role:"tab","aria-selected":Ge,id:Ce&&"".concat(Ce,"-tab-").concat(tt),className:"".concat(gn,"-btn"),"aria-controls":Ce&&"".concat(Ce,"-panel-").concat(tt),"aria-disabled":xt,tabIndex:xt?null:0,onClick:function(bn){bn.stopPropagation(),dn(bn)},onKeyDown:function(bn){[Rr.Z.SPACE,Rr.Z.ENTER].includes(bn.which)&&(bn.preventDefault(),dn(bn))},onFocus:mn},it),Mn&&ee.createElement("button",{type:"button","aria-label":nn||"remove",tabIndex:0,className:"".concat(gn,"-remove"),onClick:function(bn){bn.stopPropagation(),Yn(bn)}},Lt||Xt.removeIcon||"\xD7"));return Mt?Mt(Fn):Fn}var N=ci,Mo=oe(4447),rr=function(C){var Se=C.activeTabOffset,Ce=C.horizontal,Ge=C.rtl,Oe=C.indicatorSize,tt=(0,ee.useState)(),it=(0,Rt.Z)(tt,2),xt=it[0],Lt=it[1],ln=(0,ee.useRef)(),Mt=function(rn){return typeof Oe=="function"?Oe(rn):typeof Oe=="number"?Oe:rn};function nn(){Mo.Z.cancel(ln.current)}return(0,ee.useEffect)(function(){var Xt={};return Se&&(Ce?(Ge?(Xt.right=Se.right+Se.width/2,Xt.transform="translateX(50%)"):(Xt.left=Se.left+Se.width/2,Xt.transform="translateX(-50%)"),Xt.width=Mt(Se.width)):(Xt.top=Se.top+Se.height/2,Xt.transform="translateY(-50%)",Xt.height=Mt(Se.height))),nn(),ln.current=(0,Mo.Z)(function(){Lt(Xt)}),nn},[Se,Ce,Ge,Oe]),{style:xt}},Ki=rr,qr=function(C){var Se=C.current||{},Ce=Se.offsetWidth,Ge=Ce===void 0?0:Ce,Oe=Se.offsetHeight,tt=Oe===void 0?0:Oe;return[Ge,tt]},Dr=function(C,Se){return C[Se?0:1]};function qi(S,C){var Se,Ce=ee.useContext(Nr),Ge=Ce.prefixCls,Oe=Ce.tabs,tt=S.className,it=S.style,xt=S.id,Lt=S.animated,ln=S.activeKey,Mt=S.rtl,nn=S.extra,Xt=S.editable,rn=S.locale,mn=S.tabPosition,Sn=S.tabBarGutter,gn=S.children,Mn=S.onTabClick,dn=S.onTabScroll,Yn=S.indicatorSize,Fn=(0,ee.useRef)(),qt=(0,ee.useRef)(),bn=(0,ee.useRef)(),zn=(0,ee.useRef)(),Qt=(0,ee.useRef)(),yn=(0,ee.useRef)(),on=(0,ee.useRef)(),wt=mn==="top"||mn==="bottom",kt=Te(0,function(pn,$t){wt&&dn&&dn({direction:pn>$t?"left":"right"})}),sn=(0,Rt.Z)(kt,2),Tn=sn[0],Gr=sn[1],Qr=Te(0,function(pn,$t){!wt&&dn&&dn({direction:pn>$t?"top":"bottom"})}),Jr=(0,Rt.Z)(Qr,2),xr=Jr[0],Po=Jr[1],Fo=(0,ee.useState)([0,0]),un=(0,Rt.Z)(Fo,2),kn=un[0],Cr=un[1],Pr=(0,ee.useState)([0,0]),wr=(0,Rt.Z)(Pr,2),eo=wr[0],so=wr[1],uo=(0,ee.useState)([0,0]),pr=(0,Rt.Z)(uo,2),Ts=pr[0],ta=pr[1],Ni=(0,ee.useState)([0,0]),co=(0,Rt.Z)(Ni,2),na=co[0],In=co[1],fo=Wr(new Map),zo=(0,Rt.Z)(fo,2),Pa=zo[0],bo=zo[1],Bo=Xe(Oe,Pa,eo[0]),xo=Dr(kn,wt),Ai=Dr(eo,wt),ra=Dr(Ts,wt),Is=Dr(na,wt),Ns=xo<Ai+ra,Zr=Ns?xo-Is:xo-ra,Pu="".concat(Ge,"-nav-operations-hidden"),wo=0,Uo=0;wt&&Mt?(wo=0,Uo=Math.max(0,Ai-Zr)):(wo=Math.min(0,Zr-Ai),Uo=0);function _o(pn){return pn<wo?wo:pn>Uo?Uo:pn}var As=(0,ee.useRef)(),Fu=(0,ee.useState)(),So=(0,Rt.Z)(Fu,2),oa=So[0],Vo=So[1];function ia(){Vo(Date.now())}function lo(){window.clearTimeout(As.current)}tn(zn,function(pn,$t){function Kn(qn,Fr){qn(function(zr){var Bu=_o(zr+Fr);return Bu})}return Ns?(wt?Kn(Gr,pn):Kn(Po,$t),lo(),ia(),!0):!1}),(0,ee.useEffect)(function(){return lo(),oa&&(As.current=window.setTimeout(function(){Vo(0)},100)),lo},[oa]);var Rs=Hr(Bo,Zr,wt?Tn:xr,Ai,ra,Is,(0,hn.Z)((0,hn.Z)({},S),{},{tabs:Oe})),To=(0,Rt.Z)(Rs,2),Fa=To[0],zu=To[1],Ds=(0,ar.Z)(function(){var pn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ln,$t=Bo.get(pn)||{width:0,height:0,left:0,right:0,top:0};if(wt){var Kn=Tn;Mt?$t.right<Tn?Kn=$t.right:$t.right+$t.width>Tn+Zr&&(Kn=$t.right+$t.width-Zr):$t.left<-Tn?Kn=-$t.left:$t.left+$t.width>-Tn+Zr&&(Kn=-($t.left+$t.width-Zr)),Po(0),Gr(_o(Kn))}else{var qn=xr;$t.top<-xr?qn=-$t.top:$t.top+$t.height>-xr+Zr&&(qn=-($t.top+$t.height-Zr)),Gr(0),Po(_o(qn))}}),Ri={};mn==="top"||mn==="bottom"?Ri[Mt?"marginRight":"marginLeft"]=Sn:Ri.marginTop=Sn;var za=Oe.map(function(pn,$t){var Kn=pn.key;return ee.createElement(N,{id:xt,prefixCls:Ge,key:Kn,tab:pn,style:$t===0?void 0:Ri,closable:pn.closable,editable:Xt,active:Kn===ln,renderWrapper:gn,removeAriaLabel:rn==null?void 0:rn.removeAriaLabel,onClick:function(Fr){Mn(Kn,Fr)},onFocus:function(){Ds(Kn),ia(),zn.current&&(Mt||(zn.current.scrollLeft=0),zn.current.scrollTop=0)}})}),Cs=function(){return bo(function(){var $t=new Map;return Oe.forEach(function(Kn){var qn,Fr=Kn.key,zr=(qn=Qt.current)===null||qn===void 0?void 0:qn.querySelector('[data-node-key="'.concat(Zi(Fr),'"]'));zr&&$t.set(Fr,{width:zr.offsetWidth,height:zr.offsetHeight,left:zr.offsetLeft,top:zr.offsetTop})}),$t})};(0,ee.useEffect)(function(){Cs()},[Oe.map(function(pn){return pn.key}).join("_")]);var aa=fn(function(){var pn=qr(Fn),$t=qr(qt),Kn=qr(bn);Cr([pn[0]-$t[0]-Kn[0],pn[1]-$t[1]-Kn[1]]);var qn=qr(on);ta(qn);var Fr=qr(yn);In(Fr);var zr=qr(Qt);so([zr[0]-qn[0],zr[1]-qn[1]]),Cs()}),Ba=Oe.slice(0,Fa),Nn=Oe.slice(zu+1),Ua=[].concat((0,yo.Z)(Ba),(0,yo.Z)(Nn)),sa=Bo.get(ln),jr=Ki({activeTabOffset:sa,horizontal:wt,rtl:Mt,indicatorSize:Yn}),Va=jr.style;(0,ee.useEffect)(function(){Ds()},[ln,wo,Uo,Hi(sa),Hi(Bo),wt]),(0,ee.useEffect)(function(){aa()},[Mt]);var Di=!!Ua.length,Yr="".concat(Ge,"-nav-wrap"),Ci,li,di,Xo;return wt?Mt?(li=Tn>0,Ci=Tn!==Uo):(Ci=Tn<0,li=Tn!==wo):(di=xr<0,Xo=xr!==wo),ee.createElement(ct.Z,{onResize:aa},ee.createElement("div",{ref:(0,jn.x1)(C,Fn),role:"tablist",className:Bt()("".concat(Ge,"-nav"),tt),style:it,onKeyDown:function(){ia()}},ee.createElement(ai,{ref:qt,position:"left",extra:nn,prefixCls:Ge}),ee.createElement(ct.Z,{onResize:aa},ee.createElement("div",{className:Bt()(Yr,(Se={},(0,Je.Z)(Se,"".concat(Yr,"-ping-left"),Ci),(0,Je.Z)(Se,"".concat(Yr,"-ping-right"),li),(0,Je.Z)(Se,"".concat(Yr,"-ping-top"),di),(0,Je.Z)(Se,"".concat(Yr,"-ping-bottom"),Xo),Se)),ref:zn},ee.createElement(ct.Z,{onResize:aa},ee.createElement("div",{ref:Qt,className:"".concat(Ge,"-nav-list"),style:{transform:"translate(".concat(Tn,"px, ").concat(xr,"px)"),transition:oa?"none":void 0}},za,ee.createElement(ii,{ref:on,prefixCls:Ge,locale:rn,editable:Xt,style:(0,hn.Z)((0,hn.Z)({},za.length===0?void 0:Ri),{},{visibility:Di?"hidden":null})}),ee.createElement("div",{className:Bt()("".concat(Ge,"-ink-bar"),(0,Je.Z)({},"".concat(Ge,"-ink-bar-animated"),Lt.inkBar)),style:Va}))))),ee.createElement(Yi,(0,nt.Z)({},S,{removeAriaLabel:rn==null?void 0:rn.removeAriaLabel,ref:yn,prefixCls:Ge,tabs:Ua,className:!Di&&Pu,tabMoving:!!oa})),ee.createElement(ai,{ref:bn,position:"right",extra:nn,prefixCls:Ge})))}var oo=ee.forwardRef(qi),Qi=["renderTabBar"],_i=["label","key"];function La(S){var C=S.renderTabBar,Se=(0,er.Z)(S,Qi),Ce=ee.useContext(Nr),Ge=Ce.tabs;if(C){var Oe=(0,hn.Z)((0,hn.Z)({},Se),{},{panes:Ge.map(function(tt){var it=tt.label,xt=tt.key,Lt=(0,er.Z)(tt,_i);return ee.createElement(go,(0,nt.Z)({tab:it,key:xt,tabKey:xt},Lt))})});return C(Oe,oo)}return ee.createElement(oo,Se)}var ur=oe(29794);function En(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{inkBar:!0,tabPane:!1},C;return S===!1?C={inkBar:!1,tabPane:!1}:S===!0?C={inkBar:!0,tabPane:!1}:C=(0,hn.Z)({inkBar:!0},(0,yr.Z)(S)==="object"?S:{}),C.tabPaneMotion&&C.tabPane===void 0&&(C.tabPane=!0),!C.tabPaneMotion&&C.tabPane&&(C.tabPane=!1),C}var io=["id","prefixCls","className","items","direction","activeKey","defaultActiveKey","editable","animated","tabPosition","tabBarGutter","tabBarStyle","tabBarExtraContent","locale","moreIcon","moreTransitionName","destroyInactiveTabPane","renderTabBar","onChange","onTabClick","onTabScroll","getPopupContainer","popupClassName","indicatorSize"],br=0;function ao(S,C){var Se,Ce=S.id,Ge=S.prefixCls,Oe=Ge===void 0?"rc-tabs":Ge,tt=S.className,it=S.items,xt=S.direction,Lt=S.activeKey,ln=S.defaultActiveKey,Mt=S.editable,nn=S.animated,Xt=S.tabPosition,rn=Xt===void 0?"top":Xt,mn=S.tabBarGutter,Sn=S.tabBarStyle,gn=S.tabBarExtraContent,Mn=S.locale,dn=S.moreIcon,Yn=S.moreTransitionName,Fn=S.destroyInactiveTabPane,qt=S.renderTabBar,bn=S.onChange,zn=S.onTabClick,Qt=S.onTabScroll,yn=S.getPopupContainer,on=S.popupClassName,wt=S.indicatorSize,kt=(0,er.Z)(S,io),sn=ee.useMemo(function(){return(it||[]).filter(function(In){return In&&(0,yr.Z)(In)==="object"&&"key"in In})},[it]),Tn=xt==="rtl",Gr=En(nn),Qr=(0,ee.useState)(!1),Jr=(0,Rt.Z)(Qr,2),xr=Jr[0],Po=Jr[1];(0,ee.useEffect)(function(){Po((0,Er.Z)())},[]);var Fo=(0,Cn.Z)(function(){var In;return(In=sn[0])===null||In===void 0?void 0:In.key},{value:Lt,defaultValue:ln}),un=(0,Rt.Z)(Fo,2),kn=un[0],Cr=un[1],Pr=(0,ee.useState)(function(){return sn.findIndex(function(In){return In.key===kn})}),wr=(0,Rt.Z)(Pr,2),eo=wr[0],so=wr[1];(0,ee.useEffect)(function(){var In=sn.findIndex(function(zo){return zo.key===kn});if(In===-1){var fo;In=Math.max(0,Math.min(eo,sn.length-1)),Cr((fo=sn[In])===null||fo===void 0?void 0:fo.key)}so(In)},[sn.map(function(In){return In.key}).join("_"),kn,eo]);var uo=(0,Cn.Z)(null,{value:Ce}),pr=(0,Rt.Z)(uo,2),Ts=pr[0],ta=pr[1];(0,ee.useEffect)(function(){Ce||(ta("rc-tabs-".concat(br)),br+=1)},[]);function Ni(In,fo){zn==null||zn(In,fo);var zo=In!==kn;Cr(In),zo&&(bn==null||bn(In))}var co={id:Ts,activeKey:kn,animated:Gr,tabPosition:rn,rtl:Tn,mobile:xr},na=(0,hn.Z)((0,hn.Z)({},co),{},{editable:Mt,locale:Mn,moreIcon:dn,moreTransitionName:Yn,tabBarGutter:mn,onTabClick:Ni,onTabScroll:Qt,extra:gn,style:Sn,panes:null,getPopupContainer:yn,popupClassName:on,indicatorSize:wt});return ee.createElement(Nr.Provider,{value:{tabs:sn,prefixCls:Oe}},ee.createElement("div",(0,nt.Z)({ref:C,id:Ce,className:Bt()(Oe,"".concat(Oe,"-").concat(rn),(Se={},(0,Je.Z)(Se,"".concat(Oe,"-mobile"),xr),(0,Je.Z)(Se,"".concat(Oe,"-editable"),Mt),(0,Je.Z)(Se,"".concat(Oe,"-rtl"),Tn),Se),tt)},kt),ee.createElement(La,(0,nt.Z)({},na,{renderTabBar:qt})),ee.createElement(bi,(0,nt.Z)({destroyInactiveTabPane:Fn},co,{animated:Gr}))))}var Iu=ee.forwardRef(ao),Nu=Iu,bs=Nu,Au=oe(88596),ko=oe(9384),fi=oe(75079);const Si={motionAppear:!1,motionEnter:!0,motionLeave:!0};function xs(S){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{inkBar:!0,tabPane:!1},Se;return C===!1?Se={inkBar:!1,tabPane:!1}:C===!0?Se={inkBar:!0,tabPane:!0}:Se=Object.assign({inkBar:!0},typeof C=="object"?C:{}),Se.tabPane&&(Se.tabPaneMotion=Object.assign(Object.assign({},Si),{motionName:(0,fi.m)(S,"switch")})),Se}var cr=oe(82149),Ti=function(S,C){var Se={};for(var Ce in S)Object.prototype.hasOwnProperty.call(S,Ce)&&C.indexOf(Ce)<0&&(Se[Ce]=S[Ce]);if(S!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ge=0,Ce=Object.getOwnPropertySymbols(S);Ge<Ce.length;Ge++)C.indexOf(Ce[Ge])<0&&Object.prototype.propertyIsEnumerable.call(S,Ce[Ge])&&(Se[Ce[Ge]]=S[Ce[Ge]]);return Se};function Ji(S){return S.filter(C=>C)}function Go(S,C){if(S)return S;const Se=(0,cr.Z)(C).map(Ce=>{if(ee.isValidElement(Ce)){const{key:Ge,props:Oe}=Ce,tt=Oe||{},{tab:it}=tt,xt=Ti(tt,["tab"]);return Object.assign(Object.assign({key:String(Ge)},xt),{label:it})}return null});return Ji(Se)}var Eo=oe(91918),Ii=oe(79987),ws=oe(48826),Ma=oe(53301),ea=S=>{const{componentCls:C,motionDurationSlow:Se}=S;return[{[C]:{[`${C}-switch`]:{"&-appear, &-enter":{transition:"none","&-start":{opacity:0},"&-active":{opacity:1,transition:`opacity ${Se}`}},"&-leave":{position:"absolute",transition:"none",inset:0,"&-start":{opacity:1},"&-active":{opacity:0,transition:`opacity ${Se}`}}}}},[(0,Ma.oN)(S,"slide-up"),(0,Ma.oN)(S,"slide-down")]]};const ka=S=>{const{componentCls:C,tabsCardPadding:Se,cardBg:Ce,cardGutter:Ge,colorBorderSecondary:Oe,itemSelectedColor:tt}=S;return{[`${C}-card`]:{[`> ${C}-nav, > div > ${C}-nav`]:{[`${C}-tab`]:{margin:0,padding:Se,background:Ce,border:`${S.lineWidth}px ${S.lineType} ${Oe}`,transition:`all ${S.motionDurationSlow} ${S.motionEaseInOut}`},[`${C}-tab-active`]:{color:tt,background:S.colorBgContainer},[`${C}-ink-bar`]:{visibility:"hidden"}},[`&${C}-top, &${C}-bottom`]:{[`> ${C}-nav, > div > ${C}-nav`]:{[`${C}-tab + ${C}-tab`]:{marginLeft:{_skip_check_:!0,value:`${Ge}px`}}}},[`&${C}-top`]:{[`> ${C}-nav, > div > ${C}-nav`]:{[`${C}-tab`]:{borderRadius:`${S.borderRadiusLG}px ${S.borderRadiusLG}px 0 0`},[`${C}-tab-active`]:{borderBottomColor:S.colorBgContainer}}},[`&${C}-bottom`]:{[`> ${C}-nav, > div > ${C}-nav`]:{[`${C}-tab`]:{borderRadius:`0 0 ${S.borderRadiusLG}px ${S.borderRadiusLG}px`},[`${C}-tab-active`]:{borderTopColor:S.colorBgContainer}}},[`&${C}-left, &${C}-right`]:{[`> ${C}-nav, > div > ${C}-nav`]:{[`${C}-tab + ${C}-tab`]:{marginTop:`${Ge}px`}}},[`&${C}-left`]:{[`> ${C}-nav, > div > ${C}-nav`]:{[`${C}-tab`]:{borderRadius:{_skip_check_:!0,value:`${S.borderRadiusLG}px 0 0 ${S.borderRadiusLG}px`}},[`${C}-tab-active`]:{borderRightColor:{_skip_check_:!0,value:S.colorBgContainer}}}},[`&${C}-right`]:{[`> ${C}-nav, > div > ${C}-nav`]:{[`${C}-tab`]:{borderRadius:{_skip_check_:!0,value:`0 ${S.borderRadiusLG}px ${S.borderRadiusLG}px 0`}},[`${C}-tab-active`]:{borderLeftColor:{_skip_check_:!0,value:S.colorBgContainer}}}}}}},Ln=S=>{const{componentCls:C,itemHoverColor:Se,dropdownEdgeChildVerticalPadding:Ce}=S;return{[`${C}-dropdown`]:Object.assign(Object.assign({},(0,Eo.Wf)(S)),{position:"absolute",top:-9999,left:{_skip_check_:!0,value:-9999},zIndex:S.zIndexPopup,display:"block","&-hidden":{display:"none"},[`${C}-dropdown-menu`]:{maxHeight:S.tabsDropdownHeight,margin:0,padding:`${Ce}px 0`,overflowX:"hidden",overflowY:"auto",textAlign:{_skip_check_:!0,value:"left"},listStyleType:"none",backgroundColor:S.colorBgContainer,backgroundClip:"padding-box",borderRadius:S.borderRadiusLG,outline:"none",boxShadow:S.boxShadowSecondary,"&-item":Object.assign(Object.assign({},Eo.vS),{display:"flex",alignItems:"center",minWidth:S.tabsDropdownWidth,margin:0,padding:`${S.paddingXXS}px ${S.paddingSM}px`,color:S.colorText,fontWeight:"normal",fontSize:S.fontSize,lineHeight:S.lineHeight,cursor:"pointer",transition:`all ${S.motionDurationSlow}`,"> span":{flex:1,whiteSpace:"nowrap"},"&-remove":{flex:"none",marginLeft:{_skip_check_:!0,value:S.marginSM},color:S.colorTextDescription,fontSize:S.fontSizeSM,background:"transparent",border:0,cursor:"pointer","&:hover":{color:Se}},"&:hover":{background:S.controlItemBgHover},"&-disabled":{"&, &:hover":{color:S.colorTextDisabled,background:"transparent",cursor:"not-allowed"}}})}})}},_s=S=>{const{componentCls:C,margin:Se,colorBorderSecondary:Ce,horizontalMargin:Ge,verticalItemPadding:Oe,verticalItemMargin:tt}=S;return{[`${C}-top, ${C}-bottom`]:{flexDirection:"column",[`> ${C}-nav, > div > ${C}-nav`]:{margin:Ge,"&::before":{position:"absolute",right:{_skip_check_:!0,value:0},left:{_skip_check_:!0,value:0},borderBottom:`${S.lineWidth}px ${S.lineType} ${Ce}`,content:"''"},[`${C}-ink-bar`]:{height:S.lineWidthBold,"&-animated":{transition:`width ${S.motionDurationSlow}, left ${S.motionDurationSlow},
            right ${S.motionDurationSlow}`}},[`${C}-nav-wrap`]:{"&::before, &::after":{top:0,bottom:0,width:S.controlHeight},"&::before":{left:{_skip_check_:!0,value:0},boxShadow:S.boxShadowTabsOverflowLeft},"&::after":{right:{_skip_check_:!0,value:0},boxShadow:S.boxShadowTabsOverflowRight},[`&${C}-nav-wrap-ping-left::before`]:{opacity:1},[`&${C}-nav-wrap-ping-right::after`]:{opacity:1}}}},[`${C}-top`]:{[`> ${C}-nav,
        > div > ${C}-nav`]:{"&::before":{bottom:0},[`${C}-ink-bar`]:{bottom:0}}},[`${C}-bottom`]:{[`> ${C}-nav, > div > ${C}-nav`]:{order:1,marginTop:`${Se}px`,marginBottom:0,"&::before":{top:0},[`${C}-ink-bar`]:{top:0}},[`> ${C}-content-holder, > div > ${C}-content-holder`]:{order:0}},[`${C}-left, ${C}-right`]:{[`> ${C}-nav, > div > ${C}-nav`]:{flexDirection:"column",minWidth:S.controlHeight*1.25,[`${C}-tab`]:{padding:Oe,textAlign:"center"},[`${C}-tab + ${C}-tab`]:{margin:tt},[`${C}-nav-wrap`]:{flexDirection:"column","&::before, &::after":{right:{_skip_check_:!0,value:0},left:{_skip_check_:!0,value:0},height:S.controlHeight},"&::before":{top:0,boxShadow:S.boxShadowTabsOverflowTop},"&::after":{bottom:0,boxShadow:S.boxShadowTabsOverflowBottom},[`&${C}-nav-wrap-ping-top::before`]:{opacity:1},[`&${C}-nav-wrap-ping-bottom::after`]:{opacity:1}},[`${C}-ink-bar`]:{width:S.lineWidthBold,"&-animated":{transition:`height ${S.motionDurationSlow}, top ${S.motionDurationSlow}`}},[`${C}-nav-list, ${C}-nav-operations`]:{flex:"1 0 auto",flexDirection:"column"}}},[`${C}-left`]:{[`> ${C}-nav, > div > ${C}-nav`]:{[`${C}-ink-bar`]:{right:{_skip_check_:!0,value:0}}},[`> ${C}-content-holder, > div > ${C}-content-holder`]:{marginLeft:{_skip_check_:!0,value:`-${S.lineWidth}px`},borderLeft:{_skip_check_:!0,value:`${S.lineWidth}px ${S.lineType} ${S.colorBorder}`},[`> ${C}-content > ${C}-tabpane`]:{paddingLeft:{_skip_check_:!0,value:S.paddingLG}}}},[`${C}-right`]:{[`> ${C}-nav, > div > ${C}-nav`]:{order:1,[`${C}-ink-bar`]:{left:{_skip_check_:!0,value:0}}},[`> ${C}-content-holder, > div > ${C}-content-holder`]:{order:0,marginRight:{_skip_check_:!0,value:-S.lineWidth},borderRight:{_skip_check_:!0,value:`${S.lineWidth}px ${S.lineType} ${S.colorBorder}`},[`> ${C}-content > ${C}-tabpane`]:{paddingRight:{_skip_check_:!0,value:S.paddingLG}}}}}},Ru=S=>{const{componentCls:C,cardPaddingSM:Se,cardPaddingLG:Ce,horizontalItemPaddingSM:Ge,horizontalItemPaddingLG:Oe}=S;return{[C]:{"&-small":{[`> ${C}-nav`]:{[`${C}-tab`]:{padding:Ge,fontSize:S.titleFontSizeSM}}},"&-large":{[`> ${C}-nav`]:{[`${C}-tab`]:{padding:Oe,fontSize:S.titleFontSizeLG}}}},[`${C}-card`]:{[`&${C}-small`]:{[`> ${C}-nav`]:{[`${C}-tab`]:{padding:Se}},[`&${C}-bottom`]:{[`> ${C}-nav ${C}-tab`]:{borderRadius:`0 0 ${S.borderRadius}px ${S.borderRadius}px`}},[`&${C}-top`]:{[`> ${C}-nav ${C}-tab`]:{borderRadius:`${S.borderRadius}px ${S.borderRadius}px 0 0`}},[`&${C}-right`]:{[`> ${C}-nav ${C}-tab`]:{borderRadius:{_skip_check_:!0,value:`0 ${S.borderRadius}px ${S.borderRadius}px 0`}}},[`&${C}-left`]:{[`> ${C}-nav ${C}-tab`]:{borderRadius:{_skip_check_:!0,value:`${S.borderRadius}px 0 0 ${S.borderRadius}px`}}}},[`&${C}-large`]:{[`> ${C}-nav`]:{[`${C}-tab`]:{padding:Ce}}}}}},Du=S=>{const{componentCls:C,itemActiveColor:Se,itemHoverColor:Ce,iconCls:Ge,tabsHorizontalItemMargin:Oe,horizontalItemPadding:tt,itemSelectedColor:it,itemColor:xt}=S,Lt=`${C}-tab`;return{[Lt]:{position:"relative",WebkitTouchCallout:"none",WebkitTapHighlightColor:"transparent",display:"inline-flex",alignItems:"center",padding:tt,fontSize:S.titleFontSize,background:"transparent",border:0,outline:"none",cursor:"pointer",color:xt,"&-btn, &-remove":Object.assign({"&:focus:not(:focus-visible), &:active":{color:Se}},(0,Eo.Qy)(S)),"&-btn":{outline:"none",transition:"all 0.3s"},"&-remove":{flex:"none",marginRight:{_skip_check_:!0,value:-S.marginXXS},marginLeft:{_skip_check_:!0,value:S.marginXS},color:S.colorTextDescription,fontSize:S.fontSizeSM,background:"transparent",border:"none",outline:"none",cursor:"pointer",transition:`all ${S.motionDurationSlow}`,"&:hover":{color:S.colorTextHeading}},"&:hover":{color:Ce},[`&${Lt}-active ${Lt}-btn`]:{color:it,textShadow:S.tabsActiveTextShadow},[`&${Lt}-disabled`]:{color:S.colorTextDisabled,cursor:"not-allowed"},[`&${Lt}-disabled ${Lt}-btn, &${Lt}-disabled ${C}-remove`]:{"&:focus, &:active":{color:S.colorTextDisabled}},[`& ${Lt}-remove ${Ge}`]:{margin:0},[Ge]:{marginRight:{_skip_check_:!0,value:S.marginSM}}},[`${Lt} + ${Lt}`]:{margin:{_skip_check_:!0,value:Oe}}}},Ga=S=>{const{componentCls:C,tabsHorizontalItemMarginRTL:Se,iconCls:Ce,cardGutter:Ge}=S;return{[`${C}-rtl`]:{direction:"rtl",[`${C}-nav`]:{[`${C}-tab`]:{margin:{_skip_check_:!0,value:Se},[`${C}-tab:last-of-type`]:{marginLeft:{_skip_check_:!0,value:0}},[Ce]:{marginRight:{_skip_check_:!0,value:0},marginLeft:{_skip_check_:!0,value:`${S.marginSM}px`}},[`${C}-tab-remove`]:{marginRight:{_skip_check_:!0,value:`${S.marginXS}px`},marginLeft:{_skip_check_:!0,value:`-${S.marginXXS}px`},[Ce]:{margin:0}}}},[`&${C}-left`]:{[`> ${C}-nav`]:{order:1},[`> ${C}-content-holder`]:{order:0}},[`&${C}-right`]:{[`> ${C}-nav`]:{order:0},[`> ${C}-content-holder`]:{order:1}},[`&${C}-card${C}-top, &${C}-card${C}-bottom`]:{[`> ${C}-nav, > div > ${C}-nav`]:{[`${C}-tab + ${C}-tab`]:{marginRight:{_skip_check_:!0,value:Ge},marginLeft:{_skip_check_:!0,value:0}}}}},[`${C}-dropdown-rtl`]:{direction:"rtl"},[`${C}-menu-item`]:{[`${C}-dropdown-rtl`]:{textAlign:{_skip_check_:!0,value:"right"}}}}},Cu=S=>{const{componentCls:C,tabsCardPadding:Se,cardHeight:Ce,cardGutter:Ge,itemHoverColor:Oe,itemActiveColor:tt,colorBorderSecondary:it}=S;return{[C]:Object.assign(Object.assign(Object.assign(Object.assign({},(0,Eo.Wf)(S)),{display:"flex",[`> ${C}-nav, > div > ${C}-nav`]:{position:"relative",display:"flex",flex:"none",alignItems:"center",[`${C}-nav-wrap`]:{position:"relative",display:"flex",flex:"auto",alignSelf:"stretch",overflow:"hidden",whiteSpace:"nowrap",transform:"translate(0)","&::before, &::after":{position:"absolute",zIndex:1,opacity:0,transition:`opacity ${S.motionDurationSlow}`,content:"''",pointerEvents:"none"}},[`${C}-nav-list`]:{position:"relative",display:"flex",transition:`opacity ${S.motionDurationSlow}`},[`${C}-nav-operations`]:{display:"flex",alignSelf:"stretch"},[`${C}-nav-operations-hidden`]:{position:"absolute",visibility:"hidden",pointerEvents:"none"},[`${C}-nav-more`]:{position:"relative",padding:Se,background:"transparent",border:0,color:S.colorText,"&::after":{position:"absolute",right:{_skip_check_:!0,value:0},bottom:0,left:{_skip_check_:!0,value:0},height:S.controlHeightLG/8,transform:"translateY(100%)",content:"''"}},[`${C}-nav-add`]:Object.assign({minWidth:Ce,marginLeft:{_skip_check_:!0,value:Ge},padding:`0 ${S.paddingXS}px`,background:"transparent",border:`${S.lineWidth}px ${S.lineType} ${it}`,borderRadius:`${S.borderRadiusLG}px ${S.borderRadiusLG}px 0 0`,outline:"none",cursor:"pointer",color:S.colorText,transition:`all ${S.motionDurationSlow} ${S.motionEaseInOut}`,"&:hover":{color:Oe},"&:active, &:focus:not(:focus-visible)":{color:tt}},(0,Eo.Qy)(S))},[`${C}-extra-content`]:{flex:"none"},[`${C}-ink-bar`]:{position:"absolute",background:S.inkBarColor,pointerEvents:"none"}}),Du(S)),{[`${C}-content`]:{position:"relative",width:"100%"},[`${C}-content-holder`]:{flex:"auto",minWidth:0,minHeight:0},[`${C}-tabpane`]:{outline:"none","&-hidden":{display:"none"}}}),[`${C}-centered`]:{[`> ${C}-nav, > div > ${C}-nav`]:{[`${C}-nav-wrap`]:{[`&:not([class*='${C}-nav-wrap-ping'])`]:{justifyContent:"center"}}}}}};var Ou=(0,Ii.Z)("Tabs",S=>{const C=(0,ws.TS)(S,{tabsCardPadding:S.cardPadding||`${(S.cardHeight-Math.round(S.fontSize*S.lineHeight))/2-S.lineWidth}px ${S.padding}px`,dropdownEdgeChildVerticalPadding:S.paddingXXS,tabsActiveTextShadow:"0 0 0.25px currentcolor",tabsDropdownHeight:200,tabsDropdownWidth:120,tabsHorizontalItemMargin:`0 0 0 ${S.horizontalItemGutter}px`,tabsHorizontalItemMarginRTL:`0 0 0 ${S.horizontalItemGutter}px`});return[Ru(C),Ga(C),_s(C),Ln(C),ka(C),Cu(C),ea(C)]},S=>{const C=S.controlHeightLG;return{zIndexPopup:S.zIndexPopupBase+50,cardBg:S.colorFillAlter,cardHeight:C,cardPadding:"",cardPaddingSM:`${S.paddingXXS*1.5}px ${S.padding}px`,cardPaddingLG:`${S.paddingXS}px ${S.padding}px ${S.paddingXXS*1.5}px`,titleFontSize:S.fontSize,titleFontSizeLG:S.fontSizeLG,titleFontSizeSM:S.fontSize,inkBarColor:S.colorPrimary,horizontalMargin:`0 0 ${S.margin}px 0`,horizontalItemGutter:32,horizontalItemMargin:"",horizontalItemMarginRTL:"",horizontalItemPadding:`${S.paddingSM}px 0`,horizontalItemPaddingSM:`${S.paddingXS}px 0`,horizontalItemPaddingLG:`${S.padding}px 0`,verticalItemPadding:`${S.paddingXS}px ${S.paddingLG}px`,verticalItemMargin:`${S.margin}px 0 0 0`,itemColor:S.colorText,itemSelectedColor:S.colorPrimary,itemHoverColor:S.colorPrimaryHover,itemActiveColor:S.colorPrimaryActive,cardGutter:S.marginXXS/2}}),Mu=()=>null,ku=function(S,C){var Se={};for(var Ce in S)Object.prototype.hasOwnProperty.call(S,Ce)&&C.indexOf(Ce)<0&&(Se[Ce]=S[Ce]);if(S!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ge=0,Ce=Object.getOwnPropertySymbols(S);Ge<Ce.length;Ge++)C.indexOf(Ce[Ge])<0&&Object.prototype.propertyIsEnumerable.call(S,Ce[Ge])&&(Se[Ce[Ge]]=S[Ce[Ge]]);return Se};const Ss=S=>{const{type:C,className:Se,rootClassName:Ce,size:Ge,onEdit:Oe,hideAdd:tt,centered:it,addIcon:xt,popupClassName:Lt,children:ln,items:Mt,animated:nn,style:Xt,indicatorSize:rn}=S,mn=ku(S,["type","className","rootClassName","size","onEdit","hideAdd","centered","addIcon","popupClassName","children","items","animated","style","indicatorSize"]),{prefixCls:Sn,moreIcon:gn=ee.createElement(At.Z,null)}=mn,{direction:Mn,tabs:dn,getPrefixCls:Yn,getPopupContainer:Fn}=ee.useContext(Au.E_),qt=Yn("tabs",Sn),[bn,zn]=Ou(qt);let Qt;C==="editable-card"&&(Qt={onEdit:(Tn,Gr)=>{let{key:Qr,event:Jr}=Gr;Oe==null||Oe(Tn==="add"?Jr:Qr,Tn)},removeIcon:ee.createElement(Zt.Z,null),addIcon:xt||ee.createElement(Vn,null),showAdd:tt!==!0});const yn=Yn(),on=Go(Mt,ln),wt=xs(qt,nn),kt=(0,ko.Z)(Ge),sn=Object.assign(Object.assign({},dn==null?void 0:dn.style),Xt);return bn(ee.createElement(bs,Object.assign({direction:Mn,getPopupContainer:Fn,moreTransitionName:`${yn}-slide-up`},mn,{items:on,className:Bt()({[`${qt}-${kt}`]:kt,[`${qt}-card`]:["card","editable-card"].includes(C),[`${qt}-editable-card`]:C==="editable-card",[`${qt}-centered`]:it},dn==null?void 0:dn.className,Se,Ce,zn),popupClassName:Bt()(Lt,zn),style:sn,editable:Qt,moreIcon:gn,prefixCls:qt,animated:wt,indicatorSize:rn!=null?rn:dn==null?void 0:dn.indicatorSize})))};Ss.TabPane=Mu;var Gu=Ss},63504:function(qe,pt,oe){"use strict";oe.d(pt,{Z:function(){return yo}});var ee=oe(56920),Zt=oe(25940),At=oe(90885),nt=oe(48385),jt=oe(78323),bt=oe(84875),be=oe.n(bt),_n=oe(75586),Vn=oe(87363),Ot=oe.n(Vn),Bt=oe(83251),Je=oe(4447),hn=Bt.Z.ESC,Rt=Bt.Z.TAB;function yr(ct){var ar=ct.visible,jn=ct.triggerRef,On=ct.onVisibleChange,Xe=ct.autoFocus,Te=ct.overlayRef,ke=Vn.useRef(!1),$e=function(){if(ar){var Kt,fn;(Kt=jn.current)===null||Kt===void 0||(fn=Kt.focus)===null||fn===void 0||fn.call(Kt),On==null||On(!1)}},ft=function(){var Kt;return(Kt=Te.current)!==null&&Kt!==void 0&&Kt.focus?(Te.current.focus(),ke.current=!0,!0):!1},st=function(Kt){switch(Kt.keyCode){case hn:$e();break;case Rt:{var fn=!1;ke.current||(fn=ft()),fn?Kt.preventDefault():$e();break}}};Vn.useEffect(function(){return ar?(window.addEventListener("keydown",st),Xe&&(0,Je.Z)(ft,3),function(){window.removeEventListener("keydown",st),ke.current=!1}):function(){ke.current=!1}},[ar])}var er=(0,Vn.forwardRef)(function(ct,ar){var jn=ct.overlay,On=ct.arrow,Xe=ct.prefixCls,Te=(0,Vn.useMemo)(function(){var $e;return typeof jn=="function"?$e=jn():$e=jn,$e},[jn]),ke=(0,_n.sQ)(ar,Te==null?void 0:Te.ref);return Ot().createElement(Ot().Fragment,null,On&&Ot().createElement("div",{className:"".concat(Xe,"-arrow")}),Ot().cloneElement(Te,{ref:(0,_n.Yr)(Te)?ke:void 0}))}),Er=er,Cn={adjustX:1,adjustY:1},tr=[0,0],Nr={topLeft:{points:["bl","tl"],overflow:Cn,offset:[0,-4],targetOffset:tr},top:{points:["bc","tc"],overflow:Cn,offset:[0,-4],targetOffset:tr},topRight:{points:["br","tr"],overflow:Cn,offset:[0,-4],targetOffset:tr},bottomLeft:{points:["tl","bl"],overflow:Cn,offset:[0,4],targetOffset:tr},bottom:{points:["tc","bc"],overflow:Cn,offset:[0,4],targetOffset:tr},bottomRight:{points:["tr","br"],overflow:Cn,offset:[0,4],targetOffset:tr}},$r=Nr,go=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger","autoFocus","overlay","children","onVisibleChange"];function ro(ct,ar){var jn,On=ct.arrow,Xe=On===void 0?!1:On,Te=ct.prefixCls,ke=Te===void 0?"rc-dropdown":Te,$e=ct.transitionName,ft=ct.animation,st=ct.align,tn=ct.placement,Kt=tn===void 0?"bottomLeft":tn,fn=ct.placements,Wr=fn===void 0?$r:fn,Ar=ct.getPopupContainer,Hr=ct.showAction,Hi=ct.hideAction,sr=ct.overlayClassName,Zi=ct.overlayStyle,xi=ct.visible,wi=ct.trigger,ii=wi===void 0?["hover"]:wi,ji=ct.autoFocus,ai=ct.overlay,si=ct.children,nr=ct.onVisibleChange,Rr=(0,nt.Z)(ct,go),ui=Ot().useState(),Yi=(0,At.Z)(ui,2),ci=Yi[0],N=Yi[1],Mo="visible"in ct?xi:ci,rr=Ot().useRef(null),Ki=Ot().useRef(null),qr=Ot().useRef(null);Ot().useImperativeHandle(ar,function(){return rr.current});var Dr=function(br){N(br),nr==null||nr(br)};yr({visible:Mo,triggerRef:qr,onVisibleChange:Dr,autoFocus:ji,overlayRef:Ki});var qi=function(br){var ao=ct.onOverlayClick;N(!1),ao&&ao(br)},oo=function(){return Ot().createElement(Er,{ref:Ki,overlay:ai,prefixCls:ke,arrow:Xe})},Qi=function(){return typeof ai=="function"?oo:oo()},_i=function(){var br=ct.minOverlayWidthMatchTrigger,ao=ct.alignPoint;return"minOverlayWidthMatchTrigger"in ct?br:!ao},La=function(){var br=ct.openClassName;return br!==void 0?br:"".concat(ke,"-open")},ur=Ot().cloneElement(si,{className:be()((jn=si.props)===null||jn===void 0?void 0:jn.className,Mo&&La()),ref:(0,_n.Yr)(si)?(0,_n.sQ)(qr,si.ref):void 0}),En=Hi;return!En&&ii.indexOf("contextMenu")!==-1&&(En=["click"]),Ot().createElement(jt.Z,(0,ee.Z)({builtinPlacements:Wr},Rr,{prefixCls:ke,ref:rr,popupClassName:be()(sr,(0,Zt.Z)({},"".concat(ke,"-show-arrow"),Xe)),popupStyle:Zi,action:ii,showAction:Hr,hideAction:En,popupPlacement:Kt,popupAlign:st,popupTransitionName:$e,popupAnimation:ft,popupVisible:Mo,stretch:_i()?"minWidth":"",popup:Qi(),onPopupVisibleChange:Dr,onPopupClick:qi,getPopupContainer:Ar}),ur)}var bi=Ot().forwardRef(ro),yo=bi},14990:function(qe,pt,oe){"use strict";oe.d(pt,{Z:function(){return be}});var ee=oe(56159),Zt=oe(87363),At={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 000 13.8z"}}]},name:"menu-fold",theme:"outlined"},nt=At,jt=oe(92335),bt=function(Vn,Ot){return Zt.createElement(jt.Z,(0,ee.Z)({},Vn,{ref:Ot,icon:nt}))},be=Zt.forwardRef(bt)},22465:function(qe,pt,oe){"use strict";oe.d(pt,{Z:function(){return be}});var ee=oe(56159),Zt=oe(87363),At={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"}}]},name:"menu-unfold",theme:"outlined"},nt=At,jt=oe(92335),bt=function(Vn,Ot){return Zt.createElement(jt.Z,(0,ee.Z)({},Vn,{ref:Ot,icon:nt}))},be=Zt.forwardRef(bt)},17600:function(qe,pt,oe){"use strict";oe.d(pt,{Vq:function(){return Ks}});var ee={};oe.r(ee),oe.d(ee,{components:function(){return _o},dfs:function(){return So},dijkstra:function(){return Ri},dijkstraAll:function(){return Cs},findCycles:function(){return Ua},floydWarshall:function(){return Yc},isAcyclic:function(){return Uu},postorder:function(){return ua},preorder:function(){return $u},prim:function(){return wo},tarjan:function(){return Ba},topsort:function(){return Os}});const Zt=e=>typeof e=="string",At=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},nt=/-(\w)/g,jt=At(e=>e.replace(nt,(t,n)=>n?n.toUpperCase():"")),bt=Array.isArray,be=e=>typeof e=="number",_n=e=>Number.isNaN(Number(e)),Vn=e=>{const t=parseFloat(e);return _n(t)?e:t},Ot=e=>e!==null&&typeof e=="object",Bt=e=>{if(e===null)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof Array){const t=[];return e.forEach(n=>{t.push(n)}),t.map(n=>Bt(n))}if(typeof e=="object"&&Object.keys(e).length){const t=Object.assign({},e);return Object.keys(t).forEach(n=>{t[n]=Bt(t[n])}),t}return e},Je=(e,t)=>{const n=e[t];return Ot(n)?n.cell:n},hn=(e,t,n)=>{const r=[];for(let o=0;o<e;o++)r[o]={in:0,out:0,all:0};return n&&n.forEach(o=>{const i=Je(o,"source"),a=Je(o,"target");i&&r[t[i]]&&(r[t[i]].out+=1,r[t[i]].all+=1),a&&r[t[a]]&&(r[t[a]].in+=1,r[t[a]].all+=1)}),r},Rt=(e,t)=>{const n={};return e.forEach(r=>{n[r.id]={in:0,out:0,all:0}}),t&&t.forEach(r=>{const o=Je(r,"source"),i=Je(r,"target");o&&(n[o].out+=1,n[o].all+=1),i&&(n[i].in+=1,n[i].all+=1)}),n},yr=e=>{const t=[],n=e.length;for(let r=0;r<n;r+=1){t[r]=[];for(let o=0;o<n;o+=1)r===o?t[r][o]=0:e[r][o]===0||!e[r][o]?t[r][o]=1/0:t[r][o]=e[r][o]}for(let r=0;r<n;r+=1)for(let o=0;o<n;o+=1)for(let i=0;i<n;i+=1)t[o][i]>t[o][r]+t[r][i]&&(t[o][i]=t[o][r]+t[r][i]);return t},er=(e,t)=>{const{nodes:n,edges:r}=e,o=[],i={};if(!n)throw new Error("invalid nodes data!");return n&&n.forEach((a,s)=>{i[a.id]=s;const u=[];o.push(u)}),r==null||r.forEach(a=>{const s=Je(a,"source"),u=Je(a,"target"),c=i[s],f=i[u];c===void 0||f===void 0||(o[c][f]=1,t||(o[f][c]=1))}),o},Er=(e,t)=>{const n=[];return e.forEach(r=>{const o=[];r.forEach(i=>{o.push(i*t)}),n.push(o)}),n},Cn=(e,t)=>{if(e&&e.children){for(let n=e.children.length-1;n>=0;n--)if(!Cn(e.children[n],t))return}return!!t(e)},tr=(e,t)=>{typeof t=="function"&&Cn(e,t)},Nr=e=>{let t=1/0,n=1/0,r=-1/0,o=-1/0;return e.forEach(i=>{let a=i.size;bt(a)?a.length===1&&(a=[a[0],a[0]]):be(a)?a=[a,a]:(a===void 0||isNaN(a))&&(a=[30,30]);const s=[a[0]/2,a[1]/2],u=i.x-s[0],c=i.x+s[0],f=i.y-s[1],l=i.y+s[1];t>u&&(t=u),n>f&&(n=f),r<c&&(r=c),o<l&&(o=l)}),{minX:t,minY:n,maxX:r,maxY:o}},$r=e=>{const t={x:0,y:0};e.forEach(r=>{t.x+=r.x||0,t.y+=r.y||0});const n=e.length||1;return{x:t.x/n,y:t.y/n}},go=(e,t,n)=>{var r,o;return e==="source"?((r=n==null?void 0:n.find(i=>i.target===t.id))===null||r===void 0?void 0:r.source)||{}:((o=n==null?void 0:n.find(i=>i.source===t.id))===null||o===void 0?void 0:o.target)||{}},ro=(e,t,n)=>{let r=[];switch(e){case"source":r=n==null?void 0:n.filter(i=>i.source===t.id).map(i=>i.target);break;case"target":r=n==null?void 0:n.filter(i=>i.target===t.id).map(i=>i.source);break;case"both":r=n==null?void 0:n.filter(i=>i.source===t.id).map(i=>i.target).concat(n==null?void 0:n.filter(i=>i.target===t.id).map(i=>i.source));break;default:break}const o=new Set(r);return Array.from(o)},bi=(e,t,n,r,o)=>{const i=n[t]||"";let a=(r==null?void 0:r.filter(s=>s[t]===i))||[];return e==="leaf"&&(a=a.filter(s=>{var u,c;return((u=o[s.id])===null||u===void 0?void 0:u.in)===0||((c=o[s.id])===null||c===void 0?void 0:c.out)===0})),a},yo=(e,t,n,r,o,i)=>{const{in:a,out:s}=o[t.id];let u=t,c=[];a===0?(u=go("source",t,n),c=ro("both",u,n).map(l=>i[l])):s===0&&(u=go("target",t,n),c=ro("both",u,n).map(l=>i[l])),c=c.filter(l=>o[l.id]&&(o[l.id].in===0||o[l.id].out===0));const f=bi(e,r,t,c,o);return{coreNode:u,relativeLeafNodes:c,sameTypeLeafNodes:f}},ct=e=>typeof e=="function",ar=(e,t,n)=>{let r;return n?r=n:be(e)?r=()=>e:r=()=>t,r},jn=(e,t,n=!0)=>!t&&t!==0?r=>r.size?bt(r.size)?r.size[0]>r.size[1]?r.size[0]:r.size[1]:Ot(r.size)?r.size.width>r.size.height?r.size.width:r.size.height:r.size:e:ct(t)?t:be(t)?()=>t:bt(t)?()=>{if(n){const r=Math.max(...t);return isNaN(r)?e:r}return t}:Ot(t)?()=>{if(n){const r=Math.max(t.width,t.height);return isNaN(r)?e:r}return[t.width,t.height]}:()=>e,On=new Map,Xe=(e,t)=>{if(On.get(e)&&console.warn(`The layout with the name ${e} exists already, it will be overridden`),isObject(t)){class n extends Base{constructor(o){var i;super();const a=this,s={},u=Object.assign({},a.getDefaultCfg(),((i=t.getDefaultCfg)===null||i===void 0?void 0:i.call(t))||{});Object.assign(s,u,t,o),Object.keys(s).forEach(c=>{const f=s[c];a[c]=f})}}On.set(e,n)}else On.set(e,t);return On.get(e)},Te=e=>{On.has(e)&&On.delete(e)},ke=e=>On.has(e)?On.get(e):null;class $e{constructor(){this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.hiddenNodes=[],this.hiddenEdges=[],this.hiddenCombos=[],this.vedges=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=()=>{}}layout(t){return this.init(t),this.execute(!0)}init(t){this.nodes=t.nodes||[],this.edges=t.edges||[],this.combos=t.combos||[],this.comboEdges=t.comboEdges||[],this.hiddenNodes=t.hiddenNodes||[],this.hiddenEdges=t.hiddenEdges||[],this.hiddenCombos=t.hiddenCombos||[],this.vedges=t.vedges||[]}execute(t){}executeWithWorker(){}getDefaultCfg(){return{}}updateCfg(t){t&&Object.assign(this,t)}getType(){return"base"}destroy(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0}}class ft extends $e{constructor(t){super(),this.begin=[0,0],this.preventOverlap=!0,this.preventOverlapPadding=10,this.condense=!1,this.sortBy="degree",this.nodes=[],this.edges=[],this.width=300,this.height=300,this.row=0,this.col=0,this.cellWidth=0,this.cellHeight=0,this.cellUsed={},this.id2manPos={},this.onLayoutEnd=()=>{},this.updateCfg(t)}getDefaultCfg(){return{begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30}}execute(){const t=this,{nodes:n,edges:r,begin:o}=t,i=n.length;if(i===0)return t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:r};if(i===1)return n[0].x=o[0],n[0].y=o[1],t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:r};let{sortBy:a,width:s,height:u}=t;const{condense:c,preventOverlapPadding:f,preventOverlap:l,nodeSpacing:d,nodeSize:h}=t,v=[];n.forEach(y=>{v.push(y)});const m={};if(v.forEach((y,b)=>{m[y.id]=b}),(a==="degree"||!Zt(a)||v[0][a]===void 0)&&(a="degree",_n(n[0].degree))){const y=hn(v.length,m,r);v.forEach((b,w)=>{b.degree=y[w].all})}v.sort((y,b)=>b[a]-y[a]),!s&&typeof window!="undefined"&&(s=window.innerWidth),!u&&typeof window!="undefined"&&(u=window.innerHeight);const g=t.rows,E=t.cols!=null?t.cols:t.columns;if(t.cells=i,g!=null&&E!=null?(t.rows=g,t.cols=E):g!=null&&E==null?(t.rows=g,t.cols=Math.ceil(t.cells/t.rows)):g==null&&E!=null?(t.cols=E,t.rows=Math.ceil(t.cells/t.cols)):(t.splits=Math.sqrt(t.cells*t.height/t.width),t.rows=Math.round(t.splits),t.cols=Math.round(t.width/t.height*t.splits)),t.rows=Math.max(t.rows,1),t.cols=Math.max(t.cols,1),t.cols*t.rows>t.cells){const y=t.small(),b=t.large();(y-1)*b>=t.cells?t.small(y-1):(b-1)*y>=t.cells&&t.large(b-1)}else for(;t.cols*t.rows<t.cells;){const y=t.small(),b=t.large();(b+1)*y>=t.cells?t.large(b+1):t.small(y+1)}if(t.cellWidth=s/t.cols,t.cellHeight=u/t.rows,c&&(t.cellWidth=0,t.cellHeight=0),l||d){const y=jn(10,d),b=jn(30,h,!1);v.forEach(w=>{(!w.x||!w.y)&&(w.x=0,w.y=0);const T=b(w)||30;let $,he;bt(T)?($=T[0],he=T[1]):($=T,he=T);const te=y!==void 0?y(w):f,j=$+te,q=he+te;t.cellWidth=Math.max(t.cellWidth,j),t.cellHeight=Math.max(t.cellHeight,q)})}t.cellUsed={},t.row=0,t.col=0,t.id2manPos={};for(let y=0;y<v.length;y++){const b=v[y];let w;if(t.position&&(w=t.position(b)),w&&(w.row!==void 0||w.col!==void 0)){const T={row:w.row,col:w.col};if(T.col===void 0)for(T.col=0;t.used(T.row,T.col);)T.col++;else if(T.row===void 0)for(T.row=0;t.used(T.row,T.col);)T.row++;t.id2manPos[b.id]=T,t.use(T.row,T.col)}t.getPos(b)}return t.onLayoutEnd&&t.onLayoutEnd(),{edges:r,nodes:v}}small(t){const n=this;let r;const o=n.rows||5,i=n.cols||5;return t==null?r=Math.min(o,i):Math.min(o,i)===n.rows?n.rows=t:n.cols=t,r}large(t){const n=this;let r;const o=n.rows||5,i=n.cols||5;return t==null?r=Math.max(o,i):Math.max(o,i)===n.rows?n.rows=t:n.cols=t,r}used(t,n){return this.cellUsed[`c-${t}-${n}`]||!1}use(t,n){const r=this;r.cellUsed[`c-${t}-${n}`]=!0}moveToNextCell(){const t=this,n=t.cols||5;t.col++,t.col>=n&&(t.col=0,t.row++)}getPos(t){const n=this,{begin:r,cellWidth:o,cellHeight:i}=n;let a,s;const u=n.id2manPos[t.id];if(u)a=u.col*o+o/2+r[0],s=u.row*i+i/2+r[1];else{for(;n.used(n.row,n.col);)n.moveToNextCell();a=n.col*o+o/2+r[0],s=n.row*i+i/2+r[1],n.use(n.row,n.col),n.moveToNextCell()}t.x=a,t.y=s}getType(){return"grid"}}const st=(e,t)=>{let n;return e?be(e)?n=r=>e:n=e:n=r=>t||1,n};class tn extends $e{constructor(t){super(),this.maxIteration=500,this.workerEnabled=!1,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.preventOverlap=!0,this.collideStrength=1,this.tick=()=>{},this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.animate=!0,this.updateCfg(t)}getDefaultCfg(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}}execute(){var t,n;const r=this,o=r.nodes;if(r.timeInterval!==void 0&&typeof window!="undefined"&&window.clearInterval(r.timeInterval),!o||o.length===0){(t=r.onLayoutEnd)===null||t===void 0||t.call(r);return}!r.width&&typeof window!="undefined"&&(r.width=window.innerWidth),!r.height&&typeof window!="undefined"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const i=r.center;if(o.length===1){o[0].x=i[0],o[0].y=i[1],(n=r.onLayoutEnd)===null||n===void 0||n.call(r);return}const a={},s={};o.forEach((l,d)=>{be(l.x)||(l.x=Math.random()*r.width),be(l.y)||(l.y=Math.random()*r.height),a[l.id]=l,s[l.id]=d}),r.nodeMap=a,r.nodeIdxMap=s,r.linkDistance=st(r.linkDistance,1),r.nodeStrength=st(r.nodeStrength,1),r.edgeStrength=st(r.edgeStrength,1);const u=r.nodeSize;let c;if(r.preventOverlap){const l=r.nodeSpacing;let d;be(l)?d=()=>l:ct(l)?d=l:d=()=>0,u?bt(u)?c=h=>Math.max(u[0],u[1])+d(h):c=h=>u+d(h):c=h=>h.size?bt(h.size)?Math.max(h.size[0],h.size[1])+d(h):Ot(h.size)?Math.max(h.size.width,h.size.height)+d(h):h.size+d(h):10+d(h)}r.nodeSize=c;const f=r.edges;r.degrees=hn(o.length,r.nodeIdxMap,f),r.getMass||(r.getMass=l=>l.mass||r.degrees[r.nodeIdxMap[l.id]].all||1),r.run()}run(){var t;const n=this,{maxIteration:r,nodes:o,workerEnabled:i,minMovement:a,animate:s}=n;if(o)if(i||!s){for(let u=0;u<r;u++){const c=n.runOneStep(u);if(n.reachMoveThreshold(o,c,a))break}(t=n.onLayoutEnd)===null||t===void 0||t.call(n)}else{if(typeof window=="undefined")return;let u=0;this.timeInterval=window.setInterval(()=>{var c,f;if(!o)return;const l=n.runOneStep(u)||[];n.reachMoveThreshold(o,l,a)&&((c=n.onLayoutEnd)===null||c===void 0||c.call(n),window.clearInterval(n.timeInterval)),u++,u>=r&&((f=n.onLayoutEnd)===null||f===void 0||f.call(n),window.clearInterval(n.timeInterval))},0)}}reachMoveThreshold(t,n,r){let o=0;return t.forEach((i,a)=>{const s=i.x-n[a].x,u=i.y-n[a].y;o+=Math.sqrt(s*s+u*u)}),o/=t.length,o<r}runOneStep(t){var n;const r=this,{nodes:o,edges:i}=r,a=[],s=[];if(!o)return;o.forEach((f,l)=>{a[2*l]=0,a[2*l+1]=0,s[2*l]=0,s[2*l+1]=0}),r.calRepulsive(a,o),i&&r.calAttractive(a,i),r.calGravity(a,o);const u=Math.max(.02,r.interval-t*.002);r.updateVelocity(a,s,u,o);const c=[];return o.forEach(f=>{c.push({x:f.x,y:f.y})}),r.updatePosition(s,u,o),(n=r.tick)===null||n===void 0||n.call(r),c}calRepulsive(t,n){const r=this,{getMass:o,factor:i,coulombDisScale:a,preventOverlap:s,collideStrength:u=1}=r,c=r.nodeStrength,f=r.nodeSize;n.forEach((l,d)=>{const h=o?o(l):1;n.forEach((v,m)=>{if(d>=m)return;let g=l.x-v.x,E=l.y-v.y;g===0&&E===0&&(g=Math.random()*.01,E=Math.random()*.01);const y=g*g+E*E,b=Math.sqrt(y),w=(b+.1)*a,T=g/b,$=E/b,he=(c(l)+c(v))*.5*i/(w*w),te=o?o(v):1;if(t[2*d]+=T*he,t[2*d+1]+=$*he,t[2*m]-=T*he,t[2*m+1]-=$*he,s&&(f(l)+f(v))/2>b){const j=u*(c(l)+c(v))*.5/y;t[2*d]+=T*j/h,t[2*d+1]+=$*j/h,t[2*m]-=T*j/te,t[2*m+1]-=$*j/te}})})}calAttractive(t,n){const r=this,{nodeMap:o,nodeIdxMap:i,linkDistance:a,edgeStrength:s}=r,u=r.nodeSize,c=r.getMass;n.forEach((f,l)=>{const d=Je(f,"source"),h=Je(f,"target"),v=o[d],m=o[h];let g=m.x-v.x,E=m.y-v.y;g===0&&E===0&&(g=Math.random()*.01,E=Math.random()*.01);const y=Math.sqrt(g*g+E*E),b=g/y,w=E/y,he=((a(f,v,m)||1+(u(v)+u(m)||0)/2)-y)*s(f),te=i[d],j=i[h],q=c?c(v):1,ve=c?c(m):1;t[2*te]-=b*he/q,t[2*te+1]-=w*he/q,t[2*j]+=b*he/ve,t[2*j+1]+=w*he/ve})}calGravity(t,n){const r=this,o=r.center,i=r.gravity,a=r.degrees,s=n.length;for(let u=0;u<s;u++){const c=n[u];let f=c.x-o[0],l=c.y-o[1],d=i;if(r.getCenter){const h=r.getCenter(c,a[u].all);h&&be(h[0])&&be(h[1])&&be(h[2])&&(f=c.x-h[0],l=c.y-h[1],d=h[2])}d&&(t[2*u]-=d*f,t[2*u+1]-=d*l)}}updateVelocity(t,n,r,o){const i=this,a=r*i.damping;o.forEach((s,u)=>{let c=t[2*u]*a||.01,f=t[2*u+1]*a||.01;const l=Math.sqrt(c*c+f*f);if(l>i.maxSpeed){const d=i.maxSpeed/l;c=d*c,f=d*f}n[2*u]=c,n[2*u+1]=f})}updatePosition(t,n,r){r.forEach((o,i)=>{if(be(o.fx)&&be(o.fy)){o.x=o.fx,o.y=o.fy;return}const a=t[2*i]*n,s=t[2*i+1]*n;o.x+=a,o.y+=s})}stop(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)}destroy(){const t=this;t.stop(),t.tick=null,t.nodes=null,t.edges=null,t.destroyed=!0}getType(){return"gForce"}}function Kt(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return fn(this.cover(t,n),t,n,e)}function fn(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var o,i=e._root,a={data:r},s=e._x0,u=e._y0,c=e._x1,f=e._y1,l,d,h,v,m,g,E,y;if(!i)return e._root=a,e;for(;i.length;)if((m=t>=(l=(s+c)/2))?s=l:c=l,(g=n>=(d=(u+f)/2))?u=d:f=d,o=i,!(i=i[E=g<<1|m]))return o[E]=a,e;if(h=+e._x.call(null,i.data),v=+e._y.call(null,i.data),t===h&&n===v)return a.next=i,o?o[E]=a:e._root=a,e;do o=o?o[E]=new Array(4):e._root=new Array(4),(m=t>=(l=(s+c)/2))?s=l:c=l,(g=n>=(d=(u+f)/2))?u=d:f=d;while((E=g<<1|m)===(y=(v>=d)<<1|h>=l));return o[y]=i,o[E]=a,e}function Wr(e){var t,n,r=e.length,o,i,a=new Array(r),s=new Array(r),u=1/0,c=1/0,f=-1/0,l=-1/0;for(n=0;n<r;++n)isNaN(o=+this._x.call(null,t=e[n]))||isNaN(i=+this._y.call(null,t))||(a[n]=o,s[n]=i,o<u&&(u=o),o>f&&(f=o),i<c&&(c=i),i>l&&(l=i));if(u>f||c>l)return this;for(this.cover(u,c).cover(f,l),n=0;n<r;++n)fn(this,a[n],s[n],e[n]);return this}function Ar(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,o=this._x1,i=this._y1;if(isNaN(n))o=(n=Math.floor(e))+1,i=(r=Math.floor(t))+1;else{for(var a=o-n||1,s=this._root,u,c;n>e||e>=o||r>t||t>=i;)switch(c=(t<r)<<1|e<n,u=new Array(4),u[c]=s,s=u,a*=2,c){case 0:o=n+a,i=r+a;break;case 1:n=o-a,i=r+a;break;case 2:o=n+a,r=i-a;break;case 3:n=o-a,r=i-a;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=o,this._y1=i,this}function Hr(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function Hi(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function sr(e,t,n,r,o){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=o}function Zi(e,t,n){var r,o=this._x0,i=this._y0,a,s,u,c,f=this._x1,l=this._y1,d=[],h=this._root,v,m;for(h&&d.push(new sr(h,o,i,f,l)),n==null?n=1/0:(o=e-n,i=t-n,f=e+n,l=t+n,n*=n);v=d.pop();)if(!(!(h=v.node)||(a=v.x0)>f||(s=v.y0)>l||(u=v.x1)<o||(c=v.y1)<i))if(h.length){var g=(a+u)/2,E=(s+c)/2;d.push(new sr(h[3],g,E,u,c),new sr(h[2],a,E,g,c),new sr(h[1],g,s,u,E),new sr(h[0],a,s,g,E)),(m=(t>=E)<<1|e>=g)&&(v=d[d.length-1],d[d.length-1]=d[d.length-1-m],d[d.length-1-m]=v)}else{var y=e-+this._x.call(null,h.data),b=t-+this._y.call(null,h.data),w=y*y+b*b;if(w<n){var T=Math.sqrt(n=w);o=e-T,i=t-T,f=e+T,l=t+T,r=h.data}}return r}function xi(e){if(isNaN(f=+this._x.call(null,e))||isNaN(l=+this._y.call(null,e)))return this;var t,n=this._root,r,o,i,a=this._x0,s=this._y0,u=this._x1,c=this._y1,f,l,d,h,v,m,g,E;if(!n)return this;if(n.length)for(;;){if((v=f>=(d=(a+u)/2))?a=d:u=d,(m=l>=(h=(s+c)/2))?s=h:c=h,t=n,!(n=n[g=m<<1|v]))return this;if(!n.length)break;(t[g+1&3]||t[g+2&3]||t[g+3&3])&&(r=t,E=g)}for(;n.data!==e;)if(o=n,!(n=n.next))return this;return(i=n.next)&&delete n.next,o?(i?o.next=i:delete o.next,this):t?(i?t[g]=i:delete t[g],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[E]=n:this._root=n),this):(this._root=i,this)}function wi(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function ii(){return this._root}function ji(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function ai(e){var t=[],n,r=this._root,o,i,a,s,u;for(r&&t.push(new sr(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,i=n.x0,a=n.y0,s=n.x1,u=n.y1)&&r.length){var c=(i+s)/2,f=(a+u)/2;(o=r[3])&&t.push(new sr(o,c,f,s,u)),(o=r[2])&&t.push(new sr(o,i,f,c,u)),(o=r[1])&&t.push(new sr(o,c,a,s,f)),(o=r[0])&&t.push(new sr(o,i,a,c,f))}return this}function si(e){var t=[],n=[],r;for(this._root&&t.push(new sr(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var o=r.node;if(o.length){var i,a=r.x0,s=r.y0,u=r.x1,c=r.y1,f=(a+u)/2,l=(s+c)/2;(i=o[0])&&t.push(new sr(i,a,s,f,l)),(i=o[1])&&t.push(new sr(i,f,s,u,l)),(i=o[2])&&t.push(new sr(i,a,l,f,c)),(i=o[3])&&t.push(new sr(i,f,l,u,c))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function nr(e){return e[0]}function Rr(e){return arguments.length?(this._x=e,this):this._x}function ui(e){return e[1]}function Yi(e){return arguments.length?(this._y=e,this):this._y}function ci(e,t,n){var r=new N(t==null?nr:t,n==null?ui:n,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function N(e,t,n,r,o,i){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=o,this._y1=i,this._root=void 0}function Mo(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var rr=ci.prototype=N.prototype;rr.copy=function(){var e=new N(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=Mo(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var o=0;o<4;++o)(r=t.source[o])&&(r.length?n.push({source:r,target:t.target[o]=new Array(4)}):t.target[o]=Mo(r));return e},rr.add=Kt,rr.addAll=Wr,rr.cover=Ar,rr.data=Hr,rr.extent=Hi,rr.find=Zi,rr.remove=xi,rr.removeAll=wi,rr.root=ii,rr.size=ji,rr.visit=ai,rr.visitAfter=si,rr.x=Rr,rr.y=Yi;const Ki=.81,qr=.1;function Dr(e,t,n,r,o){const i=n/r,a=e.map((u,c)=>{const f=t[u.id],{data:l,x:d,y:h,size:v}=f,{nodeStrength:m}=l.layout.force;return{x:d,y:h,size:v,index:c,vx:0,vy:0,weight:i*m}}),s=ci(a,u=>u.x,u=>u.y).visitAfter(qi);return a.forEach(u=>{Qi(u,s)}),a.map((u,c)=>{const f=t[e[c].id],{mass:l=1}=f.data.layout.force;o[2*c]=u.vx/l,o[2*c+1]=u.vy/l}),o}function qi(e){let t=0,n=0,r=0;if(e.length){for(let o=0;o<4;o++){const i=e[o];i&&i.weight&&(t+=i.weight,n+=i.x*i.weight,r+=i.y*i.weight)}e.x=n/t,e.y=r/t,e.weight=t}else{const o=e;e.x=o.data.x,e.y=o.data.y,e.weight=o.data.weight}}const oo=(e,t,n,r,o,i)=>{const a=i.x-e.x||qr,s=i.y-e.y||qr,u=r-t,c=a*a+s*s,f=Math.sqrt(c)*c;if(u*u*Ki<c){const l=e.weight/f;return i.vx+=a*l,i.vy+=s*l,!0}if(e.length)return!1;if(e.data!==i){const l=e.data.weight/f;i.vx+=a*l,i.vy+=s*l}};function Qi(e,t){t.visit((n,r,o,i,a)=>oo(n,r,o,i,a,e))}const _i=(e,t)=>{let n;return e?be(e)?n=r=>e:n=e:n=r=>t||1,n};class La extends $e{constructor(t){super(),this.maxIteration=1e3,this.workerEnabled=!1,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=500,this.minMovement=.4,this.interval=.02,this.factor=1,this.linkDistance=200,this.gravity=0,this.clusterNodeStrength=20,this.preventOverlap=!0,this.distanceThresholdMode="mean",this.tick=()=>{},this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.judgingDistance=0,this.centripetalOptions={leaf:2,single:2,others:1,center:r=>({x:this.width/2,y:this.height/2})};const{getMass:n}=t;this.propsGetMass=n,this.updateCfg(t)}getCentripetalOptions(){const{leafCluster:t,clustering:n,nodeClusterBy:r,nodes:o,nodeMap:i,clusterNodeStrength:a}=this,s=h=>typeof a=="function"?a(h):a;let u={},c;if(t){c=this.getSameTypeLeafMap()||{};const h=Array.from(new Set(o==null?void 0:o.map(v=>v[r])))||[];u={single:100,leaf:(v,m,g)=>{const{relativeLeafNodes:E,sameTypeLeafNodes:y}=c[v.id]||{};return(y==null?void 0:y.length)===(E==null?void 0:E.length)||(h==null?void 0:h.length)===1?1:s(v)},others:1,center:(v,m,g)=>{var E;const{degree:y}=((E=v.data)===null||E===void 0?void 0:E.layout)||{};if(!y)return{x:100,y:100};let b;if(y===1){const{sameTypeLeafNodes:w=[]}=c[v.id]||{};w.length===1?b=void 0:w.length>1&&(b=$r(w))}else b=void 0;return{x:b==null?void 0:b.x,y:b==null?void 0:b.y}}}}if(n){c||(c=this.getSameTypeLeafMap());const h=Array.from(new Set(o.map((m,g)=>m[r]))).filter(m=>m!==void 0),v={};h.forEach(m=>{const g=o.filter(E=>E[r]===m).map(E=>i[E.id]);v[m]=$r(g)}),u={single:m=>s(m),leaf:m=>s(m),others:m=>s(m),center:(m,g,E)=>{const y=v[m[r]];return{x:y==null?void 0:y.x,y:y==null?void 0:y.y}}}}this.centripetalOptions=Object.assign(Object.assign({},this.centripetalOptions),u);const{leaf:f,single:l,others:d}=this.centripetalOptions;f&&typeof f!="function"&&(this.centripetalOptions.leaf=()=>f),l&&typeof l!="function"&&(this.centripetalOptions.single=()=>l),d&&typeof d!="function"&&(this.centripetalOptions.others=()=>d)}updateCfg(t){t&&Object.assign(this,t)}getDefaultCfg(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}}execute(){const t=this;t.stop();const{nodes:n,edges:r,defSpringLen:o}=t;if(t.judgingDistance=0,!n||n.length===0){t.onLayoutEnd([]);return}!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]);const i=t.center;if(n.length===1){n[0].x=i[0],n[0].y=i[1],t.onLayoutEnd([Object.assign({},n[0])]);return}t.degreesMap=Rt(n,r),t.propsGetMass?t.getMass=t.propsGetMass:t.getMass=f=>{let l=1;be(f.mass)&&(l=f.mass);const d=t.degreesMap[f.id].all;return!d||d<5?l:d*5*l};const a=t.nodeSize;let s;if(t.preventOverlap){const f=t.nodeSpacing;let l;be(f)?l=()=>f:ct(f)?l=f:l=()=>0,a?bt(a)?s=d=>Math.max(a[0],a[1])+l(d):s=d=>a+l(d):s=d=>d.size?bt(d.size)?Math.max(d.size[0],d.size[1])+l(d):Ot(d.size)?Math.max(d.size.width,d.size.height)+l(d):d.size+l(d):10+l(d)}t.nodeSize=s,t.linkDistance=_i(t.linkDistance,1),t.nodeStrength=_i(t.nodeStrength,1),t.edgeStrength=_i(t.edgeStrength,1);const u={},c={};n.forEach((f,l)=>{be(f.x)||(f.x=Math.random()*t.width),be(f.y)||(f.y=Math.random()*t.height);const d=t.degreesMap[f.id];u[f.id]=Object.assign(Object.assign({},f),{data:Object.assign(Object.assign({},f.data),{size:t.nodeSize(f)||30,layout:{inDegree:d.in,outDegree:d.out,degree:d.all,tDegree:d.in,sDegree:d.out,force:{mass:t.getMass(f),nodeStrength:t.nodeStrength(f,r)}}})}),c[f.id]=l}),t.nodeMap=u,t.nodeIdxMap=c,t.edgeInfos=[],r==null||r.forEach(f=>{const l=u[f.source],d=u[f.target];!l||!d?elf.edgeInfos.push({}):t.edgeInfos.push({edgeStrength:t.edgeStrength(f),linkDistance:o?o(Object.assign(Object.assign({},f),{source:l,target:d}),l,d):t.linkDistance(f,l,d)||1+(a(l)+a(l)||0)/2})}),this.getCentripetalOptions(),t.onLayoutEnd=t.onLayoutEnd||(()=>{}),t.run()}run(){const t=this,{maxIteration:n,nodes:r,edges:o,workerEnabled:i,minMovement:a,animate:s,nodeMap:u,height:c}=t;if(t.currentMinY=0,t.currentMaxY=c,!r)return;const f=[];if(r.forEach((h,v)=>{f[2*v]=0,f[2*v+1]=0}),this.defSideCoe&&typeof this.defSideCoe=="function"){const h={};o.forEach(v=>{const{source:m,target:g}=v;h[m]=h[m]||[],h[m].push(v),h[g]=h[g]||[],h[g].push(v)}),this.relatedEdges=h}const l=n;if(i||!s){let h=0;for(let v=0;(t.judgingDistance>a||v<1)&&v<l;v++)h=v,t.runOneStep(v,f);t.onLayoutEnd(Object.values(u))}else{if(typeof window=="undefined")return;let h=0;this.timeInterval=window.setInterval(()=>{r&&(t.runOneStep(h,f),h++,(h>=l||t.judgingDistance<a)&&(t.onLayoutEnd(Object.values(u)),window.clearInterval(t.timeInterval)))},0)}}runOneStep(t,n){var r;const o=this,{nodes:i,edges:a,nodeMap:s,monitor:u}=o,c=[];if(!(i!=null&&i.length))return;o.calRepulsive(c),a&&o.calAttractive(c),o.calGravity(c),o.attractToSide(c);const f=o.interval;if(o.updateVelocity(c,n,f),o.updatePosition(n,f),(r=o.tick)===null||r===void 0||r.call(o),u){const l=this.calTotalEnergy(c);u({energy:l,nodes:i,edges:a,iterations:t})}}calTotalEnergy(t){const{nodes:n,nodeMap:r}=this;if(!(n!=null&&n.length))return 0;let o=0;return n.forEach((i,a)=>{const s=t[2*a],u=t[2*a+1],c=s*s+u*u,{mass:f=1}=r[i.id].data.layout.force;o+=f*c*.5}),o}calRepulsive(t){const n=this,{nodes:r,nodeMap:o,factor:i,coulombDisScale:a}=n,s=n.nodeSize;Dr(r,o,i,a*a,t)}calAttractive(t){const n=this,{edges:r,nodeMap:o,nodeIdxMap:i,edgeInfos:a}=n,s=n.nodeSize;r.forEach((u,c)=>{const f=Je(u,"source"),l=Je(u,"target"),d=o[f],h=o[l];if(!d||!h)return;let v=h.x-d.x,m=h.y-d.y;!v&&!m&&(v=Math.random()*.01,m=Math.random()*.01);const g=Math.sqrt(v*v+m*m),E=v/g,y=m/g,{linkDistance:b=200,edgeStrength:w=200}=a[c]||{},$=(b-g)*w,he=d.data.layout.force.mass||1,te=h.data.layout.force.mass||1,j=1/he,q=1/te,ve=E*$,k=y*$,pe=2*i[f],Pe=2*i[l];t[pe]-=ve*j,t[pe+1]-=k*j,t[Pe]+=ve*q,t[Pe+1]+=k*q})}calGravity(t){var n;const r=this,{nodes:o,edges:i=[],nodeMap:a,width:s,height:u,center:c,gravity:f,degreesMap:l,centripetalOptions:d}=r;if(!o)return;const h=o.length;for(let v=0;v<h;v++){const m=2*v,g=a[o[v].id],{mass:E=1}=g.data.layout.force;let y=0,b=0,w=f;const{in:T,out:$,all:he}=l[g.id],te=(n=r.getCenter)===null||n===void 0?void 0:n.call(r,g,he);if(te){const[j,q,ve]=te;y=g.x-j,b=g.y-q,w=ve}else y=g.x-c[0],b=g.y-c[1];if(w&&(t[m]-=w*y/E,t[m+1]-=w*b/E),d){const{leaf:j,single:q,others:ve,center:k}=d,{x:pe,y:Pe,centerStrength:Ue}=(k==null?void 0:k(g,o,i,s,u))||{x:0,y:0,centerStrength:0};if(!be(pe)||!be(Pe))continue;const mt=(g.x-pe)/E,Ke=(g.y-Pe)/E;if(Ue&&(t[m]-=Ue*mt,t[m+1]-=Ue*Ke),he===0){const dt=q(g);if(!dt)continue;t[m]-=dt*mt,t[m+1]-=dt*Ke;continue}if(T===0||$===0){const dt=j(g,o,i);if(!dt)continue;t[m]-=dt*mt,t[m+1]-=dt*Ke;continue}const Et=ve(g);if(!Et)continue;t[m]-=Et*mt,t[m+1]-=Et*Ke}}}attractToSide(t){const{defSideCoe:n,height:r,nodes:o,relatedEdges:i,currentMinY:a=0,currentMaxY:s=this.height}=this;!n||typeof n!="function"||!(o!=null&&o.length)||o.forEach((u,c)=>{const f=n(u,i[u.id]||[]);if(f===0)return;const l=f<0?a:s,d=Math.abs(f);t[2*c+1]-=d*(u.y-l)})}updateVelocity(t,n,r){const o=this,{nodes:i,damping:a,maxSpeed:s}=o;i!=null&&i.length&&i.forEach((u,c)=>{let f=(n[2*c]+t[2*c]*r)*a||.01,l=(n[2*c+1]+t[2*c+1]*r)*a||.01;const d=Math.sqrt(f*f+l*l);if(d>s){const h=s/d;f=h*f,l=h*l}n[2*c]=f,n[2*c+1]=l})}updatePosition(t,n){const r=this,{nodes:o,distanceThresholdMode:i,nodeMap:a}=r;if(!(o!=null&&o.length)){this.judgingDistance=0;return}let s=0;i==="max"?r.judgingDistance=-1/0:i==="min"&&(r.judgingDistance=1/0);let u=1/0,c=-1/0;o.forEach((f,l)=>{const d=a[f.id];if(be(f.fx)&&be(f.fy)){f.x=f.fx,f.y=f.fy,d.x=f.x,d.y=f.y;return}const h=t[2*l]*n,v=t[2*l+1]*n;f.x+=h,f.y+=v,d.x=f.x,d.y=f.y,f.y<u&&(u=f.y),f.y>c&&(c=f.y);const m=Math.sqrt(h*h+v*v);switch(i){case"max":r.judgingDistance<m&&(r.judgingDistance=m);break;case"min":r.judgingDistance>m&&(r.judgingDistance=m);break;default:s=s+m;break}}),this.currentMinY=u,this.currentMaxY=c,(!i||i==="mean")&&(r.judgingDistance=s/o.length)}stop(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)}destroy(){const t=this;t.stop(),t.tick=null,t.nodes=null,t.edges=null,t.destroyed=!0}getType(){return"force2"}getSameTypeLeafMap(){const{nodeClusterBy:t,nodes:n,edges:r,nodeMap:o,degreesMap:i}=this;if(!(n!=null&&n.length))return;const a={};return n.forEach((s,u)=>{i[s.id].all===1&&(a[s.id]=yo("leaf",s,r,t,i,o))}),a}}function ur(e){return function(){return e}}function En(e){return(e()-.5)*1e-6}var io={value:function(){}};function br(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new ao(n)}function ao(e){this._=e}function Iu(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}ao.prototype=br.prototype={constructor:ao,on:function(t,n){var r=this._,o=Iu(t+"",r),i,a=-1,s=o.length;if(arguments.length<2){for(;++a<s;)if((i=(t=o[a]).type)&&(i=Nu(r[i],t.name)))return i;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++a<s;)if(i=(t=o[a]).type)r[i]=bs(r[i],t.name,n);else if(n==null)for(i in r)r[i]=bs(r[i],t.name,null);return this},copy:function(){var t={},n=this._;for(var r in n)t[r]=n[r].slice();return new ao(t)},call:function(t,n){if((i=arguments.length-2)>0)for(var r=new Array(i),o=0,i,a;o<i;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],o=0,i=a.length;o<i;++o)a[o].value.apply(n,r)},apply:function(t,n,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var o=this._[t],i=0,a=o.length;i<a;++i)o[i].value.apply(n,r)}};function Nu(e,t){for(var n=0,r=e.length,o;n<r;++n)if((o=e[n]).name===t)return o.value}function bs(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=io,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Au=br,ko=0,fi=0,Si=0,xs=1e3,cr,Ti,Ji=0,Go=0,Eo=0,Ii=typeof performance=="object"&&performance.now?performance:Date,ws=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ma(){return Go||(ws(Zc),Go=Ii.now()+Eo)}function Zc(){Go=0}function ea(){this._call=this._time=this._next=null}ea.prototype=ka.prototype={constructor:ea,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Ma():+n)+(t==null?0:+t),!this._next&&Ti!==this&&(Ti?Ti._next=this:cr=this,Ti=this),this._call=e,this._time=n,Ga()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ga())}};function ka(e,t,n){var r=new ea;return r.restart(e,t,n),r}function Ln(){Ma(),++ko;for(var e=cr,t;e;)(t=Go-e._time)>=0&&e._call.call(null,t),e=e._next;--ko}function _s(){Go=(Ji=Ii.now())+Eo,ko=fi=0;try{Ln()}finally{ko=0,Du(),Go=0}}function Ru(){var e=Ii.now(),t=e-Ji;t>xs&&(Eo-=t,Ji=e)}function Du(){for(var e,t=cr,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:cr=n);Ti=e,Ga(r)}function Ga(e){if(!ko){fi&&(fi=clearTimeout(fi));var t=e-Go;t>24?(e<1/0&&(fi=setTimeout(_s,e-Ii.now()-Eo)),Si&&(Si=clearInterval(Si))):(Si||(Ji=Ii.now(),Si=setInterval(Ru,xs)),ko=1,ws(_s))}}var Cu=1664525,Ou=1013904223,Lu=4294967296;function Mu(){var e=1;return function(){return(e=(Cu*e+Ou)%Lu)/Lu}}function ku(e){return e.x}function Ss(e){return e.y}var Gu=10,S=Math.PI*(3-Math.sqrt(5));function C(e){var t,n=1,r=.001,o=1-Math.pow(r,1/300),i=0,a=.6,s=new Map,u=ka(l),c=Au("tick","end"),f=Mu();e==null&&(e=[]);function l(){d(),c.call("tick",t),n<r&&(u.stop(),c.call("end",t))}function d(m){var g,E=e.length,y;m===void 0&&(m=1);for(var b=0;b<m;++b)for(n+=(i-n)*o,s.forEach(function(w){w(n)}),g=0;g<E;++g)y=e[g],y.fx==null?y.x+=y.vx*=a:(y.x=y.fx,y.vx=0),y.fy==null?y.y+=y.vy*=a:(y.y=y.fy,y.vy=0);return t}function h(){for(var m=0,g=e.length,E;m<g;++m){if(E=e[m],E.index=m,E.fx!=null&&(E.x=E.fx),E.fy!=null&&(E.y=E.fy),isNaN(E.x)||isNaN(E.y)){var y=Gu*Math.sqrt(.5+m),b=m*S;E.x=y*Math.cos(b),E.y=y*Math.sin(b)}(isNaN(E.vx)||isNaN(E.vy))&&(E.vx=E.vy=0)}}function v(m){return m.initialize&&m.initialize(e,f),m}return h(),t={tick:d,restart:function(){return u.restart(l),t},stop:function(){return u.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),s.forEach(v),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(r=+g,t):r},alphaDecay:function(g){return arguments.length?(o=+g,t):+o},alphaTarget:function(g){return arguments.length?(i=+g,t):i},velocityDecay:function(g){return arguments.length?(a=1-g,t):1-a},randomSource:function(g){return arguments.length?(f=g,s.forEach(v),t):f},force:function(g,E){return arguments.length>1?(E==null?s.delete(g):s.set(g,v(E)),t):s.get(g)},find:function(g,E,y){var b=0,w=e.length,T,$,he,te,j;for(y==null?y=1/0:y*=y,b=0;b<w;++b)te=e[b],T=g-te.x,$=E-te.y,he=T*T+$*$,he<y&&(j=te,y=he);return j},on:function(g,E){return arguments.length>1?(c.on(g,E),t):c.on(g)}}}function Se(){var e,t,n,r,o=ur(-30),i,a=1,s=1/0,u=.81;function c(h){var v,m=e.length,g=ci(e,ku,Ss).visitAfter(l);for(r=h,v=0;v<m;++v)t=e[v],g.visit(d)}function f(){if(e){var h,v=e.length,m;for(i=new Array(v),h=0;h<v;++h)m=e[h],i[m.index]=+o(m,h,e)}}function l(h){var v=0,m,g,E=0,y,b,w;if(h.length){for(y=b=w=0;w<4;++w)(m=h[w])&&(g=Math.abs(m.value))&&(v+=m.value,E+=g,y+=g*m.x,b+=g*m.y);h.x=y/E,h.y=b/E}else{m=h,m.x=m.data.x,m.y=m.data.y;do v+=i[m.data.index];while(m=m.next)}h.value=v}function d(h,v,m,g){if(!h.value)return!0;var E=h.x-t.x,y=h.y-t.y,b=g-v,w=E*E+y*y;if(b*b/u<w)return w<s&&(E===0&&(E=En(n),w+=E*E),y===0&&(y=En(n),w+=y*y),w<a&&(w=Math.sqrt(a*w)),t.vx+=E*h.value*r/w,t.vy+=y*h.value*r/w),!0;if(h.length||w>=s)return;(h.data!==t||h.next)&&(E===0&&(E=En(n),w+=E*E),y===0&&(y=En(n),w+=y*y),w<a&&(w=Math.sqrt(a*w)));do h.data!==t&&(b=i[h.data.index]*r/w,t.vx+=E*b,t.vy+=y*b);while(h=h.next)}return c.initialize=function(h,v){e=h,n=v,f()},c.strength=function(h){return arguments.length?(o=typeof h=="function"?h:ur(+h),f(),c):o},c.distanceMin=function(h){return arguments.length?(a=h*h,c):Math.sqrt(a)},c.distanceMax=function(h){return arguments.length?(s=h*h,c):Math.sqrt(s)},c.theta=function(h){return arguments.length?(u=h*h,c):Math.sqrt(u)},c}function Ce(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function o(){var i,a=n.length,s,u=0,c=0;for(i=0;i<a;++i)s=n[i],u+=s.x,c+=s.y;for(u=(u/a-e)*r,c=(c/a-t)*r,i=0;i<a;++i)s=n[i],s.x-=u,s.y-=c}return o.initialize=function(i){n=i},o.x=function(i){return arguments.length?(e=+i,o):e},o.y=function(i){return arguments.length?(t=+i,o):t},o.strength=function(i){return arguments.length?(r=+i,o):r},o}var Ge=oe(37635),Oe=oe.n(Ge);function tt(e){return e.index}function it(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function xt(e){var t=tt,n=l,r,o=ur(30),i,a,s,u,c,f=1;e==null&&(e=[]);function l(g){return 1/Math.min(s[g.source.index],s[g.target.index])}function d(g){for(var E=0,y=e.length;E<f;++E)for(var b=0,w,T,$,he,te,j,q;b<y;++b)w=e[b],T=w.source,$=w.target,he=$.x+$.vx-T.x-T.vx||En(c),te=$.y+$.vy-T.y-T.vy||En(c),j=Math.sqrt(he*he+te*te),j=(j-i[b])/j*g*r[b],he*=j,te*=j,$.vx-=he*(q=u[b]),$.vy-=te*q,T.vx+=he*(q=1-q),T.vy+=te*q}function h(){if(a){var g,E=a.length,y=e.length,b=new Map(a.map(function(T,$){return[t(T,$,a),T]})),w;for(g=0,s=new Array(E);g<y;++g)w=e[g],w.index=g,Oe()(w.source)!=="object"&&(w.source=it(b,w.source)),Oe()(w.target)!=="object"&&(w.target=it(b,w.target)),s[w.source.index]=(s[w.source.index]||0)+1,s[w.target.index]=(s[w.target.index]||0)+1;for(g=0,u=new Array(y);g<y;++g)w=e[g],u[g]=s[w.source.index]/(s[w.source.index]+s[w.target.index]);r=new Array(y),v(),i=new Array(y),m()}}function v(){if(a)for(var g=0,E=e.length;g<E;++g)r[g]=+n(e[g],g,e)}function m(){if(a)for(var g=0,E=e.length;g<E;++g)i[g]=+o(e[g],g,e)}return d.initialize=function(g,E){a=g,c=E,h()},d.links=function(g){return arguments.length?(e=g,h(),d):e},d.id=function(g){return arguments.length?(t=g,d):t},d.iterations=function(g){return arguments.length?(f=+g,d):f},d.strength=function(g){return arguments.length?(n=typeof g=="function"?g:ur(+g),v(),d):n},d.distance=function(g){return arguments.length?(o=typeof g=="function"?g:ur(+g),m(),d):o},d}function Lt(e){return e.x+e.vx}function ln(e){return e.y+e.vy}function Mt(e){var t,n,r,o=1,i=1;typeof e!="function"&&(e=ur(e==null?1:+e));function a(){for(var c,f=t.length,l,d,h,v,m,g,E=0;E<i;++E)for(l=ci(t,Lt,ln).visitAfter(s),c=0;c<f;++c)d=t[c],m=n[d.index],g=m*m,h=d.x+d.vx,v=d.y+d.vy,l.visit(y);function y(b,w,T,$,he){var te=b.data,j=b.r,q=m+j;if(te){if(te.index>d.index){var ve=h-te.x-te.vx,k=v-te.y-te.vy,pe=ve*ve+k*k;pe<q*q&&(ve===0&&(ve=En(r),pe+=ve*ve),k===0&&(k=En(r),pe+=k*k),pe=(q-(pe=Math.sqrt(pe)))/pe*o,d.vx+=(ve*=pe)*(q=(j*=j)/(g+j)),d.vy+=(k*=pe)*q,te.vx-=ve*(q=1-q),te.vy-=k*q)}return}return w>h+q||$<h-q||T>v+q||he<v-q}}function s(c){if(c.data)return c.r=n[c.data.index];for(var f=c.r=0;f<4;++f)c[f]&&c[f].r>c.r&&(c.r=c[f].r)}function u(){if(t){var c,f=t.length,l;for(n=new Array(f),c=0;c<f;++c)l=t[c],n[l.index]=+e(l,c,t)}}return a.initialize=function(c,f){t=c,r=f,u()},a.iterations=function(c){return arguments.length?(i=+c,a):i},a.strength=function(c){return arguments.length?(o=+c,a):o},a.radius=function(c){return arguments.length?(e=typeof c=="function"?c:ur(+c),u(),a):e},a}function nn(e){var t=ur(.1),n,r,o;typeof e!="function"&&(e=ur(e==null?0:+e));function i(s){for(var u=0,c=n.length,f;u<c;++u)f=n[u],f.vx+=(o[u]-f.x)*r[u]*s}function a(){if(n){var s,u=n.length;for(r=new Array(u),o=new Array(u),s=0;s<u;++s)r[s]=isNaN(o[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return i.initialize=function(s){n=s,a()},i.strength=function(s){return arguments.length?(t=typeof s=="function"?s:ur(+s),a(),i):t},i.x=function(s){return arguments.length?(e=typeof s=="function"?s:ur(+s),a(),i):e},i}function Xt(e){var t=ur(.1),n,r,o;typeof e!="function"&&(e=ur(e==null?0:+e));function i(s){for(var u=0,c=n.length,f;u<c;++u)f=n[u],f.vy+=(o[u]-f.y)*r[u]*s}function a(){if(n){var s,u=n.length;for(r=new Array(u),o=new Array(u),s=0;s<u;++s)r[s]=isNaN(o[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return i.initialize=function(s){n=s,a()},i.strength=function(s){return arguments.length?(t=typeof s=="function"?s:ur(+s),a(),i):t},i.y=function(s){return arguments.length?(e=typeof s=="function"?s:ur(+s),a(),i):e},i}function rn(){function e(Ze){return()=>Ze}let t=Ze=>Ze.cluster,n=e(1),r=e(-1),o=e(100),i=e(.1),a=[0,0],s=[],u={},c=[],f=100,l=100,d={none:{x:0,y:0}},h=[],v,m="force",g=!0,E=.1;function y(Ze){if(!g)return y;v.tick(),te();for(let Yt=0,Jn=s.length,cn,Dn=Ze*E;Yt<Jn;++Yt)cn=s[Yt],cn.vx+=(d[t(cn)].x-cn.x)*Dn,cn.vy+=(d[t(cn)].y-cn.y)*Dn}function b(){s&&w()}function w(){if(!s||!s.length)return;if(t(s[0])===void 0)throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInABox.groupBy('clusterAttr') before calling .links()");const Ze=T();v=C(Ze.nodes).force("x",nn(f).strength(.1)).force("y",Xt(l).strength(.1)).force("collide",Mt(Yt=>Yt.r).iterations(4)).force("charge",Se().strength(r)).force("links",xt(Ze.nodes.length?Ze.links:[]).distance(o).strength(i)),h=v.nodes(),te()}function T(){const Ze=[],Yt=[],Jn={};let cn=[],Dn={},Ve=[];return Dn=$(s),Ve=he(c),cn=Object.keys(Dn),cn.forEach((ut,xn)=>{const Ft=Dn[ut];Ze.push({id:ut,size:Ft.count,r:Math.sqrt(Ft.sumforceNodeSize/Math.PI)}),Jn[ut]=xn}),Ve.forEach(ut=>{const xn=Je(ut,"source"),Ft=Je(ut,"target"),Pn=Jn[xn],en=Jn[Ft];Pn!==void 0&&en!==void 0&&Yt.push({source:Pn,target:en,count:ut.count})}),{nodes:Ze,links:Yt}}function $(Ze){const Yt={};return Ze.forEach(Jn=>{const cn=t(Jn);Yt[cn]||(Yt[cn]={count:0,sumforceNodeSize:0})}),Ze.forEach(Jn=>{const cn=t(Jn),Dn=n(Jn),Ve=Yt[cn];Ve.count=Ve.count+1,Ve.sumforceNodeSize=Ve.sumforceNodeSize+Math.PI*(Dn*Dn)*1.3,Yt[cn]=Ve}),Yt}function he(Ze){const Yt={},Jn=[];return Ze.forEach(Dn=>{const Ve=j(Dn);let ut=0;Yt[Ve]!==void 0&&(ut=Yt[Ve]),ut+=1,Yt[Ve]=ut}),Object.entries(Yt).forEach(([Dn,Ve])=>{const ut=Dn.split("~")[0],xn=Dn.split("~")[1];ut!==void 0&&xn!==void 0&&Jn.push({source:ut,target:xn,count:Ve})}),Jn}function te(){return d={none:{x:0,y:0}},h.forEach(Ze=>{d[Ze.id]={x:Ze.x-a[0],y:Ze.y-a[1]}}),d}function j(Ze){const Yt=Je(Ze,"source"),Jn=Je(Ze,"target"),cn=t(u[Yt]),Dn=t(u[Jn]);return cn<=Dn?`${cn}~${Dn}`:`${Dn}~${cn}`}function q(Ze){u={},Ze.forEach(Yt=>{u[Yt.id]=Yt})}function ve(Ze){return arguments.length?(m=Ze,b(),y):m}function k(Ze){return arguments.length?typeof Ze=="string"?(t=Yt=>Yt[Ze],y):(t=Ze,y):t}function pe(Ze){return arguments.length?(g=Ze,y):g}function Pe(Ze){return arguments.length?(E=Ze,y):E}function Ue(Ze){return arguments.length?(f=Ze,y):f}function mt(Ze){return arguments.length?(l=Ze,y):l}function Ke(Ze){return arguments.length?(q(Ze||[]),s=Ze||[],y):s}function Et(Ze){return arguments.length?(c=Ze||[],b(),y):c}function dt(Ze){return arguments.length?(typeof Ze=="function"?n=Ze:n=e(+Ze),b(),y):n}function Pt(Ze){return arguments.length?(typeof Ze=="function"?r=Ze:r=e(+Ze),b(),y):r}function Jt(Ze){return arguments.length?(typeof Ze=="function"?o=Ze:o=e(+Ze),b(),y):o}function Un(Ze){return arguments.length?(typeof Ze=="function"?i=Ze:i=e(+Ze),b(),y):i}function Zn(Ze){return arguments.length?(a=Ze,y):a}return y.initialize=Ze=>{s=Ze,b()},y.template=ve,y.groupBy=k,y.enableGrouping=pe,y.strength=Pe,y.centerX=Ue,y.centerY=mt,y.nodes=Ke,y.links=Et,y.forceNodeSize=dt,y.nodeSize=y.forceNodeSize,y.forceCharge=Pt,y.forceLinkDistance=Jt,y.forceLinkStrength=Un,y.offset=Zn,y.getFocis=te,y}const mn={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"},Sn={gForce:!0,force2:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0};class gn extends $e{constructor(t){super(),this.center=[0,0],this.nodeStrength=null,this.edgeStrength=null,this.preventOverlap=!1,this.clusterNodeStrength=null,this.clusterEdgeStrength=null,this.clusterEdgeDistance=null,this.clusterNodeSize=null,this.clusterFociStrength=null,this.linkDistance=50,this.alphaDecay=.028,this.alphaMin=.001,this.alpha=.3,this.collideStrength=1,this.workerEnabled=!1,this.tick=()=>{},this.onLayoutEnd=()=>{},this.ticking=void 0,t&&this.updateCfg(t)}getDefaultCfg(){return{center:[0,0],nodeStrength:null,edgeStrength:null,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10,tick(){},onLayoutEnd(){},workerEnabled:!1}}init(t){const n=this;n.nodes=t.nodes||[];const r=t.edges||[];n.edges=r.map(o=>{const i={},a=["targetNode","sourceNode","startPoint","endPoint"];return Object.keys(o).forEach(s=>{a.indexOf(s)>-1||(i[s]=o[s])}),i}),n.ticking=!1}execute(t){const n=this,r=n.nodes,o=n.edges;if(n.ticking)return;let i=n.forceSimulation;const a=n.alphaMin,s=n.alphaDecay,u=n.alpha;if(i){if(t){if(n.clustering&&n.clusterForce&&(n.clusterForce.nodes(r),n.clusterForce.links(o)),i.nodes(r),o&&n.edgeForce)n.edgeForce.links(o);else if(o&&!n.edgeForce){const c=xt().id(f=>f.id).links(o);n.edgeStrength&&c.strength(n.edgeStrength),n.linkDistance&&c.distance(n.linkDistance),n.edgeForce=c,i.force("link",c)}}n.preventOverlap&&n.overlapProcess(i),i.alpha(u).restart(),this.ticking=!0}else try{const c=Se();if(n.nodeStrength&&c.strength(n.nodeStrength),i=C().nodes(r),n.clustering){const f=rn();f.centerX(n.center[0]).centerY(n.center[1]).template("force").strength(n.clusterFociStrength),o&&f.links(o),r&&f.nodes(r),f.forceLinkDistance(n.clusterEdgeDistance).forceLinkStrength(n.clusterEdgeStrength).forceCharge(n.clusterNodeStrength).forceNodeSize(n.clusterNodeSize),n.clusterForce=f,i.force("group",f)}if(i.force("center",Ce(n.center[0],n.center[1])).force("charge",c).alpha(u).alphaDecay(s).alphaMin(a),n.preventOverlap&&n.overlapProcess(i),o){const f=xt().id(l=>l.id).links(o);n.edgeStrength&&f.strength(n.edgeStrength),n.linkDistance&&f.distance(n.linkDistance),n.edgeForce=f,i.force("link",f)}if(n.workerEnabled&&!dn()&&(n.workerEnabled=!1,console.warn("workerEnabled option is only supported when running in web worker.")),!n.workerEnabled)i.on("tick",()=>{n.tick()}).on("end",()=>{n.ticking=!1,n.onLayoutEnd&&n.onLayoutEnd()}),n.ticking=!0;else{i.stop();const f=Mn(i);for(let l=1;l<=f;l++)i.tick(),postMessage({nodes:r,currentTick:l,totalTicks:f,type:mn.TICK},void 0);n.ticking=!1}n.forceSimulation=i,n.ticking=!0}catch(c){n.ticking=!1,console.warn(c)}}overlapProcess(t){const n=this,r=n.nodeSize,o=n.nodeSpacing;let i,a;const s=n.collideStrength;if(be(o)?a=()=>o:ct(o)?a=o:a=()=>0,!r)i=u=>u.size?bt(u.size)?(u.size[0]>u.size[1]?u.size[0]:u.size[1])/2+a(u):Ot(u.size)?(u.size.width>u.size.height?u.size.width:u.size.height)/2+a(u):u.size/2+a(u):10+a(u);else if(ct(r))i=u=>r(u)+a(u);else if(bt(r)){const c=(r[0]>r[1]?r[0]:r[1])/2;i=f=>c+a(f)}else if(be(r)){const u=r/2;i=c=>u+a(c)}else i=()=>10;t.force("collisionForce",Mt(i).strength(s))}updateCfg(t){const n=this;n.ticking&&(n.forceSimulation.stop(),n.ticking=!1),n.forceSimulation=null,Object.assign(n,t)}destroy(){const t=this;t.ticking&&(t.forceSimulation.stop(),t.ticking=!1),t.nodes=null,t.edges=null,t.destroyed=!0}}function Mn(e){const t=e.alphaMin(),n=e.alphaTarget(),r=e.alpha(),o=Math.log((t-n)/(r-n))/Math.log(1-e.alphaDecay());return Math.ceil(o)}function dn(){return typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope}function Yn(e,t,n,r){e.forEach((o,i)=>{e[i].children=[],e[i].parent=[]}),r?t.forEach(o=>{const i=Je(o,"source"),a=Je(o,"target");let s=0;i&&(s=n[i]);let u=0;a&&(u=n[a]);const c=e[s].children,f=e[u].parent;c.push(e[u].id),f.push(e[s].id)}):t.forEach(o=>{const i=Je(o,"source"),a=Je(o,"target");let s=0;i&&(s=n[i]);let u=0;a&&(u=n[a]);const c=e[s].children,f=e[u].children;c.push(e[u].id),f.push(e[s].id)})}function Fn(e,t,n){const r=n.length;for(let o=0;o<r;o++){const i=Je(n[o],"source"),a=Je(n[o],"target");if(e.id===i&&t.id===a||t.id===i&&e.id===a)return!0}return!1}function qt(e,t){const n=e.degree,r=t.degree;return n<r?-1:n>r?1:0}class bn extends $e{constructor(t){super(),this.radius=null,this.nodeSize=void 0,this.startRadius=null,this.endRadius=null,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.divisions=1,this.ordering=null,this.angleRatio=1,this.nodes=[],this.edges=[],this.nodeMap={},this.degrees=[],this.width=300,this.height=300,this.updateCfg(t)}getDefaultCfg(){return{radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1}}execute(){var t;const n=this,r=n.nodes,o=n.edges,i=r.length;if(i===0){n.onLayoutEnd&&n.onLayoutEnd();return}!n.width&&typeof window!="undefined"&&(n.width=window.innerWidth),!n.height&&typeof window!="undefined"&&(n.height=window.innerHeight),n.center||(n.center=[n.width/2,n.height/2]);const a=n.center;if(i===1){r[0].x=a[0],r[0].y=a[1],n.onLayoutEnd&&n.onLayoutEnd();return}let{radius:s,startRadius:u,endRadius:c}=n;const{divisions:f,startAngle:l,endAngle:d,angleRatio:h,ordering:v,clockwise:m,nodeSpacing:g,nodeSize:E}=n,y=(d-l)/i,b={};r.forEach((te,j)=>{b[te.id]=j}),n.nodeMap=b;const w=hn(r.length,b,o);if(n.degrees=w,g){const te=jn(10,g),j=jn(10,E);let q=-1/0;r.forEach(k=>{const pe=j(k);q<pe&&(q=pe)});let ve=0;r.forEach((k,pe)=>{pe===0?ve+=q||10:ve+=(te(k)||0)+(q||10)}),s=ve/(2*Math.PI)}else!s&&!u&&!c?s=n.height>n.width?n.width/2:n.height/2:!u&&c?u=c:u&&!c&&(c=u);const T=y*h;let $=[];v==="topology"?$=n.topologyOrdering():v==="topology-directed"?$=n.topologyOrdering(!0):v==="degree"?$=n.degreeOrdering():$=r;const he=Math.ceil(i/f);for(let te=0;te<i;++te){let j=s;!j&&u!==null&&c!==null&&(j=u+te*(c-u)/(i-1)),j||(j=10+te*100/(i-1));let q=l+te%he*T+2*Math.PI/f*Math.floor(te/he);m||(q=d-te%he*T-2*Math.PI/f*Math.floor(te/he)),$[te].x=a[0]+Math.cos(q)*j,$[te].y=a[1]+Math.sin(q)*j,$[te].weight=w[te].all}return(t=n.onLayoutEnd)===null||t===void 0||t.call(n),{nodes:$,edges:this.edges}}topologyOrdering(t=!1){const n=this,r=n.degrees,o=n.edges,i=n.nodes,a=Bt(i),s=n.nodeMap,u=[a[0]],c=[i[0]],f=[],l=i.length;f[0]=!0,Yn(a,o,s,t);let d=0;return a.forEach((h,v)=>{if(v!==0)if((v===l-1||r[v].all!==r[v+1].all||Fn(u[d],h,o))&&!f[v])u.push(h),c.push(i[s[h.id]]),f[v]=!0,d++;else{const m=u[d].children;let g=!1;for(let y=0;y<m.length;y++){const b=s[m[y]];if(r[b].all===r[v].all&&!f[b]){u.push(a[b]),c.push(i[s[a[b].id]]),f[b]=!0,g=!0;break}}let E=0;for(;!g&&(f[E]||(u.push(a[E]),c.push(i[s[a[E].id]]),f[E]=!0,g=!0),E++,E!==l););}}),c}degreeOrdering(){const t=this,n=t.nodes,r=[],o=t.degrees;return n.forEach((i,a)=>{i.degree=o[a].all,r.push(i)}),r.sort(qt),r}getType(){return"circular"}}const zn=(e,t)=>{if(e!=="next"&&e!=="prev")return t},Qt=e=>{e.prev.next=e.next,e.next.prev=e.prev,delete e.next,delete e.prev};class yn{constructor(){const t={};t.prev=t,t.next=t.prev,this.shortcut=t}dequeue(){const t=this.shortcut,n=t.prev;if(n&&n!==t)return Qt(n),n}enqueue(t){const n=this.shortcut;t.prev&&t.next&&Qt(t),t.next=n.next,n.next.prev=t,n.next=t,t.prev=n}toString(){const t=[],n=this.shortcut;let r=n.prev;for(;r!==n;)t.push(JSON.stringify(r,zn)),r=r==null?void 0:r.prev;return`[${t.join(", ")}]`}}var on;(function(e){e.DEFAULT_EDGE_NAME="\0",e.GRAPH_NODE="\0",e.EDGE_KEY_DELIM=""})(on||(on={}));function wt(e,t){var n=e.get(t)||0;e.set(t,n+1)}function kt(e,t){var n=e.get(t);n!==void 0&&(n=n-1,n>0?e.set(t,n):e.delete(t))}function sn(e,t,n,r){var o=String(t),i=String(n);if(!e&&o>i){var a=o;o=i,i=a}return o+on.EDGE_KEY_DELIM+i+on.EDGE_KEY_DELIM+(r===void 0?on.DEFAULT_EDGE_NAME:r)}function Tn(e,t,n,r){var o=String(t),i=String(n),a={v:t,w:n};if(!e&&o>i){var s=a.v;a.v=a.w,a.w=s}return r!==void 0&&(a.name=r),a}function Gr(e,t){return sn(e,t.v,t.w,t.name)}function Qr(e){return typeof e=="function"}var Jr=function(t){return t.nodes().map(function(n){var r=t.node(n),o=t.parent(n),i={id:n,value:r,parent:o};return i.value===void 0&&delete i.value,i.parent===void 0&&delete i.parent,i})},xr=function(t){return t.edges().map(function(n){var r=t.edge(n),o={v:n.v,w:n.w,value:r,name:n.name};return o.name===void 0&&delete o.name,o.value===void 0&&delete o.value,o})},Po=function(t){var n={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:Jr(t),edges:xr(t),value:t.graph()};return n.value===void 0&&delete n.value,n},Fo=function(t){var n=new uo(t.options);return t.value!==void 0&&n.setGraph(t.value),t.nodes.forEach(function(r){n.setNode(r.id,r.value),r.parent&&n.setParent(r.id,r.parent)}),t.edges.forEach(function(r){n.setEdge(r.v,r.w,r.value,r.name)}),n};function un(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function kn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?un(Object(n),!0).forEach(function(r){Cr(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):un(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Cr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eo(e,t,n){return t&&wr(e.prototype,t),n&&wr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var so={compound:!1,multigraph:!1,directed:!0},uo=function(){function e(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Pr(this,e),this.directed=!0,this.multigraph=!1,this.compound=!1,this.GRAPH_NODE=on.GRAPH_NODE,this.label=void 0,this.nodeCountNum=0,this.edgeCountNum=0,this.defaultNodeLabelFn=function(){},this.defaultEdgeLabelFn=function(){},this.parentMap=void 0,this.childrenMap=void 0,this.nodesLabelMap=new Map,this.inEdgesMap=new Map,this.outEdgesMap=new Map,this.predecessorsMap=new Map,this.successorsMap=new Map,this.edgesMap=new Map,this.edgesLabelsMap=new Map,this.isDirected=function(){return t.directed},this.isMultigraph=function(){return t.multigraph},this.isCompound=function(){return t.compound},this.setGraph=function(o){return t.label=o,t},this.graph=function(){return t.label},this.setDefaultNodeLabel=function(o){return Qr(o)?t.defaultNodeLabelFn=o:t.defaultNodeLabelFn=function(){return o},t},this.nodeCount=function(){return t.nodeCountNum},this.node=function(o){return t.nodesLabelMap.get(o)},this.nodes=function(){return Array.from(t.nodesLabelMap.keys())},this.sources=function(){return t.nodes().filter(function(o){var i;return!(!((i=t.inEdgesMap.get(o))===null||i===void 0)&&i.size)})},this.sinks=function(){return t.nodes().filter(function(o){var i;return!(!((i=t.outEdgesMap.get(o))===null||i===void 0)&&i.size)})},this.setNodes=function(o,i){return o.map(function(a){return t.setNode(a,i)}),t},this.hasNode=function(o){return t.nodesLabelMap.has(o)},this.checkCompound=function(){if(!t.isCompound())throw new Error("Cannot construct parent-children relations in a non-compound graph")},this.parent=function(o){if(t.isCompound()){var i,a=(i=t.parentMap)===null||i===void 0?void 0:i.get(o);if(a!==t.GRAPH_NODE)return a}},this.removeFromParentsChildList=function(o){var i=t.parentMap.get(o);t.childrenMap.get(i).delete(o)},this.setParent=function(o,i){var a,s;t.checkCompound();for(var u=i===void 0?t.GRAPH_NODE:i,c=t.parent(u);c;){if(o===c)throw new Error("Setting "+i+" as parent of "+o+" would create a cycle");c=t.parent(c)}i&&t.setNode(i),t.setNode(o),t.removeFromParentsChildList(o),(a=t.parentMap)===null||a===void 0||a.set(o,u);var f=t.childrenMap.get(u);return f.set(o,!0),(s=t.childrenMap)===null||s===void 0||s.set(u,f),t},this.children=function(o){var i=o===void 0?t.GRAPH_NODE:o;if(t.isCompound()){var a,s=(a=t.childrenMap)===null||a===void 0?void 0:a.get(i);return s?Array.from(s.keys()):void 0}if(i===t.GRAPH_NODE)return t.nodes();if(o&&t.hasNode(o))return[]},this.predecessors=function(o){var i=t.predecessorsMap.get(o);return i?Array.from(i.keys()):void 0},this.successors=function(o){var i=t.successorsMap.get(o);return i?Array.from(i.keys()):void 0},this.neighbors=function(o){var i;if(t.hasNode(o))return Array.from(new Set((i=t.predecessors(o))===null||i===void 0?void 0:i.concat(t.successors(o))))},this.isLeaf=function(o){var i;if(t.isDirected()){var a;return!(!((a=t.successors(o))===null||a===void 0)&&a.length)}return!(!((i=t.neighbors(o))===null||i===void 0)&&i.length)},this.filterNodes=function(o){var i=t.directed,a=t.multigraph,s=t.compound,u=new e({directed:i,multigraph:a,compound:s});if(u.setGraph(t.graph()),t.nodes().forEach(function(f){o(f)&&u.setNode(f,t.node(f))}),t.edges().forEach(function(f){u.hasNode(f.v)&&u.hasNode(f.w)&&u.setEdgeObj(f,t.edge(f))}),s){var c=function(l){for(var d=t.parent(l);d!==void 0&&!u.hasNode(d);)d=t.parent(d);return d};u.nodes().forEach(function(f){u.setParent(f,c(f))})}return u},this.setDefaultEdgeLabel=function(o){return Qr(o)?t.defaultEdgeLabelFn=o:t.defaultEdgeLabelFn=function(){return o},t},this.edgeCount=function(){return t.edgeCountNum},this.setEdgeObj=function(o,i){return t.setEdge(o.v,o.w,i,o.name)},this.setPath=function(o,i){return o.reduce(function(a,s){return t.setEdge(a,s,i),s}),t},this.edgeFromArgs=function(o,i,a){return t.edge({v:o,w:i,name:a})},this.edge=function(o){return t.edgesLabelsMap.get(Gr(t.isDirected(),o))},this.hasEdge=function(o,i,a){return t.edgesLabelsMap.has(Gr(t.isDirected(),{v:o,w:i,name:a}))},this.removeEdgeObj=function(o){var i=o.v,a=o.w,s=o.name;return t.removeEdge(i,a,s)},this.edges=function(){return Array.from(t.edgesMap.values())},this.inEdges=function(o,i){var a=t.inEdgesMap.get(o);if(a)return Array.from(a.values()).filter(function(s){return!i||s.v===i})},this.outEdges=function(o,i){var a=t.outEdgesMap.get(o);if(a)return Array.from(a.values()).filter(function(s){return!i||s.w===i})},this.nodeEdges=function(o,i){var a;if(t.hasNode(o))return(a=t.inEdges(o,i))===null||a===void 0?void 0:a.concat(t.outEdges(o,i))},this.toJSON=function(){return Po(t)},this.nodeInDegree=function(o){var i=t.inEdgesMap.get(o);return i?i.size:0},this.nodeOutDegree=function(o){var i=t.outEdgesMap.get(o);return i?i.size:0},this.nodeDegree=function(o){return t.nodeInDegree(o)+t.nodeOutDegree(o)},this.source=function(o){return o.v},this.target=function(o){return o.w};var r=kn(kn({},so),n);this.compound=r.compound,this.directed=r.directed,this.multigraph=r.multigraph,this.compound&&(this.parentMap=new Map,this.childrenMap=new Map)}return eo(e,[{key:"setNode",value:function(n,r){var o=this.nodesLabelMap,i=this.defaultNodeLabelFn,a=this.isCompound,s=this.parentMap,u=this.childrenMap,c=this.inEdgesMap,f=this.outEdgesMap,l=this.predecessorsMap,d=this.successorsMap;if(o.has(n))return r!==void 0&&o.set(n,r),this;if(o.set(n,r||i(n)),a()){var h;s==null||s.set(n,this.GRAPH_NODE),u==null||u.set(n,new Map),u!=null&&u.has(this.GRAPH_NODE)||u==null||u.set(this.GRAPH_NODE,new Map),u==null||(h=u.get(this.GRAPH_NODE))===null||h===void 0||h.set(n,!0)}return[c,f,l,d].forEach(function(v){return v.set(n,new Map)}),this.nodeCountNum+=1,this}},{key:"removeNode",value:function(n){var r=this;if(this.hasNode(n)){var o=function(g){r.removeEdge(g.v,g.w,g.name)},i=this.inEdgesMap,a=this.outEdgesMap,s=this.predecessorsMap,u=this.successorsMap,c=this.nodesLabelMap;if(this.isCompound()){var f,l,d;this.removeFromParentsChildList(n),(f=this.parentMap)===null||f===void 0||f.delete(n),(l=this.children(n))===null||l===void 0||l.forEach(function(m){return r.setParent(m)}),(d=this.childrenMap)===null||d===void 0||d.delete(n)}var h=i.get(n),v=a.get(n);Array.from(h.values()).forEach(function(m){return o(m)}),Array.from(v.values()).forEach(function(m){return o(m)}),c.delete(n),i.delete(n),a.delete(n),s.delete(n),u.delete(n),this.nodeCountNum-=1}return this}},{key:"setEdge",value:function(n,r,o,i){var a,s,u=Tn(this.isDirected(),n,r,i),c=Gr(this.isDirected(),u),f=u.v,l=u.w;if(this.edgesLabelsMap.has(c))return this.edgesLabelsMap.set(c,o),this;if(i!==void 0&&!this.isMultigraph())throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(f),this.setNode(l),this.edgesLabelsMap.set(c,o||this.defaultEdgeLabelFn(f,l,i)),Object.freeze(u),this.edgesMap.set(c,u);var d=this.predecessorsMap.get(l),h=this.successorsMap.get(f);return wt(d,f),wt(h,l),(a=this.inEdgesMap.get(l))===null||a===void 0||a.set(c,u),(s=this.outEdgesMap.get(f))===null||s===void 0||s.set(c,u),this.edgeCountNum+=1,this}},{key:"removeEdge",value:function(n,r,o){var i=sn(this.isDirected(),n,r,o),a=this.edgesMap.get(i);if(a){var s=Tn(this.isDirected(),n,r,o),u=s.v,c=s.w;this.edgesLabelsMap.delete(i),this.edgesMap.delete(i);var f=this.predecessorsMap.get(c),l=this.successorsMap.get(u);kt(f,u),kt(l,c),this.inEdgesMap.get(c).delete(i),this.outEdgesMap.get(u).delete(i),this.edgeCountNum-=1}return this}}]),e}();uo.fromJSON=Fo;function pr(e){"@babel/helpers - typeof";return pr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pr(e)}function Ts(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ta(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ni(e,t,n){return t&&ta(e.prototype,t),n&&ta(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function co(){return typeof Reflect!="undefined"&&Reflect.get?co=Reflect.get:co=function(t,n,r){var o=na(t,n);if(o){var i=Object.getOwnPropertyDescriptor(o,n);return i.get?i.get.call(arguments.length<3?t:r):i.value}},co.apply(this,arguments)}function na(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=xo(e),e!==null););return e}function In(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fo(e,t)}function fo(e,t){return fo=Object.setPrototypeOf||function(r,o){return r.__proto__=o,r},fo(e,t)}function zo(e){var t=Bo();return function(){var r=xo(e),o;if(t){var i=xo(this).constructor;o=Reflect.construct(r,arguments,i)}else o=r.apply(this,arguments);return Pa(this,o)}}function Pa(e,t){if(t&&(pr(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bo(e)}function bo(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function xo(e){return xo=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},xo(e)}var Ai=null;function ra(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Is(e,t,n){return t&&ra(e.prototype,t),n&&ra(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ns(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Zr=Is(function e(){var t=this;Ns(this,e),this.arr=[],this.keyIndice=new Map,this.size=function(){return t.arr.length},this.keys=function(){return t.arr.map(function(n){return n.key})},this.has=function(n){return t.keyIndice.has(n)},this.priority=function(n){var r=t.keyIndice.get(n);if(r!==void 0)return t.arr[r].priority},this.swap=function(n,r){var o=t.arr,i=t.keyIndice,a=[o[n],o[r]],s=a[0],u=a[1];o[n]=u,o[r]=s,i.set(s.key,r),i.set(u.key,n)},this.innerDecrease=function(n){for(var r=t.arr,o=r[n].priority,i,a=n;a!==0;){var s;if(i=a>>1,((s=r[i])===null||s===void 0?void 0:s.priority)<o)break;t.swap(a,i),a=i}},this.heapify=function(n){var r=t.arr,o=n<<1,i=o+1,a=n;o<r.length&&(a=r[o].priority<r[a].priority?o:a,i<r.length&&(a=r[i].priority<r[a].priority?i:a),a!==n&&(t.swap(n,a),t.heapify(a)))},this.min=function(){if(t.size()===0)throw new Error("Queue underflow");return t.arr[0].key},this.add=function(n,r){var o=t.keyIndice,i=t.arr;if(!o.has(n)){var a=i.length;return o.set(n,a),i.push({key:n,priority:r}),t.innerDecrease(a),!0}return!1},this.removeMin=function(){t.swap(0,t.arr.length-1);var n=t.arr.pop();return t.keyIndice.delete(n.key),t.heapify(0),n.key},this.decrease=function(n,r){if(!t.has(n))throw new Error("There's no key named ".concat(n));var o=t.keyIndice.get(n);if(r>t.arr[o].priority)throw new Error("New priority is greater than current priority.Key: ".concat(n," Old: + ").concat(t.arr[o].priority," New: ").concat(r));t.arr[o].priority=r,t.innerDecrease(o)}}),Pu=function(t,n){var r=new uo,o=new Map,i=new Zr,a;function s(f){var l=f.v===a?f.w:f.v,d=i.priority(l);if(d!==void 0){var h=n(f);h<d&&(o.set(l,a),i.decrease(l,h))}}if(t.nodeCount()===0)return r;t.nodes().forEach(function(f){i.add(f,Number.POSITIVE_INFINITY),r.setNode(f)}),i.decrease(t.nodes()[0],0);for(var u=!1;i.size()>0;){var c;if(a=i.removeMin(),o.has(a))r.setEdge(a,o.get(a));else{if(u)throw new Error("Input graph is not connected: "+t.graph());u=!0}(c=t.nodeEdges(a))===null||c===void 0||c.forEach(s)}return r},wo=Pu,Uo=function(t){var n=new Set,r=[],o=t.nodes();return o.forEach(function(i){for(var a=[],s=[i];s.length>0;){var u=s.pop();if(!n.has(u)){var c,f;n.add(u),a.push(u),(c=t.successors(u))===null||c===void 0||c.forEach(function(l){return s.push(l)}),(f=t.predecessors(u))===null||f===void 0||f.forEach(function(l){return s.push(l)})}}a.length&&r.push(a)}),r},_o=Uo,As=function e(t,n,r,o,i,a){o.includes(n)||(o.push(n),r||a.push(n),i(n).forEach(function(s){return e(t,s,r,o,i,a)}),r&&a.push(n))},Fu=function(t,n,r){var o=Array.isArray(n)?n:[n],i=function(c){return t.isDirected()?t.successors(c):t.neighbors(c)},a=[],s=[];return o.forEach(function(u){if(t.hasNode(u))As(t,u,r==="post",s,i,a);else throw new Error("Graph does not have node: "+u)}),a},So=Fu;function oa(e,t){return To(e)||Rs(e,t)||ia(e,t)||Vo()}function Vo(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ia(e,t){if(e){if(typeof e=="string")return lo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lo(e,t)}}function lo(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Rs(e,t){var n=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r=[],o=!0,i=!1,a,s;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(r.push(a.value),!(t&&r.length===t));o=!0);}catch(u){i=!0,s=u}finally{try{!o&&n.return!=null&&n.return()}finally{if(i)throw s}}return r}}function To(e){if(Array.isArray(e))return e}var Fa=function(){return 1},zu=function(t,n,r,o){return Ds(t,n,r||Fa,o||function(i){return t.outEdges(i)})},Ds=function(t,n,r,o){var i=new Map,a=new Zr,s,u,c=function(d){var h=d.v!==s?d.v:d.w,v=i.get(h),m=r(d),g=u.distance+m;if(m<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+d+" Weight: "+m);g<v.distance&&(v.distance=g,v.predecessor=s,a.decrease(h,g))};for(t.nodes().forEach(function(l){var d=l===n?0:Number.POSITIVE_INFINITY;i.set(l,{distance:d}),a.add(l,d)});a.size()>0&&(s=a.removeMin(),u=i.get(s),!(u&&u.distance===Number.POSITIVE_INFINITY));)o(s).forEach(c);var f={};return Array.from(i.entries()).forEach(function(l){var d=oa(l,2),h=d[0],v=d[1];return f[String(h)]=v,f}),f},Ri=zu,za=function(t,n,r){var o={};return t.nodes().forEach(function(i){return o[String(i)]=Ri(t,i,n,r),o}),o},Cs=za,aa=function(t){var n=0,r=[],o=new Map,i=[];function a(s){var u,c={onStack:!0,lowlink:n,index:n};if(o.set(s,c),n+=1,r.push(s),(u=t.successors(s))===null||u===void 0||u.forEach(function(h){var v;if(o.has(h)){if(!((v=o.get(h))===null||v===void 0)&&v.onStack){var g=o.get(h);c.lowlink=Math.min(c.lowlink,g.index)}}else{a(h);var m=o.get(h);c.lowlink=Math.min(c.lowlink,m.lowlink)}}),c.lowlink===c.index){var f=[],l;do{l=r.pop();var d=o.get(l);d.onStack=!1,f.push(l)}while(s!==l);i.push(f)}}return t.nodes().forEach(function(s){o.has(s)||a(s)}),i},Ba=aa,Nn=function(t){return Ba(t).filter(function(n){return n.length>1||n.length===1&&t.hasEdge(n[0],n[0])})},Ua=Nn;function sa(e){"@babel/helpers - typeof";return sa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sa(e)}function jr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Va(e,t,n){return t&&jr(e.prototype,t),n&&jr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Di(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yr(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qn(e,t)}function Ci(e){var t=$t();return function(){var r=Fr(e),o;if(t){var i=Fr(this).constructor;o=Reflect.construct(r,arguments,i)}else o=r.apply(this,arguments);return li(this,o)}}function li(e,t){if(t&&(sa(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return di(e)}function di(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xo(e){var t=typeof Map=="function"?new Map:void 0;return Xo=function(r){if(r===null||!Kn(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(r))return t.get(r);t.set(r,o)}function o(){return pn(r,arguments,Fr(this).constructor)}return o.prototype=Object.create(r.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),qn(o,r)},Xo(e)}function pn(e,t,n){return $t()?pn=Reflect.construct:pn=function(o,i,a){var s=[null];s.push.apply(s,i);var u=Function.bind.apply(o,s),c=new u;return a&&qn(c,a.prototype),c},pn.apply(null,arguments)}function $t(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function Kn(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function qn(e,t){return qn=Object.setPrototypeOf||function(r,o){return r.__proto__=o,r},qn(e,t)}function Fr(e){return Fr=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},Fr(e)}var zr=function(e){Yr(n,e);var t=Ci(n);function n(){return Di(this,n),t.apply(this,arguments)}return Va(n)}(Xo(Error));function Bu(e){var t=new Set,n=new Set,r=[];function o(i){if(n.has(i))throw new zr;if(!t.has(i)){var a;n.add(i),t.add(i),(a=e.predecessors(i))===null||a===void 0||a.forEach(o),n.delete(i),r.push(i)}}if(e.sinks().forEach(o),t.size!==e.nodeCount())throw new zr;return r}var Os=Bu,Ls=function(t){try{Os(t)}catch(n){if(n instanceof zr)return!1;throw n}return!0},Uu=Ls,Vu=function(t,n){return So(t,n,"post")},ua=Vu,Xu=function(t,n){return So(t,n,"pre")},$u=Xu,Wu=function(){return 1};function Hu(e,t,n){return jc(e,t||Wu,n||function(r){return e.outEdges(r)})}function jc(e,t,n){var r={},o=e.nodes();return o.forEach(function(i){var a=String(i);r[a]={},r[a][a]={distance:0},o.forEach(function(s){i!==s&&(r[a][String(s)]={distance:Number.POSITIVE_INFINITY})}),n(i).forEach(function(s){var u=s.v===i?s.w:s.v,c=t(s);r[a][String(u)]={distance:c,predecessor:i}})}),o.forEach(function(i){var a=String(i),s=r[a];o.forEach(function(u){var c=String(u),f=r[c];o.forEach(function(l){var d=String(l),h=f[a],v=s[d],m=f[d],g=h.distance+v.distance;g<m.distance&&(m.distance=g,m.predecessor=v.predecessor)})})}),r}var Yc=Hu;function Kc(e,t){return ef(e)||Jc(e,t)||Qc(e,t)||qc()}function qc(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qc(e,t){if(e){if(typeof e=="string")return Zu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zu(e,t)}}function Zu(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Jc(e,t){var n=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r=[],o=!0,i=!1,a,s;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(r.push(a.value),!(t&&r.length===t));o=!0);}catch(u){i=!0,s=u}finally{try{!o&&n.return!=null&&n.return()}finally{if(i)throw s}}return r}}function ef(e){if(Array.isArray(e))return e}function Xa(e){return e instanceof Graph}function tf(e){if(e.isMultigraph())return!1;for(var t=e.edges(),n=new Map,r=0;r<t.length;r++){var o=t[r];if(o.v===o.w)return!1;var i=[o.v,o.w].sort(),a=Kc(i,2),s=a[0],u=a[1],c="".concat(s,"-").concat(u);if(n.has(c))return!1;n.set(c,!0)}return!0}function nf(e){return e.nodes().length===0}function Ms(e){for(var t=e.edges(),n=0;n<t.length;n++){var r=t[n];if(r.v===r.w)return!0}return!1}var Th=function(t,n){if(!isSimpleGraph(t)||!isSimpleGraph(n)||!containAllSameNodes(t,n)||containSameEdges(t,n))return!1;var r=t.nodeCount();return t.edgeCount()+n.edgeCount()===r*(r-1)/2},Ih=function(t){if(!isSimpleGraph(t))return null;for(var n=t.nodeCount(),r=new Graph({compound:t.isCompound(),directed:t.isDirected(),multigraph:t.isMultigraph()}),o=t.nodes(),i=0;i<n;i++){var a=o[i];r.setNode(a,t.node(a));for(var s=i+1;s<n;s++){var u=o[s];t.hasEdge(a,u)||r.setEdge(a,u)}}return r};class zl extends yn{}class ju extends uo{}const Bl=()=>1,Ul=(e,t)=>{var n;if(e.nodeCount()<=1)return[];const r=Xl(e,t||Bl);return(n=Vl(r.graph,r.buckets,r.zeroIdx).map(i=>e.outEdges(i.v,i.w)))===null||n===void 0?void 0:n.flat()},Vl=(e,t,n)=>{let r=[];const o=t[t.length-1],i=t[0];let a;for(;e.nodeCount();){for(;a=i.dequeue();)$a(e,t,n,a);for(;a=o.dequeue();)$a(e,t,n,a);if(e.nodeCount()){for(let s=t.length-2;s>0;--s)if(a=t[s].dequeue(),a){r=r.concat($a(e,t,n,a,!0));break}}}return r},$a=(e,t,n,r,o)=>{var i,a;const s=[];return(i=e.inEdges(r.v))===null||i===void 0||i.forEach(u=>{const c=e.edge(u),f=e.node(u.v);o&&s.push({v:u.v,w:u.w,in:0,out:0}),f.out===void 0&&(f.out=0),f.out-=c,Wa(t,n,f)}),(a=e.outEdges(r.v))===null||a===void 0||a.forEach(u=>{const c=e.edge(u),f=u.w,l=e.node(f);l.in===void 0&&(l.in=0),l.in-=c,Wa(t,n,l)}),e.removeNode(r.v),o?s:void 0},Xl=(e,t)=>{const n=new ju;let r=0,o=0;e.nodes().forEach(u=>{n.setNode(u,{v:u,in:0,out:0})}),e.edges().forEach(u=>{const c=n.edge(u)||0,f=(t==null?void 0:t(u))||1,l=c+f;n.setEdge(u.v,u.w,l),o=Math.max(o,n.node(u.v).out+=f),r=Math.max(r,n.node(u.w).in+=f)});const i=[],a=o+r+3;for(let u=0;u<a;u++)i.push(new zl);const s=r+1;return n.nodes().forEach(u=>{Wa(i,s,n.node(u))}),{buckets:i,zeroIdx:s,graph:n}},Wa=(e,t,n)=>{n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)};var rf=Ul;const of=e=>{const t=r=>o=>{var i;return((i=r.edge(o))===null||i===void 0?void 0:i.weight)||1},n=e.graph().acyclicer==="greedy"?rf(e,t(e)):Yu(e);n==null||n.forEach(r=>{const o=e.edge(r);e.removeEdgeObj(r),o.forwardName=r.name,o.reversed=!0,e.setEdge(r.w,r.v,o,`rev-${Math.random()}`)})},Yu=e=>{const t=[],n={},r={},o=i=>{var a;r[i]||(r[i]=!0,n[i]=!0,(a=e.outEdges(i))===null||a===void 0||a.forEach(s=>{n[s.w]?t.push(s):o(s.w)}),delete n[i])};return e.nodes().forEach(o),t};var Ha={run:of,undo:e=>{e.edges().forEach(t=>{const n=e.edge(t);if(n.reversed){e.removeEdgeObj(t);const r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}};class $o extends uo{}const $l=(e,t)=>Number(e)-Number(t),ca=(e,t,n,r)=>{let o;do o=`${r}${Math.random()}`;while(e.hasNode(o));return n.dummy=t,e.setNode(o,n),o},Wl=e=>{const t=new $o().setGraph(e.graph());return e.nodes().forEach(n=>{t.setNode(n,e.node(n))}),e.edges().forEach(n=>{const r=t.edgeFromArgs(n.v,n.w)||{weight:0,minlen:1},o=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+o.weight,minlen:Math.max(r.minlen,o.minlen)})}),t},af=e=>{const t=new $o({multigraph:e.isMultigraph()}).setGraph(e.graph());return e.nodes().forEach(n=>{var r;!((r=e.children(n))===null||r===void 0)&&r.length||t.setNode(n,e.node(n))}),e.edges().forEach(n=>{t.setEdgeObj(n,e.edge(n))}),t},sf=(e,t)=>e==null?void 0:e.reduce((n,r,o)=>(n[r]=t[o],n),{}),Ah=e=>{const t={};return e.nodes().forEach(n=>{var r;const o={};(r=e.outEdges(n))===null||r===void 0||r.forEach(i=>{var a;o[i.w]=(o[i.w]||0)+(((a=e.edge(i))===null||a===void 0?void 0:a.weight)||0)}),t[n]=o}),t},Hl=e=>{const t=e.nodes(),n=t.map(r=>{var o;const i={};return(o=e.inEdges(r))===null||o===void 0||o.forEach(a=>{i[a.v]=(i[a.v]||0)+e.edge(a).weight}),i});return sf(t,n)},fa=(e,t)=>{const n=Number(e.x),r=Number(e.y),o=Number(t.x)-n,i=Number(t.y)-r;let a=Number(e.width)/2,s=Number(e.height)/2;if(!o&&!i)return{x:0,y:0};let u,c;return Math.abs(i)*a>Math.abs(o)*s?(i<0&&(s=-s),u=s*o/i,c=s):(o<0&&(a=-a),u=a,c=a*i/o),{x:n+u,y:r+c}},Za=e=>{const t=[],n=Ku(e)+1;for(let r=0;r<n;r++)t.push([]);e.nodes().forEach(r=>{const o=e.node(r);if(!o)return;const i=o.rank;i!==void 0&&t[i]&&t[i].push(r)});for(let r=0;r<n;r++)t[r]=t[r].sort((o,i)=>{var a,s;return $l((a=e.node(o))===null||a===void 0?void 0:a.order,(s=e.node(i))===null||s===void 0?void 0:s.order)});return t},ks=e=>{const t=e.nodes().filter(r=>{var o;return((o=e.node(r))===null||o===void 0?void 0:o.rank)!==void 0}).map(r=>e.node(r).rank),n=Math.min(...t);e.nodes().forEach(r=>{const o=e.node(r);o.hasOwnProperty("rank")&&n!==1/0&&(o.rank-=n)})},to=e=>{const t=e.nodes(),n=t.filter(s=>{var u;return((u=e.node(s))===null||u===void 0?void 0:u.rank)!==void 0}).map(s=>e.node(s).rank),r=Math.min(...n),o=[];t.forEach(s=>{var u;const c=(((u=e.node(s))===null||u===void 0?void 0:u.rank)||0)-r;o[c]||(o[c]=[]),o[c].push(s)});let i=0;const a=e.graph().nodeRankFactor||0;for(let s=0;s<o.length;s++){const u=o[s];u===void 0?s%a!==0&&(i-=1):i&&(u==null||u.forEach(c=>{const f=e.node(c);f&&(f.rank=f.rank||0,f.rank+=i)}))}},Oi=(e,t,n,r)=>{const o={width:0,height:0};return be(n)&&be(r)&&(o.rank=n,o.order=r),ca(e,"border",o,t)},Ku=e=>{let t;return e.nodes().forEach(n=>{var r;const o=(r=e.node(n))===null||r===void 0?void 0:r.rank;o!==void 0&&(t===void 0||o>t)&&(t=o)}),t||(t=0),t},uf=(e,t)=>{const n={lhs:[],rhs:[]};return e==null||e.forEach(r=>{t(r)?n.lhs.push(r):n.rhs.push(r)}),n},qu=(e,t)=>{const n=Date.now();try{return t()}finally{console.log(`${e} time: ${Date.now()-n}ms`)}},Qu=(e,t)=>t(),Gs=(e,t)=>e.reduce((n,r)=>{const o=t(n),i=t(r);return o>i?r:n}),cf=e=>{e.graph().dummyChains=[],e.edges().forEach(t=>Zl(e,t))},Zl=(e,t)=>{let n=t.v,r=e.node(n).rank;const o=t.w,i=e.node(o).rank,a=t.name,s=e.edge(t),u=s.labelRank;if(i===r+1)return;e.removeEdgeObj(t);const c=e.graph();let f,l,d;for(d=0,++r;r<i;++d,++r)s.points=[],l={edgeLabel:s,width:0,height:0,edgeObj:t,rank:r},f=ca(e,"edge",l,"_d"),r===u&&(l.width=s.width,l.height=s.height,l.dummy="edge-label",l.labelpos=s.labelpos),e.setEdge(n,f,{weight:s.weight},a),d===0&&(c.dummyChains||(c.dummyChains=[]),c.dummyChains.push(f)),n=f;e.setEdge(n,o,{weight:s.weight},a)};var fr={run:cf,undo:e=>{var t;(t=e.graph().dummyChains)===null||t===void 0||t.forEach(n=>{let r=e.node(n);const o=r.edgeLabel;let i;r.edgeObj&&e.setEdgeObj(r.edgeObj,o);let a=n;for(;r.dummy;)i=e.successors(a)[0],e.removeNode(a),o.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(o.x=r.x,o.y=r.y,o.width=r.width,o.height=r.height),a=i,r=e.node(a)})}};const Ps=e=>{var t;const n={},r=o=>{var i;const a=e.node(o);if(!a)return 0;if(n[o])return a.rank;n[o]=!0;let s;return(i=e.outEdges(o))===null||i===void 0||i.forEach(u=>{const c=r(u.w),f=e.edge(u).minlen,l=c-f;l&&(s===void 0||l<s)&&(s=l)}),s||(s=0),a.rank=s,s};(t=e.sources())===null||t===void 0||t.forEach(o=>r(o))},Ju=e=>{var t;const n={};let r;const o=s=>{var u;const c=e.node(s);if(!c)return 0;if(n[s])return c.rank;n[s]=!0;let f;return(u=e.outEdges(s))===null||u===void 0||u.forEach(l=>{const d=o(l.w),h=e.edge(l).minlen,v=d-h;v&&(f===void 0||v<f)&&(f=v)}),f||(f=0),(r===void 0||f<r)&&(r=f),c.rank=f,f};(t=e.sources())===null||t===void 0||t.forEach(s=>{e.node(s)&&o(s)}),r===void 0&&(r=0);const i={},a=(s,u)=>{var c;const f=e.node(s),l=isNaN(f.layer)?u:f.layer;(f.rank===void 0||f.rank<l)&&(f.rank=l),!i[s]&&(i[s]=!0,(c=e.outEdges(s))===null||c===void 0||c.map(d=>{a(d.w,l+e.edge(d).minlen)}))};e.nodes().forEach(s=>{const u=e.node(s);u&&(isNaN(u.layer)?u.rank-=r:a(s,u.layer))})},Or=(e,t)=>e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen;var jl={longestPath:Ps,longestPathWithLayer:Ju,slack:Or};const ec=e=>{const t=new $o({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});let o,i;for(;Yl(t,e)<r;)o=lf(t,e),i=t.hasNode(o.v)?Or(e,o):-Or(e,o),Fs(t,e,i);return t},Yl=(e,t)=>{const n=r=>{t.nodeEdges(r).forEach(o=>{const i=o.v,a=r===i?o.w:i;!e.hasNode(a)&&!Or(t,o)&&(e.setNode(a,{}),e.setEdge(r,a,{}),n(a))})};return e.nodes().forEach(n),e.nodeCount()},ff=e=>{const t=new $o({directed:!1}),n=e.nodes()[0],r=e.nodes().filter(a=>!!e.node(a)).length;t.setNode(n,{});let o,i;for(;Kl(t,e)<r;)o=lf(t,e),i=t.hasNode(o.v)?Or(e,o):-Or(e,o),Fs(t,e,i);return t},Kl=(e,t)=>{const n=r=>{var o;(o=t.nodeEdges(r))===null||o===void 0||o.forEach(i=>{const a=i.v,s=r===a?i.w:a;!e.hasNode(s)&&(t.node(s).layer!==void 0||!Or(t,i))&&(e.setNode(s,{}),e.setEdge(r,s,{}),n(s))})};return e.nodes().forEach(n),e.nodeCount()},lf=(e,t)=>Gs(t.edges(),n=>e.hasNode(n.v)!==e.hasNode(n.w)?Or(t,n):1/0),Fs=(e,t,n)=>{e.nodes().forEach(r=>{t.node(r).rank||(t.node(r).rank=0),t.node(r).rank+=n})};var ql={feasibleTree:ec,feasibleTreeWithLayer:ff};const{preorder:Ql,postorder:df}=ee,hf=e=>{const t=Wl(e);Ps(t);const n=ec(t);Wo(n),vf(n,t);let r,o;for(;r=pf(n);)o=mf(n,t,r),gf(n,t,r,o)},vf=(e,t)=>{let n=df(e,e.nodes());n=n==null?void 0:n.slice(0,(n==null?void 0:n.length)-1),n==null||n.forEach(r=>{zs(e,t,r)})},zs=(e,t,n)=>{const o=e.node(n).parent;e.edgeFromArgs(n,o).cutvalue=Jl(e,t,n)},Jl=(e,t,n)=>{var r;const i=e.node(n).parent;let a=!0,s=t.edgeFromArgs(n,i),u=0;return s||(a=!1,s=t.edgeFromArgs(i,n)),u=s.weight,(r=t.nodeEdges(n))===null||r===void 0||r.forEach(c=>{const f=c.v===n,l=f?c.w:c.v;if(l!==i){const d=f===a,h=t.edge(c).weight;if(u+=d?h:-h,Ef(e,n,l)){const v=e.edgeFromArgs(n,l).cutvalue;u+=d?-v:v}}}),u},Wo=(e,t=e.nodes()[0])=>{Ya(e,{},1,t)},Ya=(e,t,n,r,o)=>{var i;const a=n;let s=n;const u=e.node(r);return t[r]=!0,(i=e.neighbors(r))===null||i===void 0||i.forEach(c=>{t[c]||(s=Ya(e,t,s,c,r))}),u.low=a,u.lim=s++,o?u.parent=o:delete u.parent,s},pf=e=>e.edges().find(t=>e.edge(t).cutvalue<0),mf=(e,t,n)=>{let r=n.v,o=n.w;t.hasEdge(r,o)||(r=n.w,o=n.v);const i=e.node(r),a=e.node(o);let s=i,u=!1;i.lim>a.lim&&(s=a,u=!0);const c=t.edges().filter(f=>u===tc(e,e.node(f.v),s)&&u!==tc(e,e.node(f.w),s));return Gs(c,f=>Or(t,f))},gf=(e,t,n,r)=>{const o=n.v,i=n.w;e.removeEdge(o,i),e.setEdge(r.v,r.w,{}),Wo(e),vf(e,t),yf(e,t)},yf=(e,t)=>{const n=e.nodes().find(o=>{var i;return!(!((i=t.node(o))===null||i===void 0)&&i.parent)});let r=Ql(e,n);r=r==null?void 0:r.slice(1),r==null||r.forEach(o=>{const i=e.node(o).parent;let a=t.edgeFromArgs(o,i),s=!1;a||(a=t.edgeFromArgs(i,o),s=!0),t.node(o).rank=t.node(i).rank+(s?a.minlen:-a.minlen)})},Ef=(e,t,n)=>e.hasEdge(t,n),tc=(e,t,n)=>n.low<=t.lim&&t.lim<=n.lim;var bf=hf;const xf=e=>{switch(e.graph().ranker){case"network-simplex":_f(e);break;case"tight-tree":no(e);break;case"longest-path":wf(e);break;default:no(e)}},wf=Ps,no=e=>{Ju(e),ff(e)},_f=e=>{bf(e)};var ed=xf;const Ho=e=>{var t;const n={};let r=0;const o=i=>{var a;const s=r;(a=e.children(i))===null||a===void 0||a.forEach(o),n[i]={low:s,lim:r++}};return(t=e.children())===null||t===void 0||t.forEach(o),n},nc=(e,t,n,r)=>{const o=[],i=[],a=Math.min(t[n].low,t[r].low),s=Math.max(t[n].lim,t[r].lim);let u,c;u=n;do u=e.parent(u),o.push(u);while(u&&(t[u].low>a||s>t[u].lim));for(c=u,u=r;u&&u!==c;)i.push(u),u=e.parent(u);return{lca:c,path:o.concat(i.reverse())}};var Bs=e=>{var t;const n=Ho(e);(t=e.graph().dummyChains)===null||t===void 0||t.forEach(r=>{var o,i;let a=r,s=e.node(a);const u=s.edgeObj;if(!u)return;const c=nc(e,n,u.v,u.w),f=c.path,l=c.lca;let d=0,h=f[d],v=!0;for(;a!==u.w;){if(s=e.node(a),v){for(;h!==l&&((o=e.node(h))===null||o===void 0?void 0:o.maxRank)<s.rank;)d++,h=f[d];h===l&&(v=!1)}if(!v){for(;d<f.length-1&&((i=e.node(f[d+1]))===null||i===void 0?void 0:i.minRank)<=s.rank;)d++;h=f[d]}e.setParent(a,h),a=e.successors(a)[0]}})};const Sf=e=>{var t;const n=ca(e,"root",{},"_root"),r=Tf(e);let o=Math.max(...Object.values(r));Math.abs(o)===1/0&&(o=1);const i=o-1,a=2*i+1;e.graph().nestingRoot=n,e.edges().forEach(u=>{e.edge(u).minlen*=a});const s=If(e)+1;(t=e.children())===null||t===void 0||t.forEach(u=>{rc(e,n,a,s,i,r,u)}),e.graph().nodeRankFactor=a},rc=(e,t,n,r,o,i,a)=>{const s=e.children(a);if(!(s!=null&&s.length)){a!==t&&e.setEdge(t,a,{weight:0,minlen:n});return}const u=Oi(e,"_bt"),c=Oi(e,"_bb"),f=e.node(a);e.setParent(u,a),f.borderTop=u,e.setParent(c,a),f.borderBottom=c,s==null||s.forEach(l=>{rc(e,t,n,r,o,i,l);const d=e.node(l),h=d.borderTop?d.borderTop:l,v=d.borderBottom?d.borderBottom:l,m=d.borderTop?r:2*r,g=h!==v?1:o-i[a]+1;e.setEdge(u,h,{minlen:g,weight:m,nestingEdge:!0}),e.setEdge(v,c,{minlen:g,weight:m,nestingEdge:!0})}),e.parent(a)||e.setEdge(t,u,{weight:0,minlen:o+i[a]})},Tf=e=>{var t;const n={},r=(o,i)=>{const a=e.children(o);a==null||a.forEach(s=>r(s,i+1)),n[o]=i};return(t=e.children())===null||t===void 0||t.forEach(o=>r(o,1)),n},If=e=>{let t=0;return e.edges().forEach(n=>{t+=e.edge(n).weight}),t};var Nf={run:Sf,cleanup:e=>{const t=e.graph();t.nestingRoot&&e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges().forEach(n=>{e.edge(n).nestingEdge&&e.removeEdgeObj(n)})}};const nd=e=>{var t;const n=r=>{const o=e.children(r),i=e.node(r);if(o!=null&&o.length&&o.forEach(a=>n(a)),i.hasOwnProperty("minRank")){i.borderLeft=[],i.borderRight=[];for(let a=i.minRank,s=i.maxRank+1;a<s;a+=1)Af(e,"borderLeft","_bl",r,i,a),Af(e,"borderRight","_br",r,i,a)}};(t=e.children())===null||t===void 0||t.forEach(r=>n(r))},Af=(e,t,n,r,o,i)=>{const a={rank:i,borderType:t,width:0,height:0},s=o[t][i-1],u=ca(e,"border",a,n);o[t][i]=u,e.setParent(u,r),s&&e.setEdge(s,u,{weight:1})};var rd=nd;const od=e=>{var t;const n=(t=e.graph().rankdir)===null||t===void 0?void 0:t.toLowerCase();(n==="lr"||n==="rl")&&Rf(e)},id=e=>{var t;const n=(t=e.graph().rankdir)===null||t===void 0?void 0:t.toLowerCase();(n==="bt"||n==="rl")&&Df(e),(n==="lr"||n==="rl")&&(ad(e),Rf(e))},Rf=e=>{e.nodes().forEach(t=>{oc(e.node(t))}),e.edges().forEach(t=>{oc(e.edge(t))})},oc=e=>{const t=e.width;e.width=e.height,e.height=t},Df=e=>{e.nodes().forEach(t=>{ic(e.node(t))}),e.edges().forEach(t=>{var n;const r=e.edge(t);(n=r.points)===null||n===void 0||n.forEach(o=>ic(o)),r.hasOwnProperty("y")&&ic(r)})},ic=e=>{e!=null&&e.y&&(e.y=-e.y)},ad=e=>{e.nodes().forEach(t=>{Ka(e.node(t))}),e.edges().forEach(t=>{var n;const r=e.edge(t);(n=r.points)===null||n===void 0||n.forEach(o=>Ka(o)),r.hasOwnProperty("x")&&Ka(r)})},Ka=e=>{const t=e.x;e.x=e.y,e.y=t};var qa={adjust:od,undo:id},sd={}.toString,ud=function(e,t){return sd.call(e)==="[object "+t+"]"},cd=ud,Cf=function(e){return Array.isArray?Array.isArray(e):cd(e,"Array")},ac=function(e){if(Cf(e))return e.reduce(function(t,n){return Math.max(t,n)},e[0])},Of=e=>{const t={},n=e.nodes().filter(f=>{var l;return!(!((l=e.children(f))===null||l===void 0)&&l.length)}),r=n.map(f=>e.node(f).rank),o=ac(r),i=[];for(let f=0;f<o+1;f++)i.push([]);const a=f=>{var l;if(t.hasOwnProperty(f))return;t[f]=!0;const d=e.node(f);isNaN(d.rank)||i[d.rank].push(f),(l=e.successors(f))===null||l===void 0||l.forEach(h=>a(h))},s=n.sort((f,l)=>e.node(f).rank-e.node(l).rank),c=s.filter(f=>e.node(f).fixorder!==void 0).sort((f,l)=>e.node(f).fixorder-e.node(l).fixorder);return c==null||c.forEach(f=>{isNaN(e.node(f).rank)||i[e.node(f).rank].push(f),t[f]=!0}),s==null||s.forEach(a),i};const ld=(e,t,n)=>{const r=sf(n,n.map((f,l)=>l)),i=t.map(f=>{var l;const d=(l=e.outEdges(f))===null||l===void 0?void 0:l.map(h=>({pos:r[h.w]||0,weight:e.edge(h).weight}));return d==null?void 0:d.sort((h,v)=>h.pos-v.pos)}).flat().filter(f=>f!==void 0);let a=1;for(;a<n.length;)a<<=1;const s=2*a-1;a-=1;const u=Array(s).fill(0,0,s);let c=0;return i==null||i.forEach(f=>{if(f){let l=f.pos+a;u[l]+=f.weight;let d=0;for(;l>0;)l%2&&(d+=u[l+1]),l=l-1>>1,u[l]+=f.weight;c+=f.weight*d}}),c};var Lf=(e,t)=>{let n=0;for(let r=1;r<(t==null?void 0:t.length);r+=1)n+=ld(e,t[r-1],t[r]);return n};const dd=(e,t,n)=>{const r=da(e),o=new $o({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(i=>e.node(i));return e.nodes().forEach(i=>{var a;const s=e.node(i),u=e.parent(i);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(o.setNode(i),o.setParent(i,u||r),(a=e[n](i))===null||a===void 0||a.forEach(c=>{const f=c.v===i?c.w:c.v,l=o.edgeFromArgs(f,i),d=l!==void 0?l.weight:0;o.setEdge(f,i,{weight:e.edge(c).weight+d})}),s.hasOwnProperty("minRank")&&o.setNode(i,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))}),o},da=e=>{let t;for(;e.hasNode(t=`_root${Math.random()}`););return t};var hd=dd,Mf=(e,t,n)=>{const r={};let o;n==null||n.forEach(i=>{let a=e.parent(i),s,u;for(;a;){if(s=e.parent(a),s?(u=r[s],r[s]=a):(u=o,o=a),u&&u!==a){t.setEdge(u,a);return}a=s}})},vd=(e,t)=>t.map(n=>{const r=e.inEdges(n);if(!(r!=null&&r.length))return{v:n};{const o={sum:0,weight:0};return r==null||r.forEach(i=>{const a=e.edge(i),s=e.node(i.v);o.sum+=a.weight*s.order,o.weight+=a.weight}),{v:n,barycenter:o.sum/o.weight,weight:o.weight}}});const Gf=(e,t)=>{var n,r,o;const i={};e==null||e.forEach((s,u)=>{i[s.v]={i:u,indegree:0,in:[],out:[],vs:[s.v]};const c=i[s.v];s.barycenter!==void 0&&(c.barycenter=s.barycenter,c.weight=s.weight)}),(n=t.edges())===null||n===void 0||n.forEach(s=>{const u=i[s.v],c=i[s.w];u!==void 0&&c!==void 0&&(c.indegree++,u.out.push(i[s.w]))});const a=(o=(r=Object.values(i)).filter)===null||o===void 0?void 0:o.call(r,s=>!s.indegree);return pd(a)},pd=e=>{var t,n;const r=[],o=u=>c=>{c.merged||(c.barycenter===void 0||u.barycenter===void 0||c.barycenter>=u.barycenter)&&md(u,c)},i=u=>c=>{c.in.push(u),--c.indegree===0&&e.push(c)};for(;e!=null&&e.length;){const u=e.pop();r.push(u),(t=u.in.reverse())===null||t===void 0||t.forEach(c=>o(u)(c)),(n=u.out)===null||n===void 0||n.forEach(c=>i(u)(c))}const a=r.filter(u=>!u.merged),s=["vs","i","barycenter","weight"];return a.map(u=>{const c={};return s==null||s.forEach(f=>{u[f]!==void 0&&(c[f]=u[f])}),c})},md=(e,t)=>{var n;let r=0,o=0;e.weight&&(r+=e.barycenter*e.weight,o+=e.weight),t.weight&&(r+=t.barycenter*t.weight,o+=t.weight),e.vs=(n=t.vs)===null||n===void 0?void 0:n.concat(e.vs),e.barycenter=r/o,e.weight=o,e.i=Math.min(t.i,e.i),t.merged=!0};var gd=Gf;const yd=(e,t,n,r)=>{const o=uf(e,d=>{const h=d.hasOwnProperty("fixorder")&&!isNaN(d.fixorder);return r?!h&&d.hasOwnProperty("barycenter"):h||d.hasOwnProperty("barycenter")}),i=o.lhs,a=o.rhs.sort((d,h)=>-d.i- -h.i),s=[];let u=0,c=0,f=0;i==null||i.sort(Qa(!!t,!!n)),f=Pf(s,a,f),i==null||i.forEach(d=>{var h;f+=(h=d.vs)===null||h===void 0?void 0:h.length,s.push(d.vs),u+=d.barycenter*d.weight,c+=d.weight,f=Pf(s,a,f)});const l={vs:s.flat()};return c&&(l.barycenter=u/c,l.weight=c),l},Pf=(e,t,n)=>{let r=n,o;for(;t.length&&(o=t[t.length-1]).i<=r;)t.pop(),e==null||e.push(o.vs),r++;return r},Qa=(e,t)=>(n,r)=>{if(n.fixorder!==void 0&&r.fixorder!==void 0)return n.fixorder-r.fixorder;if(n.barycenter<r.barycenter)return-1;if(n.barycenter>r.barycenter)return 1;if(t&&n.order!==void 0&&r.order!==void 0){if(n.order<r.order)return-1;if(n.order>r.order)return 1}return e?r.i-n.i:n.i-r.i};var Ed=yd;const Ja=(e,t,n,r,o,i)=>{var a,s,u,c;let f=e.children(t);const l=e.node(t),d=l?l.borderLeft:void 0,h=l?l.borderRight:void 0,v={};d&&(f=f==null?void 0:f.filter(y=>y!==d&&y!==h));const m=vd(e,f||[]);m==null||m.forEach(y=>{var b;if(!((b=e.children(y.v))===null||b===void 0)&&b.length){const w=Ja(e,y.v,n,r,i);v[y.v]=w,w.hasOwnProperty("barycenter")&&ha(y,w)}});const g=gd(m,n);bd(g,v),(a=g.filter(y=>y.vs.length>0))===null||a===void 0||a.forEach(y=>{const b=e.node(y.vs[0]);b&&(y.fixorder=b.fixorder,y.order=b.order)});const E=Ed(g,r,o,i);if(d&&(E.vs=[d,E.vs,h].flat(),!((s=e.predecessors(d))===null||s===void 0)&&s.length)){const y=e.node(((u=e.predecessors(d))===null||u===void 0?void 0:u[0])||""),b=e.node(((c=e.predecessors(h))===null||c===void 0?void 0:c[0])||"");E.hasOwnProperty("barycenter")||(E.barycenter=0,E.weight=0),E.barycenter=(E.barycenter*E.weight+y.order+b.order)/(E.weight+2),E.weight+=2}return E},bd=(e,t)=>{e==null||e.forEach(n=>{var r;const o=(r=n.vs)===null||r===void 0?void 0:r.map(i=>t[i]?t[i].vs:i);n.vs=o.flat()})},ha=(e,t)=>{e.barycenter!==void 0?(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight):(e.barycenter=t.barycenter,e.weight=t.weight)};var va=Ja;const xd=(e,t)=>{const n=Ku(e),r=[],o=[];for(let f=1;f<n+1;f++)r.push(f);for(let f=n-1;f>-1;f--)o.push(f);const i=Li(e,r,"inEdges"),a=Li(e,o,"outEdges");let s=Of(e);hi(e,s);let u=Number.POSITIVE_INFINITY,c;for(let f=0,l=0;l<4;++f,++l){sc(f%2?i:a,f%4>=2,!1,t),s=Za(e);const d=Lf(e,s);d<u&&(l=0,c=Bt(s),u=d)}s=Of(e),hi(e,s);for(let f=0,l=0;l<4;++f,++l){sc(f%2?i:a,f%4>=2,!0,t),s=Za(e);const d=Lf(e,s);d<u&&(l=0,c=Bt(s),u=d)}hi(e,c)},Li=(e,t,n)=>t.map(r=>hd(e,r,n)),sc=(e,t,n,r)=>{const o=new $o;e==null||e.forEach(i=>{var a;const s=i.graph().root,u=va(i,s,o,t,n,r);for(let c=0;c<((a=u.vs)===null||a===void 0?void 0:a.length);c++){const f=i.node(u.vs[c]);f&&(f.order=c)}Mf(i,o,u.vs)})},hi=(e,t)=>{t==null||t.forEach(n=>{n==null||n.forEach((r,o)=>{e.node(r).order=o})})};var uc=xd,Us=function(e){if(Cf(e))return e.reduce(function(t,n){return Math.min(t,n)},e[0])};class cc extends uo{}const Vs=(e,t)=>{const n={},r=(o,i)=>{let a=0,s=0;const u=o.length,c=i==null?void 0:i[(i==null?void 0:i.length)-1];return i==null||i.forEach((f,l)=>{var d;const h=$s(e,f),v=h?e.node(h).order:u;(h||f===c)&&((d=i.slice(s,l+1))===null||d===void 0||d.forEach(m=>{var g;(g=e.predecessors(m))===null||g===void 0||g.forEach(E=>{var y;const b=e.node(E),w=b.order;(w<a||v<w)&&!(b.dummy&&(!((y=e.node(m))===null||y===void 0)&&y.dummy))&&fc(n,E,m)})}),s=l+1,a=v)}),i};return t!=null&&t.length&&t.reduce(r),n},Xs=(e,t)=>{const n={};function r(s,u,c,f,l){var d,h;let v;for(let m=u;m<c;m++)v=s[m],!((d=e.node(v))===null||d===void 0)&&d.dummy&&((h=e.predecessors(v))===null||h===void 0||h.forEach(g=>{const E=e.node(g);E.dummy&&(E.order<f||E.order>l)&&fc(n,g,v)}))}function o(s){return JSON.stringify(s.slice(1))}function i(s,u){const c=o(s);u.get(c)||(r(...s),u.set(c,!0))}const a=(s,u)=>{let c=-1,f,l=0;const d=new Map;return u==null||u.forEach((h,v)=>{var m;if(((m=e.node(h))===null||m===void 0?void 0:m.dummy)==="border"){const g=e.predecessors(h)||[];g.length&&(f=e.node(g[0]).order,i([u,l,v,c,f],d),l=v,c=f)}i([u,l,u.length,f,s.length],d)}),u};return t!=null&&t.length&&t.reduce(a),n},$s=(e,t)=>{var n,r;if(!((n=e.node(t))===null||n===void 0)&&n.dummy)return(r=e.predecessors(t))===null||r===void 0?void 0:r.find(o=>e.node(o).dummy)},fc=(e,t,n)=>{let r=t,o=n;if(r>o){const a=r;r=o,o=a}let i=e[r];i||(e[r]=i={}),i[o]=!0},Ff=(e,t,n)=>{let r=t,o=n;if(r>o){const i=t;r=o,o=i}return!!e[r]},lc=(e,t,n,r)=>{const o={},i={},a={};return t==null||t.forEach(s=>{s==null||s.forEach((u,c)=>{o[u]=u,i[u]=u,a[u]=c})}),t==null||t.forEach(s=>{let u=-1;s==null||s.forEach(c=>{let f=r(c);if(f.length){f=f.sort((d,h)=>a[d]-a[h]);const l=(f.length-1)/2;for(let d=Math.floor(l),h=Math.ceil(l);d<=h;++d){const v=f[d];i[c]===c&&u<a[v]&&!Ff(n,c,v)&&(i[v]=c,i[c]=o[c]=o[v],u=a[v])}}})}),{root:o,align:i}},dc=(e,t,n,r,o)=>{var i;const a={},s=zf(e,t,n,o),u=o?"borderLeft":"borderRight",c=(d,h)=>{let v=s.nodes(),m=v.pop();const g={};for(;m;)g[m]?d(m):(g[m]=!0,v.push(m),v=v.concat(h(m))),m=v.pop()},f=d=>{a[d]=(s.inEdges(d)||[]).reduce((h,v)=>Math.max(h,(a[v.v]||0)+s.edge(v)),0)},l=d=>{const h=(s.outEdges(d)||[]).reduce((m,g)=>Math.min(m,(a[g.w]||0)-s.edge(g)),Number.POSITIVE_INFINITY),v=e.node(d);h!==Number.POSITIVE_INFINITY&&v.borderType!==u&&(a[d]=Math.max(a[d],h))};return c(f,s.predecessors.bind(s)),c(l,s.successors.bind(s)),(i=Object.values(r))===null||i===void 0||i.forEach(d=>{a[d]=a[n[d]]}),a},zf=(e,t,n,r)=>{const o=new cc,i=e.graph(),a=Bf(i.nodesep,i.edgesep,r);return t==null||t.forEach(s=>{let u;s==null||s.forEach(c=>{const f=n[c];if(o.setNode(f),u){const l=n[u],d=o.edgeFromArgs(l,f);o.setEdge(l,f,Math.max(a(e,c,u),d||0))}u=c})}),o},Ws=(e,t)=>Gs(Object.values(t),n=>{var r;let o=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return(r=Object.keys(n))===null||r===void 0||r.forEach(a=>{const s=n[a],u=Uf(e,a)/2;o=Math.max(s+u,o),i=Math.min(s-u,i)}),o-i});function Hs(e,t){const n=Object.values(t),r=Us(n),o=ac(n);["u","d"].forEach(i=>{["l","r"].forEach(a=>{const s=i+a,u=e[s];let c;if(u===t)return;const f=Object.values(u);c=a==="l"?r-Us(f):o-ac(f),c&&(e[s]={},Object.keys(u).forEach(l=>{e[s][l]=u[l]+c}))})})}const hc=(e,t)=>{const n={};return Object.keys(e.ul).forEach(r=>{if(t)n[r]=e[t.toLowerCase()][r];else{const o=Object.values(e).map(i=>i[r]);n[r]=(o[0]+o[1])/2}}),n},wd=e=>{const t=buildLayerMatrix(e),n=Object.assign(Vs(e,t),Xs(e,t)),r={};let o;["u","d"].forEach(a=>{o=a==="u"?t:Object.values(t).reverse(),["l","r"].forEach(s=>{s==="r"&&(o=o.map(l=>Object.values(l).reverse()));const u=(a==="u"?e.predecessors:e.successors).bind(e),c=lc(e,o,n,u),f=dc(e,o,c.root,c.align,s==="r");s==="r"&&Object.keys(f).forEach(l=>{f[l]=-f[l]}),r[a+s]=f})});const i=Ws(e,r);return Hs(r,i),hc(r,e.graph().align)},Bf=(e,t,n)=>(r,o,i)=>{const a=r.node(o),s=r.node(i);let u=0,c;if(u+=a.width/2,a.hasOwnProperty("labelpos"))switch((a.labelpos||"").toLowerCase()){case"l":c=-a.width/2;break;case"r":c=a.width/2;break}if(c&&(u+=n?c:-c),c=0,u+=(a.dummy?t:e)/2,u+=(s.dummy?t:e)/2,u+=s.width/2,s.labelpos)switch((s.labelpos||"").toLowerCase()){case"l":c=s.width/2;break;case"r":c=-s.width/2;break}return c&&(u+=n?c:-c),c=0,u},Uf=(e,t)=>e.node(t).width||0,vc=e=>{const t=Za(e),n=e.graph().ranksep;let r=0;t==null||t.forEach(o=>{const i=o.map(s=>e.node(s).height),a=Math.max(...i,0);o==null||o.forEach(s=>{e.node(s).y=r+a/2}),r+=a+n})},Vf=e=>{const t=Za(e),n=Object.assign(Vs(e,t),Xs(e,t)),r={};let o=[];["u","d"].forEach(a=>{o=a==="u"?t:Object.values(t).reverse(),["l","r"].forEach(s=>{s==="r"&&(o=o.map(l=>Object.values(l).reverse()));const u=(a==="u"?e.predecessors:e.successors).bind(e),c=lc(e,o,n,u),f=dc(e,o,c.root,c.align,s==="r");s==="r"&&Object.keys(f).forEach(l=>f[l]=-f[l]),r[a+s]=f})});const i=Ws(e,r);return i&&Hs(r,i),hc(r,e.graph().align)};var pc=e=>{var t;const n=af(e);vc(n);const r=Vf(n);(t=Object.keys(r))===null||t===void 0||t.forEach(o=>{n.node(o).x=r[o]})},$f=(e,t)=>{const r=e.nodes().filter(a=>{var s;return!(!((s=e.children(a))===null||s===void 0)&&s.length)}).map(a=>e.node(a).rank),o=Math.max(...r),i=[];for(let a=0;a<o+1;a++)i[a]=[];t==null||t.forEach(a=>{const s=e.node(a);!s||s!=null&&s.dummy||isNaN(s.rank)||(s.fixorder=i[s.rank].length,i[s.rank].push(a))})};const mc=(e,t)=>{const n=t&&t.debugTiming?qu:Qu;n("layout",()=>{t&&!t.keepNodeOrder&&t.prevGraph&&n("  inheritOrder",()=>{Hf(e,t.prevGraph)});const r=n("  buildLayoutGraph",()=>ns(e));t&&t.edgeLabelSpace===!1||n("  makeSpaceForEdgeLabels",()=>{Mi(r)});try{n("  runLayout",()=>{Wf(r,n,t)})}catch(o){if(o.message==="Not possible to find intersection inside of the rectangle"){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,o);return}throw o}n("  updateInputGraph",()=>{gc(e,r)})})},Wf=(e,t,n)=>{t("    removeSelfEdges",()=>{Ec(e)}),t("    acyclic",()=>{Ha.run(e)}),t("    nestingGraph.run",()=>{Nf.run(e)}),t("    rank",()=>{ed(af(e))}),t("    injectEdgeLabelProxies",()=>{rs(e)}),t("    removeEmptyRanks",()=>{to(e)}),t("    nestingGraph.cleanup",()=>{Nf.cleanup(e)}),t("    normalizeRanks",()=>{ks(e)}),t("    assignRankMinMax",()=>{os(e)}),t("    removeEdgeLabelProxies",()=>{ki(e)}),t("    normalize.run",()=>{fr.run(e)}),t("    parentDummyChains",()=>{Bs(e)}),t("    addBorderSegments",()=>{rd(e)}),n&&n.keepNodeOrder&&t("    initDataOrder",()=>{$f(e,n.nodeOrder)}),t("    order",()=>{uc(e,n==null?void 0:n.keepNodeOrder)}),t("    insertSelfEdges",()=>{bc(e)}),t("    adjustCoordinateSystem",()=>{qa.adjust(e)}),t("    position",()=>{pc(e)}),t("    positionSelfEdges",()=>{pa(e)}),t("    removeBorderNodes",()=>{is(e)}),t("    normalize.undo",()=>{fr.undo(e)}),t("    fixupEdgeLabelCoords",()=>{js(e)}),t("    undoCoordinateSystem",()=>{qa.undo(e)}),t("    translateGraph",()=>{Gi(e)}),t("    assignNodeIntersects",()=>{Pi(e)}),t("    reversePoints",()=>{Ys(e)}),t("    acyclic.undo",()=>{Ha.undo(e)})},Hf=(e,t)=>{e.nodes().forEach(n=>{const r=e.node(n),o=t.node(n);o!==void 0?(r.fixorder=o._order,delete o._order):delete r.fixorder})},gc=(e,t)=>{e.nodes().forEach(n=>{var r;const o=e.node(n);if(o){const i=t.node(n);o.x=i.x,o.y=i.y,o._order=i.order,o._rank=i.rank,!((r=t.children(n))===null||r===void 0)&&r.length&&(o.width=i.width,o.height=i.height)}}),e.edges().forEach(n=>{const r=e.edge(n),o=t.edge(n);r.points=o?o.points:[],o&&o.hasOwnProperty("x")&&(r.x=o.x,r.y=o.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height},Zf=["nodesep","edgesep","ranksep","marginx","marginy"],jf={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},es=["acyclicer","ranker","rankdir","align"],yc=["width","height","layer","fixorder"],ts={width:0,height:0},Yf=["minlen","weight","width","height","labeloffset"],Zs={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},ho=["labelpos"],ns=e=>{const t=new $o({multigraph:!0,compound:!0}),n=xc(e.graph()),r={};return es==null||es.forEach(o=>{n[o]!==void 0&&(r[o]=n[o])}),t.setGraph(Object.assign({},jf,vi(n,Zf),r)),e.nodes().forEach(o=>{const i=xc(e.node(o)),a=Object.assign(Object.assign({},ts),i),s=vi(a,yc);t.setNode(o,s),t.setParent(o,e.parent(o))}),e.edges().forEach(o=>{const i=xc(e.edge(o)),a={};ho==null||ho.forEach(s=>{i[s]!==void 0&&(a[s]=i[s])}),t.setEdgeObj(o,Object.assign({},Zs,vi(i,Yf),a))}),t},Mi=e=>{const t=e.graph();t.ranksep||(t.ranksep=0),t.ranksep/=2,e.nodes().forEach(n=>{const r=e.node(n);isNaN(r.layer)||r.layer||(r.layer=0)}),e.edges().forEach(n=>{var r;const o=e.edge(n);o.minlen*=2,((r=o.labelpos)===null||r===void 0?void 0:r.toLowerCase())!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?o.width+=o.labeloffset:o.height+=o.labeloffset)})},rs=e=>{e.edges().forEach(t=>{const n=e.edge(t);if(n.width&&n.height){const r=e.node(t.v),o=e.node(t.w),i={e:t,rank:(o.rank-r.rank)/2+r.rank};ca(e,"edge-proxy",i,"_ep")}})},os=e=>{let t=0;e.nodes().forEach(n=>{var r,o;const i=e.node(n);i.borderTop&&(i.minRank=(r=e.node(i.borderTop))===null||r===void 0?void 0:r.rank,i.maxRank=(o=e.node(i.borderBottom))===null||o===void 0?void 0:o.rank,t=Math.max(t,i.maxRank||-1/0))}),e.graph().maxRank=t},ki=e=>{e.nodes().forEach(t=>{const n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})},Gi=e=>{let t,n=0,r,o=0;const i=e.graph(),a=i.marginx||0,s=i.marginy||0,u=c=>{if(!c)return;const f=c.x,l=c.y,d=c.width,h=c.height;!isNaN(f)&&!isNaN(d)&&(t===void 0&&(t=f-d/2),t=Math.min(t,f-d/2),n=Math.max(n,f+d/2)),!isNaN(l)&&!isNaN(h)&&(r===void 0&&(r=l-h/2),r=Math.min(r,l-h/2),o=Math.max(o,l+h/2))};e.nodes().forEach(c=>{u(e.node(c))}),e.edges().forEach(c=>{const f=e.edge(c);f!=null&&f.hasOwnProperty("x")&&u(f)}),t-=a,r-=s,e.nodes().forEach(c=>{const f=e.node(c);f&&(f.x-=t,f.y-=r)}),e.edges().forEach(c=>{var f;const l=e.edge(c);(f=l.points)===null||f===void 0||f.forEach(d=>{d.x-=t,d.y-=r}),l.hasOwnProperty("x")&&(l.x-=t),l.hasOwnProperty("y")&&(l.y-=r)}),i.width=n-t+a,i.height=o-r+s},Pi=e=>{e.edges().forEach(t=>{const n=e.edge(t),r=e.node(t.v),o=e.node(t.w);let i,a;n.points?(i=n.points[0],a=n.points[n.points.length-1]):(n.points=[],i=o,a=r),n.points.unshift(fa(r,i)),n.points.push(fa(o,a))})},js=e=>{e.edges().forEach(t=>{const n=e.edge(t);if(n!=null&&n.hasOwnProperty("x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})},Ys=e=>{e.edges().forEach(t=>{var n;const r=e.edge(t);r.reversed&&((n=r.points)===null||n===void 0||n.reverse())})},is=e=>{e.nodes().forEach(t=>{var n,r,o;if(!((n=e.children(t))===null||n===void 0)&&n.length){const i=e.node(t),a=e.node(i.borderTop),s=e.node(i.borderBottom),u=e.node(i.borderLeft[((r=i.borderLeft)===null||r===void 0?void 0:r.length)-1]),c=e.node(i.borderRight[((o=i.borderRight)===null||o===void 0?void 0:o.length)-1]);i.width=Math.abs((c==null?void 0:c.x)-(u==null?void 0:u.x))||10,i.height=Math.abs((s==null?void 0:s.y)-(a==null?void 0:a.y))||10,i.x=((u==null?void 0:u.x)||0)+i.width/2,i.y=((a==null?void 0:a.y)||0)+i.height/2}}),e.nodes().forEach(t=>{var n;((n=e.node(t))===null||n===void 0?void 0:n.dummy)==="border"&&e.removeNode(t)})},Ec=e=>{e.edges().forEach(t=>{if(t.v===t.w){const n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdgeObj(t)}})},bc=e=>{const t=Za(e);t==null||t.forEach(n=>{let r=0;n==null||n.forEach((o,i)=>{var a;const s=e.node(o);s.order=i+r,(a=s.selfEdges)===null||a===void 0||a.forEach(u=>{ca(e,"selfedge",{width:u.label.width,height:u.label.height,rank:s.rank,order:i+ ++r,e:u.e,label:u.label},"_se")}),delete s.selfEdges})})},pa=e=>{e.nodes().forEach(t=>{const n=e.node(t);if(n.dummy==="selfedge"){const r=e.node(n.e.v),o=r.x+r.width/2,i=r.y,a=n.x-o,s=r.height/2;e.setEdgeObj(n.e,n.label),e.removeNode(t),n.label.points=[{x:o+2*a/3,y:i-s},{x:o+5*a/6,y:i-s},{y:i,x:o+a},{x:o+5*a/6,y:i+s},{x:o+2*a/3,y:i+s}],n.label.x=n.x,n.label.y=n.y}})},vi=(e,t)=>{const n={};return t==null||t.forEach(r=>{e[r]!==void 0&&(n[r]=+e[r])}),n},xc=(e={})=>{const t={};return Object.keys(e).forEach(n=>{t[n.toLowerCase()]=e[n]}),t};var Sd=mc,Kf={layout:Sd,util:{time:qu,notime:Qu}};class Ks extends $e{constructor(t){super(),this.rankdir="TB",this.nodesep=50,this.ranksep=50,this.controlPoints=!1,this.sortByCombo=!1,this.edgeLabelSpace=!0,this.radial=!1,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.layoutNode=n=>{const r=this,{nodes:o}=r,i=o.find(a=>a.id===n);return i?i.layout!==!1:!0},this.updateCfg(t)}getDefaultCfg(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1,radial:!1,focusNode:null}}execute(){var t,n,r,o;const i=this,{nodes:a,nodeSize:s,rankdir:u,combos:c,begin:f,radial:l,comboEdges:d=[],vedges:h=[]}=i;if(!a)return;const v=i.edges||[],m=new $o({multigraph:!0,compound:!0});i.nodeMap={};const g={};a.forEach(k=>{i.nodeMap[k.id]=k,k.comboId&&(g[k.comboId]=g[k.comboId]||[],g[k.comboId].push(k.id))});let E=[];const y={};!((t=i.nodeOrder)===null||t===void 0)&&t.length?(i.nodeOrder.forEach(k=>{y[k]=!0,E.push(i.nodeMap[k])}),a.forEach(k=>{y[k.id]||E.push(k)})):E=a;let b;s?bt(s)?b=()=>s:b=()=>[s,s]:b=k=>k.size?bt(k.size)?k.size:Ot(k.size)?[k.size.width||40,k.size.height||40]:[k.size,k.size]:[40,40];const w=ar(i.ranksep,50,i.ranksepFunc),T=ar(i.nodesep,50,i.nodesepFunc);let $=T,he=w;(u==="LR"||u==="RL")&&($=w,he=T),m.setDefaultEdgeLabel(()=>({})),m.setGraph(i);const te={};this.sortByCombo&&c&&c.forEach(k=>{if(te[k.id]=k,k.collapsed){const pe=b(k),Pe=he(k),Ue=$(k),mt=pe[0]+2*Ue,Ke=pe[1]+2*Pe;m.setNode(k.id,{width:mt,height:Ke})}k.parentId&&(te[k.parentId]||m.setNode(k.parentId,{}),m.setParent(k.id,k.parentId))}),E.filter(k=>k.layout!==!1).forEach(k=>{const pe=b(k),Pe=he(k),Ue=$(k),mt=pe[0]+2*Ue,Ke=pe[1]+2*Pe,Et=k.layer;be(Et)?m.setNode(k.id,{width:mt,height:Ke,layer:Et}):m.setNode(k.id,{width:mt,height:Ke}),this.sortByCombo&&k.comboId&&(te[k.comboId]||(te[k.comboId]={id:k.comboId},m.setNode(k.comboId,{})),m.setParent(k.id,k.comboId))}),v.forEach(k=>{const pe=Je(k,"source"),Pe=Je(k,"target");this.layoutNode(pe)&&this.layoutNode(Pe)&&m.setEdge(pe,Pe,{weight:k.weight||1})}),(n=d==null?void 0:d.concat(h||[]))===null||n===void 0||n.forEach(k=>{var pe,Pe;const{source:Ue,target:mt}=k,Ke=!((pe=te[Ue])===null||pe===void 0)&&pe.collapsed?[Ue]:g[Ue]||[Ue],Et=!((Pe=te[mt])===null||Pe===void 0)&&Pe.collapsed?[mt]:g[mt]||[mt];Ke.forEach(dt=>{Et.forEach(Pt=>{m.setEdge(dt,Pt,{weight:k.weight||1})})})});let j;!((r=i.preset)===null||r===void 0)&&r.nodes&&(j=new $o({multigraph:!0,compound:!0}),i.preset.nodes.forEach(k=>{j==null||j.setNode(k.id,k)})),Kf.layout(m,{prevGraph:j,edgeLabelSpace:i.edgeLabelSpace,keepNodeOrder:!!i.nodeOrder,nodeOrder:i.nodeOrder});const q=[0,0];if(f){let k=1/0,pe=1/0;m.nodes().forEach(Pe=>{const Ue=m.node(Pe);k>Ue.x&&(k=Ue.x),pe>Ue.y&&(pe=Ue.y)}),m.edges().forEach(Pe=>{var Ue;(Ue=m.edge(Pe).points)===null||Ue===void 0||Ue.forEach(Ke=>{k>Ke.x&&(k=Ke.x),pe>Ke.y&&(pe=Ke.y)})}),q[0]=f[0]-k,q[1]=f[1]-pe}const ve=u==="LR"||u==="RL";if(l){const{focusNode:k,ranksep:pe,getRadialPos:Pe}=this,Ue=Zt(k)?k:k==null?void 0:k.id,mt=Ue?(o=m.node(Ue))===null||o===void 0?void 0:o._rank:0,Ke=[],Et=ve?"y":"x",dt=ve?"height":"width";let Pt=1/0,Jt=-1/0;m.nodes().forEach(Ve=>{const ut=m.node(Ve);if(!i.nodeMap[Ve])return;const xn=T(i.nodeMap[Ve]);if(mt===0)Ke[ut._rank]||(Ke[ut._rank]={nodes:[],totalWidth:0,maxSize:-1/0}),Ke[ut._rank].nodes.push(Ve),Ke[ut._rank].totalWidth+=xn*2+ut[dt],Ke[ut._rank].maxSize<Math.max(ut.width,ut.height)&&(Ke[ut._rank].maxSize=Math.max(ut.width,ut.height));else{const en=ut._rank-mt;if(en===0)Ke[en]||(Ke[en]={nodes:[],totalWidth:0,maxSize:-1/0}),Ke[en].nodes.push(Ve),Ke[en].totalWidth+=xn*2+ut[dt],Ke[en].maxSize<Math.max(ut.width,ut.height)&&(Ke[en].maxSize=Math.max(ut.width,ut.height));else{const wn=Math.abs(en);Ke[wn]||(Ke[wn]={left:[],right:[],totalWidth:0,maxSize:-1/0}),Ke[wn].totalWidth+=xn*2+ut[dt],Ke[wn].maxSize<Math.max(ut.width,ut.height)&&(Ke[wn].maxSize=Math.max(ut.width,ut.height)),en<0?Ke[wn].left.push(Ve):Ke[wn].right.push(Ve)}}const Ft=ut[Et]-ut[dt]/2-xn,Pn=ut[Et]+ut[dt]/2+xn;Ft<Pt&&(Pt=Ft),Pn>Jt&&(Jt=Pn)});let Un=pe||50;const Zn={},Ze=(Jt-Pt)/.9,Yt=[(Pt+Jt-Ze)*.5,(Pt+Jt+Ze)*.5],Jn=(Ve,ut,xn=-1/0,Ft=[0,1])=>{let Pn=xn;return Ve.forEach(en=>{const wn=m.node(en);Zn[en]=ut;const{x:gr,y:vr}=Pe(wn[Et],Yt,Ze,ut,Ft);if(!i.nodeMap[en])return;i.nodeMap[en].x=gr+q[0],i.nodeMap[en].y=vr+q[1],i.nodeMap[en]._order=wn._order;const Mr=w(i.nodeMap[en]);Pn<Mr&&(Pn=Mr)}),Pn};let cn=!0;const Dn=0;Ke.forEach(Ve=>{var ut,xn,Ft,Pn,en,wn,gr;if(!(!((ut=Ve==null?void 0:Ve.nodes)===null||ut===void 0)&&ut.length)&&!(!((xn=Ve==null?void 0:Ve.left)===null||xn===void 0)&&xn.length)&&!(!((Ft=Ve==null?void 0:Ve.right)===null||Ft===void 0)&&Ft.length))return;if(cn&&Ve.nodes.length===1){const Mr=Ve.nodes[0];if(!i.nodeMap[Mr])return;i.nodeMap[Mr].x=q[0],i.nodeMap[Mr].y=q[1],Zn[Ve.nodes[0]]=0,Un=w(i.nodeMap[Mr]),cn=!1;return}Un=Math.max(Un,Ve.totalWidth/(2*Math.PI));let vr=-1/0;if(mt===0||!((Pn=Ve.nodes)===null||Pn===void 0)&&Pn.length)vr=Jn(Ve.nodes,Un,vr,[0,1]);else{const Mr=((en=Ve.left)===null||en===void 0?void 0:en.length)/(((wn=Ve.left)===null||wn===void 0?void 0:wn.length)+((gr=Ve.right)===null||gr===void 0?void 0:gr.length));vr=Jn(Ve.left,Un,vr,[0,Mr]),vr=Jn(Ve.right,Un,vr,[Mr+.05,1])}Un+=vr,cn=!1,Dn-Ve.maxSize}),m.edges().forEach(Ve=>{var ut,xn,Ft;const Pn=m.edge(Ve),en=v.findIndex(wn=>{const gr=Je(wn,"source"),vr=Je(wn,"target");return gr===Ve.v&&vr===Ve.w});if(!(en<=-1)&&i.edgeLabelSpace&&i.controlPoints&&v[en].type!=="loop"){const wn=Et==="x"?"y":"x",gr=(ut=Pn==null?void 0:Pn.points)===null||ut===void 0?void 0:ut.slice(1,Pn.points.length-1),vr=[],Mr=(xn=m.node(Ve.v))===null||xn===void 0?void 0:xn[wn],Bc=Mr-((Ft=m.node(Ve.w))===null||Ft===void 0?void 0:Ft[wn]),kr=Zn[Ve.v],ms=kr-Zn[Ve.w];gr==null||gr.forEach(gs=>{const xu=(gs[wn]-Mr)/Bc*ms+kr,Aa=Pe(gs[Et],Yt,Ze,xu);vr.push({x:Aa.x+q[0],y:Aa.y+q[1]})}),v[en].controlPoints=vr}})}else{const k=new Set,Pe=u==="BT"||u==="RL"?(Et,dt)=>dt-Et:(Et,dt)=>Et-dt;m.nodes().forEach(Et=>{const dt=m.node(Et);if(!dt)return;let Pt=this.nodeMap[Et];Pt||(Pt=c==null?void 0:c.find(Jt=>Jt.id===Et)),Pt&&(Pt.x=dt.x+q[0],Pt.y=dt.y+q[1],Pt._order=dt._order,k.add(ve?Pt.x:Pt.y))});const Ue=Array.from(k).sort(Pe),mt=ve?(Et,dt)=>Et.x!==dt.x:(Et,dt)=>Et.y!==dt.y,Ke=ve?(Et,dt,Pt)=>{const Jt=Math.max(dt.y,Pt.y),Un=Math.min(dt.y,Pt.y);return Et.filter(Zn=>Zn.y<=Jt&&Zn.y>=Un)}:(Et,dt,Pt)=>{const Jt=Math.max(dt.x,Pt.x),Un=Math.min(dt.x,Pt.x);return Et.filter(Zn=>Zn.x<=Jt&&Zn.x>=Un)};m.edges().forEach(Et=>{var dt;const Pt=m.edge(Et),Jt=v.findIndex(Un=>{const Zn=Je(Un,"source"),Ze=Je(Un,"target");return Zn===Et.v&&Ze===Et.w});if(!(Jt<=-1)&&i.edgeLabelSpace&&i.controlPoints&&v[Jt].type!=="loop"){(dt=Pt==null?void 0:Pt.points)===null||dt===void 0||dt.forEach(Ze=>{Ze.x+=q[0],Ze.y+=q[1]});const Un=i.nodeMap[Et.v],Zn=i.nodeMap[Et.w];v[Jt].controlPoints=qf(Pt==null?void 0:Pt.points,Un,Zn,Ue,ve,mt,Ke)}})}return i.onLayoutEnd&&i.onLayoutEnd(),{nodes:a,edges:v}}getRadialPos(t,n,r,o,i=[0,1]){let a=(t-n[0])/r;a=a*(i[1]-i[0])+i[0];const s=a*2*Math.PI;return{x:Math.cos(s)*o,y:Math.sin(s)*o}}getType(){return"dagre"}}const qf=(e,t,n,r,o,i,a)=>{let s=(e==null?void 0:e.slice(1,e.length-1))||[];if(t&&n){let{x:u,y:c}=t,{x:f,y:l}=n;if(o&&(u=t.y,c=t.x,f=n.y,l=n.x),l!==c&&u!==f){const d=r.indexOf(c),h=r[d+1];if(h){const g=s[0],E=o?{x:(c+h)/2,y:(g==null?void 0:g.y)||f}:{x:(g==null?void 0:g.x)||f,y:(c+h)/2};(!g||i(g,E))&&s.unshift(E)}const v=r.indexOf(l),m=Math.abs(v-d);if(m===1)s=a(s,t,n),s.length||s.push(o?{x:(c+l)/2,y:u}:{x:u,y:(c+l)/2});else if(m>1){const g=r[v-1];if(g){const E=s[s.length-1],y=o?{x:(l+g)/2,y:(E==null?void 0:E.y)||f}:{x:(E==null?void 0:E.x)||u,y:(l+g)/2};(!E||i(E,y))&&s.push(y)}}}}return s},qs={graph:{meta:{rankDir:"TB",nodeSep:50,rankSep:50,edgeSep:5,align:void 0}},subScene:{meta:{paddingTop:20,paddingBottom:20,paddingLeft:20,paddingRight:20,labelHeight:20}},nodeSize:{meta:{width:100,maxLabelWidth:0,height:20},node:{width:80,height:20,labelOffset:10,maxLabelWidth:40},bridge:{width:5,height:5,radius:2,labelOffset:0}}};function Zo(e={},t=qs){var n,r,o,i;const a=JSON.parse(JSON.stringify(t)),s=((n=e==null?void 0:e.graph)===null||n===void 0?void 0:n.meta)||{},u=((r=e==null?void 0:e.subScene)===null||r===void 0?void 0:r.meta)||{},c=((o=e==null?void 0:e.nodeSize)===null||o===void 0?void 0:o.meta)||{},f=((i=e==null?void 0:e.nodeSize)===null||i===void 0?void 0:i.node)||{},l=a.nodeSize.bridge;return{graph:{meta:Object.assign(a.graph.meta,s)},subScene:{meta:Object.assign(a.subScene.meta,u)},nodeSize:{meta:Object.assign(a.nodeSize.meta,c),node:Object.assign(a.nodeSize.node,f),bridge:l}}}function Qf(e){return`\u25EC${e}\u25EC`}const ma=Qf("ROOT"),Td=Qf("BRIDGE_GRAPH");var _r,ga,as,Qs;(function(e){e[e.META=0]="META",e[e.NODE=1]="NODE",e[e.BRIDGE=2]="BRIDGE"})(_r||(_r={})),function(e){e[e.INCLUDE=0]="INCLUDE",e[e.EXCLUDE=1]="EXCLUDE",e[e.UNSPECIFIED=2]="UNSPECIFIED"}(ga||(ga={})),function(e){e[e.META=0]="META",e[e.CORE=1]="CORE",e[e.BRIDGE=2]="BRIDGE"}(as||(as={})),function(e){e[e.META=0]="META",e[e.OP=1]="OP",e[e.SERIES=2]="SERIES"}(Qs||(Qs={}));var Js=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof oe.g!="undefined"?oe.g:typeof self!="undefined"?self:{};function wc(e,t){return e(t={exports:{}},t.exports),t.exports}var Id=function(){this.__data__=[],this.size=0},ya=function(e,t){return e===t||e!=e&&t!=t},eu=function(e,t){for(var n=e.length;n--;)if(ya(e[n][0],t))return n;return-1},Nd=Array.prototype.splice,Ad=function(e){var t=this.__data__,n=eu(t,e);return!(n<0)&&(n==t.length-1?t.pop():Nd.call(t,n,1),--this.size,!0)},_c=function(e){var t=this.__data__,n=eu(t,e);return n<0?void 0:t[n][1]},tu=function(e){return eu(this.__data__,e)>-1},nu=function(e,t){var n=this.__data__,r=eu(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function jo(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}jo.prototype.clear=Id,jo.prototype.delete=Ad,jo.prototype.get=_c,jo.prototype.has=tu,jo.prototype.set=nu;var Ea=jo,ru=function(){this.__data__=new Ea,this.size=0},ou=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},iu=function(e){return this.__data__.get(e)},Sc=function(e){return this.__data__.has(e)},ss=typeof Js=="object"&&Js&&Js.Object===Object&&Js,au=typeof self=="object"&&self&&self.Object===Object&&self,Br=ss||au||Function("return this")(),Sr=Br.Symbol,ba=Object.prototype,us=ba.hasOwnProperty,cs=ba.toString,Yo=Sr?Sr.toStringTag:void 0,Jf=function(e){var t=us.call(e,Yo),n=e[Yo];try{e[Yo]=void 0;var r=!0}catch(i){}var o=cs.call(e);return r&&(t?e[Yo]=n:delete e[Yo]),o},fs=Object.prototype.toString,Fi=function(e){return fs.call(e)},Tc=Sr?Sr.toStringTag:void 0,Io=function(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Tc&&Tc in Object(e)?Jf(e):Fi(e)},Ur=function(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")},el,ls=function(e){if(!Ur(e))return!1;var t=Io(e);return t=="[object Function]"||t=="[object GeneratorFunction]"||t=="[object AsyncFunction]"||t=="[object Proxy]"},No=Br["__core-js_shared__"],Ic=(el=/[^.]+$/.exec(No&&No.keys&&No.keys.IE_PROTO||""))?"Symbol(src)_1."+el:"",tl=function(e){return!!Ic&&Ic in e},nl=Function.prototype.toString,zi=function(e){if(e!=null){try{return nl.call(e)}catch(t){}try{return e+""}catch(t){}}return""},rl=/^\[object .+?Constructor\]$/,Rd=Function.prototype,Ao=Object.prototype,ol=Rd.toString,xa=Ao.hasOwnProperty,pi=RegExp("^"+ol.call(xa).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),il=function(e){return!(!Ur(e)||tl(e))&&(ls(e)?pi:rl).test(zi(e))},Nc=function(e,t){return e==null?void 0:e[t]},Ro=function(e,t){var n=Nc(e,t);return il(n)?n:void 0},wa=Ro(Br,"Map"),lr=Ro(Object,"create"),mi=function(){this.__data__=lr?lr(null):{},this.size=0},Xn=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Vr=Object.prototype.hasOwnProperty,al=function(e){var t=this.__data__;if(lr){var n=t[e];return n==="__lodash_hash_undefined__"?void 0:n}return Vr.call(t,e)?t[e]:void 0},Dd=Object.prototype.hasOwnProperty,Cd=function(e){var t=this.__data__;return lr?t[e]!==void 0:Dd.call(t,e)},Od=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=lr&&t===void 0?"__lodash_hash_undefined__":t,this};function _a(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}_a.prototype.clear=mi,_a.prototype.delete=Xn,_a.prototype.get=al,_a.prototype.has=Cd,_a.prototype.set=Od;var Ac=_a,Ld=function(){this.size=0,this.__data__={hash:new Ac,map:new(wa||Ea),string:new Ac}},Md=function(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null},su=function(e,t){var n=e.__data__;return Md(t)?n[typeof t=="string"?"string":"hash"]:n.map},kd=function(e){var t=su(this,e).delete(e);return this.size-=t?1:0,t},Gd=function(e){return su(this,e).get(e)},sl=function(e){return su(this,e).has(e)},ul=function(e,t){var n=su(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function Bi(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Bi.prototype.clear=Ld,Bi.prototype.delete=kd,Bi.prototype.get=Gd,Bi.prototype.has=sl,Bi.prototype.set=ul;var uu=Bi,Pd=function(e,t){var n=this.__data__;if(n instanceof Ea){var r=n.__data__;if(!wa||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new uu(r)}return n.set(e,t),this.size=n.size,this};function Ui(e){var t=this.__data__=new Ea(e);this.size=t.size}Ui.prototype.clear=ru,Ui.prototype.delete=ou,Ui.prototype.get=iu,Ui.prototype.has=Sc,Ui.prototype.set=Pd;var Sa=Ui,p=function(e,t){for(var n=-1,r=e==null?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e},_=function(){try{var e=Ro(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),O=function(e,t,n){t=="__proto__"&&_?_(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},K=Object.prototype.hasOwnProperty,ae=function(e,t,n){var r=e[t];K.call(e,t)&&ya(r,n)&&(n!==void 0||t in e)||O(e,t,n)},Z=function(e,t,n,r){var o=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var s=t[i],u=r?r(n[s],e[s],s,n,e):void 0;u===void 0&&(u=e[s]),o?O(n,s,u):ae(n,s,u)}return n},Q=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},fe=function(e){return e!=null&&typeof e=="object"},me=function(e){return fe(e)&&Io(e)=="[object Arguments]"},_e=Object.prototype,ge=_e.hasOwnProperty,Ae=_e.propertyIsEnumerable,De=me(function(){return arguments}())?me:function(e){return fe(e)&&ge.call(e,"callee")&&!Ae.call(e,"callee")},se=Array.isArray,Re=function(){return!1},V=wc(function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,o=r&&r.exports===n?Br.Buffer:void 0,i=(o?o.isBuffer:void 0)||Re;e.exports=i}),J=/^(?:0|[1-9]\d*)$/,ye=function(e,t){var n=typeof e;return!!(t=t==null?9007199254740991:t)&&(n=="number"||n!="symbol"&&J.test(e))&&e>-1&&e%1==0&&e<t},Me=function(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=9007199254740991},ne={};ne["[object Float32Array]"]=ne["[object Float64Array]"]=ne["[object Int8Array]"]=ne["[object Int16Array]"]=ne["[object Int32Array]"]=ne["[object Uint8Array]"]=ne["[object Uint8ClampedArray]"]=ne["[object Uint16Array]"]=ne["[object Uint32Array]"]=!0,ne["[object Arguments]"]=ne["[object Array]"]=ne["[object ArrayBuffer]"]=ne["[object Boolean]"]=ne["[object DataView]"]=ne["[object Date]"]=ne["[object Error]"]=ne["[object Function]"]=ne["[object Map]"]=ne["[object Number]"]=ne["[object Object]"]=ne["[object RegExp]"]=ne["[object Set]"]=ne["[object String]"]=ne["[object WeakMap]"]=!1;var ze=function(e){return fe(e)&&Me(e.length)&&!!ne[Io(e)]},le=function(e){return function(t){return e(t)}},Ie=wc(function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,o=r&&r.exports===n&&ss.process,i=function(){try{var a=r&&r.require&&r.require("util").types;return a||o&&o.binding&&o.binding("util")}catch(s){}}();e.exports=i}),de=Ie&&Ie.isTypedArray,Ne=de?le(de):ze,Qe=Object.prototype.hasOwnProperty,lt=function(e,t){var n=se(e),r=!n&&De(e),o=!n&&!r&&V(e),i=!n&&!r&&!o&&Ne(e),a=n||r||o||i,s=a?Q(e.length,String):[],u=s.length;for(var c in e)!t&&!Qe.call(e,c)||a&&(c=="length"||o&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||ye(c,u))||s.push(c);return s},Le=Object.prototype,xe=function(e){var t=e&&e.constructor;return e===(typeof t=="function"&&t.prototype||Le)},ce=function(e,t){return function(n){return e(t(n))}},at=ce(Object.keys,Object),_t=Object.prototype.hasOwnProperty,We=function(e){if(!xe(e))return at(e);var t=[];for(var n in Object(e))_t.call(e,n)&&n!="constructor"&&t.push(n);return t},ht=function(e){return e!=null&&Me(e.length)&&!ls(e)},ot=function(e){return ht(e)?lt(e):We(e)},It=function(e,t){return e&&Z(t,ot(t),e)},Ut=function(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t},$n=Object.prototype.hasOwnProperty,or=function(e){if(!Ur(e))return Ut(e);var t=xe(e),n=[];for(var r in e)(r!="constructor"||!t&&$n.call(e,r))&&n.push(r);return n},St=function(e){return ht(e)?lt(e,!0):or(e)},Qn=function(e,t){return e&&Z(t,St(t),e)},vn=wc(function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,o=r&&r.exports===n?Br.Buffer:void 0,i=o?o.allocUnsafe:void 0;e.exports=function(a,s){if(s)return a.slice();var u=a.length,c=i?i(u):new a.constructor(u);return a.copy(c),c}}),Bn=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t},Wn=function(e,t){for(var n=-1,r=e==null?0:e.length,o=0,i=[];++n<r;){var a=e[n];t(a,n,e)&&(i[o++]=a)}return i},Hn=function(){return[]},dr=Object.prototype.propertyIsEnumerable,hr=Object.getOwnPropertySymbols,An=hr?function(e){return e==null?[]:(e=Object(e),Wn(hr(e),function(t){return dr.call(e,t)}))}:Hn,Tt=function(e,t){return Z(e,An(e),t)},ir=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e},zt=ce(Object.getPrototypeOf,Object),et=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)ir(t,An(e)),e=zt(e);return t}:Hn,Ct=function(e,t){return Z(e,et(e),t)},Gt=function(e,t,n){var r=t(e);return se(e)?r:ir(r,n(e))},Rn=function(e){return Gt(e,ot,An)},Do=function(e){return Gt(e,St,et)},Ko=Ro(Br,"DataView"),D=Ro(Br,"Promise"),Y=Ro(Br,"Set"),H=Ro(Br,"WeakMap"),Be=zi(Ko),Dt=zi(wa),R=zi(D),x=zi(Y),M=zi(H),B=Io;(Ko&&B(new Ko(new ArrayBuffer(1)))!="[object DataView]"||wa&&B(new wa)!="[object Map]"||D&&B(D.resolve())!="[object Promise]"||Y&&B(new Y)!="[object Set]"||H&&B(new H)!="[object WeakMap]")&&(B=function(e){var t=Io(e),n=t=="[object Object]"?e.constructor:void 0,r=n?zi(n):"";if(r)switch(r){case Be:return"[object DataView]";case Dt:return"[object Map]";case R:return"[object Promise]";case x:return"[object Set]";case M:return"[object WeakMap]"}return t});var X=B,F=Object.prototype.hasOwnProperty,G=function(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&F.call(e,"index")&&(n.index=e.index,n.input=e.input),n},z=Br.Uint8Array,A=function(e){var t=new e.constructor(e.byteLength);return new z(t).set(new z(e)),t},L=function(e,t){var n=t?A(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},I=/\w*$/,U=function(e){var t=new e.constructor(e.source,I.exec(e));return t.lastIndex=e.lastIndex,t},W=Sr?Sr.prototype:void 0,ie=W?W.valueOf:void 0,ue=function(e){return ie?Object(ie.call(e)):{}},re=function(e,t){var n=t?A(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)},we=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return A(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return L(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return re(e,n);case"[object Map]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return U(e);case"[object Set]":return new r;case"[object Symbol]":return ue(e)}},Ye=Object.create,yt=function(){function e(){}return function(t){if(!Ur(t))return{};if(Ye)return Ye(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),He=function(e){return typeof e.constructor!="function"||xe(e)?{}:yt(zt(e))},rt=function(e){return fe(e)&&X(e)=="[object Map]"},vt=Ie&&Ie.isMap,Vt=vt?le(vt):rt,Gn=function(e){return fe(e)&&X(e)=="[object Set]"},Tr=Ie&&Ie.isSet,Rc=Tr?le(Tr):Gn,Wt={};Wt["[object Arguments]"]=Wt["[object Array]"]=Wt["[object ArrayBuffer]"]=Wt["[object DataView]"]=Wt["[object Boolean]"]=Wt["[object Date]"]=Wt["[object Float32Array]"]=Wt["[object Float64Array]"]=Wt["[object Int8Array]"]=Wt["[object Int16Array]"]=Wt["[object Int32Array]"]=Wt["[object Map]"]=Wt["[object Number]"]=Wt["[object Object]"]=Wt["[object RegExp]"]=Wt["[object Set]"]=Wt["[object String]"]=Wt["[object Symbol]"]=Wt["[object Uint8Array]"]=Wt["[object Uint8ClampedArray]"]=Wt["[object Uint16Array]"]=Wt["[object Uint32Array]"]=!0,Wt["[object Error]"]=Wt["[object Function]"]=Wt["[object WeakMap]"]=!1;var Dc=function e(t,n,r,o,i,a){var s,u=1&n,c=2&n,f=4&n;if(r&&(s=i?r(t,o,i,a):r(t)),s!==void 0)return s;if(!Ur(t))return t;var l=se(t);if(l){if(s=G(t),!u)return Bn(t,s)}else{var d=X(t),h=d=="[object Function]"||d=="[object GeneratorFunction]";if(V(t))return vn(t,u);if(d=="[object Object]"||d=="[object Arguments]"||h&&!i){if(s=c||h?{}:He(t),!u)return c?Ct(t,Qn(s,t)):Tt(t,It(s,t))}else{if(!Wt[d])return i?t:{};s=we(t,d,u)}}a||(a=new Sa);var v=a.get(t);if(v)return v;a.set(t,s),Rc(t)?t.forEach(function(g){s.add(e(g,n,r,g,t,a))}):Vt(t)&&t.forEach(function(g,E){s.set(E,e(g,n,r,E,t,a))});var m=l?void 0:(f?c?Do:Rn:c?St:ot)(t);return p(m||t,function(g,E){m&&(g=t[E=g]),ae(s,E,e(g,n,r,E,t,a))}),s},vo=function(e){return Dc(e,4)},cu=function(e){return function(){return e}},Fd=function(e){return function(t,n,r){for(var o=-1,i=Object(t),a=r(t),s=a.length;s--;){var u=a[e?s:++o];if(n(i[u],u,i)===!1)break}return t}}(),zd=function(e,t){return e&&Fd(e,t,ot)},cl=function(e,t){return function(n,r){if(n==null)return n;if(!ht(n))return e(n,r);for(var o=n.length,i=t?o:-1,a=Object(n);(t?i--:++i<o)&&r(a[i],i,a)!==!1;);return n}}(zd),ds=function(e){return e},Ch=function(e){return typeof e=="function"?e:ds},Oh=function(e,t){return(se(e)?p:cl)(e,Ch(t))},Lh=Oh,Zp=function(e,t){var n=[];return cl(e,function(r,o,i){t(r,o,i)&&n.push(r)}),n},jp=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Yp=function(e){return this.__data__.has(e)};function fl(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new uu;++t<n;)this.add(e[t])}fl.prototype.add=fl.prototype.push=jp,fl.prototype.has=Yp;var Mh=fl,Kp=function(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},kh=function(e,t){return e.has(t)},Gh=function(e,t,n,r,o,i){var a=1&n,s=e.length,u=t.length;if(s!=u&&!(a&&u>s))return!1;var c=i.get(e),f=i.get(t);if(c&&f)return c==t&&f==e;var l=-1,d=!0,h=2&n?new Mh:void 0;for(i.set(e,t),i.set(t,e);++l<s;){var v=e[l],m=t[l];if(r)var g=a?r(m,v,l,t,e,i):r(v,m,l,e,t,i);if(g!==void 0){if(g)continue;d=!1;break}if(h){if(!Kp(t,function(E,y){if(!kh(h,y)&&(v===E||o(v,E,n,r,i)))return h.push(y)})){d=!1;break}}else if(v!==m&&!o(v,m,n,r,i)){d=!1;break}}return i.delete(e),i.delete(t),d},qp=function(e){var t=-1,n=Array(e.size);return e.forEach(function(r,o){n[++t]=[o,r]}),n},Bd=function(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n},Ph=Sr?Sr.prototype:void 0,Ud=Ph?Ph.valueOf:void 0,Qp=function(e,t,n,r,o,i,a){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!i(new z(e),new z(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return ya(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=qp;case"[object Set]":var u=1&r;if(s||(s=Bd),e.size!=t.size&&!u)return!1;var c=a.get(e);if(c)return c==t;r|=2,a.set(e,t);var f=Gh(s(e),s(t),r,o,i,a);return a.delete(e),f;case"[object Symbol]":if(Ud)return Ud.call(e)==Ud.call(t)}return!1},Jp=Object.prototype.hasOwnProperty,e0=function(e,t,n,r,o,i){var a=1&n,s=Rn(e),u=s.length;if(u!=Rn(t).length&&!a)return!1;for(var c=u;c--;){var f=s[c];if(!(a?f in t:Jp.call(t,f)))return!1}var l=i.get(e),d=i.get(t);if(l&&d)return l==t&&d==e;var h=!0;i.set(e,t),i.set(t,e);for(var v=a;++c<u;){var m=e[f=s[c]],g=t[f];if(r)var E=a?r(g,m,f,t,e,i):r(m,g,f,e,t,i);if(!(E===void 0?m===g||o(m,g,n,r,i):E)){h=!1;break}v||(v=f=="constructor")}if(h&&!v){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||typeof y=="function"&&y instanceof y&&typeof b=="function"&&b instanceof b||(h=!1)}return i.delete(e),i.delete(t),h},Fh=Object.prototype.hasOwnProperty,t0=function(e,t,n,r,o,i){var a=se(e),s=se(t),u=a?"[object Array]":X(e),c=s?"[object Array]":X(t),f=(u=u=="[object Arguments]"?"[object Object]":u)=="[object Object]",l=(c=c=="[object Arguments]"?"[object Object]":c)=="[object Object]",d=u==c;if(d&&V(e)){if(!V(t))return!1;a=!0,f=!1}if(d&&!f)return i||(i=new Sa),a||Ne(e)?Gh(e,t,n,r,o,i):Qp(e,t,u,n,r,o,i);if(!(1&n)){var h=f&&Fh.call(e,"__wrapped__"),v=l&&Fh.call(t,"__wrapped__");if(h||v){var m=h?e.value():e,g=v?t.value():t;return i||(i=new Sa),o(m,g,n,r,i)}}return!!d&&(i||(i=new Sa),e0(e,t,n,r,o,i))},zh=function e(t,n,r,o,i){return t===n||(t==null||n==null||!fe(t)&&!fe(n)?t!=t&&n!=n:t0(t,n,r,o,e,i))},n0=function(e,t,n,r){var o=n.length,i=o,a=!r;if(e==null)return!i;for(e=Object(e);o--;){var s=n[o];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<i;){var u=(s=n[o])[0],c=e[u],f=s[1];if(a&&s[2]){if(c===void 0&&!(u in e))return!1}else{var l=new Sa;if(r)var d=r(c,f,u,e,t,l);if(!(d===void 0?zh(f,c,3,r,l):d))return!1}}return!0},Bh=function(e){return e==e&&!Ur(e)},r0=function(e){for(var t=ot(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,Bh(o)]}return t},Uh=function(e,t){return function(n){return n!=null&&n[e]===t&&(t!==void 0||e in Object(n))}},o0=function(e){var t=r0(e);return t.length==1&&t[0][2]?Uh(t[0][0],t[0][1]):function(n){return n===e||n0(n,e,t)}},hs=function(e){return typeof e=="symbol"||fe(e)&&Io(e)=="[object Symbol]"},i0=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a0=/^\w*$/,Vd=function(e,t){if(se(e))return!1;var n=typeof e;return!(n!="number"&&n!="symbol"&&n!="boolean"&&e!=null&&!hs(e))||a0.test(e)||!i0.test(e)||t!=null&&e in Object(t)};function Xd(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError("Expected a function");var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=e.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new(Xd.Cache||uu),n}Xd.Cache=uu;var s0=Xd,u0=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,c0=/\\(\\)?/g,f0=function(e){var t=s0(e,function(r){return n.size===500&&n.clear(),r}),n=t.cache;return t}(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(u0,function(n,r,o,i){t.push(o?i.replace(c0,"$1"):r||n)}),t}),fu=function(e,t){for(var n=-1,r=e==null?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o},Vh=Sr?Sr.prototype:void 0,Xh=Vh?Vh.toString:void 0,l0=function e(t){if(typeof t=="string")return t;if(se(t))return fu(t,e)+"";if(hs(t))return Xh?Xh.call(t):"";var n=t+"";return n=="0"&&1/t==-1/0?"-0":n},$h=function(e){return e==null?"":l0(e)},ll=function(e,t){return se(e)?e:Vd(e,t)?[e]:f0($h(e))},Cc=function(e){if(typeof e=="string"||hs(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t},dl=function(e,t){for(var n=0,r=(t=ll(t,e)).length;e!=null&&n<r;)e=e[Cc(t[n++])];return n&&n==r?e:void 0},d0=function(e,t,n){var r=e==null?void 0:dl(e,t);return r===void 0?n:r},h0=function(e,t){return e!=null&&t in Object(e)},Wh=function(e,t,n){for(var r=-1,o=(t=ll(t,e)).length,i=!1;++r<o;){var a=Cc(t[r]);if(!(i=e!=null&&n(e,a)))break;e=e[a]}return i||++r!=o?i:!!(o=e==null?0:e.length)&&Me(o)&&ye(a,o)&&(se(e)||De(e))},Hh=function(e,t){return e!=null&&Wh(e,t,h0)},v0=function(e,t){return Vd(e)&&Bh(t)?Uh(Cc(e),t):function(n){var r=d0(n,e);return r===void 0&&r===t?Hh(n,e):zh(t,r,3)}},Zh=function(e){return function(t){return t==null?void 0:t[e]}},p0=function(e){return function(t){return dl(t,e)}},m0=function(e){return Vd(e)?Zh(Cc(e)):p0(e)},Vi=function(e){return typeof e=="function"?e:e==null?ds:typeof e=="object"?se(e)?v0(e[0],e[1]):o0(e):m0(e)},jh=function(e,t){return(se(e)?Wn:Zp)(e,Vi(t))},g0=Object.prototype.hasOwnProperty,y0=function(e,t){return e!=null&&g0.call(e,t)},Yh=function(e,t){return e!=null&&Wh(e,t,y0)},E0=Object.prototype.hasOwnProperty,b0=function(e){if(e==null)return!0;if(ht(e)&&(se(e)||typeof e=="string"||typeof e.splice=="function"||V(e)||Ne(e)||De(e)))return!e.length;var t=X(e);if(t=="[object Map]"||t=="[object Set]")return!e.size;if(xe(e))return!We(e).length;for(var n in e)if(E0.call(e,n))return!1;return!0},Kh=function(e){return e===void 0},qh=function(e,t){var n=-1,r=ht(e)?Array(e.length):[];return cl(e,function(o,i,a){r[++n]=t(o,i,a)}),r},Qh=function(e,t){return(se(e)?fu:qh)(e,Vi(t))},x0=function(e,t,n,r){var o=-1,i=e==null?0:e.length;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n},w0=function(e,t,n,r,o){return o(e,function(i,a,s){n=r?(r=!1,i):t(n,i,a,s)}),n},Jh=function(e,t,n){var r=se(e)?x0:w0,o=arguments.length<3;return r(e,Vi(t),n,o,cl)},_0=function(e){return typeof e=="string"||!se(e)&&fe(e)&&Io(e)=="[object String]"},S0=Zh("length"),T0=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),I0=function(e){return T0.test(e)},N0="[\\ud800-\\udfff]",$d="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Wd="\\ud83c[\\udffb-\\udfff]",ev="[^\\ud800-\\udfff]",tv="(?:\\ud83c[\\udde6-\\uddff]){2}",nv="[\\ud800-\\udbff][\\udc00-\\udfff]",rv="(?:"+$d+"|"+Wd+")?",A0="[\\ufe0e\\ufe0f]?"+rv+("(?:\\u200d(?:"+[ev,tv,nv].join("|")+")[\\ufe0e\\ufe0f]?"+rv+")*"),R0="(?:"+[ev+$d+"?",$d,tv,nv,N0].join("|")+")",ov=RegExp(Wd+"(?="+Wd+")|"+R0+A0,"g"),D0=function(e){for(var t=ov.lastIndex=0;ov.test(e);)++t;return t},C0=function(e){return I0(e)?D0(e):S0(e)},O0=function(e){if(e==null)return 0;if(ht(e))return _0(e)?C0(e):e.length;var t=X(e);return t=="[object Map]"||t=="[object Set]"?e.size:We(e).length},L0=function(e,t,n){var r=se(e),o=r||V(e)||Ne(e);if(t=Vi(t),n==null){var i=e&&e.constructor;n=o?r?new i:[]:Ur(e)&&ls(i)?yt(zt(e)):{}}return(o?p:zd)(e,function(a,s,u){return t(n,a,s,u)}),n},iv=Sr?Sr.isConcatSpreadable:void 0,M0=function(e){return se(e)||De(e)||!!(iv&&e&&e[iv])},Hd=function e(t,n,r,o,i){var a=-1,s=t.length;for(r||(r=M0),i||(i=[]);++a<s;){var u=t[a];n>0&&r(u)?n>1?e(u,n-1,r,o,i):ir(i,u):o||(i[i.length]=u)}return i},k0=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},av=Math.max,sv=function(e,t,n){return t=av(t===void 0?e.length-1:t,0),function(){for(var r=arguments,o=-1,i=av(r.length-t,0),a=Array(i);++o<i;)a[o]=r[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=r[o];return s[t]=n(a),k0(e,this,s)}},G0=_?function(e,t){return _(e,"toString",{configurable:!0,enumerable:!1,value:cu(t),writable:!0})}:ds,P0=Date.now,uv=function(e){var t=0,n=0;return function(){var r=P0(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(G0),hl=function(e,t){return uv(sv(e,t,ds),e+"")},cv=function(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1},F0=function(e){return e!=e},z0=function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1},B0=function(e,t,n){return t==t?z0(e,t,n):cv(e,F0,n)},U0=function(e,t){return!!(e!=null&&e.length)&&B0(e,t,0)>-1},V0=function(e,t,n){for(var r=-1,o=e==null?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1},X0=function(){},$0=Y&&1/Bd(new Y([,-0]))[1]==1/0?function(e){return new Y(e)}:X0,W0=function(e,t,n){var r=-1,o=U0,i=e.length,a=!0,s=[],u=s;if(n)a=!1,o=V0;else if(i>=200){var c=t?null:$0(e);if(c)return Bd(c);a=!1,o=kh,u=new Mh}else u=t?[]:s;e:for(;++r<i;){var f=e[r],l=t?t(f):f;if(f=n||f!==0?f:0,a&&l==l){for(var d=u.length;d--;)if(u[d]===l)continue e;t&&u.push(l),s.push(f)}else o(u,l,n)||(u!==s&&u.push(l),s.push(f))}return s},fv=function(e){return fe(e)&&ht(e)},H0=hl(function(e){return W0(Hd(e,1,fv,!0))}),Z0=function(e,t){return fu(t,function(n){return e[n]})},vl,lv=function(e){return e==null?[]:Z0(e,ot(e))};try{vl={clone:vo,constant:cu,each:Lh,filter:jh,has:Yh,isArray:se,isEmpty:b0,isFunction:ls,isUndefined:Kh,keys:ot,map:Qh,reduce:Jh,size:O0,transform:L0,union:H0,values:lv}}catch(e){}vl||(vl=window._);var je=vl,Zd=Ht;function Ht(e){this._isDirected=!je.has(e,"directed")||e.directed,this._isMultigraph=!!je.has(e,"multigraph")&&e.multigraph,this._isCompound=!!je.has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=je.constant(void 0),this._defaultEdgeLabelFn=je.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function dv(e,t){e[t]?e[t]++:e[t]=1}function hv(e,t){--e[t]||delete e[t]}function Oc(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var a=o;o=i,i=a}return o+""+i+""+(je.isUndefined(r)?"\0":r)}function j0(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var a=o;o=i,i=a}var s={v:o,w:i};return r&&(s.name=r),s}function jd(e,t){return Oc(e,t.v,t.w,t.name)}Ht.prototype._nodeCount=0,Ht.prototype._edgeCount=0,Ht.prototype.isDirected=function(){return this._isDirected},Ht.prototype.isMultigraph=function(){return this._isMultigraph},Ht.prototype.isCompound=function(){return this._isCompound},Ht.prototype.setGraph=function(e){return this._label=e,this},Ht.prototype.graph=function(){return this._label},Ht.prototype.setDefaultNodeLabel=function(e){return je.isFunction(e)||(e=je.constant(e)),this._defaultNodeLabelFn=e,this},Ht.prototype.nodeCount=function(){return this._nodeCount},Ht.prototype.nodes=function(){return je.keys(this._nodes)},Ht.prototype.sources=function(){var e=this;return je.filter(this.nodes(),function(t){return je.isEmpty(e._in[t])})},Ht.prototype.sinks=function(){var e=this;return je.filter(this.nodes(),function(t){return je.isEmpty(e._out[t])})},Ht.prototype.setNodes=function(e,t){var n=arguments,r=this;return je.each(e,function(o){n.length>1?r.setNode(o,t):r.setNode(o)}),this},Ht.prototype.setNode=function(e,t){return je.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]="\0",this._children[e]={},this._children["\0"][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},Ht.prototype.node=function(e){return this._nodes[e]},Ht.prototype.hasNode=function(e){return je.has(this._nodes,e)},Ht.prototype.removeNode=function(e){var t=this;if(je.has(this._nodes,e)){var n=function(r){t.removeEdge(t._edgeObjs[r])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],je.each(this.children(e),function(r){t.setParent(r)}),delete this._children[e]),je.each(je.keys(this._in[e]),n),delete this._in[e],delete this._preds[e],je.each(je.keys(this._out[e]),n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},Ht.prototype.setParent=function(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(je.isUndefined(t))t="\0";else{for(var n=t+="";!je.isUndefined(n);n=this.parent(n))if(n===e)throw new Error("Setting "+t+" as parent of "+e+" would create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this},Ht.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},Ht.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if(t!=="\0")return t}},Ht.prototype.children=function(e){if(je.isUndefined(e)&&(e="\0"),this._isCompound){var t=this._children[e];if(t)return je.keys(t)}else{if(e==="\0")return this.nodes();if(this.hasNode(e))return[]}},Ht.prototype.predecessors=function(e){var t=this._preds[e];if(t)return je.keys(t)},Ht.prototype.successors=function(e){var t=this._sucs[e];if(t)return je.keys(t)},Ht.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return je.union(t,this.successors(e))},Ht.prototype.isLeaf=function(e){return(this.isDirected()?this.successors(e):this.neighbors(e)).length===0},Ht.prototype.filterNodes=function(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;je.each(this._nodes,function(i,a){e(a)&&t.setNode(a,i)}),je.each(this._edgeObjs,function(i){t.hasNode(i.v)&&t.hasNode(i.w)&&t.setEdge(i,n.edge(i))});var r={};function o(i){var a=n.parent(i);return a===void 0||t.hasNode(a)?(r[i]=a,a):a in r?r[a]:o(a)}return this._isCompound&&je.each(t.nodes(),function(i){t.setParent(i,o(i))}),t},Ht.prototype.setDefaultEdgeLabel=function(e){return je.isFunction(e)||(e=je.constant(e)),this._defaultEdgeLabelFn=e,this},Ht.prototype.edgeCount=function(){return this._edgeCount},Ht.prototype.edges=function(){return je.values(this._edgeObjs)},Ht.prototype.setPath=function(e,t){var n=this,r=arguments;return je.reduce(e,function(o,i){return r.length>1?n.setEdge(o,i,t):n.setEdge(o,i),i}),this},Ht.prototype.setEdge=function(){var e,t,n,r,o=!1,i=arguments[0];typeof i=="object"&&i!==null&&"v"in i?(e=i.v,t=i.w,n=i.name,arguments.length===2&&(r=arguments[1],o=!0)):(e=i,t=arguments[1],n=arguments[3],arguments.length>2&&(r=arguments[2],o=!0)),e=""+e,t=""+t,je.isUndefined(n)||(n=""+n);var a=Oc(this._isDirected,e,t,n);if(je.has(this._edgeLabels,a))return o&&(this._edgeLabels[a]=r),this;if(!je.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[a]=o?r:this._defaultEdgeLabelFn(e,t,n);var s=j0(this._isDirected,e,t,n);return e=s.v,t=s.w,Object.freeze(s),this._edgeObjs[a]=s,dv(this._preds[t],e),dv(this._sucs[e],t),this._in[t][a]=s,this._out[e][a]=s,this._edgeCount++,this},Ht.prototype.edge=function(e,t,n){var r=arguments.length===1?jd(this._isDirected,arguments[0]):Oc(this._isDirected,e,t,n);return this._edgeLabels[r]},Ht.prototype.hasEdge=function(e,t,n){var r=arguments.length===1?jd(this._isDirected,arguments[0]):Oc(this._isDirected,e,t,n);return je.has(this._edgeLabels,r)},Ht.prototype.removeEdge=function(e,t,n){var r=arguments.length===1?jd(this._isDirected,arguments[0]):Oc(this._isDirected,e,t,n),o=this._edgeObjs[r];return o&&(e=o.v,t=o.w,delete this._edgeLabels[r],delete this._edgeObjs[r],hv(this._preds[t],e),hv(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this},Ht.prototype.inEdges=function(e,t){var n=this._in[e];if(n){var r=je.values(n);return t?je.filter(r,function(o){return o.v===t}):r}},Ht.prototype.outEdges=function(e,t){var n=this._out[e];if(n){var r=je.values(n);return t?je.filter(r,function(o){return o.w===t}):r}},Ht.prototype.nodeEdges=function(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))};var vv={Graph:Zd,version:"2.1.8"},Y0={write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:K0(e),edges:q0(e)};return je.isUndefined(e.graph())||(t.value=je.clone(e.graph())),t},read:function(e){var t=new Zd(e.options).setGraph(e.value);return je.each(e.nodes,function(n){t.setNode(n.v,n.value),n.parent&&t.setParent(n.v,n.parent)}),je.each(e.edges,function(n){t.setEdge({v:n.v,w:n.w,name:n.name},n.value)}),t}};function K0(e){return je.map(e.nodes(),function(t){var n=e.node(t),r=e.parent(t),o={v:t};return je.isUndefined(n)||(o.value=n),je.isUndefined(r)||(o.parent=r),o})}function q0(e){return je.map(e.edges(),function(t){var n=e.edge(t),r={v:t.v,w:t.w};return je.isUndefined(t.name)||(r.name=t.name),je.isUndefined(n)||(r.value=n),r})}var Q0=function(e){var t,n={},r=[];function o(i){je.has(n,i)||(n[i]=!0,t.push(i),je.each(e.successors(i),o),je.each(e.predecessors(i),o))}return je.each(e.nodes(),function(i){t=[],o(i),t.length&&r.push(t)}),r},pv=Co;function Co(){this._arr=[],this._keyIndices={}}Co.prototype.size=function(){return this._arr.length},Co.prototype.keys=function(){return this._arr.map(function(e){return e.key})},Co.prototype.has=function(e){return je.has(this._keyIndices,e)},Co.prototype.priority=function(e){var t=this._keyIndices[e];if(t!==void 0)return this._arr[t].priority},Co.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},Co.prototype.add=function(e,t){var n=this._keyIndices;if(e=String(e),!je.has(n,e)){var r=this._arr,o=r.length;return n[e]=o,r.push({key:e,priority:t}),this._decrease(o),!0}return!1},Co.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},Co.prototype.decrease=function(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)},Co.prototype._heapify=function(e){var t=this._arr,n=2*e,r=n+1,o=e;n<t.length&&(o=t[n].priority<t[o].priority?n:o,r<t.length&&(o=t[r].priority<t[o].priority?r:o),o!==e&&(this._swap(e,o),this._heapify(o)))},Co.prototype._decrease=function(e){for(var t,n=this._arr,r=n[e].priority;e!==0&&!(n[t=e>>1].priority<r);)this._swap(e,t),e=t},Co.prototype._swap=function(e,t){var n=this._arr,r=this._keyIndices,o=n[e],i=n[t];n[e]=i,n[t]=o,r[i.key]=e,r[o.key]=t};var mv=function(e,t,n,r){return function(o,i,a,s){var u,c,f={},l=new pv,d=function(h){var v=h.v!==u?h.v:h.w,m=f[v],g=a(h),E=c.distance+g;if(g<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+h+" Weight: "+g);E<m.distance&&(m.distance=E,m.predecessor=u,l.decrease(v,E))};for(o.nodes().forEach(function(h){var v=h===i?0:Number.POSITIVE_INFINITY;f[h]={distance:v},l.add(h,v)});l.size()>0&&(u=l.removeMin(),(c=f[u]).distance!==Number.POSITIVE_INFINITY);)s(u).forEach(d);return f}(e,String(t),n||J0,r||function(o){return e.outEdges(o)})},J0=je.constant(1),em=function(e,t,n){return je.transform(e.nodes(),function(r,o){r[o]=mv(e,o,t,n)},{})},gv=function(e){var t=0,n=[],r={},o=[];function i(a){var s=r[a]={onStack:!0,lowlink:t,index:t++};if(n.push(a),e.successors(a).forEach(function(f){je.has(r,f)?r[f].onStack&&(s.lowlink=Math.min(s.lowlink,r[f].index)):(i(f),s.lowlink=Math.min(s.lowlink,r[f].lowlink))}),s.lowlink===s.index){var u,c=[];do u=n.pop(),r[u].onStack=!1,c.push(u);while(a!==u);o.push(c)}}return e.nodes().forEach(function(a){je.has(r,a)||i(a)}),o},tm=function(e){return je.filter(gv(e),function(t){return t.length>1||t.length===1&&e.hasEdge(t[0],t[0])})},nm=function(e,t,n){return function(r,o,i){var a={},s=r.nodes();return s.forEach(function(u){a[u]={},a[u][u]={distance:0},s.forEach(function(c){u!==c&&(a[u][c]={distance:Number.POSITIVE_INFINITY})}),i(u).forEach(function(c){var f=c.v===u?c.w:c.v,l=o(c);a[u][f]={distance:l,predecessor:u}})}),s.forEach(function(u){var c=a[u];s.forEach(function(f){var l=a[f];s.forEach(function(d){var h=l[u],v=c[d],m=l[d],g=h.distance+v.distance;g<m.distance&&(m.distance=g,m.predecessor=v.predecessor)})})}),a}(e,t||rm,n||function(r){return e.outEdges(r)})},rm=je.constant(1),Yd=yv;function yv(e){var t={},n={},r=[];if(je.each(e.sinks(),function o(i){if(je.has(n,i))throw new pl;je.has(t,i)||(n[i]=!0,t[i]=!0,je.each(e.predecessors(i),o),delete n[i],r.push(i))}),je.size(t)!==e.nodeCount())throw new pl;return r}function pl(){}yv.CycleException=pl,pl.prototype=new Error;var Ev=function(e,t,n){je.isArray(t)||(t=[t]);var r=(e.isDirected()?e.successors:e.neighbors).bind(e),o=[],i={};return je.each(t,function(a){if(!e.hasNode(a))throw new Error("Graph does not have node: "+a);bv(e,a,n==="post",i,r,o)}),o};function bv(e,t,n,r,o,i){je.has(r,t)||(r[t]=!0,n||i.push(t),je.each(o(t),function(a){bv(e,a,n,r,o,i)}),n&&i.push(t))}var ml,om={Graph:vv.Graph,json:Y0,alg:{components:Q0,dijkstra:mv,dijkstraAll:em,findCycles:tm,floydWarshall:nm,isAcyclic:function(e){try{Yd(e)}catch(t){if(t instanceof Yd.CycleException)return!1;throw t}return!0},postorder:function(e,t){return Ev(e,t,"post")},preorder:function(e,t){return Ev(e,t,"pre")},prim:function(e,t){var n,r=new Zd,o={},i=new pv;function a(u){var c=u.v===n?u.w:u.v,f=i.priority(c);if(f!==void 0){var l=t(u);l<f&&(o[c]=n,i.decrease(c,l))}}if(e.nodeCount()===0)return r;je.each(e.nodes(),function(u){i.add(u,Number.POSITIVE_INFINITY),r.setNode(u)}),i.decrease(e.nodes()[0],0);for(var s=!1;i.size()>0;){if(n=i.removeMin(),je.has(o,n))r.setEdge(n,o[n]);else{if(s)throw new Error("Input graph is not connected: "+e);s=!0}e.nodeEdges(n).forEach(a)}return r},tarjan:gv,topsort:Yd},version:vv.version};try{ml=om}catch(e){}ml||(ml=window.graphlib);var qo=ml,im=function(e){return Dc(e,5)},Lc=function(e,t,n){if(!Ur(n))return!1;var r=typeof t;return!!(r=="number"?ht(n)&&ye(t,n.length):r=="string"&&t in n)&&ya(n[t],e)},xv=Object.prototype,am=xv.hasOwnProperty,sm=hl(function(e,t){e=Object(e);var n=-1,r=t.length,o=r>2?t[2]:void 0;for(o&&Lc(t[0],t[1],o)&&(r=1);++n<r;)for(var i=t[n],a=St(i),s=-1,u=a.length;++s<u;){var c=a[s],f=e[c];(f===void 0||ya(f,xv[c])&&!am.call(e,c))&&(e[c]=i[c])}return e}),um=function(e){return function(t,n,r){var o=Object(t);if(!ht(t)){var i=Vi(n);t=ot(t),n=function(s){return i(o[s],s,o)}}var a=e(t,n,r);return a>-1?o[i?t[a]:a]:void 0}},cm=/^\s+|\s+$/g,fm=/^[-+]0x[0-9a-f]+$/i,lm=/^0b[01]+$/i,dm=/^0o[0-7]+$/i,hm=parseInt,vm=function(e){if(typeof e=="number")return e;if(hs(e))return NaN;if(Ur(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Ur(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(cm,"");var n=lm.test(e);return n||dm.test(e)?hm(e.slice(2),n?2:8):fm.test(e)?NaN:+e},gl=function(e){return e?(e=vm(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:e===0?e:0},pm=function(e){var t=gl(e),n=t%1;return t==t?n?t-n:t:0},mm=Math.max,gm=um(function(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var o=n==null?0:pm(n);return o<0&&(o=mm(r+o,0)),cv(e,Vi(t),o)}),wv=function(e){return e!=null&&e.length?Hd(e,1):[]},ym=function(e,t){return e==null?e:Fd(e,Ch(t),St)},Em=function(e){var t=e==null?0:e.length;return t?e[t-1]:void 0},bm=function(e,t){var n={};return t=Vi(t),zd(e,function(r,o,i){O(n,o,t(r,o,i))}),n},Kd=function(e,t,n){for(var r=-1,o=e.length;++r<o;){var i=e[r],a=t(i);if(a!=null&&(s===void 0?a==a&&!hs(a):n(a,s)))var s=a,u=i}return u},xm=function(e,t){return e>t},wm=function(e){return e&&e.length?Kd(e,ds,xm):void 0},qd=function(e,t,n){(n!==void 0&&!ya(e[t],n)||n===void 0&&!(t in e))&&O(e,t,n)},_m=Function.prototype,Sm=Object.prototype,_v=_m.toString,Tm=Sm.hasOwnProperty,Im=_v.call(Object),Nm=function(e){if(!fe(e)||Io(e)!="[object Object]")return!1;var t=zt(e);if(t===null)return!0;var n=Tm.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&_v.call(n)==Im},Qd=function(e,t){if((t!=="constructor"||typeof e[t]!="function")&&t!="__proto__")return e[t]},Am=function(e){return Z(e,St(e))},Rm=function(e,t,n,r,o,i,a){var s=Qd(e,n),u=Qd(t,n),c=a.get(u);if(c)qd(e,n,c);else{var f=i?i(s,u,n+"",e,t,a):void 0,l=f===void 0;if(l){var d=se(u),h=!d&&V(u),v=!d&&!h&&Ne(u);f=u,d||h||v?se(s)?f=s:fv(s)?f=Bn(s):h?(l=!1,f=vn(u,!0)):v?(l=!1,f=re(u,!0)):f=[]:Nm(u)||De(u)?(f=s,De(s)?f=Am(s):Ur(s)&&!ls(s)||(f=He(u))):l=!1}l&&(a.set(u,f),o(f,u,r,i,a),a.delete(u)),qd(e,n,f)}},Dm=function e(t,n,r,o,i){t!==n&&Fd(n,function(a,s){if(i||(i=new Sa),Ur(a))Rm(t,n,s,r,e,o,i);else{var u=o?o(Qd(t,s),a,s+"",t,n,i):void 0;u===void 0&&(u=a),qd(t,s,u)}},St)},Cm=function(e){return hl(function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(i=e.length>3&&typeof i=="function"?(o--,i):void 0,a&&Lc(n[0],n[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++r<o;){var s=n[r];s&&e(t,s,r,i)}return t})}(function(e,t,n){Dm(e,t,n)}),Sv=function(e,t){return e<t},Om=function(e){return e&&e.length?Kd(e,ds,Sv):void 0},Lm=function(e,t){return e&&e.length?Kd(e,Vi(t),Sv):void 0},Mm=function(){return Br.Date.now()},km=function(e,t,n,r){if(!Ur(e))return e;for(var o=-1,i=(t=ll(t,e)).length,a=i-1,s=e;s!=null&&++o<i;){var u=Cc(t[o]),c=n;if(u==="__proto__"||u==="constructor"||u==="prototype")return e;if(o!=a){var f=s[u];(c=r?r(f,u,s):void 0)===void 0&&(c=Ur(f)?f:ye(t[o+1])?[]:{})}ae(s,u,c),s=s[u]}return e},Gm=function(e,t,n){for(var r=-1,o=t.length,i={};++r<o;){var a=t[r],s=dl(e,a);n(s,a)&&km(i,ll(a,e),s)}return i},Pm=function(e,t){return Gm(e,t,function(n,r){return Hh(e,r)})},Fm=function(e){return uv(sv(e,void 0,wv),e+"")}(function(e,t){return e==null?{}:Pm(e,t)}),zm=Math.ceil,Bm=Math.max,Um=function(e,t,n,r){for(var o=-1,i=Bm(zm((t-e)/(n||1)),0),a=Array(i);i--;)a[r?i:++o]=e,e+=n;return a},Vm=function(e){return function(t,n,r){return r&&typeof r!="number"&&Lc(t,n,r)&&(n=r=void 0),t=gl(t),n===void 0?(n=t,t=0):n=gl(n),r=r===void 0?t<n?1:-1:gl(r),Um(t,n,r,e)}}(),Xm=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e},$m=function(e,t){if(e!==t){var n=e!==void 0,r=e===null,o=e==e,i=hs(e),a=t!==void 0,s=t===null,u=t==t,c=hs(t);if(!s&&!c&&!i&&e>t||i&&a&&u&&!s&&!c||r&&a&&u||!n&&u||!o)return 1;if(!r&&!i&&!c&&e<t||c&&n&&o&&!r&&!i||s&&n&&o||!a&&o||!u)return-1}return 0},Wm=function(e,t,n){for(var r=-1,o=e.criteria,i=t.criteria,a=o.length,s=n.length;++r<a;){var u=$m(o[r],i[r]);if(u)return r>=s?u:u*(n[r]=="desc"?-1:1)}return e.index-t.index},Hm=function(e,t,n){t=t.length?fu(t,function(i){return se(i)?function(a){return dl(a,i.length===1?i[0]:i)}:i}):[ds];var r=-1;t=fu(t,le(Vi));var o=qh(e,function(i,a,s){return{criteria:fu(t,function(u){return u(i)}),index:++r,value:i}});return Xm(o,function(i,a){return Wm(i,a,n)})},Zm=hl(function(e,t){if(e==null)return[];var n=t.length;return n>1&&Lc(e,t[0],t[1])?t=[]:n>2&&Lc(t[0],t[1],t[2])&&(t=[t[0]]),Hm(e,Hd(t,1),[])}),jm=0,Ym=function(e){var t=++jm;return $h(e)+t},Km=function(e,t,n){for(var r=-1,o=e.length,i=t.length,a={};++r<o;){var s=r<i?t[r]:void 0;n(a,e[r],s)}return a},yl,qm=function(e,t){return Km(e||[],t||[],ae)};try{yl={cloneDeep:im,constant:cu,defaults:sm,each:Lh,filter:jh,find:gm,flatten:wv,forEach:Oh,forIn:ym,has:Yh,isUndefined:Kh,last:Em,map:Qh,mapValues:bm,max:wm,merge:Cm,min:Om,minBy:Lm,now:Mm,pick:Fm,range:Vm,reduce:Jh,sortBy:Zm,uniqueId:Ym,values:lv,zipObject:qm}}catch(e){}yl||(yl=window._);var P=yl,Qm=El;function El(){var e={};e._next=e._prev=e,this._sentinel=e}function Tv(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function Jm(e,t){if(e!=="_next"&&e!=="_prev")return t}El.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return Tv(t),t},El.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&Tv(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t},El.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,Jm)),n=n._prev;return"["+e.join(", ")+"]"};var eg=qo.Graph,tg=function(e,t){if(e.nodeCount()<=1)return[];var n=function(o,i){var a=new eg,s=0,u=0;P.forEach(o.nodes(),function(l){a.setNode(l,{v:l,in:0,out:0})}),P.forEach(o.edges(),function(l){var d=a.edge(l.v,l.w)||0,h=i(l),v=d+h;a.setEdge(l.v,l.w,v),u=Math.max(u,a.node(l.v).out+=h),s=Math.max(s,a.node(l.w).in+=h)});var c=P.range(u+s+3).map(function(){return new Qm}),f=s+1;return P.forEach(a.nodes(),function(l){eh(c,f,a.node(l))}),{graph:a,buckets:c,zeroIdx:f}}(e,t||ng),r=function(o,i,a){for(var s,u=[],c=i[i.length-1],f=i[0];o.nodeCount();){for(;s=f.dequeue();)Jd(o,i,a,s);for(;s=c.dequeue();)Jd(o,i,a,s);if(o.nodeCount()){for(var l=i.length-2;l>0;--l)if(s=i[l].dequeue()){u=u.concat(Jd(o,i,a,s,!0));break}}}return u}(n.graph,n.buckets,n.zeroIdx);return P.flatten(P.map(r,function(o){return e.outEdges(o.v,o.w)}),!0)},ng=P.constant(1);function Jd(e,t,n,r,o){var i=o?[]:void 0;return P.forEach(e.inEdges(r.v),function(a){var s=e.edge(a),u=e.node(a.v);o&&i.push({v:a.v,w:a.w}),u.out-=s,eh(t,n,u)}),P.forEach(e.outEdges(r.v),function(a){var s=e.edge(a),u=a.w,c=e.node(u);c.in-=s,eh(t,n,c)}),e.removeNode(r.v),i}function eh(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}var Iv={run:function(e){var t=e.graph().acyclicer==="greedy"?tg(e,function(n){return function(r){return n.edge(r).weight}}(e)):function(n){var r=[],o={},i={};function a(s){P.has(i,s)||(i[s]=!0,o[s]=!0,P.forEach(n.outEdges(s),function(u){P.has(o,u.w)?r.push(u):a(u.w)}),delete o[s])}return P.forEach(n.nodes(),a),r}(e);P.forEach(t,function(n){var r=e.edge(n);e.removeEdge(n),r.forwardName=n.name,r.reversed=!0,e.setEdge(n.w,n.v,r,P.uniqueId("rev"))})},undo:function(e){P.forEach(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}},Nv=qo.Graph,Ir={addDummyNode:Av,simplify:function(e){var t=new Nv().setGraph(e.graph());return P.forEach(e.nodes(),function(n){t.setNode(n,e.node(n))}),P.forEach(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},o=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+o.weight,minlen:Math.max(r.minlen,o.minlen)})}),t},asNonCompoundGraph:function(e){var t=new Nv({multigraph:e.isMultigraph()}).setGraph(e.graph());return P.forEach(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),P.forEach(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t},successorWeights:function(e){var t=P.map(e.nodes(),function(n){var r={};return P.forEach(e.outEdges(n),function(o){r[o.w]=(r[o.w]||0)+e.edge(o).weight}),r});return P.zipObject(e.nodes(),t)},predecessorWeights:function(e){var t=P.map(e.nodes(),function(n){var r={};return P.forEach(e.inEdges(n),function(o){r[o.v]=(r[o.v]||0)+e.edge(o).weight}),r});return P.zipObject(e.nodes(),t)},intersectRect:function(e,t){var n,r,o=e.x,i=e.y,a=t.x-o,s=t.y-i,u=e.width/2,c=e.height/2;if(!a&&!s)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(s)*u>Math.abs(a)*c?(s<0&&(c=-c),n=c*a/s,r=c):(a<0&&(u=-u),n=u,r=u*s/a),{x:o+n,y:i+r}},buildLayerMatrix:function(e){var t=P.map(P.range(Rv(e)+1),function(){return[]});return P.forEach(e.nodes(),function(n){var r=e.node(n),o=r.rank;P.isUndefined(o)||(t[o][r.order]=n)}),t},normalizeRanks:function(e){var t=P.min(P.map(e.nodes(),function(n){return e.node(n).rank}));P.forEach(e.nodes(),function(n){var r=e.node(n);P.has(r,"rank")&&(r.rank-=t)})},removeEmptyRanks:function(e){var t=P.min(P.map(e.nodes(),function(i){return e.node(i).rank})),n=[];P.forEach(e.nodes(),function(i){var a=e.node(i).rank-t;n[a]||(n[a]=[]),n[a].push(i)});var r=0,o=e.graph().nodeRankFactor;P.forEach(n,function(i,a){P.isUndefined(i)&&a%o!=0?--r:r&&P.forEach(i,function(s){e.node(s).rank+=r})})},addBorderNode:function(e,t,n,r){var o={width:0,height:0};return arguments.length>=4&&(o.rank=n,o.order=r),Av(e,"border",o,t)},maxRank:Rv,partition:function(e,t){var n={lhs:[],rhs:[]};return P.forEach(e,function(r){t(r)?n.lhs.push(r):n.rhs.push(r)}),n},time:function(e,t){var n=P.now();try{return t()}finally{console.log(e+" time: "+(P.now()-n)+"ms")}},notime:function(e,t){return t()}};function Av(e,t,n,r){var o;do o=P.uniqueId(r);while(e.hasNode(o));return n.dummy=t,e.setNode(o,n),o}function Rv(e){return P.max(P.map(e.nodes(),function(t){var n=e.node(t).rank;if(!P.isUndefined(n))return n}))}var Dv={run:function(e){e.graph().dummyChains=[],P.forEach(e.edges(),function(t){(function(n,r){var o,i,a,s=r.v,u=n.node(s).rank,c=r.w,f=n.node(c).rank,l=r.name,d=n.edge(r),h=d.labelRank;if(f!==u+1){for(n.removeEdge(r),a=0,++u;u<f;++a,++u)d.points=[],i={width:0,height:0,edgeLabel:d,edgeObj:r,rank:u},o=Ir.addDummyNode(n,"edge",i,"_d"),u===h&&(i.width=d.width,i.height=d.height,i.dummy="edge-label",i.labelpos=d.labelpos),n.setEdge(s,o,{weight:d.weight},l),a===0&&n.graph().dummyChains.push(o),s=o;n.setEdge(s,c,{weight:d.weight},l)}})(e,t)})},undo:function(e){P.forEach(e.graph().dummyChains,function(t){var n,r=e.node(t),o=r.edgeLabel;for(e.setEdge(r.edgeObj,o);r.dummy;)n=e.successors(t)[0],e.removeNode(t),o.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(o.x=r.x,o.y=r.y,o.width=r.width,o.height=r.height),t=n,r=e.node(t)})}},Cv=function(e){var t={};P.forEach(e.sources(),function n(r){var o=e.node(r);if(P.has(t,r))return o.rank;t[r]=!0;var i=P.min(P.map(e.outEdges(r),function(a){return n(a.w)-e.edge(a).minlen}));return i!==Number.POSITIVE_INFINITY&&i!=null||(i=0),o.rank=i})},Ov=function(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen},rg=qo.Graph,bl=Ov,Lv=function(e){var t,n,r=new rg({directed:!1}),o=e.nodes()[0],i=e.nodeCount();for(r.setNode(o,{});og(r,e)<i;)t=ig(r,e),n=r.hasNode(t.v)?bl(e,t):-bl(e,t),ag(r,e,n);return r};function og(e,t){return P.forEach(e.nodes(),function n(r){P.forEach(t.nodeEdges(r),function(o){var i=o.v,a=r===i?o.w:i;e.hasNode(a)||bl(t,o)||(e.setNode(a,{}),e.setEdge(r,a,{}),n(a))})}),e.nodeCount()}function ig(e,t){return P.minBy(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return bl(t,n)})}function ag(e,t,n){P.forEach(e.nodes(),function(r){t.node(r).rank+=n})}var sg=Ov,ug=Cv,cg=qo.alg.preorder,fg=qo.alg.postorder,lg=Ir.simplify,dg=vs;function vs(e){e=lg(e),ug(e);var t,n=Lv(e);for(nh(n),th(n,e);t=Gv(n);)Fv(n,e,t,Pv(n,e,t))}function th(e,t){var n=fg(e,e.nodes());n=n.slice(0,n.length-1),P.forEach(n,function(r){(function(o,i,a){var s=o.node(a).parent;o.edge(a,s).cutvalue=Mv(o,i,a)})(e,t,r)})}function Mv(e,t,n){var r=e.node(n).parent,o=!0,i=t.edge(n,r),a=0;return i||(o=!1,i=t.edge(r,n)),a=i.weight,P.forEach(t.nodeEdges(n),function(s){var u,c,f=s.v===n,l=f?s.w:s.v;if(l!==r){var d=f===o,h=t.edge(s).weight;if(a+=d?h:-h,u=n,c=l,e.hasEdge(u,c)){var v=e.edge(n,l).cutvalue;a+=d?-v:v}}}),a}function nh(e,t){arguments.length<2&&(t=e.nodes()[0]),kv(e,{},1,t)}function kv(e,t,n,r,o){var i=n,a=e.node(r);return t[r]=!0,P.forEach(e.neighbors(r),function(s){P.has(t,s)||(n=kv(e,t,n,s,r))}),a.low=i,a.lim=n++,o?a.parent=o:delete a.parent,n}function Gv(e){return P.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function Pv(e,t,n){var r=n.v,o=n.w;t.hasEdge(r,o)||(r=n.w,o=n.v);var i=e.node(r),a=e.node(o),s=i,u=!1;i.lim>a.lim&&(s=a,u=!0);var c=P.filter(t.edges(),function(f){return u===zv(e,e.node(f.v),s)&&u!==zv(e,e.node(f.w),s)});return P.minBy(c,function(f){return sg(t,f)})}function Fv(e,t,n,r){var o=n.v,i=n.w;e.removeEdge(o,i),e.setEdge(r.v,r.w,{}),nh(e),th(e,t),function(a,s){var u=P.find(a.nodes(),function(f){return!s.node(f).parent}),c=cg(a,u);c=c.slice(1),P.forEach(c,function(f){var l=a.node(f).parent,d=s.edge(f,l),h=!1;d||(d=s.edge(l,f),h=!0),s.node(f).rank=s.node(l).rank+(h?d.minlen:-d.minlen)})}(e,t)}function zv(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}vs.initLowLimValues=nh,vs.initCutValues=th,vs.calcCutValue=Mv,vs.leaveEdge=Gv,vs.enterEdge=Pv,vs.exchangeEdges=Fv;var Bv=Cv,hg=function(e){switch(e.graph().ranker){case"network-simplex":Uv(e);break;case"tight-tree":(function(t){Bv(t),Lv(t)})(e);break;case"longest-path":vg(e);break;default:Uv(e)}},vg=Bv;function Uv(e){dg(e)}var pg=function(e){var t=function(n){var r={},o=0;function i(a){var s=o;P.forEach(n.children(a),i),r[a]={low:s,lim:o++}}return P.forEach(n.children(),i),r}(e);P.forEach(e.graph().dummyChains,function(n){for(var r=e.node(n),o=r.edgeObj,i=function(l,d,h,v){var m,g,E=[],y=[],b=Math.min(d[h].low,d[v].low),w=Math.max(d[h].lim,d[v].lim);m=h;do m=l.parent(m),E.push(m);while(m&&(d[m].low>b||w>d[m].lim));for(g=m,m=v;(m=l.parent(m))!==g;)y.push(m);return{path:E.concat(y.reverse()),lca:g}}(e,t,o.v,o.w),a=i.path,s=i.lca,u=0,c=a[u],f=!0;n!==o.w;){if(r=e.node(n),f){for(;(c=a[u])!==s&&e.node(c).maxRank<r.rank;)u++;c===s&&(f=!1)}if(!f){for(;u<a.length-1&&e.node(c=a[u+1]).minRank<=r.rank;)u++;c=a[u]}e.setParent(n,c),n=e.successors(n)[0]}})},Vv={run:function(e){var t=Ir.addDummyNode(e,"root",{},"_root"),n=function(a){var s={};function u(c,f){var l=a.children(c);l&&l.length&&P.forEach(l,function(d){u(d,f+1)}),s[c]=f}return P.forEach(a.children(),function(c){u(c,1)}),s}(e),r=P.max(P.values(n))-1,o=2*r+1;e.graph().nestingRoot=t,P.forEach(e.edges(),function(a){e.edge(a).minlen*=o});var i=function(a){return P.reduce(a.edges(),function(s,u){return s+a.edge(u).weight},0)}(e)+1;P.forEach(e.children(),function(a){Xv(e,t,o,i,r,n,a)}),e.graph().nodeRankFactor=o},cleanup:function(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,P.forEach(e.edges(),function(n){e.edge(n).nestingEdge&&e.removeEdge(n)})}};function Xv(e,t,n,r,o,i,a){var s=e.children(a);if(s.length){var u=Ir.addBorderNode(e,"_bt"),c=Ir.addBorderNode(e,"_bb"),f=e.node(a);e.setParent(u,a),f.borderTop=u,e.setParent(c,a),f.borderBottom=c,P.forEach(s,function(l){Xv(e,t,n,r,o,i,l);var d=e.node(l),h=d.borderTop?d.borderTop:l,v=d.borderBottom?d.borderBottom:l,m=d.borderTop?r:2*r,g=h!==v?1:o-i[a]+1;e.setEdge(u,h,{weight:m,minlen:g,nestingEdge:!0}),e.setEdge(v,c,{weight:m,minlen:g,nestingEdge:!0})}),e.parent(a)||e.setEdge(t,u,{weight:0,minlen:o+i[a]})}else a!==t&&e.setEdge(t,a,{weight:0,minlen:n})}var mg=function(e){P.forEach(e.children(),function t(n){var r=e.children(n),o=e.node(n);if(r.length&&P.forEach(r,t),P.has(o,"minRank")){o.borderLeft=[],o.borderRight=[];for(var i=o.minRank,a=o.maxRank+1;i<a;++i)$v(e,"borderLeft","_bl",n,o,i),$v(e,"borderRight","_br",n,o,i)}})};function $v(e,t,n,r,o,i){var a={width:0,height:0,rank:i,borderType:t},s=o[t][i-1],u=Ir.addDummyNode(e,"border",a,n);o[t][i]=u,e.setParent(u,r),s&&e.setEdge(s,u,{weight:1})}var Wv={adjust:function(e){var t=e.graph().rankdir.toLowerCase();t!=="lr"&&t!=="rl"||Hv(e)},undo:function(e){var t=e.graph().rankdir.toLowerCase();t!=="bt"&&t!=="rl"||function(n){P.forEach(n.nodes(),function(r){rh(n.node(r))}),P.forEach(n.edges(),function(r){var o=n.edge(r);P.forEach(o.points,rh),P.has(o,"y")&&rh(o)})}(e),t!=="lr"&&t!=="rl"||(function(n){P.forEach(n.nodes(),function(r){oh(n.node(r))}),P.forEach(n.edges(),function(r){var o=n.edge(r);P.forEach(o.points,oh),P.has(o,"x")&&oh(o)})}(e),Hv(e))}};function Hv(e){P.forEach(e.nodes(),function(t){Zv(e.node(t))}),P.forEach(e.edges(),function(t){Zv(e.edge(t))})}function Zv(e){var t=e.width;e.width=e.height,e.height=t}function rh(e){e.y=-e.y}function oh(e){var t=e.x;e.x=e.y,e.y=t}var gg=function(e){var t={},n=P.filter(e.nodes(),function(s){return!e.children(s).length}),r=P.max(P.map(n,function(s){return e.node(s).rank})),o=P.map(P.range(r+1),function(){return[]});function i(s){if(!P.has(t,s)){t[s]=!0;var u=e.node(s);o[u.rank].push(s),P.forEach(e.successors(s),i)}}var a=P.sortBy(n,function(s){return e.node(s).rank});return P.forEach(a,i),o},yg=function(e,t){for(var n=0,r=1;r<t.length;++r)n+=Eg(e,t[r-1],t[r]);return n};function Eg(e,t,n){for(var r=P.zipObject(n,P.map(n,function(c,f){return f})),o=P.flatten(P.map(t,function(c){return P.sortBy(P.map(e.outEdges(c),function(f){return{pos:r[f.w],weight:e.edge(f).weight}}),"pos")}),!0),i=1;i<n.length;)i<<=1;var a=2*i-1;i-=1;var s=P.map(new Array(a),function(){return 0}),u=0;return P.forEach(o.forEach(function(c){var f=c.pos+i;s[f]+=c.weight;for(var l=0;f>0;)f%2&&(l+=s[f+1]),s[f=f-1>>1]+=c.weight;u+=c.weight*l})),u}var bg=function(e,t){return P.map(t,function(n){var r=e.inEdges(n);if(r.length){var o=P.reduce(r,function(i,a){var s=e.edge(a),u=e.node(a.v);return{sum:i.sum+s.weight*u.order,weight:i.weight+s.weight}},{sum:0,weight:0});return{v:n,barycenter:o.sum/o.weight,weight:o.weight}}return{v:n}})},xg=function(e,t){var n={};return P.forEach(e,function(r,o){var i=n[r.v]={indegree:0,in:[],out:[],vs:[r.v],i:o};P.isUndefined(r.barycenter)||(i.barycenter=r.barycenter,i.weight=r.weight)}),P.forEach(t.edges(),function(r){var o=n[r.v],i=n[r.w];P.isUndefined(o)||P.isUndefined(i)||(i.indegree++,o.out.push(n[r.w]))}),function(r){var o=[];function i(u){return function(c){c.merged||(P.isUndefined(c.barycenter)||P.isUndefined(u.barycenter)||c.barycenter>=u.barycenter)&&function(f,l){var d=0,h=0;f.weight&&(d+=f.barycenter*f.weight,h+=f.weight),l.weight&&(d+=l.barycenter*l.weight,h+=l.weight),f.vs=l.vs.concat(f.vs),f.barycenter=d/h,f.weight=h,f.i=Math.min(l.i,f.i),l.merged=!0}(u,c)}}function a(u){return function(c){c.in.push(u),--c.indegree==0&&r.push(c)}}for(;r.length;){var s=r.pop();o.push(s),P.forEach(s.in.reverse(),i(s)),P.forEach(s.out,a(s))}return P.map(P.filter(o,function(u){return!u.merged}),function(u){return P.pick(u,["vs","i","barycenter","weight"])})}(P.filter(n,function(r){return!r.indegree}))},wg=function(e,t){var n=Ir.partition(e,function(l){return P.has(l,"barycenter")}),r=n.lhs,o=P.sortBy(n.rhs,function(l){return-l.i}),i=[],a=0,s=0,u=0;r.sort((c=!!t,function(l,d){return l.barycenter<d.barycenter?-1:l.barycenter>d.barycenter?1:c?d.i-l.i:l.i-d.i})),u=jv(i,o,u),P.forEach(r,function(l){u+=l.vs.length,i.push(l.vs),a+=l.barycenter*l.weight,s+=l.weight,u=jv(i,o,u)});var c,f={vs:P.flatten(i,!0)};return s&&(f.barycenter=a/s,f.weight=s),f};function jv(e,t,n){for(var r;t.length&&(r=P.last(t)).i<=n;)t.pop(),e.push(r.vs),n++;return n}var _g=function e(t,n,r,o){var i=t.children(n),a=t.node(n),s=a?a.borderLeft:void 0,u=a?a.borderRight:void 0,c={};s&&(i=P.filter(i,function(m){return m!==s&&m!==u}));var f=bg(t,i);P.forEach(f,function(m){if(t.children(m.v).length){var g=e(t,m.v,r,o);c[m.v]=g,P.has(g,"barycenter")&&(E=m,y=g,P.isUndefined(E.barycenter)?(E.barycenter=y.barycenter,E.weight=y.weight):(E.barycenter=(E.barycenter*E.weight+y.barycenter*y.weight)/(E.weight+y.weight),E.weight+=y.weight))}var E,y});var l=xg(f,r);(function(m,g){P.forEach(m,function(E){E.vs=P.flatten(E.vs.map(function(y){return g[y]?g[y].vs:y}),!0)})})(l,c);var d=wg(l,o);if(s&&(d.vs=P.flatten([s,d.vs,u],!0),t.predecessors(s).length)){var h=t.node(t.predecessors(s)[0]),v=t.node(t.predecessors(u)[0]);P.has(d,"barycenter")||(d.barycenter=0,d.weight=0),d.barycenter=(d.barycenter*d.weight+h.order+v.order)/(d.weight+2),d.weight+=2}return d},Sg=qo.Graph,Tg=function(e,t,n){var r=function(i){for(var a;i.hasNode(a=P.uniqueId("_root")););return a}(e),o=new Sg({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(i){return e.node(i)});return P.forEach(e.nodes(),function(i){var a=e.node(i),s=e.parent(i);(a.rank===t||a.minRank<=t&&t<=a.maxRank)&&(o.setNode(i),o.setParent(i,s||r),P.forEach(e[n](i),function(u){var c=u.v===i?u.w:u.v,f=o.edge(c,i),l=P.isUndefined(f)?0:f.weight;o.setEdge(c,i,{weight:e.edge(u).weight+l})}),P.has(a,"minRank")&&o.setNode(i,{borderLeft:a.borderLeft[t],borderRight:a.borderRight[t]}))}),o},Ig=function(e,t,n){var r,o={};P.forEach(n,function(i){for(var a,s,u=e.parent(i);u;){if((a=e.parent(u))?(s=o[a],o[a]=u):(s=r,r=u),s&&s!==u)return void t.setEdge(s,u);u=a}})},Ng=qo.Graph,Ag=function(e){var t=Ir.maxRank(e),n=Yv(e,P.range(1,t+1),"inEdges"),r=Yv(e,P.range(t-1,-1,-1),"outEdges"),o=gg(e);Kv(e,o);for(var i,a=Number.POSITIVE_INFINITY,s=0,u=0;u<4;++s,++u){Rg(s%2?n:r,s%4>=2),o=Ir.buildLayerMatrix(e);var c=yg(e,o);c<a&&(u=0,i=P.cloneDeep(o),a=c)}Kv(e,i)};function Yv(e,t,n){return P.map(t,function(r){return Tg(e,r,n)})}function Rg(e,t){var n=new Ng;P.forEach(e,function(r){var o=r.graph().root,i=_g(r,o,n,t);P.forEach(i.vs,function(a,s){r.node(a).order=s}),Ig(r,n,i.vs)})}function Kv(e,t){P.forEach(t,function(n){P.forEach(n,function(r,o){e.node(r).order=o})})}var Dg=qo.Graph,Cg=function(e){var t,n=Ir.buildLayerMatrix(e),r=P.merge(Og(e,n),Lg(e,n)),o={};P.forEach(["u","d"],function(a){t=a==="u"?n:P.values(n).reverse(),P.forEach(["l","r"],function(s){s==="r"&&(t=P.map(t,function(l){return P.values(l).reverse()}));var u=(a==="u"?e.predecessors:e.successors).bind(e),c=kg(e,t,r,u),f=Gg(e,t,c.root,c.align,s==="r");s==="r"&&(f=P.mapValues(f,function(l){return-l})),o[a+s]=f})});var i=Pg(e,o);return Fg(o,i),zg(o,e.graph().align)};function Og(e,t){var n={};return P.reduce(t,function(r,o){var i=0,a=0,s=r.length,u=P.last(o);return P.forEach(o,function(c,f){var l=function(h,v){if(h.node(v).dummy)return P.find(h.predecessors(v),function(m){return h.node(m).dummy})}(e,c),d=l?e.node(l).order:s;(l||c===u)&&(P.forEach(o.slice(a,f+1),function(h){P.forEach(e.predecessors(h),function(v){var m=e.node(v),g=m.order;!(g<i||d<g)||m.dummy&&e.node(h).dummy||qv(n,v,h)})}),a=f+1,i=d)}),o}),n}function Lg(e,t){var n={};function r(o,i,a,s,u){var c;P.forEach(P.range(i,a),function(f){c=o[f],e.node(c).dummy&&P.forEach(e.predecessors(c),function(l){var d=e.node(l);d.dummy&&(d.order<s||d.order>u)&&qv(n,l,c)})})}return P.reduce(t,function(o,i){var a,s=-1,u=0;return P.forEach(i,function(c,f){if(e.node(c).dummy==="border"){var l=e.predecessors(c);l.length&&(a=e.node(l[0]).order,r(i,u,f,s,a),u=f,s=a)}r(i,u,i.length,a,o.length)}),i}),n}function qv(e,t,n){if(t>n){var r=t;t=n,n=r}var o=e[t];o||(e[t]=o={}),o[n]=!0}function Mg(e,t,n){if(t>n){var r=t;t=n,n=r}return P.has(e[t],n)}function kg(e,t,n,r){var o={},i={},a={};return P.forEach(t,function(s){P.forEach(s,function(u,c){o[u]=u,i[u]=u,a[u]=c})}),P.forEach(t,function(s){var u=-1;P.forEach(s,function(c){var f=r(c);if(f.length)for(var l=((f=P.sortBy(f,function(m){return a[m]})).length-1)/2,d=Math.floor(l),h=Math.ceil(l);d<=h;++d){var v=f[d];i[c]===c&&u<a[v]&&!Mg(n,c,v)&&(i[v]=c,i[c]=o[c]=o[v],u=a[v])}})}),{root:o,align:i}}function Gg(e,t,n,r,o){var i={},a=function(c,f,l,d){var h=new Dg,v=c.graph(),m=function(g,E,y){return function(b,w,T){var $,he=b.node(w),te=b.node(T),j=0;if(j+=he.width/2,P.has(he,"labelpos"))switch(he.labelpos.toLowerCase()){case"l":$=-he.width/2;break;case"r":$=he.width/2}if($&&(j+=y?$:-$),$=0,j+=(he.dummy?E:g)/2,j+=(te.dummy?E:g)/2,j+=te.width/2,P.has(te,"labelpos"))switch(te.labelpos.toLowerCase()){case"l":$=te.width/2;break;case"r":$=-te.width/2}return $&&(j+=y?$:-$),$=0,j}}(v.nodesep,v.edgesep,d);return P.forEach(f,function(g){var E;P.forEach(g,function(y){var b=l[y];if(h.setNode(b),E){var w=l[E],T=h.edge(w,b);h.setEdge(w,b,Math.max(m(c,y,E),T||0))}E=y})}),h}(e,t,n,o),s=o?"borderLeft":"borderRight";function u(c,f){for(var l=a.nodes(),d=l.pop(),h={};d;)h[d]?c(d):(h[d]=!0,l.push(d),l=l.concat(f(d))),d=l.pop()}return u(function(c){i[c]=a.inEdges(c).reduce(function(f,l){return Math.max(f,i[l.v]+a.edge(l))},0)},a.predecessors.bind(a)),u(function(c){var f=a.outEdges(c).reduce(function(d,h){return Math.min(d,i[h.w]-a.edge(h))},Number.POSITIVE_INFINITY),l=e.node(c);f!==Number.POSITIVE_INFINITY&&l.borderType!==s&&(i[c]=Math.max(i[c],f))},a.successors.bind(a)),P.forEach(r,function(c){i[c]=i[n[c]]}),i}function Pg(e,t){return P.minBy(P.values(t),function(n){var r=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return P.forIn(n,function(i,a){var s=function(u,c){return u.node(c).width}(e,a)/2;r=Math.max(i+s,r),o=Math.min(i-s,o)}),r-o})}function Fg(e,t){var n=P.values(t),r=P.min(n),o=P.max(n);P.forEach(["u","d"],function(i){P.forEach(["l","r"],function(a){var s,u=i+a,c=e[u];if(c!==t){var f=P.values(c);(s=a==="l"?r-P.min(f):o-P.max(f))&&(e[u]=P.mapValues(c,function(l){return l+s}))}})})}function zg(e,t){return P.mapValues(e.ul,function(n,r){if(t)return e[t.toLowerCase()][r];var o=P.sortBy(P.map(e,r));return(o[1]+o[2])/2})}var Bg=Cg,Ug=function(e){(function(t){var n=Ir.buildLayerMatrix(t),r=t.graph().ranksep,o=0;P.forEach(n,function(i){var a=P.max(P.map(i,function(s){return t.node(s).height}));P.forEach(i,function(s){t.node(s).y=o+a/2}),o+=a+r})})(e=Ir.asNonCompoundGraph(e)),P.forEach(Bg(e),function(t,n){e.node(n).x=t})},Vg=Ir.normalizeRanks,Xg=Ir.removeEmptyRanks,Ta=Ir,$g=qo.Graph,Wg=function(e,t){var n=t&&t.debugTiming?Ta.time:Ta.notime;n("layout",function(){var r=n("  buildLayoutGraph",function(){return function(o){var i=new $g({multigraph:!0,compound:!0}),a=ah(o.graph());return i.setGraph(P.merge({},Zg,ih(a,Hg),P.pick(a,jg))),P.forEach(o.nodes(),function(s){var u=ah(o.node(s));i.setNode(s,P.defaults(ih(u,Yg),Kg)),i.setParent(s,o.parent(s))}),P.forEach(o.edges(),function(s){var u=ah(o.edge(s));i.setEdge(s,P.merge({},Qg,ih(u,qg),P.pick(u,Jg)))}),i}(e)});n("  runLayout",function(){(function(o,i){i("    makeSpaceForEdgeLabels",function(){(function(a){var s=a.graph();s.ranksep/=2,P.forEach(a.edges(),function(u){var c=a.edge(u);c.minlen*=2,c.labelpos.toLowerCase()!=="c"&&(s.rankdir==="TB"||s.rankdir==="BT"?c.width+=c.labeloffset:c.height+=c.labeloffset)})})(o)}),i("    removeSelfEdges",function(){(function(a){P.forEach(a.edges(),function(s){if(s.v===s.w){var u=a.node(s.v);u.selfEdges||(u.selfEdges=[]),u.selfEdges.push({e:s,label:a.edge(s)}),a.removeEdge(s)}})})(o)}),i("    acyclic",function(){Iv.run(o)}),i("    nestingGraph.run",function(){Vv.run(o)}),i("    rank",function(){hg(Ta.asNonCompoundGraph(o))}),i("    injectEdgeLabelProxies",function(){(function(a){P.forEach(a.edges(),function(s){var u=a.edge(s);if(u.width&&u.height){var c=a.node(s.v),f={rank:(a.node(s.w).rank-c.rank)/2+c.rank,e:s};Ta.addDummyNode(a,"edge-proxy",f,"_ep")}})})(o)}),i("    removeEmptyRanks",function(){Xg(o)}),i("    nestingGraph.cleanup",function(){Vv.cleanup(o)}),i("    normalizeRanks",function(){Vg(o)}),i("    assignRankMinMax",function(){(function(a){var s=0;P.forEach(a.nodes(),function(u){var c=a.node(u);c.borderTop&&(c.minRank=a.node(c.borderTop).rank,c.maxRank=a.node(c.borderBottom).rank,s=P.max(s,c.maxRank))}),a.graph().maxRank=s})(o)}),i("    removeEdgeLabelProxies",function(){(function(a){P.forEach(a.nodes(),function(s){var u=a.node(s);u.dummy==="edge-proxy"&&(a.edge(u.e).labelRank=u.rank,a.removeNode(s))})})(o)}),i("    normalize.run",function(){Dv.run(o)}),i("    parentDummyChains",function(){pg(o)}),i("    addBorderSegments",function(){mg(o)}),i("    order",function(){Ag(o)}),i("    insertSelfEdges",function(){(function(a){var s=Ta.buildLayerMatrix(a);P.forEach(s,function(u){var c=0;P.forEach(u,function(f,l){var d=a.node(f);d.order=l+c,P.forEach(d.selfEdges,function(h){Ta.addDummyNode(a,"selfedge",{width:h.label.width,height:h.label.height,rank:d.rank,order:l+ ++c,e:h.e,label:h.label},"_se")}),delete d.selfEdges})})})(o)}),i("    adjustCoordinateSystem",function(){Wv.adjust(o)}),i("    position",function(){Ug(o)}),i("    positionSelfEdges",function(){(function(a){P.forEach(a.nodes(),function(s){var u=a.node(s);if(u.dummy==="selfedge"){var c=a.node(u.e.v),f=c.x+c.width/2,l=c.y,d=u.x-f,h=c.height/2;a.setEdge(u.e,u.label),a.removeNode(s),u.label.points=[{x:f+2*d/3,y:l-h},{x:f+5*d/6,y:l-h},{x:f+d,y:l},{x:f+5*d/6,y:l+h},{x:f+2*d/3,y:l+h}],u.label.x=u.x,u.label.y=u.y}})})(o)}),i("    removeBorderNodes",function(){(function(a){P.forEach(a.nodes(),function(s){if(a.children(s).length){var u=a.node(s),c=a.node(u.borderTop),f=a.node(u.borderBottom),l=a.node(P.last(u.borderLeft)),d=a.node(P.last(u.borderRight));u.width=Math.abs(d.x-l.x),u.height=Math.abs(f.y-c.y),u.x=l.x+u.width/2,u.y=c.y+u.height/2}}),P.forEach(a.nodes(),function(s){a.node(s).dummy==="border"&&a.removeNode(s)})})(o)}),i("    normalize.undo",function(){Dv.undo(o)}),i("    fixupEdgeLabelCoords",function(){(function(a){P.forEach(a.edges(),function(s){var u=a.edge(s);if(P.has(u,"x"))switch(u.labelpos!=="l"&&u.labelpos!=="r"||(u.width-=u.labeloffset),u.labelpos){case"l":u.x-=u.width/2+u.labeloffset;break;case"r":u.x+=u.width/2+u.labeloffset}})})(o)}),i("    undoCoordinateSystem",function(){Wv.undo(o)}),i("    translateGraph",function(){(function(a){var s=Number.POSITIVE_INFINITY,u=0,c=Number.POSITIVE_INFINITY,f=0,l=a.graph(),d=l.marginx||0,h=l.marginy||0;function v(m){var g=m.x,E=m.y,y=m.width,b=m.height;s=Math.min(s,g-y/2),u=Math.max(u,g+y/2),c=Math.min(c,E-b/2),f=Math.max(f,E+b/2)}P.forEach(a.nodes(),function(m){v(a.node(m))}),P.forEach(a.edges(),function(m){var g=a.edge(m);P.has(g,"x")&&v(g)}),s-=d,c-=h,P.forEach(a.nodes(),function(m){var g=a.node(m);g.x-=s,g.y-=c}),P.forEach(a.edges(),function(m){var g=a.edge(m);P.forEach(g.points,function(E){E.x-=s,E.y-=c}),P.has(g,"x")&&(g.x-=s),P.has(g,"y")&&(g.y-=c)}),l.width=u-s+d,l.height=f-c+h})(o)}),i("    assignNodeIntersects",function(){(function(a){P.forEach(a.edges(),function(s){var u,c,f=a.edge(s),l=a.node(s.v),d=a.node(s.w);f.points?(u=f.points[0],c=f.points[f.points.length-1]):(f.points=[],u=d,c=l),f.points.unshift(Ta.intersectRect(l,u)),f.points.push(Ta.intersectRect(d,c))})})(o)}),i("    reversePoints",function(){(function(a){P.forEach(a.edges(),function(s){var u=a.edge(s);u.reversed&&u.points.reverse()})})(o)}),i("    acyclic.undo",function(){Iv.undo(o)})})(r,n)}),n("  updateInputGraph",function(){(function(o,i){P.forEach(o.nodes(),function(a){var s=o.node(a),u=i.node(a);s&&(s.x=u.x,s.y=u.y,i.children(a).length&&(s.width=u.width,s.height=u.height))}),P.forEach(o.edges(),function(a){var s=o.edge(a),u=i.edge(a);s.points=u.points,P.has(u,"x")&&(s.x=u.x,s.y=u.y)}),o.graph().width=i.graph().width,o.graph().height=i.graph().height})(e,r)})})},Hg=["nodesep","edgesep","ranksep","marginx","marginy"],Zg={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},jg=["acyclicer","ranker","rankdir","align"],Yg=["width","height"],Kg={width:0,height:0},qg=["minlen","weight","width","height","labeloffset"],Qg={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Jg=["labelpos"];function ih(e,t){return P.mapValues(P.pick(e,t),Number)}function ah(e){var t={};return P.forEach(e,function(n,r){t[r.toLowerCase()]=n}),t}var ey=qo.Graph,Qv={graphlib:qo,layout:Wg,debug:{debugOrdering:function(e){var t=Ir.buildLayerMatrix(e),n=new ey({compound:!0,multigraph:!0}).setGraph({});return P.forEach(e.nodes(),function(r){n.setNode(r,{label:r}),n.setParent(r,"layer"+e.node(r).rank)}),P.forEach(e.edges(),function(r){n.setEdge(r.v,r.w,{},r.name)}),P.forEach(t,function(r,o){var i="layer"+o;n.setNode(i,{rank:"same"}),P.reduce(r,function(a,s){return n.setEdge(a,s,{style:"invis"}),s})}),n}},util:{time:Ir.time,notime:Ir.notime},version:"0.8.5"},ty=Qv.graphlib,ny=Qv.layout;class ry{constructor(t){this.cardinality=1,this.include=ga.UNSPECIFIED,this.isGroupNode=!1,this.parentNode=null,this.type=_r.NODE,this.name=t.name,this.attr=t.attr||{},this.inputs=t.inputs,this.path=t.path||[],this.width=t.width,this.height=t.height}}class oy{constructor(){this.nodes={},this.edges=[],this.nodes={},this.edges=[]}}function iy(e){const t=new oy;return e.nodes.map(n=>new ry(n)).forEach(n=>{t.nodes[n.name]=n,n.inputs.forEach(r=>{(function(o,i,a){a.name!==i.name&&o.edges.push(Object.assign(Object.assign({},a.attr),{v:a.name,w:i.name}))})(t,n,r)})}),t}class ay{constructor(t,n={}){this.attr=null,this.bridgeGraph=null,this.cardinality=0,this.depth=1,this.include=ga.UNSPECIFIED,this.isGroupNode=!0,this.parentNode=null,this.type=_r.META,this.path=[],this.name=t,this.metaGraph=sh(t,as.META,n)}getFirstChild(){return this.metaGraph.node(this.metaGraph.nodes()[0])}getChildren(){return this.metaGraph.nodes().map(t=>this.metaGraph.node(t))}leaves(){let t,n=[],r=[this];for(;r.length;){let o=r.shift();o.isGroupNode?(t=o.metaGraph,t.nodes().forEach(i=>r.push(t.node(i)))):n.push(o.name)}return n}}class sy{constructor(t,n){this.v=t,this.w=n,this.baseEdgeList=[],this.inbound=null,this.name=null}addBaseEdge(t,n){this.baseEdgeList.push(t)}}function Jv(e,t={}){return new ay(e,t)}function ep(e,t){return new sy(e,t)}function sh(e,t,n){const r=n||{},o=new ty.Graph(r);return o.setGraph({name:e,rankdir:r.rankdir,type:t,align:r.align}),o}class uy{constructor(t={}){this.graphOptions=t,this.index={},this.graphOptions.compound=!0,this.root=Jv(ma,this.graphOptions),this.index[ma]=this.root}getNodeMap(){return this.index}node(t){return this.index[t]}setNode(t,n){this.index[t]=n}getBridgeGraph(t){const n=this.index[t];if(!n)throw Error("Could not find node in hierarchy: "+t);if(!("metaGraph"in n))return null;const r=n;if(r.bridgeGraph)return r.bridgeGraph;const o=sh(Td,as.BRIDGE,this.graphOptions);if(r.bridgeGraph=o,!n.parentNode||!("metaGraph"in n.parentNode))return o;const i=n.parentNode;return[i.metaGraph,this.getBridgeGraph(i.name)].forEach(a=>{a.edges().filter(s=>s.v===t||s.w===t).forEach(s=>{const u=s.w===t;a.edge(s).baseEdgeList.forEach(c=>{const[f,l]=u?[c.w,s.v]:[c.v,s.w],d=this.getChildName(t,f),h={v:u?l:d,w:u?d:l};let v=o.edge(h);v||(v=ep(h.v,h.w),v.inbound=u,o.setEdge(h.v,h.w,v)),v.addBaseEdge(c,this)})})}),o}getChildName(t,n){let r=this.index[n];for(;r;){if(r.parentNode&&r.parentNode.name===t)return r.name;r=r.parentNode}throw Error("Could not find immediate child for descendant: "+n)}getPredecessors(t){const n=this.index[t];if(!n)throw Error("Could not find node with name: "+t);return this.getOneWayEdges(n,!0)}getSuccessors(t){const n=this.index[t];if(!n)throw Error("Could not find node with name: "+t);return this.getOneWayEdges(n,!1)}getOneWayEdges(t,n){const r=[];if(!t.parentNode||!t.parentNode.isGroupNode)return r;const o=t.parentNode,i=o.metaGraph,a=this.getBridgeGraph(o.name);return tp(i,t,n,r),tp(a,t,n,r),r}}function cy(e,t){const{rankDirection:n,align:r}=t,o=new uy({rankdir:n,align:r});return function(i,a){Object.keys(a.nodes).forEach(s=>{const u=a.nodes[s],c=u.path;let f=i.root;f.depth=Math.max(c.length,f.depth);for(let l=0;l<c.length&&(f.depth=Math.max(f.depth,c.length-l),f.cardinality+=u.cardinality,l!==c.length-1);l++){const d=c[l];let h=i.node(d);h||(h=Jv(d,i.graphOptions),h.path=u.path.slice(0,l+1),h.parentNode=f,i.setNode(d,h),f.metaGraph.setNode(d,h)),f=h}i.setNode(u.name,u),u.parentNode=f,f.metaGraph.setNode(u.name,u)})}(o,e),function(i,a){const s=i.getNodeMap();let u=[],c=[];const f=(l,d)=>{let h=0;for(;l;)d[h++]=l.name,l=l.parentNode;return h-1};a.edges.forEach(l=>{u=[],c=[];let d=f(a.nodes[l.v],u),h=f(a.nodes[l.w],c);for(;u[d]===c[h];)if(d--,h--,d<0||h<0)throw Error("No difference found between ancestor paths.");const v=s[u[d+1]],m=u[d],g=c[h];let E=v.metaGraph.edge(m,g);E||(E=ep(m,g),v.metaGraph.setEdge(m,g,E)),E.addBaseEdge(l,i)})}(o,e),o}function tp(e,t,n,r){(n?e.inEdges(t.name):e.outEdges(t.name)).forEach(o=>{const i=e.edge(o);r.push(i)})}class fy{constructor(t){this.hierarchy=t,this.index={},this.hasSubHierarchy={},this.root=new rp(this.hierarchy.root,this.hierarchy.graphOptions),this.index[t.root.name]=this.root,this.buildSubHierarchy(t.root.name),this.root.expanded=!0}getRenderInfoNodes(){return Object.values(this.index)}getSubHierarchy(){return this.hasSubHierarchy}buildSubHierarchy(t){if(t in this.hasSubHierarchy)return;this.hasSubHierarchy[t]=!0;const n=this.index[t];if(n.node.type!==_r.META)return;const r=n,o=r.node.metaGraph,i=r.coreGraph;o.nodes().forEach(f=>{const l=this.getOrCreateRenderNodeByName(f);i.setNode(f,l)}),o.edges().forEach(f=>{const l=o.edge(f),d=new np(l);i.setEdge(f.v,f.w,d)});const a=r.node.parentNode;if(!a)return;const s=this.getRenderNodeByName(a.name),u=(f,...l)=>l.concat([f?"IN":"OUT"]).join("~~"),c=this.hierarchy.getBridgeGraph(t);c.edges().forEach(f=>{const l=c.edge(f),d=!!o.node(f.w),[h,v]=d?[f.w,f.v]:[f.v,f.w],m=T=>{const $=d?{v:T,w:t}:{v:t,w:T};return s.coreGraph.edge($)};let g=m(v);g||(g=m(u(d,v,a.name)));const E=u(d,t),y=u(d,v,t);let b=i.node(y);if(!b){let T=i.node(E);if(!T){const he={name:E,type:_r.BRIDGE,isGroupNode:!1,cardinality:0,parentNode:null,include:ga.UNSPECIFIED,inbound:d,attr:{}};T=new xl(he),this.index[E]=T,i.setNode(E,T)}const $={name:y,type:_r.BRIDGE,isGroupNode:!1,cardinality:1,parentNode:null,include:ga.UNSPECIFIED,inbound:d,attr:{}};b=new xl($),this.index[y]=b,i.setNode(y,b),i.setParent(y,E),T.node.cardinality++}const w=new np(l);w.adjoiningMetaEdge=g,d?i.setEdge(y,h,w):i.setEdge(h,y,w)})}getOrCreateRenderNodeByName(t){if(!t)return null;if(t in this.index)return this.index[t];const n=this.getNodeByName(t);return n?(this.index[t]=n.isGroupNode?new rp(n,this.hierarchy.graphOptions):new xl(n),this.index[t]):null}getRenderNodeByName(t){return this.index[t]}getNodeByName(t){return this.hierarchy.node(t)}}class xl{constructor(t){this.node=t,this.expanded=!1,this.x=0,this.y=0,this.coreBox={width:0,height:0},this.outboxWidth=0,this.labelOffset=0,this.radius=0,this.labelHeight=0,this.paddingTop=0,this.paddingLeft=0,this.paddingRight=0,this.paddingBottom=0,this.width=t.width||0,this.height=t.height||0,this.displayName=t.name,this.attr=t.attr}}class np{constructor(t){this.metaEdge=t,this.adjoiningMetaEdge=null,this.weight=1,this.points=[]}}class rp extends xl{constructor(t,n){super(t);const r=t.metaGraph.graph();n.compound=!0,this.coreGraph=sh(r.name,as.CORE,n)}}function op(e,t){e.node.isGroupNode&&function(n,r){const o=Zo(r);n.coreGraph.nodes().map(i=>n.coreGraph.node(i)).forEach(i=>{var a,s,u,c,f,l;const{height:d,width:h}=i;switch(i.node.type){case _r.NODE:Object.assign(i,o.nodeSize.node),i.height=d||o.nodeSize.node.height,i.width=h||o.nodeSize.node.width;break;case _r.BRIDGE:Object.assign(i,o.nodeSize.bridge);break;case _r.META:i.expanded?op(i,r):(Object.assign(i,o.nodeSize.meta),i.height=o.nodeSize.meta.height,i.width=o.nodeSize.meta.width);break;default:throw Error("Unrecognized node type: "+i.node.type)}if(!i.expanded){const v=i.attr;(function(m,g=!1){if(m.coreBox.width=m.width,m.coreBox.height=m.height,!g){const E=`${m.displayName}`.length,y=3;m.width=Math.max(m.coreBox.width,E*y)}})(i,r&&(i.node.type===0&&!!(!((s=(a=r==null?void 0:r.nodeSize)===null||a===void 0?void 0:a.meta)===null||s===void 0)&&s.width)||i.node.type===1&&(!!(!((c=(u=r==null?void 0:r.nodeSize)===null||u===void 0?void 0:u.node)===null||c===void 0)&&c.width)||!!v.width)||i.node.type===2&&!!(!((l=(f=r==null?void 0:r.nodeSize)===null||f===void 0?void 0:f.bridge)===null||l===void 0)&&l.width)))}})}(e,t),e.node.type===_r.META&&function(n,r){const o=Zo(r),i=o.subScene.meta;Object.assign(n,i);const{nodeSep:a,rankSep:s,edgeSep:u,align:c}=o.graph.meta,f={nodesep:a,ranksep:s,edgesep:u,align:c};Object.assign(n.coreBox,function(h,v){const{ranksep:m,nodesep:g,edgesep:E,align:y}=v;Object.assign(h.graph(),{ranksep:m,nodesep:g,edgesep:E,align:y});const b=[];if(h.nodes().forEach(te=>{h.node(te).node.type!==_r.BRIDGE&&b.push(te)}),!b.length)return{width:0,height:0};ny(h);let w=1/0,T=1/0,$=-1/0,he=-1/0;return b.forEach(te=>{const j=h.node(te),q=.5*j.width,ve=j.x-q,k=j.x+q;w=ve<w?ve:w,$=k>$?k:$;const pe=.5*j.height,Pe=j.y-pe,Ue=j.y+pe;T=Pe<T?Pe:T,he=Ue>he?Ue:he}),h.edges().forEach(te=>{const j=h.edge(te),q=h.node(j.metaEdge.v),ve=h.node(j.metaEdge.w);if(j.points.length===3&&function(Pe){let Ue=ip(Pe[0],Pe[1]);for(let mt=1;mt<Pe.length-1;mt++){const Ke=ip(Pe[mt],Pe[mt+1]);if(Math.abs(Ke-Ue)>1)return!1;Ue=Ke}return!0}(j.points)){if(q!=null){const Pe=q.expanded?q.x:uh(q);j.points[0].x=Pe}if(ve!=null){const Pe=ve.expanded?ve.x:uh(ve);j.points[2].x=Pe}j.points=[j.points[0],j.points[1]]}const k=j.points[j.points.length-2];ve!=null&&(j.points[j.points.length-1]=ap(k,ve));const pe=j.points[1];q!=null&&(j.points[0]=ap(pe,q)),j.points.forEach(Pe=>{w=Pe.x<w?Pe.x:w,$=Pe.x>$?Pe.x:$,T=Pe.y<T?Pe.y:T,he=Pe.y>he?Pe.y:he})}),h.nodes().forEach(te=>{const j=h.node(te);j.x-=w,j.y-=T}),h.edges().forEach(te=>{h.edge(te).points.forEach(j=>{j.x-=w,j.y-=T})}),{width:$-w,height:he-T}}(n.coreGraph,f));let l=0;n.coreGraph.nodeCount()>0&&l++;const d=l<=1?0:l;n.coreBox.width+=d+d,n.coreBox.height=i.labelHeight+n.coreBox.height,n.width=n.coreBox.width+i.paddingLeft+i.paddingRight,n.height=n.paddingTop+n.coreBox.height+n.paddingBottom}(e,t)}function ip(e,t){const n=t.x-e.x,r=t.y-e.y;return 180*Math.atan(r/n)/Math.PI}function uh(e){return e.expanded?e.x:e.x-e.width/2+0+e.coreBox.width/2}function ap(e,t){const n=t.expanded?t.x:uh(t),r=t.y,o=e.x-n,i=e.y-r;let a,s,u=t.expanded?t.width:t.coreBox.width,c=t.expanded?t.height:t.coreBox.height;return Math.abs(i)*u/2>Math.abs(o)*c/2?(i<0&&(c=-c),a=i===0?0:c/2*o/i,s=c/2):(o<0&&(u=-u),a=u/2,s=o===0?0:u/2*i/o),{x:n+a,y:r+s}}function ly(e,t,n){var r,o,i,a;const s=e.nodes.filter((l,d,h)=>h.findIndex(v=>v.id===l.id)!==d).map(l=>l.id);if(s.length)throw new Error(`Duplicated ids found: ${s.join(", ")}`);const u=function(l){const d={nodes:[]},h=l.compound,v=Object.keys(h||{}),m=new Map,g=(y,b=[])=>{if(m.has(y))return m.get(y);for(let w=0;w<v.length;w++){let T=v[w];if(h&&h[T].indexOf(y)!==-1)return b.unshift(T),g(T,b)}return b.length===0&&m.set(y,b),b},E=y=>l.edges.filter(b=>b.w===y).map(b=>({name:b.v}));return l.nodes.forEach(y=>{const b=y.id,w=[...g(b),b];let T=E(b);d.nodes.push({name:b,path:w,inputs:T,width:y.width,height:y.height,attr:Object.assign({},y)})}),d}(e),c=function(l,d){const h=(m,g)=>{for(let E of g.values())if(E.includes(m))return!0;return!1},v=(m,g=[])=>{if(Object.keys(m).length===0)return[...new Set(g)];const E=new Map(Object.keys(m).map(b=>[b,m[b]])),y={};for(let[b,w]of E)h(b,E)?y[b]=w:g=g.concat(b,w);return v(y,g)};return v(l).filter(m=>d.includes(m))}(e.compound||{},(t==null?void 0:t.expanded)||[]),f=function(l,d){return function(h){return new fy(h)}(cy(iy(l),d))}(u,{rankDirection:((o=(r=n==null?void 0:n.graph)===null||r===void 0?void 0:r.meta)===null||o===void 0?void 0:o.rankDir)||(t==null?void 0:t.rankDirection)||qs.graph.meta.rankDir,align:((a=(i=n==null?void 0:n.graph)===null||i===void 0?void 0:i.meta)===null||a===void 0?void 0:a.align)||qs.graph.meta.align});return function(l,d){d.forEach(h=>{const v=l.getRenderInfoNodes().find(E=>E.displayName===h);let m=v&&v.node&&v.node.name||"";const g=l.getRenderNodeByName(m);if(!g)throw new Error(`No nodes found: ${m}`);g.expanded=!0,l.buildSubHierarchy(m)})}(f,c),op(f.root,n),up(f.root)}function dy(e,t=!1){const n=JSON.parse(JSON.stringify(e)),r={nodes:[n],edges:[...n.edges]};return n.nodes.forEach(function o(i){(i.type===0||i.type===1)&&r.nodes.push(i),i.type===0&&(r.edges=r.edges.concat(i.edges)),Array.isArray(i.nodes)&&i.nodes.forEach(o)}),t&&r.nodes.forEach(o=>{const i=r.nodes.find(a=>a.id===o.parentNodeName);if(i){const a=i.x-i.width/2+i.paddingLeft,s=i.y-i.height/2+i.labelHeight+i.paddingTop;i.id!==ma&&(o.x+=a,o.y+=s),o.type===0&&o.edges.forEach(u=>{u.points.forEach(c=>{c.x+=o.x-o.width/2+o.paddingLeft,c.y+=o.y-o.height/2+o.labelHeight+o.paddingTop})})}}),r}function sp(e,t,n,r){var o,i;let a=[];const s=((o=n.find(l=>l.id===e))===null||o===void 0?void 0:o.path)||[],u=((i=n.find(l=>l.id===t))===null||i===void 0?void 0:i.path)||[],c=[ma,...s].slice(0,s.length).reverse(),f=[ma,...u].slice(0,u.length);return c.forEach(l=>{const d=n.find(h=>h.id===l);a=a.concat(d.edges.filter(h=>h.baseEdgeList.some(v=>v.v===((r==null?void 0:r.v)||e)&&v.w===((r==null?void 0:r.w)||t))))}),f.filter(l=>!c.includes(l)).forEach(l=>{const d=n.find(h=>h.id===l);a=a.concat(d.edges.filter(h=>h.baseEdgeList.some(v=>v.v===((r==null?void 0:r.v)||e)&&v.w===((r==null?void 0:r.w)||t))))}),a}function up(e){const t=e.coreGraph.nodes().map(r=>e.coreGraph.node(r));return Object.assign(Object.assign({},cp(e)),{expanded:e.expanded,nodes:e.expanded?(n=t,n.map(r=>r.node.type===_r.META?up(r):cp(r))):[],edges:e.expanded?hy(e):[]});var n}function cp(e){return{id:e.node.name,name:e.node.name,type:e.node.type,cardinality:e.node.cardinality,attr:e.attr,parentNodeName:e.node.parentNode?e.node.parentNode.name:null,coreBox:Object.assign({},e.coreBox),x:e.x,y:e.y,width:e.width,height:e.height,radius:e.radius,labelHeight:e.labelHeight,labelOffset:e.labelOffset,outboxWidth:e.outboxWidth,paddingLeft:e.paddingLeft,paddingTop:e.paddingTop,paddingRight:e.paddingRight,paddingBottom:e.paddingBottom,path:e.node.path}}function hy(e){return e.coreGraph.edges().map(t=>({renderInfoEdge:e.coreGraph.edge(t),edge:t})).filter(({renderInfoEdge:t})=>t.metaEdge).map(({edge:t,renderInfoEdge:n})=>{const r=function(o,i){const a=i.points.map(s=>Object.assign({},s));if(i.adjoiningMetaEdge){const s=i.adjoiningMetaEdge.points,u=i.metaEdge.inbound,c=u?s[s.length-1]:s[0],f=a[u?0:a.length-1],l=o.x-o.width/2,d=o.y-o.height/2,h=c.x-l,v=c.y-d,m=-o.paddingLeft,g=-(o.paddingTop+o.labelHeight);f.x=h+m,f.y=v+g}return a}(e,n);return{adjoiningEdge:n.adjoiningMetaEdge?{w:n.adjoiningMetaEdge.metaEdge.w,v:n.adjoiningMetaEdge.metaEdge.v}:null,inbound:n.metaEdge.inbound,w:t.w,v:t.v,points:r,weight:n.weight,baseEdgeList:n.metaEdge.baseEdgeList,parentNodeName:e.node.name}})}class vy extends $e{constructor(t){super(),this.rankdir="TB",this.nodesep=50,this.edgesep=5,this.ranksep=50,this.controlPoints=!0,this.anchorPoint=!0,this.nodes=[],this.edges=[],this.combos=[],this.onLayoutEnd=()=>{},this.updateCfg(t)}getDefaultCfg(){return{rankdir:"TB",align:void 0,begin:void 0,nodeSize:void 0,nodesep:50,ranksep:50,controlPoints:!0,anchorPoint:!0}}init(t){const n=t.hiddenNodes||[],r=t.hiddenEdges||[],o=t.hiddenCombos||[];this.nodes=this.getDataByOrder((t.nodes||[]).concat(n)),this.edges=this.getDataByOrder((t.edges||[]).concat(r)),this.combos=(t.combos||[]).concat(o.map(i=>Object.assign(Object.assign({},i),{collapsed:!0})))}execute(){const t=this,{nodes:n,edges:r}=t;if(!n)return;const{graphDef:o,graphOption:i,graphSettings:a}=t.getLayoutConfig(),s=ly(o,i,a),u=dy(s,!0);return this.updatePosition(u),t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:r}}getNodePath(t){const n=this,{nodes:r,combos:o}=n,i=r.find(s=>s.id===t),a=(s,u=[])=>{const c=o.find(f=>f.id===s);return c?(u.unshift(s),c.parentId?a(c.parentId,u):u):u};return i&&i.comboId?a(i.comboId,[t]):[t]}getLayoutConfig(){var t,n,r;const o=this,{nodes:i,edges:a,combos:s,nodeSize:u,rankdir:c,align:f,edgesep:l,nodesep:d,ranksep:h,settings:v}=o,m=(s||[]).reduce((pe,Pe)=>{const Ue=i.filter(Ke=>Ke.comboId===Pe.id).map(Ke=>Ke.id),mt=(s||[]).filter(Ke=>Ke.parentId===Pe.id).map(Ke=>Ke.id);return(Ue.length||mt.length)&&(pe[Pe.id]=[...Ue,...mt]),pe},{});let g;u?bt(u)?g=()=>u:g=()=>[u,u]:g=pe=>pe&&pe.size?bt(pe.size)?pe.size:Ot(pe.size)?[pe.size.width||40,pe.size.height||40]:[pe.size,pe.size]:[40,40];const E=pe=>pe&&pe.size?bt(pe.size)?pe.size:[pe.size,pe.size]:[80,40],[y,b]=E(s==null?void 0:s[0]),w=(n=(t=o.graphSettings)===null||t===void 0?void 0:t.subScene)===null||n===void 0?void 0:n.meta,[T,$,he,te]=((r=s.find(pe=>!pe.collapsed))===null||r===void 0?void 0:r.padding)||[20,20,20,20],j={compound:m,nodes:[...(i||[]).map(pe=>{const Pe=g(pe),Ue=Pe[0],mt=Pe[1];return Object.assign(Object.assign({},pe),{width:Ue,height:mt})})],edges:[...(a||[]).map(pe=>Object.assign(Object.assign({},pe),{v:pe.source,w:pe.target}))]},q={expanded:(s||[]).filter(pe=>!pe.collapsed).map(pe=>pe.id)},ve={graph:{meta:{align:f,rankDir:c,nodeSep:d,edgeSep:l,rankSep:h}},subScene:{meta:{paddingTop:T||(w==null?void 0:w.paddingTop)||20,paddingRight:$||(w==null?void 0:w.paddingRight)||20,paddingBottom:he||(w==null?void 0:w.paddingBottom)||20,paddingLeft:te||(w==null?void 0:w.paddingLeft)||20,labelHeight:0}},nodeSize:{meta:{width:y,height:b}}},k=Zo(v,Object.assign({},Zo(ve,qs)));return o.graphSettings=k,{graphDef:j,graphOption:q,graphSettings:k}}updatePosition(t){const{nodes:n,edges:r}=t;this.updateNodePosition(n,r),this.updateEdgePosition(n,r)}getBegin(t,n){const r=this,{begin:o}=r,i=[0,0];if(o){let a=1/0,s=1/0;t.forEach(u=>{a>u.x&&(a=u.x),s>u.y&&(s=u.y)}),n.forEach(u=>{u.points.forEach(c=>{a>c.x&&(a=c.x),s>c.y&&(s=c.y)})}),i[0]=o[0]-a,i[1]=o[1]-s}return i}updateNodePosition(t,n){const r=this,{combos:o,nodes:i,edges:a,anchorPoint:s,graphSettings:u}=r,c=this.getBegin(t,n);t.forEach(f=>{var l;const{x:d,y:h,id:v,type:m,coreBox:g}=f;if(m===Qs.META&&v!==ma){const E=o.findIndex(b=>b.id===v),y=(l=u==null?void 0:u.subScene)===null||l===void 0?void 0:l.meta;o[E].offsetX=d+c[0],o[E].offsetY=h+c[1],o[E].fixSize=[g.width,g.height],o[E].fixCollapseSize=[g.width,g.height],f.expanded?o[E].padding=[y==null?void 0:y.paddingTop,y==null?void 0:y.paddingRight,y==null?void 0:y.paddingBottom,y==null?void 0:y.paddingLeft]:o[E].padding=[0,0,0,0]}else if(m===Qs.OP){const E=i.findIndex(y=>y.id===v);if(i[E].x=d+c[0],i[E].y=h+c[1],s){const y=[],b=n.filter(T=>T.v===v),w=n.filter(T=>T.w===v);b.length>0&&b.forEach(T=>{const $=T.points[0],he=($.x-d)/f.width+.5,te=($.y-h)/f.height+.5;y.push([he,te]),T.baseEdgeList.forEach(j=>{const q=a.find(ve=>ve.source===j.v&&ve.target===j.w);q&&(q.sourceAnchor=y.length-1)})}),w.length>0&&w.forEach(T=>{const $=T.points[T.points.length-1],he=($.x-d)/f.width+.5,te=($.y-h)/f.height+.5;y.push([he,te]),T.baseEdgeList.forEach(j=>{const q=a.find(ve=>ve.source===j.v&&ve.target===j.w);q&&(q.targetAnchor=y.length-1)})}),i[E].anchorPoints=y.length>0?y:i[E].anchorPoints||[]}}})}updateEdgePosition(t,n){const r=this,{combos:o,edges:i,controlPoints:a}=r,s=this.getBegin(t,n);a&&(o.forEach(u=>{u.inEdges=[],u.outEdges=[]}),i.forEach(u=>{var c,f,l,d;let h=t.find(E=>E.id===u.source),v=t.find(E=>E.id===u.target),m=[],g=[];if(h&&v)g=sp(h==null?void 0:h.id,v==null?void 0:v.id,t);else if(!h||!v){const E=r.getNodePath(u.source),y=r.getNodePath(u.target),b=E.reverse().slice(h?0:1).find(T=>t.find($=>$.id===T)),w=y.reverse().slice(v?0:1).find(T=>t.find($=>$.id===T));h=t.find(T=>T.id===b),v=t.find(T=>T.id===w),g=sp(h==null?void 0:h.id,v==null?void 0:v.id,t,{v:u.source,w:u.target})}if(m=g.reduce((E,y)=>[...E,...y.points.map(b=>Object.assign(Object.assign({},b),{x:b.x+s[0],y:b.y+s[1]}))],[]),m=m.slice(1,-1),u.controlPoints=m,(v==null?void 0:v.type)===_r.META){const E=o.findIndex(y=>y.id===(v==null?void 0:v.id));if(!o[E]||!((c=o[E].inEdges)===null||c===void 0)&&c.some(y=>y.source===h.id&&y.target===v.id))return;(f=o[E].inEdges)===null||f===void 0||f.push({source:h.id,target:v.id,controlPoints:m})}if((h==null?void 0:h.type)===_r.META){const E=o.findIndex(y=>y.id===(h==null?void 0:h.id));if(!o[E]||!((l=o[E].outEdges)===null||l===void 0)&&l.some(y=>y.source===h.id&&y.target===v.id))return;(d=o[E].outEdges)===null||d===void 0||d.push({source:h.id,target:v.id,controlPoints:m})}}))}getType(){return"dagreCompound"}getDataByOrder(t){return t.every(n=>n.layoutOrder!==void 0)||t.forEach((n,r)=>{n.layoutOrder=r}),t.sort((n,r)=>n.layoutOrder-r.layoutOrder)}}var py=oe(91621),my=oe.n(py),gy=oe(58853),fp=oe.n(gy),yy=oe(38888),lp=oe.n(yy),Ey=oe(21140),wl=oe.n(Ey),by=oe(63466),_l=oe.n(by);const xy=Object.prototype.toString;function po(e){const t=xy.call(e);return t.endsWith("Array]")&&!t.includes("Big")}function wy(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!po(e))throw new TypeError("input must be an array");if(e.length===0)throw new TypeError("input must not be empty");var n=t.fromIndex,r=n===void 0?0:n,o=t.toIndex,i=o===void 0?e.length:o;if(r<0||r>=e.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=r||i>e.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=e[r],s=r+1;s<i;s++)e[s]>a&&(a=e[s]);return a}function _y(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!po(e))throw new TypeError("input must be an array");if(e.length===0)throw new TypeError("input must not be empty");var n=t.fromIndex,r=n===void 0?0:n,o=t.toIndex,i=o===void 0?e.length:o;if(r<0||r>=e.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=r||i>e.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=e[r],s=r+1;s<i;s++)e[s]<a&&(a=e[s]);return a}function dp(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(po(e)){if(e.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var n;if(t.output!==void 0){if(!po(t.output))throw new TypeError("output option must be an array if specified");n=t.output}else n=new Array(e.length);var r=_y(e),o=wy(e);if(r===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=t.min,a=i===void 0?t.autoMinMax?r:0:i,s=t.max,u=s===void 0?t.autoMinMax?o:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var c=(u-a)/(o-r),f=0;f<e.length;f++)n[f]=(e[f]-r)*c+a;return n}var Sl=" ".repeat(2),hp=" ".repeat(4);function Sy(){return vp(this)}function vp(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.maxRows,r=n===void 0?15:n,o=t.maxColumns,i=o===void 0?10:o,a=t.maxNumSize,s=a===void 0?8:a,u=t.padMinus,c=u===void 0?"auto":u;return"".concat(e.constructor.name,` {
`).concat(Sl,`[
`).concat(hp).concat(Ty(e,r,i,s,c),`
`).concat(Sl,`]
`).concat(Sl,"rows: ").concat(e.rows,`
`).concat(Sl,"columns: ").concat(e.columns,`
}`)}function Ty(e,t,n,r,o){var i=e.rows,a=e.columns,s=Math.min(i,t),u=Math.min(a,n),c=[];if(o==="auto"){o=!1;e:for(var f=0;f<s;f++)for(var l=0;l<u;l++)if(e.get(f,l)<0){o=!0;break e}}for(var d=0;d<s;d++){for(var h=[],v=0;v<u;v++)h.push(Iy(e.get(d,v),r,o));c.push("".concat(h.join(" ")))}return u!==a&&(c[c.length-1]+=" ... ".concat(a-n," more columns")),s!==i&&c.push("... ".concat(i-t," more rows")),c.join(`
`.concat(hp))}function Iy(e,t,n){return(e>=0&&n?" ".concat(pp(e,t-1)):pp(e,t)).padEnd(t)}function pp(e,t){var n=e.toString();if(n.length<=t)return n;var r=e.toFixed(t);if(r.length>t&&(r=e.toFixed(Math.max(0,t-(r.length-t)))),r.length<=t&&!r.startsWith("0.000")&&!r.startsWith("-0.000"))return r;var o=e.toExponential(t);return o.length>t&&(o=e.toExponential(Math.max(0,t-(o.length-t)))),o.slice(0)}function Ny(e,t){e.prototype.add=function(r){return typeof r=="number"?this.addS(r):this.addM(r)},e.prototype.addS=function(r){for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)+r);return this},e.prototype.addM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)+r.get(o,i));return this},e.add=function(r,o){var i=new t(r);return i.add(o)},e.prototype.sub=function(r){return typeof r=="number"?this.subS(r):this.subM(r)},e.prototype.subS=function(r){for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)-r);return this},e.prototype.subM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)-r.get(o,i));return this},e.sub=function(r,o){var i=new t(r);return i.sub(o)},e.prototype.subtract=e.prototype.sub,e.prototype.subtractS=e.prototype.subS,e.prototype.subtractM=e.prototype.subM,e.subtract=e.sub,e.prototype.mul=function(r){return typeof r=="number"?this.mulS(r):this.mulM(r)},e.prototype.mulS=function(r){for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)*r);return this},e.prototype.mulM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)*r.get(o,i));return this},e.mul=function(r,o){var i=new t(r);return i.mul(o)},e.prototype.multiply=e.prototype.mul,e.prototype.multiplyS=e.prototype.mulS,e.prototype.multiplyM=e.prototype.mulM,e.multiply=e.mul,e.prototype.div=function(r){return typeof r=="number"?this.divS(r):this.divM(r)},e.prototype.divS=function(r){for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)/r);return this},e.prototype.divM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)/r.get(o,i));return this},e.div=function(r,o){var i=new t(r);return i.div(o)},e.prototype.divide=e.prototype.div,e.prototype.divideS=e.prototype.divS,e.prototype.divideM=e.prototype.divM,e.divide=e.div,e.prototype.mod=function(r){return typeof r=="number"?this.modS(r):this.modM(r)},e.prototype.modS=function(r){for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)%r);return this},e.prototype.modM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)%r.get(o,i));return this},e.mod=function(r,o){var i=new t(r);return i.mod(o)},e.prototype.modulus=e.prototype.mod,e.prototype.modulusS=e.prototype.modS,e.prototype.modulusM=e.prototype.modM,e.modulus=e.mod,e.prototype.and=function(r){return typeof r=="number"?this.andS(r):this.andM(r)},e.prototype.andS=function(r){for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)&r);return this},e.prototype.andM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)&r.get(o,i));return this},e.and=function(r,o){var i=new t(r);return i.and(o)},e.prototype.or=function(r){return typeof r=="number"?this.orS(r):this.orM(r)},e.prototype.orS=function(r){for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)|r);return this},e.prototype.orM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)|r.get(o,i));return this},e.or=function(r,o){var i=new t(r);return i.or(o)},e.prototype.xor=function(r){return typeof r=="number"?this.xorS(r):this.xorM(r)},e.prototype.xorS=function(r){for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)^r);return this},e.prototype.xorM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)^r.get(o,i));return this},e.xor=function(r,o){var i=new t(r);return i.xor(o)},e.prototype.leftShift=function(r){return typeof r=="number"?this.leftShiftS(r):this.leftShiftM(r)},e.prototype.leftShiftS=function(r){for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)<<r);return this},e.prototype.leftShiftM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)<<r.get(o,i));return this},e.leftShift=function(r,o){var i=new t(r);return i.leftShift(o)},e.prototype.signPropagatingRightShift=function(r){return typeof r=="number"?this.signPropagatingRightShiftS(r):this.signPropagatingRightShiftM(r)},e.prototype.signPropagatingRightShiftS=function(r){for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)>>r);return this},e.prototype.signPropagatingRightShiftM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)>>r.get(o,i));return this},e.signPropagatingRightShift=function(r,o){var i=new t(r);return i.signPropagatingRightShift(o)},e.prototype.rightShift=function(r){return typeof r=="number"?this.rightShiftS(r):this.rightShiftM(r)},e.prototype.rightShiftS=function(r){for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)>>>r);return this},e.prototype.rightShiftM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,this.get(o,i)>>>r.get(o,i));return this},e.rightShift=function(r,o){var i=new t(r);return i.rightShift(o)},e.prototype.zeroFillRightShift=e.prototype.rightShift,e.prototype.zeroFillRightShiftS=e.prototype.rightShiftS,e.prototype.zeroFillRightShiftM=e.prototype.rightShiftM,e.zeroFillRightShift=e.rightShift,e.prototype.not=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,~this.get(r,o));return this},e.not=function(r){var o=new t(r);return o.not()},e.prototype.abs=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.abs(this.get(r,o)));return this},e.abs=function(r){var o=new t(r);return o.abs()},e.prototype.acos=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.acos(this.get(r,o)));return this},e.acos=function(r){var o=new t(r);return o.acos()},e.prototype.acosh=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.acosh(this.get(r,o)));return this},e.acosh=function(r){var o=new t(r);return o.acosh()},e.prototype.asin=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.asin(this.get(r,o)));return this},e.asin=function(r){var o=new t(r);return o.asin()},e.prototype.asinh=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.asinh(this.get(r,o)));return this},e.asinh=function(r){var o=new t(r);return o.asinh()},e.prototype.atan=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.atan(this.get(r,o)));return this},e.atan=function(r){var o=new t(r);return o.atan()},e.prototype.atanh=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.atanh(this.get(r,o)));return this},e.atanh=function(r){var o=new t(r);return o.atanh()},e.prototype.cbrt=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.cbrt(this.get(r,o)));return this},e.cbrt=function(r){var o=new t(r);return o.cbrt()},e.prototype.ceil=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.ceil(this.get(r,o)));return this},e.ceil=function(r){var o=new t(r);return o.ceil()},e.prototype.clz32=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.clz32(this.get(r,o)));return this},e.clz32=function(r){var o=new t(r);return o.clz32()},e.prototype.cos=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.cos(this.get(r,o)));return this},e.cos=function(r){var o=new t(r);return o.cos()},e.prototype.cosh=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.cosh(this.get(r,o)));return this},e.cosh=function(r){var o=new t(r);return o.cosh()},e.prototype.exp=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.exp(this.get(r,o)));return this},e.exp=function(r){var o=new t(r);return o.exp()},e.prototype.expm1=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.expm1(this.get(r,o)));return this},e.expm1=function(r){var o=new t(r);return o.expm1()},e.prototype.floor=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.floor(this.get(r,o)));return this},e.floor=function(r){var o=new t(r);return o.floor()},e.prototype.fround=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.fround(this.get(r,o)));return this},e.fround=function(r){var o=new t(r);return o.fround()},e.prototype.log=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.log(this.get(r,o)));return this},e.log=function(r){var o=new t(r);return o.log()},e.prototype.log1p=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.log1p(this.get(r,o)));return this},e.log1p=function(r){var o=new t(r);return o.log1p()},e.prototype.log10=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.log10(this.get(r,o)));return this},e.log10=function(r){var o=new t(r);return o.log10()},e.prototype.log2=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.log2(this.get(r,o)));return this},e.log2=function(r){var o=new t(r);return o.log2()},e.prototype.round=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.round(this.get(r,o)));return this},e.round=function(r){var o=new t(r);return o.round()},e.prototype.sign=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.sign(this.get(r,o)));return this},e.sign=function(r){var o=new t(r);return o.sign()},e.prototype.sin=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.sin(this.get(r,o)));return this},e.sin=function(r){var o=new t(r);return o.sin()},e.prototype.sinh=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.sinh(this.get(r,o)));return this},e.sinh=function(r){var o=new t(r);return o.sinh()},e.prototype.sqrt=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.sqrt(this.get(r,o)));return this},e.sqrt=function(r){var o=new t(r);return o.sqrt()},e.prototype.tan=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.tan(this.get(r,o)));return this},e.tan=function(r){var o=new t(r);return o.tan()},e.prototype.tanh=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.tanh(this.get(r,o)));return this},e.tanh=function(r){var o=new t(r);return o.tanh()},e.prototype.trunc=function(){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,Math.trunc(this.get(r,o)));return this},e.trunc=function(r){var o=new t(r);return o.trunc()},e.pow=function(r,o){var i=new t(r);return i.pow(o)},e.prototype.pow=function(r){return typeof r=="number"?this.powS(r):this.powM(r)},e.prototype.powS=function(r){for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,Math.pow(this.get(o,i),r));return this},e.prototype.powM=function(r){if(r=t.checkMatrix(r),this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal");for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.set(o,i,Math.pow(this.get(o,i),r.get(o,i)));return this}}function Qo(e,t,n){var r=n?e.rows:e.rows-1;if(t<0||t>r)throw new RangeError("Row index out of range")}function Jo(e,t,n){var r=n?e.columns:e.columns-1;if(t<0||t>r)throw new RangeError("Column index out of range")}function lu(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError("vector size must be the same as the number of columns");return t}function du(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError("vector size must be the same as the number of rows");return t}function Ay(e,t){if(!po(t))throw new TypeError("row indices must be an array");for(var n=0;n<t.length;n++)if(t[n]<0||t[n]>=e.rows)throw new RangeError("row indices are out of range")}function Ry(e,t){if(!po(t))throw new TypeError("column indices must be an array");for(var n=0;n<t.length;n++)if(t[n]<0||t[n]>=e.columns)throw new RangeError("column indices are out of range")}function mp(e,t,n,r,o){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(Il("startRow",t),Il("endRow",n),Il("startColumn",r),Il("endColumn",o),t>n||r>o||t<0||t>=e.rows||n<0||n>=e.rows||r<0||r>=e.columns||o<0||o>=e.columns)throw new RangeError("Submatrix indices are out of range")}function Tl(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=[],r=0;r<e;r++)n.push(t);return n}function Il(e,t){if(typeof t!="number")throw new TypeError("".concat(e," must be a number"))}function hu(e){if(e.isEmpty())throw new Error("Empty matrix has no elements to index")}function Dy(e){for(var t=Tl(e.rows),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t[n]+=e.get(n,r);return t}function Cy(e){for(var t=Tl(e.columns),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t[r]+=e.get(n,r);return t}function Oy(e){for(var t=0,n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)t+=e.get(n,r);return t}function Ly(e){for(var t=Tl(e.rows,1),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t[n]*=e.get(n,r);return t}function My(e){for(var t=Tl(e.columns,1),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t[r]*=e.get(n,r);return t}function ky(e){for(var t=1,n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)t*=e.get(n,r);return t}function Gy(e,t,n){for(var r=e.rows,o=e.columns,i=[],a=0;a<r;a++){for(var s=0,u=0,c=0,f=0;f<o;f++)c=e.get(a,f)-n[a],s+=c,u+=c*c;t?i.push((u-s*s/o)/(o-1)):i.push((u-s*s/o)/o)}return i}function Py(e,t,n){for(var r=e.rows,o=e.columns,i=[],a=0;a<o;a++){for(var s=0,u=0,c=0,f=0;f<r;f++)c=e.get(f,a)-n[a],s+=c,u+=c*c;t?i.push((u-s*s/r)/(r-1)):i.push((u-s*s/r)/r)}return i}function Fy(e,t,n){for(var r=e.rows,o=e.columns,i=r*o,a=0,s=0,u=0,c=0;c<r;c++)for(var f=0;f<o;f++)u=e.get(c,f)-n,a+=u,s+=u*u;return t?(s-a*a/i)/(i-1):(s-a*a/i)/i}function zy(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t[n])}function By(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t[r])}function Uy(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t)}function Vy(e){for(var t=[],n=0;n<e.rows;n++){for(var r=0,o=0;o<e.columns;o++)r+=Math.pow(e.get(n,o),2)/(e.columns-1);t.push(Math.sqrt(r))}return t}function Xy(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t[n])}function $y(e){for(var t=[],n=0;n<e.columns;n++){for(var r=0,o=0;o<e.rows;o++)r+=Math.pow(e.get(o,n),2)/(e.rows-1);t.push(Math.sqrt(r))}return t}function Wy(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t[r])}function Hy(e){for(var t=e.size-1,n=0,r=0;r<e.columns;r++)for(var o=0;o<e.rows;o++)n+=Math.pow(e.get(o,r),2)/t;return Math.sqrt(n)}function Zy(e,t){for(var n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t)}var mr=function(){function e(){wl()(this,e)}return _l()(e,[{key:"size",get:function(){return this.rows*this.columns}},{key:"apply",value:function(n){if(typeof n!="function")throw new TypeError("callback must be a function");for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)n.call(this,r,o);return this}},{key:"to1DArray",value:function(){for(var n=[],r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)n.push(this.get(r,o));return n}},{key:"to2DArray",value:function(){for(var n=[],r=0;r<this.rows;r++){n.push([]);for(var o=0;o<this.columns;o++)n[r].push(this.get(r,o))}return n}},{key:"toJSON",value:function(){return this.to2DArray()}},{key:"isRowVector",value:function(){return this.rows===1}},{key:"isColumnVector",value:function(){return this.columns===1}},{key:"isVector",value:function(){return this.rows===1||this.columns===1}},{key:"isSquare",value:function(){return this.rows===this.columns}},{key:"isEmpty",value:function(){return this.rows===0||this.columns===0}},{key:"isSymmetric",value:function(){if(this.isSquare()){for(var n=0;n<this.rows;n++)for(var r=0;r<=n;r++)if(this.get(n,r)!==this.get(r,n))return!1;return!0}return!1}},{key:"isEchelonForm",value:function(){for(var n=0,r=0,o=-1,i=!0,a=!1;n<this.rows&&i;){for(r=0,a=!1;r<this.columns&&a===!1;)this.get(n,r)===0?r++:this.get(n,r)===1&&r>o?(a=!0,o=r):(i=!1,a=!0);n++}return i}},{key:"isReducedEchelonForm",value:function(){for(var n=0,r=0,o=-1,i=!0,a=!1;n<this.rows&&i;){for(r=0,a=!1;r<this.columns&&a===!1;)this.get(n,r)===0?r++:this.get(n,r)===1&&r>o?(a=!0,o=r):(i=!1,a=!0);for(var s=r+1;s<this.rows;s++)this.get(n,s)!==0&&(i=!1);n++}return i}},{key:"echelonForm",value:function(){for(var n=this.clone(),r=0,o=0;r<n.rows&&o<n.columns;){for(var i=r,a=r;a<n.rows;a++)n.get(a,o)>n.get(i,o)&&(i=a);if(n.get(i,o)===0)o++;else{n.swapRows(r,i);for(var s=n.get(r,o),u=o;u<n.columns;u++)n.set(r,u,n.get(r,u)/s);for(var c=r+1;c<n.rows;c++){var f=n.get(c,o)/n.get(r,o);n.set(c,o,0);for(var l=o+1;l<n.columns;l++)n.set(c,l,n.get(c,l)-n.get(r,l)*f)}r++,o++}}return n}},{key:"reducedEchelonForm",value:function(){for(var n=this.echelonForm(),r=n.columns,o=n.rows,i=o-1;i>=0;)if(n.maxRow(i)===0)i--;else{for(var a=0,s=!1;a<o&&s===!1;)n.get(i,a)===1?s=!0:a++;for(var u=0;u<i;u++)for(var c=n.get(u,a),f=a;f<r;f++){var l=n.get(u,f)-c*n.get(i,f);n.set(u,f,l)}i--}return n}},{key:"set",value:function(){throw new Error("set method is unimplemented")}},{key:"get",value:function(){throw new Error("get method is unimplemented")}},{key:"repeat",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Oe()(n)!=="object")throw new TypeError("options must be an object");var r=n.rows,o=r===void 0?1:r,i=n.columns,a=i===void 0?1:i;if(!Number.isInteger(o)||o<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(a)||a<=0)throw new TypeError("columns must be a positive integer");for(var s=new Nt(this.rows*o,this.columns*a),u=0;u<o;u++)for(var c=0;c<a;c++)s.setSubMatrix(this,this.rows*u,this.columns*c);return s}},{key:"fill",value:function(n){for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,n);return this}},{key:"neg",value:function(){return this.mulS(-1)}},{key:"getRow",value:function(n){Qo(this,n);for(var r=[],o=0;o<this.columns;o++)r.push(this.get(n,o));return r}},{key:"getRowVector",value:function(n){return Nt.rowVector(this.getRow(n))}},{key:"setRow",value:function(n,r){Qo(this,n),r=lu(this,r);for(var o=0;o<this.columns;o++)this.set(n,o,r[o]);return this}},{key:"swapRows",value:function(n,r){Qo(this,n),Qo(this,r);for(var o=0;o<this.columns;o++){var i=this.get(n,o);this.set(n,o,this.get(r,o)),this.set(r,o,i)}return this}},{key:"getColumn",value:function(n){Jo(this,n);for(var r=[],o=0;o<this.rows;o++)r.push(this.get(o,n));return r}},{key:"getColumnVector",value:function(n){return Nt.columnVector(this.getColumn(n))}},{key:"setColumn",value:function(n,r){Jo(this,n),r=du(this,r);for(var o=0;o<this.rows;o++)this.set(o,n,r[o]);return this}},{key:"swapColumns",value:function(n,r){Jo(this,n),Jo(this,r);for(var o=0;o<this.rows;o++){var i=this.get(o,n);this.set(o,n,this.get(o,r)),this.set(o,r,i)}return this}},{key:"addRowVector",value:function(n){n=lu(this,n);for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)+n[o]);return this}},{key:"subRowVector",value:function(n){n=lu(this,n);for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)-n[o]);return this}},{key:"mulRowVector",value:function(n){n=lu(this,n);for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)*n[o]);return this}},{key:"divRowVector",value:function(n){n=lu(this,n);for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)/n[o]);return this}},{key:"addColumnVector",value:function(n){n=du(this,n);for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)+n[r]);return this}},{key:"subColumnVector",value:function(n){n=du(this,n);for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)-n[r]);return this}},{key:"mulColumnVector",value:function(n){n=du(this,n);for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)*n[r]);return this}},{key:"divColumnVector",value:function(n){n=du(this,n);for(var r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)this.set(r,o,this.get(r,o)/n[r]);return this}},{key:"mulRow",value:function(n,r){Qo(this,n);for(var o=0;o<this.columns;o++)this.set(n,o,this.get(n,o)*r);return this}},{key:"mulColumn",value:function(n,r){Jo(this,n);for(var o=0;o<this.rows;o++)this.set(o,n,this.get(o,n)*r);return this}},{key:"max",value:function(n){if(this.isEmpty())return NaN;switch(n){case"row":{for(var r=new Array(this.rows).fill(Number.NEGATIVE_INFINITY),o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.get(o,i)>r[o]&&(r[o]=this.get(o,i));return r}case"column":{for(var a=new Array(this.columns).fill(Number.NEGATIVE_INFINITY),s=0;s<this.rows;s++)for(var u=0;u<this.columns;u++)this.get(s,u)>a[u]&&(a[u]=this.get(s,u));return a}case void 0:{for(var c=this.get(0,0),f=0;f<this.rows;f++)for(var l=0;l<this.columns;l++)this.get(f,l)>c&&(c=this.get(f,l));return c}default:throw new Error("invalid option: ".concat(n))}}},{key:"maxIndex",value:function(){hu(this);for(var n=this.get(0,0),r=[0,0],o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.get(o,i)>n&&(n=this.get(o,i),r[0]=o,r[1]=i);return r}},{key:"min",value:function(n){if(this.isEmpty())return NaN;switch(n){case"row":{for(var r=new Array(this.rows).fill(Number.POSITIVE_INFINITY),o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.get(o,i)<r[o]&&(r[o]=this.get(o,i));return r}case"column":{for(var a=new Array(this.columns).fill(Number.POSITIVE_INFINITY),s=0;s<this.rows;s++)for(var u=0;u<this.columns;u++)this.get(s,u)<a[u]&&(a[u]=this.get(s,u));return a}case void 0:{for(var c=this.get(0,0),f=0;f<this.rows;f++)for(var l=0;l<this.columns;l++)this.get(f,l)<c&&(c=this.get(f,l));return c}default:throw new Error("invalid option: ".concat(n))}}},{key:"minIndex",value:function(){hu(this);for(var n=this.get(0,0),r=[0,0],o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)this.get(o,i)<n&&(n=this.get(o,i),r[0]=o,r[1]=i);return r}},{key:"maxRow",value:function(n){if(Qo(this,n),this.isEmpty())return NaN;for(var r=this.get(n,0),o=1;o<this.columns;o++)this.get(n,o)>r&&(r=this.get(n,o));return r}},{key:"maxRowIndex",value:function(n){Qo(this,n),hu(this);for(var r=this.get(n,0),o=[n,0],i=1;i<this.columns;i++)this.get(n,i)>r&&(r=this.get(n,i),o[1]=i);return o}},{key:"minRow",value:function(n){if(Qo(this,n),this.isEmpty())return NaN;for(var r=this.get(n,0),o=1;o<this.columns;o++)this.get(n,o)<r&&(r=this.get(n,o));return r}},{key:"minRowIndex",value:function(n){Qo(this,n),hu(this);for(var r=this.get(n,0),o=[n,0],i=1;i<this.columns;i++)this.get(n,i)<r&&(r=this.get(n,i),o[1]=i);return o}},{key:"maxColumn",value:function(n){if(Jo(this,n),this.isEmpty())return NaN;for(var r=this.get(0,n),o=1;o<this.rows;o++)this.get(o,n)>r&&(r=this.get(o,n));return r}},{key:"maxColumnIndex",value:function(n){Jo(this,n),hu(this);for(var r=this.get(0,n),o=[0,n],i=1;i<this.rows;i++)this.get(i,n)>r&&(r=this.get(i,n),o[0]=i);return o}},{key:"minColumn",value:function(n){if(Jo(this,n),this.isEmpty())return NaN;for(var r=this.get(0,n),o=1;o<this.rows;o++)this.get(o,n)<r&&(r=this.get(o,n));return r}},{key:"minColumnIndex",value:function(n){Jo(this,n),hu(this);for(var r=this.get(0,n),o=[0,n],i=1;i<this.rows;i++)this.get(i,n)<r&&(r=this.get(i,n),o[0]=i);return o}},{key:"diag",value:function(){for(var n=Math.min(this.rows,this.columns),r=[],o=0;o<n;o++)r.push(this.get(o,o));return r}},{key:"norm",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"frobenius",r=0;if(n==="max")return this.max();if(n==="frobenius"){for(var o=0;o<this.rows;o++)for(var i=0;i<this.columns;i++)r=r+this.get(o,i)*this.get(o,i);return Math.sqrt(r)}else throw new RangeError("unknown norm type: ".concat(n))}},{key:"cumulativeSum",value:function(){for(var n=0,r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)n+=this.get(r,o),this.set(r,o,n);return this}},{key:"dot",value:function(n){e.isMatrix(n)&&(n=n.to1DArray());var r=this.to1DArray();if(r.length!==n.length)throw new RangeError("vectors do not have the same size");for(var o=0,i=0;i<r.length;i++)o+=r[i]*n[i];return o}},{key:"mmul",value:function(n){n=Nt.checkMatrix(n);for(var r=this.rows,o=this.columns,i=n.columns,a=new Nt(r,i),s=new Float64Array(o),u=0;u<i;u++){for(var c=0;c<o;c++)s[c]=n.get(c,u);for(var f=0;f<r;f++){for(var l=0,d=0;d<o;d++)l+=this.get(f,d)*s[d];a.set(f,u,l)}}return a}},{key:"strassen2x2",value:function(n){n=Nt.checkMatrix(n);var r=new Nt(2,2),o=this.get(0,0),i=n.get(0,0),a=this.get(0,1),s=n.get(0,1),u=this.get(1,0),c=n.get(1,0),f=this.get(1,1),l=n.get(1,1),d=(o+f)*(i+l),h=(u+f)*i,v=o*(s-l),m=f*(c-i),g=(o+a)*l,E=(u-o)*(i+s),y=(a-f)*(c+l),b=d+m-g+y,w=v+g,T=h+m,$=d-h+v+E;return r.set(0,0,b),r.set(0,1,w),r.set(1,0,T),r.set(1,1,$),r}},{key:"strassen3x3",value:function(n){n=Nt.checkMatrix(n);var r=new Nt(3,3),o=this.get(0,0),i=this.get(0,1),a=this.get(0,2),s=this.get(1,0),u=this.get(1,1),c=this.get(1,2),f=this.get(2,0),l=this.get(2,1),d=this.get(2,2),h=n.get(0,0),v=n.get(0,1),m=n.get(0,2),g=n.get(1,0),E=n.get(1,1),y=n.get(1,2),b=n.get(2,0),w=n.get(2,1),T=n.get(2,2),$=(o+i+a-s-u-l-d)*E,he=(o-s)*(-v+E),te=u*(-h+v+g-E-y-b+T),j=(-o+s+u)*(h-v+E),q=(s+u)*(-h+v),ve=o*h,k=(-o+f+l)*(h-m+y),pe=(-o+f)*(m-y),Pe=(f+l)*(-h+m),Ue=(o+i+a-u-c-f-l)*y,mt=l*(-h+m+g-E-y-b+w),Ke=(-a+l+d)*(E+b-w),Et=(a-d)*(E-w),dt=a*b,Pt=(l+d)*(-b+w),Jt=(-a+u+c)*(y+b-T),Un=(a-c)*(y-T),Zn=(u+c)*(-b+T),Ze=i*g,Yt=c*w,Jn=s*m,cn=f*v,Dn=d*T,Ve=ve+dt+Ze,ut=$+j+q+ve+Ke+dt+Pt,xn=ve+k+Pe+Ue+dt+Jt+Zn,Ft=he+te+j+ve+dt+Jt+Un,Pn=he+j+q+ve+Yt,en=dt+Jt+Un+Zn+Jn,wn=ve+k+pe+mt+Ke+Et+dt,gr=Ke+Et+dt+Pt+cn,vr=ve+k+pe+Pe+Dn;return r.set(0,0,Ve),r.set(0,1,ut),r.set(0,2,xn),r.set(1,0,Ft),r.set(1,1,Pn),r.set(1,2,en),r.set(2,0,wn),r.set(2,1,gr),r.set(2,2,vr),r}},{key:"mmulStrassen",value:function(n){n=Nt.checkMatrix(n);var r=this.clone(),o=r.rows,i=r.columns,a=n.rows,s=n.columns;i!==a&&console.warn("Multiplying ".concat(o," x ").concat(i," and ").concat(a," x ").concat(s," matrix: dimensions do not match."));function u(d,h,v){var m=d.rows,g=d.columns;if(m===h&&g===v)return d;var E=e.zeros(h,v);return E=E.setSubMatrix(d,0,0),E}var c=Math.max(o,a),f=Math.max(i,s);r=u(r,c,f),n=u(n,c,f);function l(d,h,v,m){if(v<=512||m<=512)return d.mmul(h);v%2===1&&m%2===1?(d=u(d,v+1,m+1),h=u(h,v+1,m+1)):v%2===1?(d=u(d,v+1,m),h=u(h,v+1,m)):m%2===1&&(d=u(d,v,m+1),h=u(h,v,m+1));var g=parseInt(d.rows/2,10),E=parseInt(d.columns/2,10),y=d.subMatrix(0,g-1,0,E-1),b=h.subMatrix(0,g-1,0,E-1),w=d.subMatrix(0,g-1,E,d.columns-1),T=h.subMatrix(0,g-1,E,h.columns-1),$=d.subMatrix(g,d.rows-1,0,E-1),he=h.subMatrix(g,h.rows-1,0,E-1),te=d.subMatrix(g,d.rows-1,E,d.columns-1),j=h.subMatrix(g,h.rows-1,E,h.columns-1),q=l(e.add(y,te),e.add(b,j),g,E),ve=l(e.add($,te),b,g,E),k=l(y,e.sub(T,j),g,E),pe=l(te,e.sub(he,b),g,E),Pe=l(e.add(y,w),j,g,E),Ue=l(e.sub($,y),e.add(b,T),g,E),mt=l(e.sub(w,te),e.add(he,j),g,E),Ke=e.add(q,pe);Ke.sub(Pe),Ke.add(mt);var Et=e.add(k,Pe),dt=e.add(ve,pe),Pt=e.sub(q,ve);Pt.add(k),Pt.add(Ue);var Jt=e.zeros(2*Ke.rows,2*Ke.columns);return Jt=Jt.setSubMatrix(Ke,0,0),Jt=Jt.setSubMatrix(Et,Ke.rows,0),Jt=Jt.setSubMatrix(dt,0,Ke.columns),Jt=Jt.setSubMatrix(Pt,Ke.rows,Ke.columns),Jt.subMatrix(0,v-1,0,m-1)}return l(r,n,c,f)}},{key:"scaleRows",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Oe()(n)!=="object")throw new TypeError("options must be an object");var r=n.min,o=r===void 0?0:r,i=n.max,a=i===void 0?1:i;if(!Number.isFinite(o))throw new TypeError("min must be a number");if(!Number.isFinite(a))throw new TypeError("max must be a number");if(o>=a)throw new RangeError("min must be smaller than max");for(var s=new Nt(this.rows,this.columns),u=0;u<this.rows;u++){var c=this.getRow(u);c.length>0&&dp(c,{min:o,max:a,output:c}),s.setRow(u,c)}return s}},{key:"scaleColumns",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Oe()(n)!=="object")throw new TypeError("options must be an object");var r=n.min,o=r===void 0?0:r,i=n.max,a=i===void 0?1:i;if(!Number.isFinite(o))throw new TypeError("min must be a number");if(!Number.isFinite(a))throw new TypeError("max must be a number");if(o>=a)throw new RangeError("min must be smaller than max");for(var s=new Nt(this.rows,this.columns),u=0;u<this.columns;u++){var c=this.getColumn(u);c.length&&dp(c,{min:o,max:a,output:c}),s.setColumn(u,c)}return s}},{key:"flipRows",value:function(){for(var n=Math.ceil(this.columns/2),r=0;r<this.rows;r++)for(var o=0;o<n;o++){var i=this.get(r,o),a=this.get(r,this.columns-1-o);this.set(r,o,a),this.set(r,this.columns-1-o,i)}return this}},{key:"flipColumns",value:function(){for(var n=Math.ceil(this.rows/2),r=0;r<this.columns;r++)for(var o=0;o<n;o++){var i=this.get(o,r),a=this.get(this.rows-1-o,r);this.set(o,r,a),this.set(this.rows-1-o,r,i)}return this}},{key:"kroneckerProduct",value:function(n){n=Nt.checkMatrix(n);for(var r=this.rows,o=this.columns,i=n.rows,a=n.columns,s=new Nt(r*i,o*a),u=0;u<r;u++)for(var c=0;c<o;c++)for(var f=0;f<i;f++)for(var l=0;l<a;l++)s.set(i*u+f,a*c+l,this.get(u,c)*n.get(f,l));return s}},{key:"kroneckerSum",value:function(n){if(n=Nt.checkMatrix(n),!this.isSquare()||!n.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");var r=this.rows,o=n.rows,i=this.kroneckerProduct(Nt.eye(o,o)),a=Nt.eye(r,r).kroneckerProduct(n);return i.add(a)}},{key:"transpose",value:function(){for(var n=new Nt(this.columns,this.rows),r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)n.set(o,r,this.get(r,o));return n}},{key:"sortRows",value:function(){for(var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gp,r=0;r<this.rows;r++)this.setRow(r,this.getRow(r).sort(n));return this}},{key:"sortColumns",value:function(){for(var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gp,r=0;r<this.columns;r++)this.setColumn(r,this.getColumn(r).sort(n));return this}},{key:"subMatrix",value:function(n,r,o,i){mp(this,n,r,o,i);for(var a=new Nt(r-n+1,i-o+1),s=n;s<=r;s++)for(var u=o;u<=i;u++)a.set(s-n,u-o,this.get(s,u));return a}},{key:"subMatrixRow",value:function(n,r,o){if(r===void 0&&(r=0),o===void 0&&(o=this.columns-1),r>o||r<0||r>=this.columns||o<0||o>=this.columns)throw new RangeError("Argument out of range");for(var i=new Nt(n.length,o-r+1),a=0;a<n.length;a++)for(var s=r;s<=o;s++){if(n[a]<0||n[a]>=this.rows)throw new RangeError("Row index out of range: ".concat(n[a]));i.set(a,s-r,this.get(n[a],s))}return i}},{key:"subMatrixColumn",value:function(n,r,o){if(r===void 0&&(r=0),o===void 0&&(o=this.rows-1),r>o||r<0||r>=this.rows||o<0||o>=this.rows)throw new RangeError("Argument out of range");for(var i=new Nt(o-r+1,n.length),a=0;a<n.length;a++)for(var s=r;s<=o;s++){if(n[a]<0||n[a]>=this.columns)throw new RangeError("Column index out of range: ".concat(n[a]));i.set(s-r,a,this.get(s,n[a]))}return i}},{key:"setSubMatrix",value:function(n,r,o){if(n=Nt.checkMatrix(n),n.isEmpty())return this;var i=r+n.rows-1,a=o+n.columns-1;mp(this,r,i,o,a);for(var s=0;s<n.rows;s++)for(var u=0;u<n.columns;u++)this.set(r+s,o+u,n.get(s,u));return this}},{key:"selection",value:function(n,r){Ay(this,n),Ry(this,r);for(var o=new Nt(n.length,r.length),i=0;i<n.length;i++)for(var a=n[i],s=0;s<r.length;s++){var u=r[s];o.set(i,s,this.get(a,u))}return o}},{key:"trace",value:function(){for(var n=Math.min(this.rows,this.columns),r=0,o=0;o<n;o++)r+=this.get(o,o);return r}},{key:"clone",value:function(){for(var n=new Nt(this.rows,this.columns),r=0;r<this.rows;r++)for(var o=0;o<this.columns;o++)n.set(r,o,this.get(r,o));return n}},{key:"sum",value:function(n){switch(n){case"row":return Dy(this);case"column":return Cy(this);case void 0:return Oy(this);default:throw new Error("invalid option: ".concat(n))}}},{key:"product",value:function(n){switch(n){case"row":return Ly(this);case"column":return My(this);case void 0:return ky(this);default:throw new Error("invalid option: ".concat(n))}}},{key:"mean",value:function(n){var r=this.sum(n);switch(n){case"row":{for(var o=0;o<this.rows;o++)r[o]/=this.columns;return r}case"column":{for(var i=0;i<this.columns;i++)r[i]/=this.rows;return r}case void 0:return r/this.size;default:throw new Error("invalid option: ".concat(n))}}},{key:"variance",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Oe()(n)==="object"&&(r=n,n=void 0),Oe()(r)!=="object")throw new TypeError("options must be an object");var o=r,i=o.unbiased,a=i===void 0?!0:i,s=o.mean,u=s===void 0?this.mean(n):s;if(typeof a!="boolean")throw new TypeError("unbiased must be a boolean");switch(n){case"row":{if(!po(u))throw new TypeError("mean must be an array");return Gy(this,a,u)}case"column":{if(!po(u))throw new TypeError("mean must be an array");return Py(this,a,u)}case void 0:{if(typeof u!="number")throw new TypeError("mean must be a number");return Fy(this,a,u)}default:throw new Error("invalid option: ".concat(n))}}},{key:"standardDeviation",value:function(n,r){Oe()(n)==="object"&&(r=n,n=void 0);var o=this.variance(n,r);if(n===void 0)return Math.sqrt(o);for(var i=0;i<o.length;i++)o[i]=Math.sqrt(o[i]);return o}},{key:"center",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Oe()(n)==="object"&&(r=n,n=void 0),Oe()(r)!=="object")throw new TypeError("options must be an object");var o=r,i=o.center,a=i===void 0?this.mean(n):i;switch(n){case"row":{if(!po(a))throw new TypeError("center must be an array");return zy(this,a),this}case"column":{if(!po(a))throw new TypeError("center must be an array");return By(this,a),this}case void 0:{if(typeof a!="number")throw new TypeError("center must be a number");return Uy(this,a),this}default:throw new Error("invalid option: ".concat(n))}}},{key:"scale",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Oe()(n)==="object"&&(r=n,n=void 0),Oe()(r)!=="object")throw new TypeError("options must be an object");var o=r.scale;switch(n){case"row":{if(o===void 0)o=Vy(this);else if(!po(o))throw new TypeError("scale must be an array");return Xy(this,o),this}case"column":{if(o===void 0)o=$y(this);else if(!po(o))throw new TypeError("scale must be an array");return Wy(this,o),this}case void 0:{if(o===void 0)o=Hy(this);else if(typeof o!="number")throw new TypeError("scale must be a number");return Zy(this,o),this}default:throw new Error("invalid option: ".concat(n))}}},{key:"toString",value:function(n){return vp(this,n)}}],[{key:"from1DArray",value:function(n,r,o){var i=n*r;if(i!==o.length)throw new RangeError("data length does not match given dimensions");for(var a=new Nt(n,r),s=0;s<n;s++)for(var u=0;u<r;u++)a.set(s,u,o[s*r+u]);return a}},{key:"rowVector",value:function(n){for(var r=new Nt(1,n.length),o=0;o<n.length;o++)r.set(0,o,n[o]);return r}},{key:"columnVector",value:function(n){for(var r=new Nt(n.length,1),o=0;o<n.length;o++)r.set(o,0,n[o]);return r}},{key:"zeros",value:function(n,r){return new Nt(n,r)}},{key:"ones",value:function(n,r){return new Nt(n,r).fill(1)}},{key:"rand",value:function(n,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Oe()(o)!=="object")throw new TypeError("options must be an object");for(var i=o.random,a=i===void 0?Math.random:i,s=new Nt(n,r),u=0;u<n;u++)for(var c=0;c<r;c++)s.set(u,c,a());return s}},{key:"randInt",value:function(n,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Oe()(o)!=="object")throw new TypeError("options must be an object");var i=o.min,a=i===void 0?0:i,s=o.max,u=s===void 0?1e3:s,c=o.random,f=c===void 0?Math.random:c;if(!Number.isInteger(a))throw new TypeError("min must be an integer");if(!Number.isInteger(u))throw new TypeError("max must be an integer");if(a>=u)throw new RangeError("min must be smaller than max");for(var l=u-a,d=new Nt(n,r),h=0;h<n;h++)for(var v=0;v<r;v++){var m=a+Math.round(f()*l);d.set(h,v,m)}return d}},{key:"eye",value:function(n,r,o){r===void 0&&(r=n),o===void 0&&(o=1);for(var i=Math.min(n,r),a=this.zeros(n,r),s=0;s<i;s++)a.set(s,s,o);return a}},{key:"diag",value:function(n,r,o){var i=n.length;r===void 0&&(r=i),o===void 0&&(o=r);for(var a=Math.min(i,r,o),s=this.zeros(r,o),u=0;u<a;u++)s.set(u,u,n[u]);return s}},{key:"min",value:function(n,r){n=this.checkMatrix(n),r=this.checkMatrix(r);for(var o=n.rows,i=n.columns,a=new Nt(o,i),s=0;s<o;s++)for(var u=0;u<i;u++)a.set(s,u,Math.min(n.get(s,u),r.get(s,u)));return a}},{key:"max",value:function(n,r){n=this.checkMatrix(n),r=this.checkMatrix(r);for(var o=n.rows,i=n.columns,a=new this(o,i),s=0;s<o;s++)for(var u=0;u<i;u++)a.set(s,u,Math.max(n.get(s,u),r.get(s,u)));return a}},{key:"checkMatrix",value:function(n){return e.isMatrix(n)?n:new Nt(n)}},{key:"isMatrix",value:function(n){return n!=null&&n.klass==="Matrix"}}]),e}();mr.prototype.klass="Matrix",typeof Symbol!="undefined"&&(mr.prototype[Symbol.for("nodejs.util.inspect.custom")]=Sy);function gp(e,t){return e-t}function jy(e){return e.every(function(t){return typeof t=="number"})}mr.random=mr.rand,mr.randomInt=mr.randInt,mr.diagonal=mr.diag,mr.prototype.diagonal=mr.prototype.diag,mr.identity=mr.eye,mr.prototype.negate=mr.prototype.neg,mr.prototype.tensorProduct=mr.prototype.kroneckerProduct;var Nt=function(e){fp()(n,e);var t=lp()(n);function n(r,o){var i;if(wl()(this,n),i=t.call(this),n.isMatrix(r))return my()(i,r.clone());if(Number.isInteger(r)&&r>=0)if(i.data=[],Number.isInteger(o)&&o>=0)for(var a=0;a<r;a++)i.data.push(new Float64Array(o));else throw new TypeError("nColumns must be a positive integer");else if(po(r)){var s=r;if(r=s.length,o=r?s[0].length:0,typeof o!="number")throw new TypeError("Data must be a 2D array with at least one element");i.data=[];for(var u=0;u<r;u++){if(s[u].length!==o)throw new RangeError("Inconsistent array dimensions");if(!jy(s[u]))throw new TypeError("Input data contains non-numeric values");i.data.push(Float64Array.from(s[u]))}}else throw new TypeError("First argument must be a positive number or an array");return i.rows=r,i.columns=o,i}return _l()(n,[{key:"set",value:function(o,i,a){return this.data[o][i]=a,this}},{key:"get",value:function(o,i){return this.data[o][i]}},{key:"removeRow",value:function(o){return Qo(this,o),this.data.splice(o,1),this.rows-=1,this}},{key:"addRow",value:function(o,i){return i===void 0&&(i=o,o=this.rows),Qo(this,o,!0),i=Float64Array.from(lu(this,i)),this.data.splice(o,0,i),this.rows+=1,this}},{key:"removeColumn",value:function(o){Jo(this,o);for(var i=0;i<this.rows;i++){for(var a=new Float64Array(this.columns-1),s=0;s<o;s++)a[s]=this.data[i][s];for(var u=o+1;u<this.columns;u++)a[u-1]=this.data[i][u];this.data[i]=a}return this.columns-=1,this}},{key:"addColumn",value:function(o,i){typeof i=="undefined"&&(i=o,o=this.columns),Jo(this,o,!0),i=du(this,i);for(var a=0;a<this.rows;a++){for(var s=new Float64Array(this.columns+1),u=0;u<o;u++)s[u]=this.data[a][u];for(s[u++]=i[a];u<this.columns+1;u++)s[u]=this.data[a][u-1];this.data[a]=s}return this.columns+=1,this}}]),n}(mr);Ny(mr,Nt);var Yy=function(e){fp()(n,e);var t=lp()(n);function n(r){var o;return wl()(this,n),o=t.call(this),o.data=r,o.rows=r.length,o.columns=r[0].length,o}return _l()(n,[{key:"set",value:function(o,i,a){return this.data[o][i]=a,this}},{key:"get",value:function(o,i){return this.data[o][i]}}]),n}(mr);function vu(e,t){var n=0;return Math.abs(e)>Math.abs(t)?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):t!==0?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0}var yp=function(){function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(wl()(this,e),t=Yy.checkMatrix(t),t.isEmpty())throw new Error("Matrix must be non-empty");var r=t.rows,o=t.columns,i=n.computeLeftSingularVectors,a=i===void 0?!0:i,s=n.computeRightSingularVectors,u=s===void 0?!0:s,c=n.autoTranspose,f=c===void 0?!1:c,l=!!a,d=!!u,h=!1,v;if(r<o)if(!f)v=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{v=t.transpose(),r=v.rows,o=v.columns,h=!0;var m=l;l=d,d=m}else v=t.clone();for(var g=Math.min(r,o),E=Math.min(r+1,o),y=new Float64Array(E),b=new Nt(r,g),w=new Nt(o,o),T=new Float64Array(o),$=new Float64Array(r),he=new Float64Array(E),te=0;te<E;te++)he[te]=te;for(var j=Math.min(r-1,o),q=Math.max(0,Math.min(o-2,r)),ve=Math.max(j,q),k=0;k<ve;k++){if(k<j){y[k]=0;for(var pe=k;pe<r;pe++)y[k]=vu(y[k],v.get(pe,k));if(y[k]!==0){v.get(k,k)<0&&(y[k]=-y[k]);for(var Pe=k;Pe<r;Pe++)v.set(Pe,k,v.get(Pe,k)/y[k]);v.set(k,k,v.get(k,k)+1)}y[k]=-y[k]}for(var Ue=k+1;Ue<o;Ue++){if(k<j&&y[k]!==0){for(var mt=0,Ke=k;Ke<r;Ke++)mt+=v.get(Ke,k)*v.get(Ke,Ue);mt=-mt/v.get(k,k);for(var Et=k;Et<r;Et++)v.set(Et,Ue,v.get(Et,Ue)+mt*v.get(Et,k))}T[Ue]=v.get(k,Ue)}if(l&&k<j)for(var dt=k;dt<r;dt++)b.set(dt,k,v.get(dt,k));if(k<q){T[k]=0;for(var Pt=k+1;Pt<o;Pt++)T[k]=vu(T[k],T[Pt]);if(T[k]!==0){T[k+1]<0&&(T[k]=0-T[k]);for(var Jt=k+1;Jt<o;Jt++)T[Jt]/=T[k];T[k+1]+=1}if(T[k]=-T[k],k+1<r&&T[k]!==0){for(var Un=k+1;Un<r;Un++)$[Un]=0;for(var Zn=k+1;Zn<r;Zn++)for(var Ze=k+1;Ze<o;Ze++)$[Zn]+=T[Ze]*v.get(Zn,Ze);for(var Yt=k+1;Yt<o;Yt++)for(var Jn=-T[Yt]/T[k+1],cn=k+1;cn<r;cn++)v.set(cn,Yt,v.get(cn,Yt)+Jn*$[cn])}if(d)for(var Dn=k+1;Dn<o;Dn++)w.set(Dn,k,T[Dn])}}var Ve=Math.min(o,r+1);if(j<o&&(y[j]=v.get(j,j)),r<Ve&&(y[Ve-1]=0),q+1<Ve&&(T[q]=v.get(q,Ve-1)),T[Ve-1]=0,l){for(var ut=j;ut<g;ut++){for(var xn=0;xn<r;xn++)b.set(xn,ut,0);b.set(ut,ut,1)}for(var Ft=j-1;Ft>=0;Ft--)if(y[Ft]!==0){for(var Pn=Ft+1;Pn<g;Pn++){for(var en=0,wn=Ft;wn<r;wn++)en+=b.get(wn,Ft)*b.get(wn,Pn);en=-en/b.get(Ft,Ft);for(var gr=Ft;gr<r;gr++)b.set(gr,Pn,b.get(gr,Pn)+en*b.get(gr,Ft))}for(var vr=Ft;vr<r;vr++)b.set(vr,Ft,-b.get(vr,Ft));b.set(Ft,Ft,1+b.get(Ft,Ft));for(var Mr=0;Mr<Ft-1;Mr++)b.set(Mr,Ft,0)}else{for(var Bc=0;Bc<r;Bc++)b.set(Bc,Ft,0);b.set(Ft,Ft,1)}}if(d)for(var kr=o-1;kr>=0;kr--){if(kr<q&&T[kr]!==0)for(var ms=kr+1;ms<o;ms++){for(var gs=0,xu=kr+1;xu<o;xu++)gs+=w.get(xu,kr)*w.get(xu,ms);gs=-gs/w.get(kr+1,kr);for(var Aa=kr+1;Aa<o;Aa++)w.set(Aa,ms,w.get(Aa,ms)+gs*w.get(Aa,kr))}for(var mh=0;mh<o;mh++)w.set(mh,kr,0);w.set(kr,kr,1)}for(var $p=Ve-1,gh=0,Wp=Number.EPSILON;Ve>0;){var gt=void 0,Uc=void 0;for(gt=Ve-2;gt>=-1&&gt!==-1;gt--){var pb=Number.MIN_VALUE+Wp*Math.abs(y[gt]+Math.abs(y[gt+1]));if(Math.abs(T[gt])<=pb||Number.isNaN(T[gt])){T[gt]=0;break}}if(gt===Ve-2)Uc=4;else{var mo=void 0;for(mo=Ve-1;mo>=gt&&mo!==gt;mo--){var mb=(mo!==Ve?Math.abs(T[mo]):0)+(mo!==gt+1?Math.abs(T[mo-1]):0);if(Math.abs(y[mo])<=Wp*mb){y[mo]=0;break}}mo===gt?Uc=3:mo===Ve-1?Uc=1:(Uc=2,gt=mo)}switch(gt++,Uc){case 1:{var yh=T[Ve-2];T[Ve-2]=0;for(var Lo=Ve-2;Lo>=gt;Lo--){var Vc=vu(y[Lo],yh),Eh=y[Lo]/Vc,bh=yh/Vc;if(y[Lo]=Vc,Lo!==gt&&(yh=-bh*T[Lo-1],T[Lo-1]=Eh*T[Lo-1]),d)for(var Ra=0;Ra<o;Ra++)Vc=Eh*w.get(Ra,Lo)+bh*w.get(Ra,Ve-1),w.set(Ra,Ve-1,-bh*w.get(Ra,Lo)+Eh*w.get(Ra,Ve-1)),w.set(Ra,Lo,Vc)}break}case 2:{var xh=T[gt-1];T[gt-1]=0;for(var ni=gt;ni<Ve;ni++){var Xc=vu(y[ni],xh),wh=y[ni]/Xc,_h=xh/Xc;if(y[ni]=Xc,xh=-_h*T[ni],T[ni]=wh*T[ni],l)for(var Da=0;Da<r;Da++)Xc=wh*b.get(Da,ni)+_h*b.get(Da,gt-1),b.set(Da,gt-1,-_h*b.get(Da,ni)+wh*b.get(Da,gt-1)),b.set(Da,ni,Xc)}break}case 3:{var $c=Math.max(Math.abs(y[Ve-1]),Math.abs(y[Ve-2]),Math.abs(T[Ve-2]),Math.abs(y[gt]),Math.abs(T[gt])),wu=y[Ve-1]/$c,Hp=y[Ve-2]/$c,Gl=T[Ve-2]/$c,Sh=y[gt]/$c,gb=T[gt]/$c,ys=((Hp+wu)*(Hp-wu)+Gl*Gl)/2,Pl=wu*Gl*(wu*Gl),Wc=0;(ys!==0||Pl!==0)&&(ys<0?Wc=0-Math.sqrt(ys*ys+Pl):Wc=Math.sqrt(ys*ys+Pl),Wc=Pl/(ys+Wc));for(var Es=(Sh+wu)*(Sh-wu)+Wc,_u=Sh*gb,an=gt;an<Ve-1;an++){var Kr=vu(Es,_u);Kr===0&&(Kr=Number.MIN_VALUE);var ri=Es/Kr,oi=_u/Kr;if(an!==gt&&(T[an-1]=Kr),Es=ri*y[an]+oi*T[an],T[an]=ri*T[an]-oi*y[an],_u=oi*y[an+1],y[an+1]=ri*y[an+1],d)for(var Ca=0;Ca<o;Ca++)Kr=ri*w.get(Ca,an)+oi*w.get(Ca,an+1),w.set(Ca,an+1,-oi*w.get(Ca,an)+ri*w.get(Ca,an+1)),w.set(Ca,an,Kr);if(Kr=vu(Es,_u),Kr===0&&(Kr=Number.MIN_VALUE),ri=Es/Kr,oi=_u/Kr,y[an]=Kr,Es=ri*T[an]+oi*y[an+1],y[an+1]=-oi*T[an]+ri*y[an+1],_u=oi*T[an+1],T[an+1]=ri*T[an+1],l&&an<r-1)for(var Oa=0;Oa<r;Oa++)Kr=ri*b.get(Oa,an)+oi*b.get(Oa,an+1),b.set(Oa,an+1,-oi*b.get(Oa,an)+ri*b.get(Oa,an+1)),b.set(Oa,an,Kr)}T[Ve-2]=Es,gh=gh+1;break}case 4:{if(y[gt]<=0&&(y[gt]=y[gt]<0?-y[gt]:0,d))for(var Fl=0;Fl<=$p;Fl++)w.set(Fl,gt,-w.get(Fl,gt));for(;gt<$p&&!(y[gt]>=y[gt+1]);){var Hc=y[gt];if(y[gt]=y[gt+1],y[gt+1]=Hc,d&&gt<o-1)for(var Su=0;Su<o;Su++)Hc=w.get(Su,gt+1),w.set(Su,gt+1,w.get(Su,gt)),w.set(Su,gt,Hc);if(l&&gt<r-1)for(var Tu=0;Tu<r;Tu++)Hc=b.get(Tu,gt+1),b.set(Tu,gt+1,b.get(Tu,gt)),b.set(Tu,gt,Hc);gt++}gh=0,Ve--;break}}}if(h){var yb=w;w=b,b=yb}this.m=r,this.n=o,this.s=y,this.U=b,this.V=w}return _l()(e,[{key:"solve",value:function(n){for(var r=n,o=this.threshold,i=this.s.length,a=Nt.zeros(i,i),s=0;s<i;s++)Math.abs(this.s[s])<=o?a.set(s,s,0):a.set(s,s,1/this.s[s]);for(var u=this.U,c=this.rightSingularVectors,f=c.mmul(a),l=c.rows,d=u.rows,h=Nt.zeros(l,d),v=0;v<l;v++)for(var m=0;m<d;m++){for(var g=0,E=0;E<i;E++)g+=f.get(v,E)*u.get(m,E);h.set(v,m,g)}return h.mmul(r)}},{key:"solveForDiagonal",value:function(n){return this.solve(Nt.diag(n))}},{key:"inverse",value:function(){for(var n=this.V,r=this.threshold,o=n.rows,i=n.columns,a=new Nt(o,this.s.length),s=0;s<o;s++)for(var u=0;u<i;u++)Math.abs(this.s[u])>r&&a.set(s,u,n.get(s,u)/this.s[u]);for(var c=this.U,f=c.rows,l=c.columns,d=new Nt(o,f),h=0;h<o;h++)for(var v=0;v<f;v++){for(var m=0,g=0;g<l;g++)m+=a.get(h,g)*c.get(v,g);d.set(h,v,m)}return d}},{key:"condition",get:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}},{key:"norm2",get:function(){return this.s[0]}},{key:"rank",get:function(){for(var n=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,r=0,o=this.s,i=0,a=o.length;i<a;i++)o[i]>n&&r++;return r}},{key:"diagonal",get:function(){return Array.from(this.s)}},{key:"threshold",get:function(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}},{key:"leftSingularVectors",get:function(){return this.U}},{key:"rightSingularVectors",get:function(){return this.V}},{key:"diagonalMatrix",get:function(){return Nt.diag(this.s)}}]),e}();class Ky{constructor(t){this.distances=t.distances,this.dimension=t.dimension||2,this.linkDistance=t.linkDistance}layout(){const t=this,{dimension:n,distances:r,linkDistance:o}=t;try{const i=Nt.mul(Nt.pow(r,2),-.5),a=i.mean("row"),s=i.mean("column"),u=i.mean();i.add(u).subRowVector(a).subColumnVector(s);const c=new yp(i),f=Nt.sqrt(c.diagonalMatrix).diagonal();return c.leftSingularVectors.toJSON().map(l=>Nt.mul([l],[f]).toJSON()[0].splice(0,n))}catch(i){const a=[];for(let s=0;s<r.length;s++){const u=Math.random()*o,c=Math.random()*o;a.push([u,c])}return a}}}const qy=800;class Qy{constructor(t){this.disp=[],this.positions=t.positions,this.adjMatrix=t.adjMatrix,this.focusID=t.focusID,this.radii=t.radii,this.iterations=t.iterations||10,this.height=t.height||10,this.width=t.width||10,this.speed=t.speed||100,this.gravity=t.gravity||10,this.nodeSizeFunc=t.nodeSizeFunc,this.k=t.k||5,this.strictRadial=t.strictRadial,this.nodes=t.nodes}layout(){const t=this,n=t.positions,r=[],o=t.iterations,i=t.width/10;t.maxDisplace=i,t.disp=r;for(let a=0;a<o;a++)n.forEach((s,u)=>{r[u]={x:0,y:0}}),t.getRepulsion(),t.updatePositions();return n}getRepulsion(){const t=this,n=t.positions,r=t.nodes,o=t.disp,i=t.k,a=t.radii||[];n.forEach((s,u)=>{o[u]={x:0,y:0},n.forEach((c,f)=>{if(u===f||a[u]!==a[f])return;let l=s[0]-c[0],d=s[1]-c[1],h=Math.sqrt(l*l+d*d);if(h===0){h=1;const v=u>f?1:-1;l=.01*v,d=.01*v}if(h<t.nodeSizeFunc(r[u])/2+t.nodeSizeFunc(r[f])/2){const v=i*i/h;o[u].x+=l/h*v,o[u].y+=d/h*v}})})}updatePositions(){const t=this,n=t.positions,r=t.disp,o=t.speed,i=t.strictRadial,a=t.focusID,s=t.maxDisplace||t.width/10;i&&r.forEach((c,f)=>{const l=n[f][0]-n[a][0],d=n[f][1]-n[a][1],h=Math.sqrt(l*l+d*d);let v=d/h,m=-l/h;const g=Math.sqrt(c.x*c.x+c.y*c.y);let E=Math.acos((v*c.x+m*c.y)/g);E>Math.PI/2&&(E-=Math.PI/2,v*=-1,m*=-1);const y=Math.cos(E)*g;c.x=v*y,c.y=m*y});const u=t.radii;n.forEach((c,f)=>{if(f===a)return;const l=Math.sqrt(r[f].x*r[f].x+r[f].y*r[f].y);if(l>0&&f!==a){const d=Math.min(s*(o/qy),l);if(c[0]+=r[f].x/l*d,c[1]+=r[f].y/l*d,i){let h=c[0]-n[a][0],v=c[1]-n[a][1];const m=Math.sqrt(h*h+v*v);h=h/m*u[f],v=v/m*u[f],c[0]=n[a][0]+h,c[1]=n[a][1]+v}}})}}function Jy(e){const t=e.length,n=e[0].length,r=[];for(let o=0;o<t;o++){const i=[];for(let a=0;a<n;a++)e[o][a]!==0?i.push(1/(e[o][a]*e[o][a])):i.push(0);r.push(i)}return r}function eE(e,t){let n=-1;return e.forEach((r,o)=>{r.id===t&&(n=o)}),n}function Ep(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}class tE extends $e{constructor(t){super(),this.maxIteration=1e3,this.focusNode=null,this.unitRadius=null,this.linkDistance=50,this.preventOverlap=!1,this.strictRadial=!0,this.maxPreventOverlapIteration=200,this.sortStrength=10,this.nodes=[],this.edges=[],this.updateCfg(t)}getDefaultCfg(){return{maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,strictRadial:!0,maxPreventOverlapIteration:200,sortBy:void 0,sortStrength:10}}execute(){const t=this,n=t.nodes,r=t.edges||[];if(!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]);const o=t.center;if(n.length===1){n[0].x=o[0],n[0].y=o[1],t.onLayoutEnd&&t.onLayoutEnd();return}const i=t.linkDistance;let a=null;if(Zt(t.focusNode)){let ve=!1;for(let k=0;k<n.length;k++)n[k].id===t.focusNode&&(a=n[k],t.focusNode=a,ve=!0,k=n.length);ve||(a=null)}else a=t.focusNode;a||(a=n[0],t.focusNode=a);let s=eE(n,a.id);s<0&&(s=0),t.focusIndex=s;const u=er({nodes:n,edges:r},!1),c=yr(u),f=t.maxToFocus(c,s);t.handleInfinity(c,s,f+1),t.distances=c;const l=c[s],d=t.width||500,h=t.height||500;let v=d-o[0]>o[0]?o[0]:d-o[0],m=h-o[1]>o[1]?o[1]:h-o[1];v===0&&(v=d/2),m===0&&(m=h/2);const g=m>v?v:m,E=Math.max(...l),y=[];l.forEach((ve,k)=>{t.unitRadius||(t.unitRadius=g/E),y[k]=ve*t.unitRadius}),t.radii=y;const b=t.eIdealDisMatrix();t.eIdealDistances=b;const w=Jy(b);t.weights=w;let $=new Ky({linkDistance:i,distances:b}).layout();$.forEach(ve=>{_n(ve[0])&&(ve[0]=Math.random()*i),_n(ve[1])&&(ve[1]=Math.random()*i)}),t.positions=$,$.forEach((ve,k)=>{n[k].x=ve[0]+o[0],n[k].y=ve[1]+o[1]}),$.forEach(ve=>{ve[0]-=$[s][0],ve[1]-=$[s][1]}),t.run();const he=t.preventOverlap,te=t.nodeSize;let j;const q=t.strictRadial;if(he){const ve=t.nodeSpacing;let k;be(ve)?k=()=>ve:ct(ve)?k=ve:k=()=>0,te?bt(te)?j=Ue=>(te[0]>te[1]?te[0]:te[1])+k(Ue):j=Ue=>te+k(Ue):j=Ue=>Ue.size?bt(Ue.size)?(Ue.size[0]>Ue.size[1]?Ue.size[0]:Ue.size[1])+k(Ue):Ot(Ue.size)?(Ue.size.width>Ue.size.height?Ue.size.width:Ue.size.height)+k(Ue):Ue.size+k(Ue):10+k(Ue);const pe={nodes:n,nodeSizeFunc:j,adjMatrix:u,positions:$,radii:y,height:h,width:d,strictRadial:q,focusID:s,iterations:t.maxPreventOverlapIteration||200,k:$.length/4.5};$=new Qy(pe).layout()}return $.forEach((ve,k)=>{n[k].x=ve[0]+o[0],n[k].y=ve[1]+o[1]}),t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:r}}run(){const t=this,n=t.maxIteration,r=t.positions||[],o=t.weights||[],i=t.eIdealDistances||[],a=t.radii||[];for(let s=0;s<=n;s++){const u=s/n;t.oneIteration(u,r,a,i,o)}}oneIteration(t,n,r,o,i){const a=this,s=1-t,u=a.focusIndex;n.forEach((c,f)=>{const l=Ep(c,[0,0]),d=l===0?0:1/l;if(f===u)return;let h=0,v=0,m=0;n.forEach((E,y)=>{if(f===y)return;const b=Ep(c,E),w=b===0?0:1/b,T=o[y][f];m+=i[f][y],h+=i[f][y]*(E[0]+T*(c[0]-E[0])*w),v+=i[f][y]*(E[1]+T*(c[1]-E[1])*w)});const g=r[f]===0?0:1/r[f];m*=s,m+=t*g*g,h*=s,h+=t*g*c[0]*d,c[0]=h/m,v*=s,v+=t*g*c[1]*d,c[1]=v/m})}eIdealDisMatrix(){const t=this,n=t.nodes;if(!n)return[];const r=t.distances,o=t.linkDistance,i=t.radii||[],a=t.unitRadius||50,s=[];return r&&r.forEach((u,c)=>{const f=[];u.forEach((l,d)=>{if(c===d)f.push(0);else if(i[c]===i[d])if(t.sortBy==="data")f.push(l*(Math.abs(c-d)*t.sortStrength)/(i[c]/a));else if(t.sortBy){let h=n[c][t.sortBy]||0,v=n[d][t.sortBy]||0;Zt(h)&&(h=h.charCodeAt(0)),Zt(v)&&(v=v.charCodeAt(0)),f.push(l*(Math.abs(h-v)*t.sortStrength)/(i[c]/a))}else f.push(l*o/(i[c]/a));else{const h=(o+a)/2;f.push(l*h)}}),s.push(f)}),s}handleInfinity(t,n,r){const o=t.length;for(let i=0;i<o;i++)if(t[n][i]===1/0){t[n][i]=r,t[i][n]=r;for(let a=0;a<o;a++)t[i][a]!==1/0&&t[n][a]===1/0&&(t[n][a]=r+t[i][a],t[a][n]=r+t[i][a])}for(let i=0;i<o;i++)if(i!==n){for(let a=0;a<o;a++)if(t[i][a]===1/0){let s=Math.abs(t[n][i]-t[n][a]);s=s===0?1:s,t[i][a]=s}}}maxToFocus(t,n){let r=0;for(let o=0;o<t[n].length;o++)t[n][o]!==1/0&&(r=t[n][o]>r?t[n][o]:r);return r}getType(){return"radial"}}class bp extends $e{constructor(t){super(),this.nodeSize=30,this.minNodeSpacing=10,this.nodeSpacing=10,this.preventOverlap=!1,this.equidistant=!1,this.startAngle=3/2*Math.PI,this.clockwise=!0,this.sortBy="degree",this.nodes=[],this.edges=[],this.width=300,this.height=300,this.onLayoutEnd=()=>{},this.updateCfg(t)}getDefaultCfg(){return{nodeSize:30,minNodeSpacing:10,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:3/2*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"}}execute(){var t,n;const r=this,{nodes:o,edges:i}=r,a=o.length;if(a===0){(t=r.onLayoutEnd)===null||t===void 0||t.call(r);return}!r.width&&typeof window!="undefined"&&(r.width=window.innerWidth),!r.height&&typeof window!="undefined"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const s=r.center;if(a===1){o[0].x=s[0],o[0].y=s[1],(n=r.onLayoutEnd)===null||n===void 0||n.call(r);return}const{nodeSize:u,nodeSpacing:c}=r,f=[];let l,d=0;bt(u)?l=Math.max(u[0],u[1]):l=u,bt(c)?d=Math.max(c[0],c[1]):be(c)&&(d=c),o.forEach(b=>{f.push(b);let w=l;bt(b.size)?w=Math.max(b.size[0],b.size[1]):be(b.size)?w=b.size:Ot(b.size)&&(w=Math.max(b.size.width,b.size.height)),l=Math.max(l,w),ct(c)&&(d=Math.max(c(b),d))}),r.clockwise=r.counterclockwise!==void 0?!r.counterclockwise:r.clockwise;const h={},v={};if(f.forEach((b,w)=>{h[b.id]=b,v[b.id]=w}),(r.sortBy==="degree"||!Zt(r.sortBy)||f[0][r.sortBy]===void 0)&&(r.sortBy="degree",!be(o[0].degree))){const b=hn(o.length,v,i);f.forEach((w,T)=>{w.degree=b[T].all})}f.sort((b,w)=>w[r.sortBy]-b[r.sortBy]),r.maxValueNode=f[0],r.maxLevelDiff=r.maxLevelDiff||r.maxValueNode[r.sortBy]/4;const m=[[]];let g=m[0];f.forEach(b=>{if(g.length>0){const w=Math.abs(g[0][r.sortBy]-b[r.sortBy]);r.maxLevelDiff&&w>=r.maxLevelDiff&&(g=[],m.push(g))}g.push(b)});let E=l+(d||r.minNodeSpacing);if(!r.preventOverlap){const b=m.length>0&&m[0].length>1,T=(Math.min(r.width,r.height)/2-E)/(m.length+(b?1:0));E=Math.min(E,T)}let y=0;if(m.forEach(b=>{let w=r.sweep;w===void 0&&(w=2*Math.PI-2*Math.PI/b.length);const T=b.dTheta=w/Math.max(1,b.length-1);if(b.length>1&&r.preventOverlap){const $=Math.cos(T)-Math.cos(0),he=Math.sin(T)-Math.sin(0),te=Math.sqrt(E*E/($*$+he*he));y=Math.max(te,y)}b.r=y,y+=E}),r.equidistant){let b=0,w=0;for(let T=0;T<m.length;T++){const he=m[T].r-w;b=Math.max(b,he)}w=0,m.forEach((T,$)=>{$===0&&(w=T.r),T.r=w,w+=b})}return m.forEach(b=>{const w=b.dTheta,T=b.r;b.forEach(($,he)=>{const te=r.startAngle+(r.clockwise?1:-1)*w*he;$.x=s[0]+T*Math.cos(te),$.y=s[1]+T*Math.sin(te)})}),r.onLayoutEnd&&r.onLayoutEnd(),{nodes:o,edges:i}}getType(){return"concentric"}}class xp extends $e{constructor(t){super(),this.center=[0,0],this.linkDistance=50,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(t)}getDefaultCfg(){return{center:[0,0],linkDistance:50}}execute(){const t=this,{nodes:n,edges:r=[]}=t,o=t.center;if(!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}if(n.length===1){n[0].x=o[0],n[0].y=o[1],t.onLayoutEnd&&t.onLayoutEnd();return}const i=t.linkDistance,a=er({nodes:n,edges:r},!1),s=yr(a);t.handleInfinity(s);const u=Er(s,i);t.scaledDistances=u;const c=t.runMDS();return t.positions=c,c.forEach((f,l)=>{n[l].x=f[0]+o[0],n[l].y=f[1]+o[1]}),t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:r}}runMDS(){const t=this,n=2,r=t.scaledDistances,o=Nt.mul(Nt.pow(r,2),-.5),i=o.mean("row"),a=o.mean("column"),s=o.mean();o.add(s).subRowVector(i).subColumnVector(a);const u=new yp(o),c=Nt.sqrt(u.diagonalMatrix).diagonal();return u.leftSingularVectors.toJSON().map(f=>Nt.mul([f],[c]).toJSON()[0].splice(0,n))}handleInfinity(t){let n=-999999;t.forEach(r=>{r.forEach(o=>{o!==1/0&&n<o&&(n=o)})}),t.forEach((r,o)=>{r.forEach((i,a)=>{i===1/0&&(t[o][a]=n)})})}getType(){return"mds"}}const nE=800;class rE extends $e{constructor(t){super(),this.maxIteration=1e3,this.workerEnabled=!1,this.gravity=10,this.speed=5,this.clustering=!1,this.clusterGravity=10,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.onLayoutEnd=()=>{},this.tick=()=>{},this.animate=!0,this.updateCfg(t)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10,animate:!0}}execute(){var t,n;const r=this,o=r.nodes;if(r.timeInterval!==void 0&&typeof window!="undefined"&&window.clearInterval(r.timeInterval),!o||o.length===0){(t=r.onLayoutEnd)===null||t===void 0||t.call(r);return}!r.width&&typeof window!="undefined"&&(r.width=window.innerWidth),!r.height&&typeof window!="undefined"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);const i=r.center;if(o.length===1){o[0].x=i[0],o[0].y=i[1],(n=r.onLayoutEnd)===null||n===void 0||n.call(r);return}const a={},s={};return o.forEach((u,c)=>{be(u.x)||(u.x=Math.random()*this.width),be(u.y)||(u.y=Math.random()*this.height),a[u.id]=u,s[u.id]=c}),r.nodeMap=a,r.nodeIdxMap=s,r.run()}run(){var t;const n=this,r=n.nodes;if(!r)return;const{edges:o,maxIteration:i,workerEnabled:a,clustering:s,animate:u}=n,c={};if(s&&r.forEach(f=>{c[f.cluster]===void 0&&(c[f.cluster]={name:f.cluster,cx:0,cy:0,count:0})}),a||!u){for(let f=0;f<i;f++)n.runOneStep(c);(t=n.onLayoutEnd)===null||t===void 0||t.call(n)}else{if(typeof window=="undefined")return;let f=0;this.timeInterval=window.setInterval(()=>{var l;n.runOneStep(c),f++,f>=i&&((l=n.onLayoutEnd)===null||l===void 0||l.call(n),window.clearInterval(n.timeInterval))},0)}return{nodes:r,edges:o}}runOneStep(t){var n;const r=this,o=r.nodes;if(!o)return;const{edges:i,center:a,gravity:s,speed:u,clustering:c}=r,f=r.height*r.width,l=Math.sqrt(f)/10,d=f/(o.length+1),h=Math.sqrt(d),v=[];if(o.forEach((m,g)=>{v[g]={x:0,y:0}}),r.applyCalculate(o,i,v,h,d),c){for(const g in t)t[g].cx=0,t[g].cy=0,t[g].count=0;o.forEach(g=>{const E=t[g.cluster];be(g.x)&&(E.cx+=g.x),be(g.y)&&(E.cy+=g.y),E.count++});for(const g in t)t[g].cx/=t[g].count,t[g].cy/=t[g].count;const m=r.clusterGravity||s;o.forEach((g,E)=>{if(!be(g.x)||!be(g.y))return;const y=t[g.cluster],b=Math.sqrt((g.x-y.cx)*(g.x-y.cx)+(g.y-y.cy)*(g.y-y.cy)),w=h*m;v[E].x-=w*(g.x-y.cx)/b,v[E].y-=w*(g.y-y.cy)/b})}o.forEach((m,g)=>{if(!be(m.x)||!be(m.y))return;const E=.01*h*s;v[g].x-=E*(m.x-a[0]),v[g].y-=E*(m.y-a[1])}),o.forEach((m,g)=>{if(be(m.fx)&&be(m.fy)){m.x=m.fx,m.y=m.fy;return}if(!be(m.x)||!be(m.y))return;const E=Math.sqrt(v[g].x*v[g].x+v[g].y*v[g].y);if(E>0){const y=Math.min(l*(u/nE),E);m.x+=v[g].x/E*y,m.y+=v[g].y/E*y}}),(n=r.tick)===null||n===void 0||n.call(r)}applyCalculate(t,n,r,o,i){const a=this;a.calRepulsive(t,r,i),n&&a.calAttractive(n,r,o)}calRepulsive(t,n,r){t.forEach((o,i)=>{n[i]={x:0,y:0},t.forEach((a,s)=>{if(i===s||!be(o.x)||!be(a.x)||!be(o.y)||!be(a.y))return;let u=o.x-a.x,c=o.y-a.y,f=u*u+c*c;if(f===0){f=1;const d=i>s?1:-1;u=.01*d,c=.01*d}const l=r/f;n[i].x+=u*l,n[i].y+=c*l})})}calAttractive(t,n,r){t.forEach(o=>{const i=Je(o,"source"),a=Je(o,"target");if(!i||!a)return;const s=this.nodeIdxMap[i],u=this.nodeIdxMap[a];if(s===u)return;const c=this.nodeMap[i],f=this.nodeMap[a];if(!be(f.x)||!be(c.x)||!be(f.y)||!be(c.y))return;const l=f.x-c.x,d=f.y-c.y,h=Math.sqrt(l*l+d*d),v=h*h/r;n[u].x-=l/h*v,n[u].y-=d/h*v,n[s].x+=l/h*v,n[s].y+=d/h*v})}stop(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)}destroy(){const t=this;t.stop(),t.tick=null,t.nodes=null,t.edges=null,t.destroyed=!0}getType(){return"fruchterman"}}function wp(e,t,n,r,o,i,a){try{var s=e[i](a),u=s.value}catch(c){n(c);return}s.done?t(u):Promise.resolve(u).then(r,o)}function Ia(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(u){wp(i,r,o,a,s,"next",u)}function s(u){wp(i,r,o,a,s,"throw",u)}a(void 0)})}}var Fe=oe(36458);function ei(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var oE=oe(10859);function _p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(0,oE.Z)(r.key),r)}}function ti(e,t,n){return t&&_p(e.prototype,t),n&&_p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var iE=oe(73806),Nl=oe.n(iE),aE=oe(59933),sE=oe.n(aE),uE=oe(24669),cE=oe.n(uE),fE=oe(86170),Xr=oe.n(fE),Eb=null,lE=1;function Sp(){return lE++}var bb=null,xb=null,Ee;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.COPY_SRC=1]="COPY_SRC",e[e.COPY_DST=2]="COPY_DST",e[e.SAMPLED=4]="SAMPLED",e[e.STORAGE=8]="STORAGE",e[e.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(Ee||(Ee={}));var dE=function(){function e(){ei(this,e),this.config=void 0}return ti(e,[{key:"get",value:function(){return this.config}},{key:"set",value:function(n){this.config=n}}]),e}(),wb=typeof navigator!="undefined"&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),Mc;(function(e){e.Void="Void",e.Boolean="Boolean",e.Float="Float",e.Uint32="Uint32",e.Int32="Int32",e.Vector="Vector",e.Vector2Float="vec2<f32>",e.Vector3Float="vec3<f32>",e.Vector4Float="vec4<f32>",e.Vector2Boolean="vec2<bool>",e.Vector3Boolean="vec3<bool>",e.Vector4Boolean="vec4<bool>",e.Vector2Uint="vec2<u32>",e.Vector3Uint="vec3<u32>",e.Vector4Uint="vec4<u32>",e.Vector2Int="vec2<i32>",e.Vector3Int="vec3<i32>",e.Vector4Int="vec4<i32>",e.Matrix="Matrix",e.Matrix3x3Float="mat3x3<f32>",e.Matrix4x4Float="mat4x4<i32>",e.Struct="Struct",e.FloatArray="Float[]",e.Vector4FloatArray="vec4<f32>[]"})(Mc||(Mc={}));var Tp;(function(e){e.Program="Program",e.Identifier="Identifier",e.VariableDeclaration="VariableDeclaration",e.BlockStatement="BlockStatement",e.ReturnStatement="ReturnStatement",e.FunctionDeclaration="FunctionDeclaration",e.VariableDeclarator="VariableDeclarator",e.AssignmentExpression="AssignmentExpression",e.LogicalExpression="LogicalExpression",e.BinaryExpression="BinaryExpression",e.ArrayExpression="ArrayExpression",e.UnaryExpression="UnaryExpression",e.UpdateExpression="UpdateExpression",e.FunctionExpression="FunctionExpression",e.MemberExpression="MemberExpression",e.ConditionalExpression="ConditionalExpression",e.ExpressionStatement="ExpressionStatement",e.CallExpression="CallExpression",e.NumThreadStatement="NumThreadStatement",e.StorageStatement="StorageStatement",e.DoWhileStatement="DoWhileStatement",e.WhileStatement="WhileStatement",e.ForStatement="ForStatement",e.BreakStatement="BreakStatement",e.ContinueStatement="ContinueStatement",e.IfStatement="IfStatement",e.ImportedFunctionStatement="ImportedFunctionStatement"})(Tp||(Tp={}));var pu;(function(e){e.Input="Input",e.Output="Output",e.Uniform="Uniform",e.Workgroup="Workgroup",e.UniformConstant="UniformConstant",e.Image="Image",e.StorageBuffer="StorageBuffer",e.Private="Private",e.Function="Function"})(pu||(pu={}));var kc;(function(e){e.GLSL100="GLSL100",e.GLSL450="GLSL450",e.WGSL="WGSL"})(kc||(kc={}));var hE="__DefineValuePlaceholder__";function vE(){if(typeof document!="undefined")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Ip(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Np(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ip(Object(n),!0).forEach(function(r){(0,Fe.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ip(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var pE=function(){function e(t,n){ei(this,e),this.engine=t,this.configService=n,this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}return ti(e,[{key:"init",value:function(){var n=this.configService.get(),r=n.canvas,o=n.engineOptions;this.initPromise=this.engine.init(Np({canvas:r||vE(),antialiasing:!1},o))}},{key:"setBundle",value:function(n){this.compiledBundle=JSON.parse(JSON.stringify(n))}},{key:"setDispatch",value:function(n){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=n),this}},{key:"setMaxIteration",value:function(n){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=n),this}},{key:"setBinding",value:function(n,r){var o=this;if(typeof n=="string"){var i=sE()(r)||Nl()(r)||cE()(r);if(this.compiledBundle&&this.compiledBundle.context){var a=this.compiledBundle.context.defines.find(function(u){return u.name===n});if(a)return a.value=r,this;var s=this.compiledBundle.context.uniforms.find(function(u){return u.name===n});s&&(i?(s.data=r,s.isReferer=!1,s.storageClass===pu.Uniform?this.model&&this.model.updateUniform(n,r):this.model&&this.model.updateBuffer(n,r)):(s.isReferer=!0,s.data=r))}}else Object.keys(n).forEach(function(u){o.setBinding(u,n[u])});return this}},{key:"execute",value:function(){var t=Ia(Xr().mark(function r(){var o=this,i,a,s=arguments;return Xr().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(i=s.length>0&&s[0]!==void 0?s[0]:1,!this.dirty){c.next=6;break}return this.compiledBundle.context&&(i>1?this.compiledBundle.context.maxIteration=i:this.compiledBundle.context.maxIteration++),c.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter(function(f){var l=f.isReferer;return l}).forEach(function(f){var l=f.data,d=f.name;o.model.confirmInput(l.model,d)}),a=0;a<i;a++)this.model.run();return this.engine.endFrame(),c.abrupt("return",this);case 12:case"end":return c.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"getOutput",value:function(){var t=Ia(Xr().mark(function r(){return Xr().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",this.model.readData());case 1:case"end":return i.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"compile",value:function(){var t=Ia(Xr().mark(function r(){var o,i,a;return Xr().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.initPromise;case 2:return o=Np({},this.compiledBundle.context),i=this.engine.supportWebGPU?this.engine.useWGSL?kc.WGSL:kc.GLSL450:kc.GLSL100,a=this.compiledBundle.shaders[i],o.defines.filter(function(c){return c.runtime}).forEach(function(c){var f="".concat(hE).concat(c.name);a=a.replace(f,"".concat(c.value))}),o.shader=a,o.uniforms.forEach(function(c){if(!c.data&&c.storageClass===pu.StorageBuffer){var f=1;c.type===Mc.FloatArray?f=1:c.type===Mc.Vector4FloatArray&&(f=4),c.data=new Float32Array(o.output.length*f).fill(0)}}),this.compiledBundle.context=o,u.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=u.sent;case 12:case"end":return u.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()}]),e}(),mE=oe(32101),gE=oe.n(mE),yE=function(){function e(t,n){ei(this,e),this.attribute=void 0,this.buffer=void 0;var r=n.buffer,o=n.offset,i=n.stride,a=n.normalized,s=n.size,u=n.divisor;this.buffer=r,this.attribute={buffer:r.get(),offset:o||0,stride:i||0,normalized:a||!1,divisor:u||0},s&&(this.attribute.size=s)}return ti(e,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(n){this.buffer.subData(n)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),e}(),Xi,Gc,$i,Oo,Pc,Na,Fc,Al,gi,ps,Lr,yi,Ei,Rl,EE=(Xi={},(0,Fe.Z)(Xi,Ee.POINTS,"points"),(0,Fe.Z)(Xi,Ee.LINES,"lines"),(0,Fe.Z)(Xi,Ee.LINE_LOOP,"line loop"),(0,Fe.Z)(Xi,Ee.LINE_STRIP,"line strip"),(0,Fe.Z)(Xi,Ee.TRIANGLES,"triangles"),(0,Fe.Z)(Xi,Ee.TRIANGLE_FAN,"triangle fan"),(0,Fe.Z)(Xi,Ee.TRIANGLE_STRIP,"triangle strip"),Xi),Ap=(Gc={},(0,Fe.Z)(Gc,Ee.STATIC_DRAW,"static"),(0,Fe.Z)(Gc,Ee.DYNAMIC_DRAW,"dynamic"),(0,Fe.Z)(Gc,Ee.STREAM_DRAW,"stream"),Gc),ch=($i={},(0,Fe.Z)($i,Ee.BYTE,"int8"),(0,Fe.Z)($i,Ee.UNSIGNED_INT,"int16"),(0,Fe.Z)($i,Ee.INT,"int32"),(0,Fe.Z)($i,Ee.UNSIGNED_BYTE,"uint8"),(0,Fe.Z)($i,Ee.UNSIGNED_SHORT,"uint16"),(0,Fe.Z)($i,Ee.UNSIGNED_INT,"uint32"),(0,Fe.Z)($i,Ee.FLOAT,"float"),$i),bE=(Oo={},(0,Fe.Z)(Oo,Ee.ALPHA,"alpha"),(0,Fe.Z)(Oo,Ee.LUMINANCE,"luminance"),(0,Fe.Z)(Oo,Ee.LUMINANCE_ALPHA,"luminance alpha"),(0,Fe.Z)(Oo,Ee.RGB,"rgb"),(0,Fe.Z)(Oo,Ee.RGBA,"rgba"),(0,Fe.Z)(Oo,Ee.RGBA4,"rgba4"),(0,Fe.Z)(Oo,Ee.RGB5_A1,"rgb5 a1"),(0,Fe.Z)(Oo,Ee.RGB565,"rgb565"),(0,Fe.Z)(Oo,Ee.DEPTH_COMPONENT,"depth"),(0,Fe.Z)(Oo,Ee.DEPTH_STENCIL,"depth stencil"),Oo),xE=(Pc={},(0,Fe.Z)(Pc,Ee.DONT_CARE,"dont care"),(0,Fe.Z)(Pc,Ee.NICEST,"nice"),(0,Fe.Z)(Pc,Ee.FASTEST,"fast"),Pc),Rp=(Na={},(0,Fe.Z)(Na,Ee.NEAREST,"nearest"),(0,Fe.Z)(Na,Ee.LINEAR,"linear"),(0,Fe.Z)(Na,Ee.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,Fe.Z)(Na,Ee.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,Fe.Z)(Na,Ee.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,Fe.Z)(Na,Ee.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Na),Dp=(Fc={},(0,Fe.Z)(Fc,Ee.REPEAT,"repeat"),(0,Fe.Z)(Fc,Ee.CLAMP_TO_EDGE,"clamp"),(0,Fe.Z)(Fc,Ee.MIRRORED_REPEAT,"mirror"),Fc),wE=(Al={},(0,Fe.Z)(Al,Ee.NONE,"none"),(0,Fe.Z)(Al,Ee.BROWSER_DEFAULT_WEBGL,"browser"),Al),_E=(gi={},(0,Fe.Z)(gi,Ee.NEVER,"never"),(0,Fe.Z)(gi,Ee.ALWAYS,"always"),(0,Fe.Z)(gi,Ee.LESS,"less"),(0,Fe.Z)(gi,Ee.LEQUAL,"lequal"),(0,Fe.Z)(gi,Ee.GREATER,"greater"),(0,Fe.Z)(gi,Ee.GEQUAL,"gequal"),(0,Fe.Z)(gi,Ee.EQUAL,"equal"),(0,Fe.Z)(gi,Ee.NOTEQUAL,"notequal"),gi),Cp=(ps={},(0,Fe.Z)(ps,Ee.FUNC_ADD,"add"),(0,Fe.Z)(ps,Ee.MIN_EXT,"min"),(0,Fe.Z)(ps,Ee.MAX_EXT,"max"),(0,Fe.Z)(ps,Ee.FUNC_SUBTRACT,"subtract"),(0,Fe.Z)(ps,Ee.FUNC_REVERSE_SUBTRACT,"reverse subtract"),ps),Dl=(Lr={},(0,Fe.Z)(Lr,Ee.ZERO,"zero"),(0,Fe.Z)(Lr,Ee.ONE,"one"),(0,Fe.Z)(Lr,Ee.SRC_COLOR,"src color"),(0,Fe.Z)(Lr,Ee.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,Fe.Z)(Lr,Ee.SRC_ALPHA,"src alpha"),(0,Fe.Z)(Lr,Ee.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,Fe.Z)(Lr,Ee.DST_COLOR,"dst color"),(0,Fe.Z)(Lr,Ee.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,Fe.Z)(Lr,Ee.DST_ALPHA,"dst alpha"),(0,Fe.Z)(Lr,Ee.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,Fe.Z)(Lr,Ee.CONSTANT_COLOR,"constant color"),(0,Fe.Z)(Lr,Ee.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,Fe.Z)(Lr,Ee.CONSTANT_ALPHA,"constant alpha"),(0,Fe.Z)(Lr,Ee.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,Fe.Z)(Lr,Ee.SRC_ALPHA_SATURATE,"src alpha saturate"),Lr),SE=(yi={},(0,Fe.Z)(yi,Ee.NEVER,"never"),(0,Fe.Z)(yi,Ee.ALWAYS,"always"),(0,Fe.Z)(yi,Ee.LESS,"less"),(0,Fe.Z)(yi,Ee.LEQUAL,"lequal"),(0,Fe.Z)(yi,Ee.GREATER,"greater"),(0,Fe.Z)(yi,Ee.GEQUAL,"gequal"),(0,Fe.Z)(yi,Ee.EQUAL,"equal"),(0,Fe.Z)(yi,Ee.NOTEQUAL,"notequal"),yi),mu=(Ei={},(0,Fe.Z)(Ei,Ee.ZERO,"zero"),(0,Fe.Z)(Ei,Ee.KEEP,"keep"),(0,Fe.Z)(Ei,Ee.REPLACE,"replace"),(0,Fe.Z)(Ei,Ee.INVERT,"invert"),(0,Fe.Z)(Ei,Ee.INCR,"increment"),(0,Fe.Z)(Ei,Ee.DECR,"decrement"),(0,Fe.Z)(Ei,Ee.INCR_WRAP,"increment wrap"),(0,Fe.Z)(Ei,Ee.DECR_WRAP,"decrement wrap"),Ei),TE=(Rl={},(0,Fe.Z)(Rl,Ee.FRONT,"front"),(0,Fe.Z)(Rl,Ee.BACK,"back"),Rl),IE=function(){function e(t,n){ei(this,e),this.buffer=void 0;var r=n.data,o=n.usage,i=n.type;this.buffer=t.buffer({data:r,usage:Ap[o||Ee.STATIC_DRAW],type:ch[i||Ee.UNSIGNED_BYTE]})}return ti(e,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(n){var r=n.data,o=n.offset;this.buffer.subdata(r,o)}}]),e}(),NE=oe(68193);function AE(e){if(Array.isArray(e))return(0,NE.Z)(e)}function RE(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}var DE=oe(37987);function CE(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OE(e){return AE(e)||RE(e)||(0,DE.Z)(e)||CE()}function Op(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function Lp(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Op(Object(n),!0).forEach(function(r){(0,Fe.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Op(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var LE=`attribute vec3 a_Position;
attribute vec2 a_TexCoord;

varying vec2 v_TexCoord;

void main() {
  gl_Position = vec4(a_Position, 1.0);
  v_TexCoord = a_TexCoord;
}`,Mp=0,Cl=!1,ME=function(){function e(t,n){var r=this;ei(this,e),this.reGl=t,this.context=n,this.entity=Sp(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var o={};this.context.uniforms.forEach(function(c){var f=c.name,l=c.type,d=c.data,h=c.isReferer,v=c.storageClass;if(v===pu.StorageBuffer){if(h)r.textureCache[f]={data:void 0},o["".concat(f,"Size")]=function(){return d.compiledBundle.context.output.textureSize};else{r.textureCache[f]=r.calcDataTexture(f,l,d);var m=r.textureCache[f],g=m.textureWidth,E=m.isOutput;o["".concat(f,"Size")]=[g,g],E&&(r.outputTextureName=f,r.context.needPingpong&&(r.outputTextureName="".concat(f,"Output"),r.textureCache[r.outputTextureName]=r.calcDataTexture(f,l,d)))}o[f]=function(){return Cl&&console.log("[".concat(r.entity,"]: ").concat(f," ").concat(r.textureCache[f].id)),r.textureCache[f].texture}}else if(v===pu.Uniform){if(d&&(Array.isArray(d)||Nl()(d))&&d.length>16)throw new Error("invalid data type ".concat(l));o[f]=function(){return c.data}}});var i=this.getOuputDataTexture(),a=i.textureWidth,s=i.texelCount;o.u_OutputTextureSize=[a,a],o.u_OutputTexelCount=s,this.context.output.textureSize=[a,a];var u={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(this.context.shader),uniforms:o,vert:LE,primitive:"triangle strip",count:4};this.computeCommand=this.reGl(u)}return ti(e,[{key:"run",value:function(){var n=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use(function(){n.computeCommand()}),Cl&&console.log("[".concat(this.entity,"]: output ").concat(this.getOuputDataTexture().id))}},{key:"readData",value:function(){var t=Ia(Xr().mark(function r(){var o=this,i,a,s,u,c,f,l,d;return Xr().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(this.reGl({framebuffer:this.texFBO})(function(){i=o.reGl.read()}),!i){v.next=6;break}if(a=this.getOuputDataTexture(),s=a.originalDataLength,u=a.elementsPerTexel,c=a.typedArrayConstructor,f=c===void 0?Float32Array:c,l=[],u!==4)for(d=0;d<i.length;d+=4)u===1?l.push(i[d]):u===2?l.push(i[d],i[d+1]):l.push(i[d],i[d+1],i[d+2]);else l=i;return v.abrupt("return",new f(l.slice(0,s)));case 6:return v.abrupt("return",new Float32Array);case 7:case"end":return v.stop()}},r,this)}));function n(){return t.apply(this,arguments)}return n}()},{key:"confirmInput",value:function(n,r){var o;this.entity===n.entity?(this.dynamicPingpong=!0,o=this):o=n,this.textureCache[r].id=o.getOuputDataTexture().id,this.textureCache[r].texture=o.getOuputDataTexture().texture,Cl&&console.log("[".concat(this.entity,"]: confirm input ").concat(r," from model ").concat(o.entity,", ").concat(o.getOuputDataTexture().id))}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(n,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=this.context.uniforms.find(function(c){var f=c.name;return f===n});if(i){var a=this.calcDataTexture(n,i.type,r),s=a.texture,u=a.data;this.textureCache[n].data=u,this.textureCache[n].texture=s}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var n=this.context.output.name;this.textureCache[n].id=this.getOuputDataTexture().id,this.textureCache[n].texture=this.getOuputDataTexture().texture}var r=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=r,Cl&&console.log("[".concat(this.entity,"]: after swap, output ").concat(this.getOuputDataTexture().id))}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var n=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=n}},{key:"cloneDataTexture",value:function(n){var r=n.data,o=n.textureWidth;return Lp(Lp({},n),{},{id:Mp++,texture:this.reGl.texture({width:o,height:o,data:r,type:"float"})})}},{key:"calcDataTexture",value:function(n,r,o){var i=1;r===Mc.Vector4FloatArray&&(i=4);for(var a=[],s=0;s<o.length;s+=i)i===1?a.push(o[s],0,0,0):i===2?a.push(o[s],o[s+1],0,0):i===3?a.push(o[s],o[s+1],o[s+2],0):i===4&&a.push(o[s],o[s+1],o[s+2],o[s+3]);var u=o.length,c=Math.ceil(u/i),f=Math.ceil(Math.sqrt(c)),l=f*f;c<l&&a.push.apply(a,OE(new Array((l-c)*4).fill(0)));var d=this.reGl.texture({width:f,height:f,data:a,type:"float"});return{id:Mp++,data:a,originalDataLength:u,typedArrayConstructor:Nl()(o)?o.constructor:void 0,textureWidth:f,texture:d,texelCount:c,elementsPerTexel:i,isOutput:n===this.context.output.name}}}]),e}(),kE=function(){function e(t,n){ei(this,e),this.elements=void 0;var r=n.data,o=n.usage,i=n.type,a=n.count;this.elements=t.elements({data:r,usage:Ap[o||Ee.STATIC_DRAW],type:ch[i||Ee.UNSIGNED_BYTE],count:a})}return ti(e,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(n){var r=n.data;this.elements.subdata(r)}},{key:"destroy",value:function(){this.elements.destroy()}}]),e}(),GE=function(){function e(t,n){ei(this,e),this.framebuffer=void 0;var r=n.width,o=n.height,i=n.color,a=n.colors,s=n.depth,u=n.stencil,c={width:r,height:o};Array.isArray(a)&&(c.colors=a.map(function(f){return f.get()})),i&&typeof i!="boolean"&&(c.color=i.get()),this.framebuffer=t.framebuffer(c)}return ti(e,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(n){var r=n.width,o=n.height;this.framebuffer.resize(r,o)}}]),e}(),PE=oe(44794),FE=oe(69143),zE=oe.n(FE);function fh(e){var t={};return Object.keys(e).forEach(function(n){lh(n,e[n],t,"")}),t}function lh(e,t,n,r){if(t===null||typeof t=="number"||typeof t=="boolean"||Array.isArray(t)&&typeof t[0]=="number"||Nl()(t)||t===""||t.resize!==void 0){n["".concat(r&&r+".").concat(e)]=t;return}zE()(t)&&Object.keys(t).forEach(function(o){lh(o,t[o],n,"".concat(r&&r+".").concat(e))}),Array.isArray(t)&&t.forEach(function(o,i){Object.keys(o).forEach(function(a){lh(a,o[a],n,"".concat(r&&r+".").concat(e,"[").concat(i,"]"))})})}function kp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function gu(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kp(Object(n),!0).forEach(function(r){(0,Fe.Z)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kp(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var BE=function(){function e(t,n){ei(this,e),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=t;var r=n.vs,o=n.fs,i=n.defines,a=n.attributes,s=n.uniforms,u=n.primitive,c=n.count,f=n.elements,l=n.depth,d=n.blend,h=n.stencil,v=n.cull,m=n.instances,g=n.scissor,E=n.viewport,y={};s&&(this.uniforms=fh(s),Object.keys(s).forEach(function($){y[$]=t.prop($)}));var b={};Object.keys(a).forEach(function($){b[$]=a[$].get()});var w=i&&this.generateDefines(i)||"",T={attributes:b,frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(w,`
`).concat(o),uniforms:y,vert:`
`.concat(w,`
`).concat(r),primitive:EE[u===void 0?Ee.TRIANGLES:u]};m&&(T.instances=m),c&&(T.count=c),f&&(T.elements=f.get()),g&&(T.scissor=g),E&&(T.viewport=E),this.initDepthDrawParams({depth:l},T),this.initBlendDrawParams({blend:d},T),this.initStencilDrawParams({stencil:h},T),this.initCullDrawParams({cull:v},T),this.drawCommand=t(T)}return ti(e,[{key:"addUniforms",value:function(n){this.uniforms=gu(gu({},this.uniforms),fh(n))}},{key:"draw",value:function(n){var r=gu(gu({},this.uniforms),fh(n.uniforms||{})),o={};Object.keys(r).forEach(function(i){var a=(0,PE.Z)(r[i]);a==="boolean"||a==="number"||Array.isArray(r[i])||r[i].BYTES_PER_ELEMENT?o[i]=r[i]:a==="string"||(o[i]=r[i].get())}),this.drawCommand(o)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(n,r){var o=n.depth;o&&(r.depth={enable:o.enable===void 0?!0:!!o.enable,mask:o.mask===void 0?!0:!!o.mask,func:_E[o.func||Ee.LESS],range:o.range||[0,1]})}},{key:"initBlendDrawParams",value:function(n,r){var o=n.blend;if(o){var i=o.enable,a=o.func,s=o.equation,u=o.color,c=u===void 0?[0,0,0,0]:u;r.blend={enable:!!i,func:{srcRGB:Dl[a&&a.srcRGB||Ee.SRC_ALPHA],srcAlpha:Dl[a&&a.srcAlpha||Ee.SRC_ALPHA],dstRGB:Dl[a&&a.dstRGB||Ee.ONE_MINUS_SRC_ALPHA],dstAlpha:Dl[a&&a.dstAlpha||Ee.ONE_MINUS_SRC_ALPHA]},equation:{rgb:Cp[s&&s.rgb||Ee.FUNC_ADD],alpha:Cp[s&&s.alpha||Ee.FUNC_ADD]},color:c}}}},{key:"initStencilDrawParams",value:function(n,r){var o=n.stencil;if(o){var i=o.enable,a=o.mask,s=a===void 0?-1:a,u=o.func,c=u===void 0?{cmp:Ee.ALWAYS,ref:0,mask:-1}:u,f=o.opFront,l=f===void 0?{fail:Ee.KEEP,zfail:Ee.KEEP,zpass:Ee.KEEP}:f,d=o.opBack,h=d===void 0?{fail:Ee.KEEP,zfail:Ee.KEEP,zpass:Ee.KEEP}:d;r.stencil={enable:!!i,mask:s,func:gu(gu({},c),{},{cmp:SE[c.cmp]}),opFront:{fail:mu[l.fail],zfail:mu[l.zfail],zpass:mu[l.zpass]},opBack:{fail:mu[h.fail],zfail:mu[h.zfail],zpass:mu[h.zpass]}}}}},{key:"initCullDrawParams",value:function(n,r){var o=n.cull;if(o){var i=o.enable,a=o.face,s=a===void 0?Ee.BACK:a;r.cull={enable:!!i,face:TE[s]}}}},{key:"generateDefines",value:function(n){return Object.keys(n).map(function(r){return"#define ".concat(r," ").concat(Number(n[r]))}).join(`
`)}}]),e}(),UE=function(){function e(t,n){ei(this,e),this.texture=void 0,this.width=void 0,this.height=void 0;var r=n.data,o=n.type,i=o===void 0?Ee.UNSIGNED_BYTE:o,a=n.width,s=n.height,u=n.flipY,c=u===void 0?!1:u,f=n.format,l=f===void 0?Ee.RGBA:f,d=n.mipmap,h=d===void 0?!1:d,v=n.wrapS,m=v===void 0?Ee.CLAMP_TO_EDGE:v,g=n.wrapT,E=g===void 0?Ee.CLAMP_TO_EDGE:g,y=n.aniso,b=y===void 0?0:y,w=n.alignment,T=w===void 0?1:w,$=n.premultiplyAlpha,he=$===void 0?!1:$,te=n.mag,j=te===void 0?Ee.NEAREST:te,q=n.min,ve=q===void 0?Ee.NEAREST:q,k=n.colorSpace,pe=k===void 0?Ee.BROWSER_DEFAULT_WEBGL:k;this.width=a,this.height=s;var Pe={width:a,height:s,type:ch[i],format:bE[l],wrapS:Dp[m],wrapT:Dp[E],mag:Rp[j],min:Rp[ve],alignment:T,flipY:c,colorSpace:wE[pe],premultiplyAlpha:he,aniso:b};r&&(Pe.data=r),typeof h=="number"?Pe.mipmap=xE[h]:typeof h=="boolean"&&(Pe.mipmap=h),this.texture=t.texture(Pe)}return ti(e,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(n){var r=n.width,o=n.height;this.texture.resize(r,o),this.width=r,this.height=o}},{key:"destroy",value:function(){this.texture.destroy()}}]),e}(),VE=function(){function e(){var t=this;ei(this,e),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var n=Ia(Xr().mark(function r(o){return Xr().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!o.uniforms){a.next=3;break}return a.next=3,Promise.all(Object.keys(o.uniforms).map(function(){var s=Ia(Xr().mark(function u(c){var f;return Xr().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!(o.uniforms[c]&&o.uniforms[c].load!==void 0)){d.next=5;break}return d.next=3,o.uniforms[c].load();case 3:f=d.sent,o.uniforms[c]=f;case 5:case"end":return d.stop()}},u)}));return function(u){return s.apply(this,arguments)}}()));case 3:return a.abrupt("return",new BE(t.gl,o));case 4:case"end":return a.stop()}},r)}));return function(r){return n.apply(this,arguments)}}(),this.createAttribute=function(n){return new yE(t.gl,n)},this.createBuffer=function(n){return new IE(t.gl,n)},this.createElements=function(n){return new kE(t.gl,n)},this.createTexture2D=function(n){return new UE(t.gl,n)},this.createFramebuffer=function(n){return new GE(t.gl,n)},this.useFramebuffer=function(n,r){t.gl({framebuffer:n?n.get():null})(r)},this.createComputeModel=function(){var n=Ia(Xr().mark(function r(o){return Xr().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",new ME(t.gl,o));case 1:case"end":return a.stop()}},r)}));return function(r){return n.apply(this,arguments)}}(),this.clear=function(n){var r=n.color,o=n.depth,i=n.stencil,a=n.framebuffer,s=a===void 0?null:a,u={color:r,depth:o,stencil:i};u.framebuffer=s===null?s:s.get(),t.gl.clear(u)},this.setScissor=function(n){t.gl&&t.gl._gl&&(n.enable&&n.box?(t.gl._gl.enable(Ee.SCISSOR_TEST),t.gl._gl.scissor(n.box.x,n.box.y,n.box.width,n.box.height)):t.gl._gl.disable(Ee.SCISSOR_TEST),t.gl._refresh())},this.viewport=function(n){var r=n.x,o=n.y,i=n.width,a=n.height;t.gl&&t.gl._gl&&(t.gl._gl.viewport(r,o,i,a),t.gl._refresh())},this.readPixels=function(n){var r=n.framebuffer,o=n.x,i=n.y,a=n.width,s=n.height,u={x:o,y:i,width:a,height:s};return r&&(u.framebuffer=r.get()),t.gl.read(u)},this.getCanvas=function(){return t.$canvas},this.getGLContext=function(){return t.gl._gl},this.destroy=function(){t.gl&&(t.gl.destroy(),t.inited=!1)}}return ti(e,[{key:"init",value:function(){var t=Ia(Xr().mark(function r(o){return Xr().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!this.inited){a.next=2;break}return a.abrupt("return");case 2:return this.$canvas=o.canvas,a.next=5,new Promise(function(s,u){gE()({canvas:o.canvas,attributes:{alpha:!0,antialias:o.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(f,l){(f||!l)&&u(f),s(l)}})});case 5:this.gl=a.sent,this.inited=!0;case 7:case"end":return a.stop()}},r,this)}));function n(r){return t.apply(this,arguments)}return n}()},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),e}(),Ol=function(){function e(){ei(this,e),this.engine=void 0,this.configService=new dE}return ti(e,[{key:"setConfig",value:function(n){this.configService.set(n)}},{key:"setEngine",value:function(n){this.engine=n}},{key:"createEntity",value:function(){return Sp()}},{key:"createKernel",value:function(n){var r=new pE(this.engine,this.configService);return typeof n=="string"?r.setBundle(JSON.parse(n)):r.setBundle(n),r.init(),r}},{key:"destroy",value:function(){this.engine.destroy()}}],[{key:"create",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=new e;return r.setConfig(n),r.setEngine(new VE),r}}]),e}();const yu=(e,t)=>{let n;return e?be(e)?n=()=>e:n=e:n=()=>t||1,n},XE=(e,t)=>{const n=[],r=[],o={};let i=0;for(i=0;i<e.length;i++){const s=e[i];o[s.id]=i,n.push(s.x),n.push(s.y),n.push(0),n.push(0),r.push([])}for(i=0;i<t.length;i++){const s=t[i],u=Je(s,"source"),c=Je(s,"target");!isNaN(o[u])&&!isNaN(o[c])&&(r[o[u]].push(o[c]),r[o[c]].push(o[u]))}let a=0;for(i=0;i<e.length;i++){const s=n.length,u=r[i],c=u.length;n[i*4+2]=s,n[i*4+3]=c,a=Math.max(a,c);for(let f=0;f<c;++f){const l=u[f];n.push(+l)}}for(;n.length%4!==0;)n.push(0);return{maxEdgePerVetex:a,array:new Float32Array(n)}},$E=(e,t,n,r)=>{const o=[],i=[],a={};let s=0;for(s=0;s<e.length;s++){const c=e[s];a[c.id]=s,o.push(c.x),o.push(c.y),o.push(0),o.push(0),i.push([])}for(s=0;s<t.length;s++){const c=t[s],f=Je(c,"source"),l=Je(c,"target");i[a[f]].push(a[l]),i[a[f]].push(n(c)),i[a[f]].push(r(c)),i[a[f]].push(0),i[a[l]].push(a[f]),i[a[l]].push(n(c)),i[a[l]].push(r(c)),i[a[l]].push(0)}let u=0;for(s=0;s<e.length;s++){const c=o.length,f=i[s],l=f.length;o[s*4+2]=c+1048576*l/4,o[s*4+3]=0,u=Math.max(u,l/4);for(let d=0;d<l;++d){const h=f[d];o.push(+h)}}for(;o.length%4!==0;)o.push(0);return{maxEdgePerVetex:u,array:new Float32Array(o)}},WE=(e,t)=>{const n=[],r=e.length,o={};return t.forEach(i=>{e.forEach((a,s)=>{if(o[i[a]]===void 0&&(o[i[a]]=Object.keys(o).length),n.push(o[i[a]]),s===r-1)for(;n.length%4!==0;)n.push(0)})}),{array:new Float32Array(n),count:Object.keys(o).length}},Gp=e=>{const t=[],n=e.length,r=e[0].length;for(let o=0;o<r;o++)e.forEach((i,a)=>{if(t.push(i[o]),a===n-1)for(;t.length%4!==0;)t.push(0)});return new Float32Array(t)},_b=null,HE='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',Sb=null,ZE='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}';var Ll=function(e,t,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(f){try{c(r.next(f))}catch(l){a(l)}}function u(f){try{c(r.throw(f))}catch(l){a(l)}}function c(f){f.done?i(f.value):o(f.value).then(s,u)}c((r=r.apply(e,t||[])).next())})};class jE extends $e{constructor(t){super(),this.maxIteration=1e3,this.gravity=10,this.speed=1,this.clustering=!1,this.clusterField="cluster",this.clusterGravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(t)}getDefaultCfg(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}}execute(){return Ll(this,void 0,void 0,function*(){const t=this,n=t.nodes;if(!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]);const r=t.center;if(n.length===1){n[0].x=r[0],n[0].y=r[1],t.onLayoutEnd&&t.onLayoutEnd();return}const o={},i={};n.forEach((a,s)=>{be(a.x)||(a.x=Math.random()*this.width),be(a.y)||(a.y=Math.random()*this.height),o[a.id]=a,i[a.id]=s}),t.nodeMap=o,t.nodeIdxMap=i,yield t.run()})}executeWithWorker(t,n){return Ll(this,void 0,void 0,function*(){const r=this,o=r.nodes,i=r.center;if(!o||o.length===0)return;if(o.length===1){o[0].x=i[0],o[0].y=i[1];return}const a={},s={};o.forEach((u,c)=>{be(u.x)||(u.x=Math.random()*this.width),be(u.y)||(u.y=Math.random()*this.height),a[u.id]=u,s[u.id]=c}),r.nodeMap=a,r.nodeIdxMap=s,yield r.run(t,n)})}run(t,n){return Ll(this,void 0,void 0,function*(){const r=this,o=r.nodes,i=r.edges,a=r.maxIteration,s=r.center,u=r.height*r.width;let c=Math.sqrt(u)/10;const f=u/(o.length+1),l=Math.sqrt(f),d=r.speed,h=r.clustering,{array:v,count:m}=WE([r.clusterField],o);o.forEach((q,ve)=>{let k=0,pe=0;be(q.fx)&&be(q.fy)&&(k=q.fx||.001,pe=q.fy||.001),v[4*ve+1]=k,v[4*ve+2]=pe});const g=o.length,{maxEdgePerVetex:E,array:y}=XE(o,i),b=r.workerEnabled;let w;b?w=Ol.create({canvas:t,engineOptions:{supportCompute:!0}}):w=Ol.create({engineOptions:{supportCompute:!0}});const T=r.onLayoutEnd,$=[];for(let q=0;q<m;q++)$.push(0,0,0,0);const he=w.createKernel(HE).setDispatch([g,1,1]).setBinding({u_Data:y,u_K:l,u_K2:f,u_Gravity:r.gravity,u_ClusterGravity:r.clusterGravity||r.gravity||1,u_Speed:d,u_MaxDisplace:c,u_Clustering:h?1:0,u_Center:s,u_AttributeArray:v,u_ClusterCenters:$,MAX_EDGE_PER_VERTEX:E,VERTEX_COUNT:g});let te;h&&(te=w.createKernel(ZE).setDispatch([m,1,1]).setBinding({u_Data:y,u_NodeAttributes:v,u_ClusterCenters:$,VERTEX_COUNT:g,CLUSTER_COUNT:m})),yield(()=>Ll(this,void 0,void 0,function*(){for(let ve=0;ve<a;ve++)yield he.execute(),h&&(te.setBinding({u_Data:he}),yield te.execute(),he.setBinding({u_ClusterCenters:te})),he.setBinding({u_MaxDisplace:c*=.99});const q=yield he.getOutput();t?n.postMessage({type:mn.GPUEND,vertexEdgeData:q}):o.forEach((ve,k)=>{const pe=q[4*k],Pe=q[4*k+1];ve.x=pe,ve.y=Pe}),T&&T()}))()})}getType(){return"fruchterman-gpu"}}const Tb=null,YE='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {float distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\ngl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',Ib=null,KE='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}';var dh=function(e,t,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(f){try{c(r.next(f))}catch(l){a(l)}}function u(f){try{c(r.throw(f))}catch(l){a(l)}}function c(f){f.done?i(f.value):o(f.value).then(s,u)}c((r=r.apply(e,t||[])).next())})};class qE extends $e{constructor(t){super(),this.maxIteration=1e3,this.edgeStrength=200,this.nodeStrength=1e3,this.coulombDisScale=.005,this.damping=.9,this.maxSpeed=1e3,this.minMovement=.5,this.interval=.02,this.factor=1,this.linkDistance=1,this.gravity=10,this.workerEnabled=!1,this.nodes=[],this.edges=[],this.width=300,this.height=300,this.nodeMap={},this.nodeIdxMap={},this.updateCfg(t)}getDefaultCfg(){return{maxIteration:2e3,gravity:10,clustering:!1,clusterGravity:10}}execute(){return dh(this,void 0,void 0,function*(){const t=this,n=t.nodes;if(!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight),t.center||(t.center=[t.width/2,t.height/2]);const r=t.center;if(n.length===1){n[0].x=r[0],n[0].y=r[1],t.onLayoutEnd&&t.onLayoutEnd();return}const o={},i={};n.forEach((a,s)=>{be(a.x)||(a.x=Math.random()*t.width),be(a.y)||(a.y=Math.random()*t.height),o[a.id]=a,i[a.id]=s}),t.nodeMap=o,t.nodeIdxMap=i,t.nodeStrength=yu(t.nodeStrength,1),t.edgeStrength=yu(t.edgeStrength,1),yield t.run()})}executeWithWorker(t,n){const r=this,o=r.nodes,i=r.center;if(!o||o.length===0)return;if(o.length===1){o[0].x=i[0],o[0].y=i[1];return}const a={},s={};o.forEach((u,c)=>{be(u.x)||(u.x=Math.random()*r.width),be(u.y)||(u.y=Math.random()*r.height),a[u.id]=u,s[u.id]=c}),r.nodeMap=a,r.nodeIdxMap=s,r.nodeStrength=yu(r.nodeStrength,1),r.edgeStrength=yu(r.edgeStrength,1),r.run(t,n)}run(t,n){return dh(this,void 0,void 0,function*(){const r=this,o=r.nodes,i=r.edges,a=r.maxIteration;!r.width&&typeof window!="undefined"&&(r.width=window.innerWidth),!r.height&&typeof window!="undefined"&&(r.height=window.innerHeight);const s=o.length;r.linkDistance=yu(r.linkDistance),r.edgeStrength=yu(r.edgeStrength);const{maxEdgePerVetex:u,array:c}=$E(o,i,r.linkDistance,r.edgeStrength);r.degrees=hn(o.length,r.nodeIdxMap,i).map(k=>k.all);const f=[],l=[],d=[],h=[],v=[],m=[],g=[];r.getMass||(r.getMass=k=>r.degrees[r.nodeIdxMap[k.id]]||1);const E=r.gravity,y=r.center;o.forEach((k,pe)=>{f.push(r.getMass(k)),l.push(r.nodeStrength(k)),r.degrees[pe]||(r.degrees[pe]=0);let Pe=[y[0],y[1],E];if(r.getCenter){const Ue=r.getCenter(k,r.degrees[pe]);Ue&&be(Ue[0])&&be(Ue[1])&&be(Ue[2])&&(Pe=Ue)}d.push(Pe[0]),h.push(Pe[1]),v.push(Pe[2]),be(k.fx)&&be(k.fy)?(m.push(k.fx||.001),g.push(k.fy||.001)):(m.push(0),g.push(0))});const b=Gp([f,r.degrees,l,m]),w=Gp([d,h,v,g]),T=r.workerEnabled;let $;T?$=Ol.create({canvas:t,engineOptions:{supportCompute:!0}}):$=Ol.create({engineOptions:{supportCompute:!0}});const he=r.onLayoutEnd,te=[];c.forEach(k=>{te.push(k)});for(let k=0;k<4;k++)te.push(0);const j=$.createKernel(YE).setDispatch([s,1,1]).setBinding({u_Data:c,u_damping:r.damping,u_maxSpeed:r.maxSpeed,u_minMovement:r.minMovement,u_coulombDisScale:r.coulombDisScale,u_factor:r.factor,u_NodeAttributeArray1:b,u_NodeAttributeArray2:w,MAX_EDGE_PER_VERTEX:u,VERTEX_COUNT:s,u_AveMovement:te,u_interval:r.interval}),q=$.createKernel(KE).setDispatch([1,1,1]).setBinding({u_Data:c,VERTEX_COUNT:s,u_AveMovement:[0,0,0,0]});yield(()=>dh(this,void 0,void 0,function*(){for(let pe=0;pe<a;pe++){yield j.execute(),q.setBinding({u_Data:j}),yield q.execute();const Pe=Math.max(.02,r.interval-pe*.002);j.setBinding({u_interval:Pe,u_AveMovement:q})}const k=yield j.getOutput();t?n.postMessage({type:mn.GPUEND,vertexEdgeData:k}):o.forEach((pe,Pe)=>{const Ue=k[4*Pe],mt=k[4*Pe+1];pe.x=Ue,pe.y=mt}),he&&he()}))()})}getType(){return"gForce-gpu"}}class QE extends $e{constructor(t){super(),this.center=[0,0],this.maxIteration=100,this.gravity=10,this.comboGravity=10,this.linkDistance=10,this.alpha=1,this.alphaMin=.001,this.alphaDecay=1-Math.pow(this.alphaMin,1/300),this.alphaTarget=0,this.velocityDecay=.6,this.edgeStrength=.6,this.nodeStrength=30,this.preventOverlap=!1,this.preventNodeOverlap=!1,this.preventComboOverlap=!1,this.collideStrength=void 0,this.nodeCollideStrength=.5,this.comboCollideStrength=.5,this.comboSpacing=20,this.comboPadding=10,this.optimizeRangeFactor=1,this.onTick=()=>{},this.onLayoutEnd=()=>{},this.depthAttractiveForceScale=1,this.depthRepulsiveForceScale=2,this.nodes=[],this.edges=[],this.combos=[],this.comboTrees=[],this.width=300,this.height=300,this.bias=[],this.nodeMap={},this.oriComboMap={},this.indexMap={},this.comboMap={},this.previousLayouted=!1,this.updateCfg(t)}getDefaultCfg(){return{maxIteration:100,center:[0,0],gravity:10,speed:1,comboGravity:30,preventOverlap:!1,preventComboOverlap:!0,preventNodeOverlap:!0,nodeSpacing:void 0,collideStrength:void 0,nodeCollideStrength:.5,comboCollideStrength:.5,comboSpacing:20,comboPadding:10,edgeStrength:.6,nodeStrength:30,linkDistance:10}}execute(){const t=this,n=t.nodes,r=t.center;if(t.comboTree={id:"comboTreeRoot",depth:-1,children:t.comboTrees},!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}if(n.length===1){n[0].x=r[0],n[0].y=r[1],t.onLayoutEnd&&t.onLayoutEnd();return}t.initVals(),t.run(),t.onLayoutEnd&&t.onLayoutEnd()}run(){const t=this,n=t.nodes,r=t.previousLayouted?t.maxIteration/5:t.maxIteration;!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight);const o=t.center,i=t.velocityDecay,a=t.comboMap;t.previousLayouted||t.initPos(a);for(let c=0;c<r;c++){const f=[];n.forEach((l,d)=>{f[d]={x:0,y:0}}),t.applyCalculate(f),t.applyComboCenterForce(f),n.forEach((l,d)=>{!be(l.x)||!be(l.y)||(l.x+=f[d].x*i,l.y+=f[d].y*i)}),t.alpha+=(t.alphaTarget-t.alpha)*t.alphaDecay,t.onTick()}const s=[0,0];n.forEach(c=>{!be(c.x)||!be(c.y)||(s[0]+=c.x,s[1]+=c.y)}),s[0]/=n.length,s[1]/=n.length;const u=[o[0]-s[0],o[1]-s[1]];n.forEach((c,f)=>{!be(c.x)||!be(c.y)||(c.x+=u[0],c.y+=u[1])}),t.combos.forEach(c=>{const f=a[c.id];f&&f.empty&&(c.x=f.cx||c.x,c.y=f.cy||c.y)}),t.previousLayouted=!0}initVals(){const t=this,n=t.edges,r=t.nodes,o=t.combos,i={},a={},s={};r.forEach((q,ve)=>{a[q.id]=q,s[q.id]=ve}),t.nodeMap=a,t.indexMap=s;const u={};o.forEach(q=>{u[q.id]=q}),t.oriComboMap=u,t.comboMap=t.getComboMap();const c=t.preventOverlap;t.preventComboOverlap=t.preventComboOverlap||c,t.preventNodeOverlap=t.preventNodeOverlap||c;const f=t.collideStrength;f&&(t.comboCollideStrength=f,t.nodeCollideStrength=f),t.comboCollideStrength=t.comboCollideStrength?t.comboCollideStrength:0,t.nodeCollideStrength=t.nodeCollideStrength?t.nodeCollideStrength:0;for(let q=0;q<n.length;++q){const ve=Je(n[q],"source"),k=Je(n[q],"target");i[ve]?i[ve]++:i[ve]=1,i[k]?i[k]++:i[k]=1}const l=[];for(let q=0;q<n.length;++q){const ve=Je(n[q],"source"),k=Je(n[q],"target");l[q]=i[ve]/(i[ve]+i[k])}this.bias=l;const d=t.nodeSize,h=t.nodeSpacing;let v,m;if(be(h)?m=()=>h:ct(h)?m=h:m=()=>0,this.nodeSpacing=m,!d)v=q=>q.size?bt(q.size)?(q.size[0]>q.size[1]?q.size[0]:q.size[1])/2:Ot(q.size)?(q.size.width>q.size.height?q.size.width:q.size.height)/2:q.size/2:10;else if(ct(d))v=q=>d(q);else if(bt(d)){const ve=(d[0]>d[1]?d[0]:d[1])/2;v=k=>ve}else{const q=d/2;v=ve=>q}this.nodeSize=v;const g=t.comboSpacing;let E;be(g)?E=()=>g:ct(g)?E=g:E=()=>0,this.comboSpacing=E;const y=t.comboPadding;let b;be(y)?b=()=>y:bt(y)?b=()=>Math.max.apply(null,y):ct(y)?b=y:b=()=>0,this.comboPadding=b;let w=this.linkDistance,T;w||(w=10),be(w)?T=q=>w:T=w,this.linkDistance=T;let $=this.edgeStrength,he;$||($=1),be($)?he=q=>$:he=$,this.edgeStrength=he;let te=this.nodeStrength,j;te||(te=30),be(te)?j=q=>te:j=te,this.nodeStrength=j}initPos(t){this.nodes.forEach((o,i)=>{const a=o.comboId,s=t[a];a&&s?(o.x=s.cx+100/(i+1),o.y=s.cy+100/(i+1)):(o.x=100/(i+1),o.y=100/(i+1))})}getComboMap(){const t=this,n=t.nodeMap,r=t.comboTrees,o=t.oriComboMap,i={};return(r||[]).forEach(a=>{const s=[];tr(a,u=>{if(u.itemType==="node"||!o[u.id])return!0;if(i[u.id]===void 0){const l={id:u.id,name:u.id,cx:0,cy:0,count:0,depth:t.oriComboMap[u.id].depth||0,children:[]};i[u.id]=l}const c=u.children;c&&c.forEach(l=>{if(!i[l.id]&&!n[l.id])return!0;s.push(l)});const f=i[u.id];if(f.cx=0,f.cy=0,s.length===0){f.empty=!0;const l=o[u.id];f.cx=l.x,f.cy=l.y}return s.forEach(l=>{if(f.count++,l.itemType!=="node"){const h=i[l.id];be(h.cx)&&(f.cx+=h.cx),be(h.cy)&&(f.cy+=h.cy);return}const d=n[l.id];d&&(be(d.x)&&(f.cx+=d.x),be(d.y)&&(f.cy+=d.y))}),f.cx/=f.count||1,f.cy/=f.count||1,f.children=s,!0})}),i}applyComboCenterForce(t){const n=this,r=n.gravity,o=n.comboGravity||r,i=this.alpha,a=n.comboTrees,s=n.indexMap,u=n.nodeMap,c=n.comboMap;(a||[]).forEach(f=>{tr(f,l=>{if(l.itemType==="node"||!c[l.id])return!0;const h=c[l.id],v=(h.depth+1)/10*.5,m=h.cx,g=h.cy;return h.cx=0,h.cy=0,h.children.forEach(E=>{if(E.itemType!=="node"){const te=c[E.id];te&&be(te.cx)&&(h.cx+=te.cx),te&&be(te.cy)&&(h.cy+=te.cy);return}const y=u[E.id],b=y.x-m||.005,w=y.y-g||.005,T=Math.sqrt(b*b+w*w),$=s[y.id],he=o*i/T*v;t[$].x-=b*he,t[$].y-=w*he,be(y.x)&&(h.cx+=y.x),be(y.y)&&(h.cy+=y.y)}),h.cx/=h.count||1,h.cy/=h.count||1,!0})})}applyCalculate(t){const n=this,r=n.comboMap,o=n.nodes,i={};o.forEach((s,u)=>{o.forEach((c,f)=>{if(u<f)return;const l=s.x-c.x||.005,d=s.y-c.y||.005;let h=l*l+d*d;const v=Math.sqrt(h);h<1&&(h=v),i[`${s.id}-${c.id}`]={vx:l,vy:d,vl2:h,vl:v},i[`${c.id}-${s.id}`]={vl2:h,vl:v,vx:-l,vy:-d}})}),n.updateComboSizes(r),n.calRepulsive(t,i),n.calAttractive(t,i),n.preventComboOverlap&&n.comboNonOverlapping(t,r)}updateComboSizes(t){const n=this,r=n.comboTrees,o=n.nodeMap,i=n.nodeSize,a=n.comboSpacing,s=n.comboPadding;(r||[]).forEach(u=>{const c=[];tr(u,f=>{if(f.itemType==="node")return!0;const l=t[f.id];if(!l)return!1;const d=f.children;d&&d.forEach(m=>{!t[m.id]&&!o[m.id]||c.push(m)}),l.minX=1/0,l.minY=1/0,l.maxX=-1/0,l.maxY=-1/0,c.forEach(m=>{if(m.itemType!=="node")return!0;const g=o[m.id];if(!g)return!0;const E=i(g),y=g.x-E,b=g.y-E,w=g.x+E,T=g.y+E;l.minX>y&&(l.minX=y),l.minY>b&&(l.minY=b),l.maxX<w&&(l.maxX=w),l.maxY<T&&(l.maxY=T)});let h=n.oriComboMap[f.id].size||10;bt(h)&&(h=h[0]);const v=Math.max(l.maxX-l.minX,l.maxY-l.minY,h);return l.r=v/2+a(l)/2+s(l),!0})})}comboNonOverlapping(t,n){const r=this,o=r.comboTree,i=r.comboCollideStrength,a=r.indexMap,s=r.nodeMap;tr(o,u=>{if(!n[u.id]&&!s[u.id]&&u.id!=="comboTreeRoot")return!1;const c=u.children;return c&&c.length>1&&c.forEach((f,l)=>{if(f.itemType==="node")return!1;const d=n[f.id];d&&c.forEach((h,v)=>{if(l<=v||h.itemType==="node")return!1;const m=n[h.id];if(!m)return!1;const g=d.cx-m.cx||.005,E=d.cy-m.cy||.005,y=g*g+E*E,b=d.r||1,w=m.r||1,T=b+w,$=w*w,he=b*b;if(y<T*T){const te=f.children;if(!te||te.length===0)return!1;const j=h.children;if(!j||j.length===0)return!1;const q=Math.sqrt(y),ve=(T-q)/q*i,k=g*ve,pe=E*ve,Pe=$/(he+$),Ue=1-Pe;te.forEach(mt=>{if(mt.itemType!=="node")return!1;if(!s[mt.id])return;const Ke=a[mt.id];j.forEach(Et=>{if(Et.itemType!=="node"||!s[Et.id])return!1;const dt=a[Et.id];t[Ke].x+=k*Pe,t[Ke].y+=pe*Pe,t[dt].x-=k*Ue,t[dt].y-=pe*Ue})})}})}),!0})}calRepulsive(t,n){const r=this,o=r.nodes,i=r.width*r.optimizeRangeFactor,a=r.nodeStrength,s=r.alpha,u=r.nodeCollideStrength,c=r.preventNodeOverlap,f=r.nodeSize,l=r.nodeSpacing,d=r.depthRepulsiveForceScale,h=r.center;o.forEach((v,m)=>{if(!(!v.x||!v.y)){if(h){const g=r.gravity,E=v.x-h[0]||.005,y=v.y-h[1]||.005,b=Math.sqrt(E*E+y*y);t[m].x-=E*g*s/b,t[m].y-=y*g*s/b}o.forEach((g,E)=>{if(m===E||!g.x||!g.y)return;const{vl2:y,vl:b}=n[`${v.id}-${g.id}`];if(b>i)return;const{vx:w,vy:T}=n[`${v.id}-${g.id}`];let $=Math.log(Math.abs(g.depth-v.depth)/10)+1||1;$=$<1?1:$,g.comboId!==v.comboId&&($+=1);const he=$?Math.pow(d,$):1,te=a(g)*s/y*he;if(t[m].x+=w*te,t[m].y+=T*te,m<E&&c){const j=f(v)+l(v)||1,q=f(g)+l(g)||1,ve=j+q;if(y<ve*ve){const k=(ve-b)/b*u,pe=q*q;let Pe=pe/(j*j+pe);const Ue=w*k,mt=T*k;t[m].x+=Ue*Pe,t[m].y+=mt*Pe,Pe=1-Pe,t[E].x-=Ue*Pe,t[E].y-=mt*Pe}}})}})}calAttractive(t,n){const r=this,o=r.edges,i=r.linkDistance,a=r.alpha,s=r.edgeStrength,u=r.bias,c=r.depthAttractiveForceScale;o.forEach((f,l)=>{const d=Je(f,"source"),h=Je(f,"target");if(!d||!h||d===h)return;const v=r.indexMap[d],m=r.indexMap[h],g=r.nodeMap[d],E=r.nodeMap[h];if(!g||!E)return;let y=g.depth===E.depth?0:Math.log(Math.abs(g.depth-E.depth)/10);g.comboId===E.comboId&&(y=y/2);let b=y?Math.pow(c,y):1;if(g.comboId!==E.comboId&&b===1?b=c/2:g.comboId===E.comboId&&(b=2),!be(E.x)||!be(g.x)||!be(E.y)||!be(g.y))return;const{vl:w,vx:T,vy:$}=n[`${h}-${d}`],he=(w-i(f))/w*a*s(f)*b,te=T*he,j=$*he,q=u[l];t[m].x-=te*q,t[m].y-=j*q,t[v].x+=te*(1-q),t[v].y+=j*(1-q)})}getType(){return"comboForce"}}class JE extends $e{constructor(t){super(),this.center=[0,0],this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.comboPadding=10,this.comboTrees=[],this.updateCfg(t)}getDefaultCfg(){return{}}execute(){const t=this,n=t.nodes,r=t.center;if(!n||n.length===0){t.onLayoutEnd&&t.onLayoutEnd();return}if(n.length===1){n[0].x=r[0],n[0].y=r[1],t.onLayoutEnd&&t.onLayoutEnd();return}t.initVals(),t.run(),t.onLayoutEnd&&t.onLayoutEnd()}run(){var t;const n=this,{nodes:r,edges:o,combos:i,comboEdges:a,center:s}=n,u={};r.forEach(E=>{u[E.id]=E});const c={};i.forEach(E=>{c[E.id]=E});const f=n.getInnerGraphs(u),l=[],d=[],h={};let v=!0;this.comboTrees.forEach(E=>{const y=f[E.id],b=Object.assign(Object.assign({},E),{x:y.x||c[E.id].x,y:y.y||c[E.id].y,fx:y.fx||c[E.id].fx,fy:y.fy||c[E.id].fy,mass:y.mass||c[E.id].mass,size:y.size});d.push(b),!isNaN(b.x)&&b.x!==0&&!isNaN(b.y)&&b.y!==0?v=!1:(b.x=Math.random()*100,b.y=Math.random()*100),l.push(E.id),tr(E,w=>(w.id!==E.id&&(h[w.id]=E.id),!0))}),r.forEach(E=>{if(E.comboId&&c[E.comboId])return;const y=Object.assign({},E);d.push(y),!isNaN(y.x)&&y.x!==0&&!isNaN(y.y)&&y.y!==0?v=!1:(y.x=Math.random()*100,y.y=Math.random()*100),l.push(E.id)});const m=[];if(o.concat(a).forEach(E=>{const y=h[E.source]||E.source,b=h[E.target]||E.target;y!==b&&l.includes(y)&&l.includes(b)&&m.push({source:y,target:b})}),d!=null&&d.length){if(d.length===1)d[0].x=s[0],d[0].y=s[1];else{const E={nodes:d,edges:m},y=this.outerLayout||new tn({gravity:1,factor:4,linkDistance:(w,T,$)=>{var he,te;const j=((((he=T.size)===null||he===void 0?void 0:he[0])||30)+(((te=$.size)===null||te===void 0?void 0:te[0])||30))/2;return Math.min(j*1.5,700)}}),b=(t=y.getType)===null||t===void 0?void 0:t.call(y);y.updateCfg({center:s,kg:5,preventOverlap:!0,animate:!1}),v&&Sn[b]&&(d.length<100?new xp:new ft).layout(E),y.layout(E)}d.forEach(E=>{const y=f[E.id];if(!y){const b=u[E.id];b&&(b.x=E.x,b.y=E.y);return}y.visited=!0,y.x=E.x,y.y=E.y,y.nodes.forEach(b=>{b.x+=E.x,b.y+=E.y})})}const g=Object.keys(f);for(let E=g.length-1;E>=0;E--){const y=g[E],b=f[y];b&&(b.nodes.forEach(w=>{b.visited||(w.x+=b.x||0,w.y+=b.y||0),u[w.id]&&(u[w.id].x=w.x,u[w.id].y=w.y)}),c[y]&&(c[y].x=b.x,c[y].y=b.y))}return{nodes:r,edges:o,combos:i,comboEdges:a}}getInnerGraphs(t){const n=this,{comboTrees:r,nodeSize:o,edges:i,comboPadding:a,spacing:s}=n,u={},c=this.innerLayout||new bp({type:"concentric",sortBy:"id"});return c.center=[0,0],c.preventOverlap=!0,c.nodeSpacing=s,(r||[]).forEach(f=>{tr(f,l=>{var d;let h=(a==null?void 0:a(l))||10;if(bt(h)&&(h=Math.max(...h)),!((d=l.children)===null||d===void 0)&&d.length){const v=l.children.map(j=>{if(j.itemType==="combo")return u[j.id];const q=t[j.id]||{};return Object.assign(Object.assign({},q),j)}),m=v.map(j=>j.id),g={nodes:v,edges:i.filter(j=>m.includes(j.source)&&m.includes(j.target))};let E=1/0;v.forEach(j=>{var q;j.size||(j.size=((q=u[j.id])===null||q===void 0?void 0:q.size)||(o==null?void 0:o(j))||[30,30]),be(j.size)&&(j.size=[j.size,j.size]),E>j.size[0]&&(E=j.size[0]),E>j.size[1]&&(E=j.size[1])}),c.layout(g);const{minX:y,minY:b,maxX:w,maxY:T}=Nr(v),$={x:(w+y)/2,y:(T+b)/2};g.nodes.forEach(j=>{j.x-=$.x,j.y-=$.y});const he=Math.max(w-y,E)+h*2,te=Math.max(T-b,E)+h*2;u[l.id]={id:l.id,nodes:v,size:[he,te]}}else if(l.itemType==="combo"){const v=h?[h*2,h*2]:[30,30];u[l.id]={id:l.id,nodes:[],size:v}}return!0})}),u}initVals(){const t=this,n=t.nodeSize,r=t.spacing;let o,i;if(be(r)?i=()=>r:ct(r)?i=r:i=()=>0,this.spacing=i,!n)o=u=>{const c=i(u);return u.size?bt(u.size)?((u.size[0]>u.size[1]?u.size[0]:u.size[1])+c)/2:Ot(u.size)?((u.size.width>u.size.height?u.size.width:u.size.height)+c)/2:(u.size+c)/2:10+c/2};else if(ct(n))o=u=>{const c=n(u),f=i(u);return bt(u.size)?((u.size[0]>u.size[1]?u.size[0]:u.size[1])+f)/2:((c||10)+f)/2};else if(bt(n)){const c=(n[0]>n[1]?n[0]:n[1])/2;o=f=>c+i(f)/2}else{const u=n/2;o=c=>u+i(c)/2}this.nodeSize=o;const a=t.comboPadding;let s;be(a)?s=()=>a:bt(a)?s=()=>Math.max.apply(null,a):ct(a)?s=a:s=()=>0,this.comboPadding=s}getType(){return"comboCombined"}}class hh{constructor(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}distanceTo(t){const n=this.rx-t.rx,r=this.ry-t.ry;return Math.hypot(n,r)}setPos(t,n){this.rx=t,this.ry=n}resetForce(){this.fx=0,this.fy=0}addForce(t){const n=t.rx-this.rx,r=t.ry-this.ry;let o=Math.hypot(n,r);o=o<1e-4?1e-4:o;const i=this.g*(this.degree+1)*(t.degree+1)/o;this.fx+=i*n/o,this.fy+=i*r/o}in(t){return t.contains(this.rx,this.ry)}add(t){const n=this.mass+t.mass,r=(this.rx*this.mass+t.rx*t.mass)/n,o=(this.ry*this.mass+t.ry*t.mass)/n,i=this.degree+t.degree,a={rx:r,ry:o,mass:n,degree:i};return new hh(a)}}class Eu{constructor(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}getLength(){return this.length}contains(t,n){const r=this.length/2;return t<=this.xmid+r&&t>=this.xmid-r&&n<=this.ymid+r&&n>=this.ymid-r}NW(){const t=this.xmid-this.length/4,n=this.ymid+this.length/4,r=this.length/2,o={xmid:t,ymid:n,length:r};return new Eu(o)}NE(){const t=this.xmid+this.length/4,n=this.ymid+this.length/4,r=this.length/2,o={xmid:t,ymid:n,length:r};return new Eu(o)}SW(){const t=this.xmid-this.length/4,n=this.ymid-this.length/4,r=this.length/2,o={xmid:t,ymid:n,length:r};return new Eu(o)}SE(){const t=this.xmid+this.length/4,n=this.ymid-this.length/4,r=this.length/2,o={xmid:t,ymid:n,length:r};return new Eu(o)}}class bu{constructor(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,t!=null&&(this.quad=t)}insert(t){if(this.body==null){this.body=t;return}this._isExternal()?(this.quad&&(this.NW=new bu(this.quad.NW()),this.NE=new bu(this.quad.NE()),this.SW=new bu(this.quad.SW()),this.SE=new bu(this.quad.SE())),this._putBody(this.body),this._putBody(t),this.body=this.body.add(t)):(this.body=this.body.add(t),this._putBody(t))}_putBody(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))}_isExternal(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null}updateForce(t){if(!(this.body==null||t===this.body))if(this._isExternal())t.addForce(this.body);else{const n=this.quad?this.quad.getLength():0,r=this.body.distanceTo(t);n/r<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t))}}}class eb extends $e{constructor(t){super(),this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.kr=5,this.kg=1,this.mode="normal",this.preventOverlap=!1,this.dissuadeHubs=!1,this.barnesHut=void 0,this.maxIteration=0,this.ks=.1,this.ksmax=10,this.tao=.1,this.onLayoutEnd=()=>{},this.prune=void 0,this.updateCfg(t)}getDefaultCfg(){return{}}execute(){const t=this,{nodes:n,onLayoutEnd:r,prune:o}=t;let i=t.maxIteration;!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight);const a=[],s=n.length;for(let u=0;u<s;u+=1){const c=n[u];let f=10,l=10;be(c.size)&&(f=c.size,l=c.size),bt(c.size)?(isNaN(c.size[0])||(f=c.size[0]),isNaN(c.size[1])||(l=c.size[1])):Ot(c.size)&&(f=c.size.width,l=c.size.height),t.getWidth&&!isNaN(t.getWidth(c))&&(l=t.getWidth(c)),t.getHeight&&!isNaN(t.getHeight(c))&&(f=t.getHeight(c));const d=Math.max(f,l);a.push(d)}t.barnesHut===void 0&&s>250&&(t.barnesHut=!0),t.prune===void 0&&s>100&&(t.prune=!0),this.maxIteration===0&&!t.prune?(i=250,s<=200&&s>100?i=1e3:s>200&&(i=1200),this.maxIteration=i):this.maxIteration===0&&o&&(i=100,s<=200&&s>100?i=500:s>200&&(i=950),this.maxIteration=i),t.kr||(t.kr=50,s>100&&s<=500?t.kr=20:s>500&&(t.kr=1)),t.kg||(t.kg=20,s>100&&s<=500?t.kg=10:s>500&&(t.kg=1)),this.nodes=t.updateNodesByForces(a),r()}updateNodesByForces(t){const n=this,{edges:r,maxIteration:o}=n;let i=n.nodes;const a=r.filter(v=>{const m=Je(v,"source"),g=Je(v,"target");return m!==g}),s=i.length,u=a.length,c=[],f={},l={},d=[];for(let v=0;v<s;v+=1)f[i[v].id]=v,c[v]=0,(i[v].x===void 0||isNaN(i[v].x))&&(i[v].x=Math.random()*1e3),(i[v].y===void 0||isNaN(i[v].y))&&(i[v].y=Math.random()*1e3),d.push({x:i[v].x,y:i[v].y});for(let v=0;v<u;v+=1){let m,g,E=0,y=0;for(let b=0;b<s;b+=1){const w=Je(a[v],"source"),T=Je(a[v],"target");i[b].id===w?(m=i[b],E=b):i[b].id===T&&(g=i[b],y=b),l[v]={sourceIdx:E,targetIdx:y}}m&&(c[f[m.id]]+=1),g&&(c[f[g.id]]+=1)}let h=o;if(i=this.iterate(h,f,l,u,c,t),n.prune){for(let v=0;v<u;v+=1)c[l[v].sourceIdx]<=1?(i[l[v].sourceIdx].x=i[l[v].targetIdx].x,i[l[v].sourceIdx].y=i[l[v].targetIdx].y):c[l[v].targetIdx]<=1&&(i[l[v].targetIdx].x=i[l[v].sourceIdx].x,i[l[v].targetIdx].y=i[l[v].sourceIdx].y);n.prune=!1,n.barnesHut=!1,h=100,i=this.iterate(h,f,l,u,c,t)}return i}iterate(t,n,r,o,i,a){const s=this;let{nodes:u}=s;const{kr:c,preventOverlap:f}=s,{barnesHut:l}=s,d=u.length;let h=0;const v=100;let m=t;const g=50;let E=[];const y=[],b=[];for(let w=0;w<d;w+=1)if(E[2*w]=0,E[2*w+1]=0,l){const T={id:w,rx:u[w].x,ry:u[w].y,mass:1,g:c,degree:i[w]};b[w]=new hh(T)}for(;m>0;){for(let T=0;T<d;T+=1)y[2*T]=E[2*T],y[2*T+1]=E[2*T+1],E[2*T]=0,E[2*T+1]=0;E=this.getAttrForces(m,g,o,n,r,i,a,E),l&&(f&&m>g||!f)?E=this.getOptRepGraForces(E,b,i):E=this.getRepGraForces(m,g,E,v,a,i);const w=this.updatePos(E,y,h,i);u=w.nodes,h=w.sg,m--,s.tick&&s.tick()}return u}getAttrForces(t,n,r,o,i,a,s,u){const c=this,{nodes:f,preventOverlap:l,dissuadeHubs:d,mode:h,prune:v}=c;for(let m=0;m<r;m+=1){const g=f[i[m].sourceIdx],E=i[m].sourceIdx,y=f[i[m].targetIdx],b=i[m].targetIdx;if(v&&(a[E]<=1||a[b]<=1))continue;const w=[y.x-g.x,y.y-g.y];let T=Math.hypot(w[0],w[1]);T=T<1e-4?1e-4:T,w[0]=w[0]/T,w[1]=w[1]/T,l&&t<n&&(T=T-s[E]-s[b]);let $=T,he=$;h==="linlog"&&($=Math.log(1+T),he=$),d&&($=T/a[E],he=T/a[b]),l&&t<n&&T<=0?($=0,he=0):l&&t<n&&T>0&&($=T,he=T),u[2*o[g.id]]+=$*w[0],u[2*o[y.id]]-=he*w[0],u[2*o[g.id]+1]+=$*w[1],u[2*o[y.id]+1]-=he*w[1]}return u}getRepGraForces(t,n,r,o,i,a){const s=this,{nodes:u,preventOverlap:c,kr:f,kg:l,center:d,prune:h}=s,v=u.length;for(let m=0;m<v;m+=1){for(let b=m+1;b<v;b+=1){if(h&&(a[m]<=1||a[b]<=1))continue;const w=[u[b].x-u[m].x,u[b].y-u[m].y];let T=Math.hypot(w[0],w[1]);T=T<1e-4?1e-4:T,w[0]=w[0]/T,w[1]=w[1]/T,c&&t<n&&(T=T-i[m]-i[b]);let $=f*(a[m]+1)*(a[b]+1)/T;c&&t<n&&T<0?$=o*(a[m]+1)*(a[b]+1):c&&t<n&&T===0?$=0:c&&t<n&&T>0&&($=f*(a[m]+1)*(a[b]+1)/T),r[2*m]-=$*w[0],r[2*b]+=$*w[0],r[2*m+1]-=$*w[1],r[2*b+1]+=$*w[1]}const g=[u[m].x-d[0],u[m].y-d[1]],E=Math.hypot(g[0],g[1]);g[0]=g[0]/E,g[1]=g[1]/E;const y=l*(a[m]+1);r[2*m]-=y*g[0],r[2*m+1]-=y*g[1]}return r}getOptRepGraForces(t,n,r){const o=this,{nodes:i,kg:a,center:s,prune:u}=o,c=i.length;let f=9e10,l=-9e10,d=9e10,h=-9e10;for(let y=0;y<c;y+=1)u&&r[y]<=1||(n[y].setPos(i[y].x,i[y].y),i[y].x>=l&&(l=i[y].x),i[y].x<=f&&(f=i[y].x),i[y].y>=h&&(h=i[y].y),i[y].y<=d&&(d=i[y].y));const v=Math.max(l-f,h-d),m={xmid:(l+f)/2,ymid:(h+d)/2,length:v,massCenter:s,mass:c},g=new Eu(m),E=new bu(g);for(let y=0;y<c;y+=1)u&&r[y]<=1||n[y].in(g)&&E.insert(n[y]);for(let y=0;y<c;y+=1){if(u&&r[y]<=1)continue;n[y].resetForce(),E.updateForce(n[y]),t[2*y]-=n[y].fx,t[2*y+1]-=n[y].fy;const b=[i[y].x-s[0],i[y].y-s[1]];let w=Math.hypot(b[0],b[1]);w=w<1e-4?1e-4:w,b[0]=b[0]/w,b[1]=b[1]/w;const T=a*(r[y]+1);t[2*y]-=T*b[0],t[2*y+1]-=T*b[1]}return t}updatePos(t,n,r,o){const i=this,{nodes:a,ks:s,tao:u,prune:c,ksmax:f}=i,l=a.length,d=[],h=[];let v=0,m=0;for(let E=0;E<l;E+=1){if(c&&o[E]<=1)continue;const y=[t[2*E]-n[2*E],t[2*E+1]-n[2*E+1]],b=Math.hypot(y[0],y[1]),w=[t[2*E]+n[2*E],t[2*E+1]+n[2*E+1]],T=Math.hypot(w[0],w[1]);d[E]=b,h[E]=T/2,v+=(o[E]+1)*d[E],m+=(o[E]+1)*h[E]}const g=r;r=u*m/v,g!==0&&(r=r>1.5*g?1.5*g:r);for(let E=0;E<l;E+=1){if(c&&o[E]<=1||be(a[E].fx)&&be(a[E].fy))continue;let y=s*r/(1+r*Math.sqrt(d[E])),b=Math.hypot(t[2*E],t[2*E+1]);b=b<1e-4?1e-4:b;const w=f/b;y=y>w?w:y;const T=y*t[2*E],$=y*t[2*E+1];a[E].x+=T,a[E].y+=$}return{nodes:a,sg:r}}}class Wi{constructor(){this.cells=[],this.columnNum=0,this.rowNum=0,this.additionColumn=[],this.additionRow=[]}init(t,n,r){this.cells=[],this.CELL_W=r.CELL_W||Wi.DEFAULT_CELL_W,this.CELL_H=r.CELL_H||Wi.DEFAULT_CELL_H,this.columnNum=Math.ceil(t/this.CELL_W),this.rowNum=Math.ceil(n/this.CELL_H),Wi.MIN_DIST=Math.pow(t,2)+Math.pow(n,2);for(let o=0;o<this.columnNum;o++){const i=[];for(let a=0;a<this.rowNum;a++){const s={dx:o,dy:a,x:o*this.CELL_W,y:a*this.CELL_H,occupied:!1};i.push(s)}this.cells.push(i)}}findGridByNodeId(t){var n,r;for(let o=0;o<this.columnNum;o++)for(let i=0;i<this.rowNum;i++)if(this.cells[o][i].node&&((r=(n=this.cells[o][i])===null||n===void 0?void 0:n.node)===null||r===void 0?void 0:r.id)===t)return{column:o,row:i};return null}sqdist(t,n){return Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)}occupyNearest(t){let n=Wi.MIN_DIST,r,o=null;for(let i=0;i<this.columnNum;i++)for(let a=0;a<this.rowNum;a++)!this.cells[i][a].occupied&&(r=this.sqdist(t,this.cells[i][a]))<n&&(n=r,o=this.cells[i][a]);return o&&(o.occupied=!0),o}insertColumn(t,n){if(!(n<=0)){for(let r=0;r<n;r++){this.cells[r+this.columnNum]=[];for(let o=0;o<this.rowNum;o++)this.cells[r+this.columnNum][o]={dx:r,dy:o,x:r*this.CELL_W,y:o*this.CELL_H,occupied:!1,node:null}}for(let r=this.columnNum-1;r>t;r--)for(let o=0;o<this.rowNum;o++)this.cells[r+n][o]=Object.assign(Object.assign({},this.cells[r][o]),{x:(r+n)*this.CELL_W,y:o*this.CELL_H}),this.cells[r][o]={x:r*this.CELL_W,y:o*this.CELL_H,occupied:!0,node:null};for(let r=0;r<this.additionColumn.length;r++)this.additionColumn[r]>=t&&(this.additionColumn[r]+=n);for(let r=0;r<n;r++)this.additionColumn.push(t+r+1);this.columnNum+=n}}insertRow(t,n){if(!(n<=0)){for(let r=0;r<n;r++)for(let o=0;o<this.columnNum;o++)this.cells[o][r+this.rowNum]={dx:o,dy:r,x:o*this.CELL_W,y:r*this.CELL_H,occupied:!1,node:null};for(let r=0;r<this.columnNum;r++)for(let o=this.rowNum-1;o>t;o--)this.cells[r][o+n]=Object.assign(Object.assign({},this.cells[r][o]),{dx:r,dy:o+n,x:r*this.CELL_W,y:(o+n)*this.CELL_H}),this.cells[r][o]={dx:r,dy:o,x:r*this.CELL_W,y:o*this.CELL_H,occupied:!1,node:null};for(let r=0;r<this.additionRow.length;r++)this.additionRow[r]>=t&&(this.additionRow[r]+=n);for(let r=0;r<n;r++)this.additionRow.push(t+r+1);this.rowNum+=n}}getNodes(){const t=[];for(let n=0;n<this.columnNum;n++)for(let r=0;r<this.rowNum;r++)this.cells[n][r].node&&t.push(this.cells[n][r]);return t}}Wi.MIN_DIST=50,Wi.DEFAULT_CELL_W=80,Wi.DEFAULT_CELL_H=80;function tb(e,t){if(!e.nodes||e.nodes.length===0)return e;const n=t.width,r=t.height,o=t.nodeMinGap;let i=1e4,a=1e4;e.nodes.forEach(u=>{const c=u.size[0]||50,f=u.size[1]||50;i=Math.min(c,i),a=Math.min(f,a)});const s=new Wi;s.init(n,r,{CELL_H:a,CELL_W:i}),e.nodes.forEach(u=>{const c=s.occupyNearest(u);c&&(c.node={id:u.id,size:u.size},u.x=c.x,u.y=c.y,u.dx=c.dx,u.dy=c.dy)});for(let u=0;u<e.nodes.length;u++){const c=e.nodes[u],f=s.findGridByNodeId(c.id);if(!f)throw new Error("can not find node cell");const{column:l,row:d}=f;if(c.size[0]+o>i){const h=Math.ceil((c.size[0]+o)/i)-1;let v=h;for(let m=0;m<h&&(s.additionColumn.indexOf(l+m+1)>-1&&!s.cells[l+m+1][d].node);m++)v--;s.insertColumn(l,v)}if(c.size[1]+o>a){const h=Math.ceil((c.size[1]+o)/a)-1;let v=h;for(let m=0;m<h&&(s.additionRow.indexOf(d+m+1)>-1&&!s.cells[l][d+m+1].node);m++)v--;s.insertRow(d,v)}}for(let u=0;u<s.columnNum;u++)for(let c=0;c<s.rowNum;c++){const f=s.cells[u][c];if(f.node){const l=e.nodes.find(d=>{var h;return d.id===((h=f==null?void 0:f.node)===null||h===void 0?void 0:h.id)});l&&(l.x=f.x+l.size[0]/2,l.y=f.y+l.size[1]/2)}}}const Pp=1200,Fp=800,Ml=1e7,zc=10,zp=3.141592653589793,vh=1.5707963267948966,nb=zp*.375,rb=zp*.625,kl=new Map,ob=10,ib=10;let ph=.8;const Bp=.1,ab=.5;function sb(e,t,n){const r=e.x-e.size[0]/2,o=e.y-e.size[1]/2,i=e.x+e.size[0]/2,a=e.y+e.size[1]/2,s=t.x-t.size[0]/2,u=t.y-t.size[1]/2,c=t.x+t.size[0]/2,f=t.y+t.size[1]/2,l=e.x,d=e.y,h=t.x,v=t.y,m=h-l,g=Math.atan2(m,v-d);let E=0,y=0,b=0,w=0;g>vh?(y=o-f,E=s-i,b=parseFloat(y?(y/Math.cos(g)).toFixed(2):E.toFixed(2)),w=parseFloat(E?(E/Math.sin(g)).toFixed(2):y.toFixed(2))):0<g&&g<=vh?(y=u-a,E=s-i,y>E?b=w=parseFloat(y?(y/Math.cos(g)).toFixed(2):E.toFixed(2)):b=w=parseFloat(E?(E/Math.sin(g)).toFixed(2):y.toFixed(2))):g<-vh?(y=o-f,E=-(c-r),y>E?b=w=parseFloat(y?(y/Math.cos(g)).toFixed(2):E.toFixed(2)):b=w=parseFloat(E?(E/Math.sin(g)).toFixed(2):y.toFixed(2))):(y=u-a,Math.abs(m)>(i-r)/2?E=r-c:E=m,y>E?b=w=parseFloat(y?(y/Math.cos(g)).toFixed(2):E.toFixed(2)):b=w=parseFloat(E&&g!==0?(E/Math.sin(g)).toFixed(2):y.toFixed(2)));const T=parseFloat(g.toFixed(2));let $=n;return n&&($=nb<T&&T<rb),{distance:Math.abs(b<w?b:w),isHoriz:$}}function Up(e,t){const r=(kl.get(e.id)||[]).find(he=>he.source===t.id||he.target===t.id),o=e.size[0]*e.size[1],i=t.size[0]*t.size[1],a=o>i?t:e,s=o>i?e:t,u=a.x-a.size[0]/2,c=a.y-a.size[1]/2,f=a.x+a.size[0]/2,l=a.y+a.size[1]/2,d=s.x-s.size[0]/2,h=s.y-s.size[1]/2,v=s.x+s.size[0]/2,m=s.y+s.size[1]/2,g=a.x,E=a.y,y=s.x,b=s.y,w=f>=d&&v>=u&&l>=h&&m>=c;let T=0,$=0;if(w){$=Math.sqrt(Math.pow(y-g,2)+Math.pow(b-E,2));const he=u>d?u:d,te=c>h?c:h,j=f<v?f:v,q=l<m?l:m,ve=j-he,k=q-te,pe=ve*k;$===0&&($=1e-7),T=zc*1/$*100+pe,T*=Ml}else{let he=!1;const te=sb(a,s,he);$=te.distance,he=te.isHoriz,$<=zc?$!==0?r?T+=zc+Ml*1/$:T+=zc+Ml*zc/$:T+=Ml:(T+=$,r&&(T+=$*$))}return T}function Vp(e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];(r.x<0||r.y<0||r.x>Pp||r.y>Fp)&&(t+=1e12);for(let o=n+1;o<e.length;o++)t+=Up(r,e[o])}return t}function ub(e,t,n,r){const o=new Map;n.forEach((u,c)=>{o.set(u.id,u)});const i=r.filter(u=>u.source===e.id||u.target===e.id)||[],a=[];i.forEach(u=>{const c=u.source===e.id?u.target:u.source,f=o.get(c);f&&a.push(f)});let s=!0;for(let u=0;u<a.length;u++){const c=a[u],f=Math.atan((e.y-c.y)/(c.x-e.y))*180,l=Math.atan((t.y-c.y)/(c.x-t.y))*180,d=f<30||f>150,h=l<30||l>150,v=f>70&&f<110,m=l>70&&l<110;if(d&&!h||f*l<0){s=!1;break}else if(v&&!m||f*l<0){s=!1;break}else if((c.x-e.x)*(c.x-t.x)<0){s=!1;break}else if((c.y-e.y)*(c.y-t.y)<0){s=!1;break}}return s}function cb(e,t){let n=!1;const r=1,o=ob*r,i=ib*r,a=[o,-o,0,0],s=[0,0,i,-i];for(let u=0;u<e.length;++u){const c=e[u];let f=Xp(c,e);for(let l=0;l<a.length;l++)if(ub(c,{x:c.x+a[l],y:c.y+s[l]},e,t)){c.x+=a[l],c.y+=s[l];const h=Xp(c,e),v=Math.random();h<f||v<ph&&v>Bp?(f=h,n=!0):(c.x-=a[l],c.y-=s[l])}}return ph>Bp&&(ph*=ab),n?Vp(e):0}function Xp(e,t){let n=0;(e.x<0||e.y<0||e.x+e.size[0]+20>Pp||e.y+e.size[1]+20>Fp)&&(n+=1e12);for(let r=0;r<t.length;++r)e.id!==t[r].id&&(n+=Up(e,t[r]));return n}function fb(e,t){if(e.length===0)return{nodes:e,edges:t};e.forEach(u=>{const c=t.filter(f=>f.source===u.id||f.target===u.id);kl.set(u,c)}),e.sort((u,c)=>{var f,l;return((f=kl.get(u.id))===null||f===void 0?void 0:f.length)-((l=kl.get(c.id))===null||l===void 0?void 0:l.length)});let n=Vp(e),r=20,o=1,i=0;const a=50;let s=0;for(;r>0&&(s++,!(s>=a));){const u=cb(e,t);u!==0&&(i=u),o=i-n,n=i,o===0?--r:r=20}return e.forEach(u=>{u.x=u.x-u.size[0]/2,u.y=u.y-u.size[1]/2}),{nodes:e,edges:t}}var lb=fb;function db(e,t){const{nodes:n,edges:r}=e,o=t.width,i=t.height;if(!(n!=null&&n.length))return Promise.resolve();const a=[];n.forEach(v=>{if(r.filter(g=>g.source===v.id||g.target===v.id).length>1){const g=Object.assign({},v);delete g.size,a.push(g)}});const s=[];r.forEach(v=>{const m=a.find(E=>E.id===v.source),g=a.find(E=>E.id===v.target);m&&g&&s.push(v)});const u=new Ks({type:"dagre",ranksep:t.nodeMinGap,nodesep:t.nodeMinGap}),{nodes:c}=u.layout({nodes:a,edges:s});n.forEach(v=>{const m=(c||[]).find(g=>g.id===v.id);v.x=(m==null?void 0:m.x)||o/2,v.y=(m==null?void 0:m.y)||i/2});const f=JSON.parse(JSON.stringify(n)),l=JSON.parse(JSON.stringify(r)),d=C().nodes(f).force("link",xt(l).id(v=>v.id).distance(v=>s.find(g=>g.source===v.source&&g.target===v.target)?30:20)).force("charge",Se()).force("center",Ce(o/2,i/2)).force("x",nn(o/2)).force("y",Xt(i/2)).alpha(.3).alphaDecay(.08).alphaMin(.001);return new Promise(v=>{d.on("end",()=>{n.forEach(T=>{const $=f.find(he=>he.id===T.id);$&&(T.x=$.x,T.y=$.y)});const m=Math.min(...n.map(T=>T.x)),g=Math.max(...n.map(T=>T.x)),E=Math.min(...n.map(T=>T.y)),y=Math.max(...n.map(T=>T.y)),b=o/(g-m),w=i/(y-E);n.forEach(T=>{T.x!==void 0&&b<1&&(T.x=(T.x-m)*b),T.y!==void 0&&w<1&&(T.y=(T.y-E)*w)}),n.forEach(T=>{T.sizeTemp=T.size,T.size=[10,10]}),lb(n,r),n.forEach(T=>{T.size=T.sizeTemp||[],delete T.sizeTemp}),tb({nodes:n,edges:r},t),v()})})}class hb extends $e{constructor(t){super(),this.width=300,this.height=300,this.nodeMinGap=50,this.onLayoutEnd=()=>{},t&&this.updateCfg(t)}getDefaultCfg(){return{width:300,height:300,nodeMinGap:50}}execute(){const t=this,n=t.nodes,r=t.edges;return n==null||n.forEach(o=>{o.size||(o.size=[50,50])}),db({nodes:n,edges:r},{width:this.width,height:this.height,nodeMinGap:this.nodeMinGap}).then(()=>{t.onLayoutEnd&&t.onLayoutEnd()})}getType(){return"er"}}class vb extends $e{constructor(t){super(),this.center=[0,0],this.width=300,this.height=300,this.nodes=[],this.edges=[],this.onLayoutEnd=()=>{},this.updateCfg(t)}getDefaultCfg(){return{center:[0,0],width:300,height:300}}execute(){const t=this,n=t.nodes,r=.9,o=t.center;return!t.width&&typeof window!="undefined"&&(t.width=window.innerWidth),!t.height&&typeof window!="undefined"&&(t.height=window.innerHeight),n&&n.forEach(i=>{i.x=(Math.random()-.5)*r*t.width+o[0],i.y=(Math.random()-.5)*r*t.height+o[1]}),t.onLayoutEnd&&t.onLayoutEnd(),{nodes:n,edges:this.edges}}getType(){return"random"}}class Nb{constructor(t){const n=getLayoutByName(t.type);this.layoutInstance=new n(t)}layout(t){return this.layoutInstance.layout(t)}updateCfg(t){this.layoutInstance.updateCfg(t)}init(t){this.correctLayers(t.nodes),this.layoutInstance.init(t)}correctLayers(t){if(!(t!=null&&t.length))return;let n=1/0;const r=[];if(t.forEach(o=>{isString(o.layer)&&(o.layer=parseInt(o.layer,10)),!(o.layer===void 0||isNaN(o.layer))&&(r.push(o),o.layer<n&&(n=o.layer))}),n<=0){const o=Math.abs(n)+1;r.forEach(i=>i.layer+=o)}}execute(){this.layoutInstance.execute()}getDefaultCfg(){return this.layoutInstance.getDefaultCfg()}destroy(){return this.layoutInstance.destroy()}}const Ab={force:gn,fruchterman:rE,forceAtlas2:eb,gForce:tn,force2:La,dagre:Ks,dagreCompound:vy,circular:bn,radial:tE,concentric:bp,grid:ft,mds:xp,comboForce:QE,comboCombined:JE,random:vb,"gForce-gpu":qE,"fruchterman-gpu":jE,er:hb}},32101:function(qe){(function(pt,oe){qe.exports=oe()})(this,function(){"use strict";var pt=function(p){return p instanceof Uint8Array||p instanceof Uint16Array||p instanceof Uint32Array||p instanceof Int8Array||p instanceof Int16Array||p instanceof Int32Array||p instanceof Float32Array||p instanceof Float64Array||p instanceof Uint8ClampedArray},oe=function(p,_){for(var O=Object.keys(_),K=0;K<O.length;++K)p[O[K]]=_[O[K]];return p},ee=`
`;function Zt(p){return typeof atob!="undefined"?atob(p):"base64:"+p}function At(p){var _=new Error("(regl) "+p);throw console.error(_),_}function nt(p,_){p||At(_)}function jt(p){return p?": "+p:""}function bt(p,_,O){p in _||At("unknown parameter ("+p+")"+jt(O)+". possible values: "+Object.keys(_).join())}function be(p,_){pt(p)||At("invalid parameter type"+jt(_)+". must be a typed array")}function _n(p,_){switch(_){case"number":return typeof p=="number";case"object":return typeof p=="object";case"string":return typeof p=="string";case"boolean":return typeof p=="boolean";case"function":return typeof p=="function";case"undefined":return typeof p=="undefined";case"symbol":return typeof p=="symbol"}}function Vn(p,_,O){_n(p,_)||At("invalid parameter type"+jt(O)+". expected "+_+", got "+typeof p)}function Ot(p,_){p>=0&&(p|0)===p||At("invalid parameter type, ("+p+")"+jt(_)+". must be a nonnegative integer")}function Bt(p,_,O){_.indexOf(p)<0&&At("invalid value"+jt(O)+". must be one of: "+_)}var Je=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function hn(p){Object.keys(p).forEach(function(_){Je.indexOf(_)<0&&At('invalid regl constructor argument "'+_+'". must be one of '+Je)})}function Rt(p,_){for(p=p+"";p.length<_;)p=" "+p;return p}function yr(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function er(p,_){this.number=p,this.line=_,this.errors=[]}function Er(p,_,O){this.file=p,this.line=_,this.message=O}function Cn(){var p=new Error,_=(p.stack||p).toString(),O=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(_);if(O)return O[1];var K=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(_);return K?K[1]:"unknown"}function tr(){var p=new Error,_=(p.stack||p).toString(),O=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(_);if(O)return O[1];var K=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(_);return K?K[1]:"unknown"}function Nr(p,_){var O=p.split(`
`),K=1,ae=0,Z={unknown:new yr,0:new yr};Z.unknown.name=Z[0].name=_||Cn(),Z.unknown.lines.push(new er(0,""));for(var Q=0;Q<O.length;++Q){var fe=O[Q],me=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(fe);if(me)switch(me[1]){case"line":var _e=/(\d+)(\s+\d+)?/.exec(me[2]);_e&&(K=_e[1]|0,_e[2]&&(ae=_e[2]|0,ae in Z||(Z[ae]=new yr)));break;case"define":var ge=/SHADER_NAME(_B64)?\s+(.*)$/.exec(me[2]);ge&&(Z[ae].name=ge[1]?Zt(ge[2]):ge[2]);break}Z[ae].lines.push(new er(K++,fe))}return Object.keys(Z).forEach(function(Ae){var De=Z[Ae];De.lines.forEach(function(se){De.index[se.number]=se})}),Z}function $r(p){var _=[];return p.split(`
`).forEach(function(O){if(!(O.length<5)){var K=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(O);K?_.push(new Er(K[1]|0,K[2]|0,K[3].trim())):O.length>0&&_.push(new Er("unknown",0,O))}}),_}function go(p,_){_.forEach(function(O){var K=p[O.file];if(K){var ae=K.index[O.line];if(ae){ae.errors.push(O),K.hasErrors=!0;return}}p.unknown.hasErrors=!0,p.unknown.lines[0].errors.push(O)})}function ro(p,_,O,K,ae){if(!p.getShaderParameter(_,p.COMPILE_STATUS)){var Z=p.getShaderInfoLog(_),Q=K===p.FRAGMENT_SHADER?"fragment":"vertex";Xe(O,"string",Q+" shader source must be a string",ae);var fe=Nr(O,ae),me=$r(Z);go(fe,me),Object.keys(fe).forEach(function(_e){var ge=fe[_e];if(!ge.hasErrors)return;var Ae=[""],De=[""];function se(Re,V){Ae.push(Re),De.push(V||"")}se("file number "+_e+": "+ge.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),ge.lines.forEach(function(Re){if(Re.errors.length>0){se(Rt(Re.number,4)+"|  ","background-color:yellow; font-weight:bold"),se(Re.line+ee,"color:red; background-color:yellow; font-weight:bold");var V=0;Re.errors.forEach(function(J){var ye=J.message,Me=/^\s*'(.*)'\s*:\s*(.*)$/.exec(ye);if(Me){var ne=Me[1];switch(ye=Me[2],ne){case"assign":ne="=";break}V=Math.max(Re.line.indexOf(ne,V),0)}else V=0;se(Rt("| ",6)),se(Rt("^^^",V+3)+ee,"font-weight:bold"),se(Rt("| ",6)),se(ye+ee,"font-weight:bold")}),se(Rt("| ",6)+ee)}else se(Rt(Re.number,4)+"|  "),se(Re.line+ee,"color:red")}),typeof document!="undefined"&&!window.chrome?(De[0]=Ae.join("%c"),console.log.apply(console,De)):console.log(Ae.join(""))}),nt.raise("Error compiling "+Q+" shader, "+fe[0].name)}}function bi(p,_,O,K,ae){if(!p.getProgramParameter(_,p.LINK_STATUS)){var Z=p.getProgramInfoLog(_),Q=Nr(O,ae),fe=Nr(K,ae),me='Error linking program with vertex shader, "'+fe[0].name+'", and fragment shader "'+Q[0].name+'"';typeof document!="undefined"?console.log("%c"+me+ee+"%c"+Z,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(me+ee+Z),nt.raise(me)}}function yo(p){p._commandRef=Cn()}function ct(p,_,O,K){yo(p);function ae(me){return me?K.id(me):0}p._fragId=ae(p.static.frag),p._vertId=ae(p.static.vert);function Z(me,_e){Object.keys(_e).forEach(function(ge){me[K.id(ge)]=!0})}var Q=p._uniformSet={};Z(Q,_.static),Z(Q,_.dynamic);var fe=p._attributeSet={};Z(fe,O.static),Z(fe,O.dynamic),p._hasCount="count"in p.static||"count"in p.dynamic||"elements"in p.static||"elements"in p.dynamic}function ar(p,_){var O=tr();At(p+" in command "+(_||Cn())+(O==="unknown"?"":" called from "+O))}function jn(p,_,O){p||ar(_,O||Cn())}function On(p,_,O,K){p in _||ar("unknown parameter ("+p+")"+jt(O)+". possible values: "+Object.keys(_).join(),K||Cn())}function Xe(p,_,O,K){_n(p,_)||ar("invalid parameter type"+jt(O)+". expected "+_+", got "+typeof p,K||Cn())}function Te(p){p()}function ke(p,_,O){p.texture?Bt(p.texture._texture.internalformat,_,"unsupported texture format for attachment"):Bt(p.renderbuffer._renderbuffer.format,O,"unsupported renderbuffer format for attachment")}var $e=33071,ft=9728,st=9984,tn=9985,Kt=9986,fn=9987,Wr=5120,Ar=5121,Hr=5122,Hi=5123,sr=5124,Zi=5125,xi=5126,wi=32819,ii=32820,ji=33635,ai=34042,si=36193,nr={};nr[Wr]=nr[Ar]=1,nr[Hr]=nr[Hi]=nr[si]=nr[ji]=nr[wi]=nr[ii]=2,nr[sr]=nr[Zi]=nr[xi]=nr[ai]=4;function Rr(p,_){return p===ii||p===wi||p===ji?2:p===ai?4:nr[p]*_}function ui(p){return!(p&p-1)&&!!p}function Yi(p,_,O){var K,ae=_.width,Z=_.height,Q=_.channels;nt(ae>0&&ae<=O.maxTextureSize&&Z>0&&Z<=O.maxTextureSize,"invalid texture shape"),(p.wrapS!==$e||p.wrapT!==$e)&&nt(ui(ae)&&ui(Z),"incompatible wrap mode for texture, both width and height must be power of 2"),_.mipmask===1?ae!==1&&Z!==1&&nt(p.minFilter!==st&&p.minFilter!==Kt&&p.minFilter!==tn&&p.minFilter!==fn,"min filter requires mipmap"):(nt(ui(ae)&&ui(Z),"texture must be a square power of 2 to support mipmapping"),nt(_.mipmask===(ae<<1)-1,"missing or incomplete mipmap data")),_.type===xi&&(O.extensions.indexOf("oes_texture_float_linear")<0&&nt(p.minFilter===ft&&p.magFilter===ft,"filter not supported, must enable oes_texture_float_linear"),nt(!p.genMipmaps,"mipmap generation not supported with float textures"));var fe=_.images;for(K=0;K<16;++K)if(fe[K]){var me=ae>>K,_e=Z>>K;nt(_.mipmask&1<<K,"missing mipmap data");var ge=fe[K];if(nt(ge.width===me&&ge.height===_e,"invalid shape for mip images"),nt(ge.format===_.format&&ge.internalformat===_.internalformat&&ge.type===_.type,"incompatible type for mip image"),!ge.compressed)if(ge.data){var Ae=Math.ceil(Rr(ge.type,Q)*me/ge.unpackAlignment)*ge.unpackAlignment;nt(ge.data.byteLength===Ae*_e,"invalid data for image, buffer size is inconsistent with image format")}else ge.element||ge.copy}else p.genMipmaps||nt((_.mipmask&1<<K)===0,"extra mipmap data");_.compressed&&nt(!p.genMipmaps,"mipmap generation for compressed images not supported")}function ci(p,_,O,K){var ae=p.width,Z=p.height,Q=p.channels;nt(ae>0&&ae<=K.maxTextureSize&&Z>0&&Z<=K.maxTextureSize,"invalid texture shape"),nt(ae===Z,"cube map must be square"),nt(_.wrapS===$e&&_.wrapT===$e,"wrap mode not supported by cube map");for(var fe=0;fe<O.length;++fe){var me=O[fe];nt(me.width===ae&&me.height===Z,"inconsistent cube map face shape"),_.genMipmaps&&(nt(!me.compressed,"can not generate mipmap for compressed textures"),nt(me.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var _e=me.images,ge=0;ge<16;++ge){var Ae=_e[ge];if(Ae){var De=ae>>ge,se=Z>>ge;nt(me.mipmask&1<<ge,"missing mipmap data"),nt(Ae.width===De&&Ae.height===se,"invalid shape for mip images"),nt(Ae.format===p.format&&Ae.internalformat===p.internalformat&&Ae.type===p.type,"incompatible type for mip image"),Ae.compressed||(Ae.data?nt(Ae.data.byteLength===De*se*Math.max(Rr(Ae.type,Q),Ae.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Ae.element||Ae.copy)}}}}var N=oe(nt,{optional:Te,raise:At,commandRaise:ar,command:jn,parameter:bt,commandParameter:On,constructor:hn,type:Vn,commandType:Xe,isTypedArray:be,nni:Ot,oneOf:Bt,shaderError:ro,linkError:bi,callSite:tr,saveCommandRef:yo,saveDrawInfo:ct,framebufferFormat:ke,guessCommand:Cn,texture2D:Yi,textureCube:ci}),Mo=0,rr=0,Ki=5,qr=6;function Dr(p,_){this.id=Mo++,this.type=p,this.data=_}function qi(p){return p.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function oo(p){if(p.length===0)return[];var _=p.charAt(0),O=p.charAt(p.length-1);if(p.length>1&&_===O&&(_==='"'||_==="'"))return['"'+qi(p.substr(1,p.length-2))+'"'];var K=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(p);if(K)return oo(p.substr(0,K.index)).concat(oo(K[1])).concat(oo(p.substr(K.index+K[0].length)));var ae=p.split(".");if(ae.length===1)return['"'+qi(p)+'"'];for(var Z=[],Q=0;Q<ae.length;++Q)Z=Z.concat(oo(ae[Q]));return Z}function Qi(p){return"["+oo(p).join("][")+"]"}function _i(p,_){return new Dr(p,Qi(_+""))}function La(p){return typeof p=="function"&&!p._reglType||p instanceof Dr}function ur(p,_){if(typeof p=="function")return new Dr(rr,p);if(typeof p=="number"||typeof p=="boolean")return new Dr(Ki,p);if(Array.isArray(p))return new Dr(qr,p.map((O,K)=>ur(O,_+"["+K+"]")));if(p instanceof Dr)return p;N(!1,"invalid option type in uniform "+_)}var En={DynamicVariable:Dr,define:_i,isDynamic:La,unbox:ur,accessor:Qi},io={next:typeof requestAnimationFrame=="function"?function(p){return requestAnimationFrame(p)}:function(p){return setTimeout(p,16)},cancel:typeof cancelAnimationFrame=="function"?function(p){return cancelAnimationFrame(p)}:clearTimeout},br=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function ao(){var p={"":0},_=[""];return{id:function(O){var K=p[O];return K||(K=p[O]=_.length,_.push(O),K)},str:function(O){return _[O]}}}function Iu(p,_,O){var K=document.createElement("canvas");oe(K.style,{border:0,margin:0,padding:0,top:0,left:0}),p.appendChild(K),p===document.body&&(K.style.position="absolute",oe(p.style,{margin:0,padding:0}));function ae(){var fe=window.innerWidth,me=window.innerHeight;if(p!==document.body){var _e=p.getBoundingClientRect();fe=_e.right-_e.left,me=_e.bottom-_e.top}K.width=O*fe,K.height=O*me,oe(K.style,{width:fe+"px",height:me+"px"})}var Z;p!==document.body&&typeof ResizeObserver=="function"?(Z=new ResizeObserver(function(){setTimeout(ae)}),Z.observe(p)):window.addEventListener("resize",ae,!1);function Q(){Z?Z.disconnect():window.removeEventListener("resize",ae),p.removeChild(K)}return ae(),{canvas:K,onDestroy:Q}}function Nu(p,_){function O(K){try{return p.getContext(K,_)}catch(ae){return null}}return O("webgl")||O("experimental-webgl")||O("webgl-experimental")}function bs(p){return typeof p.nodeName=="string"&&typeof p.appendChild=="function"&&typeof p.getBoundingClientRect=="function"}function Au(p){return typeof p.drawArrays=="function"||typeof p.drawElements=="function"}function ko(p){return typeof p=="string"?p.split():(N(Array.isArray(p),"invalid extension array"),p)}function fi(p){return typeof p=="string"?(N(typeof document!="undefined","not supported outside of DOM"),document.querySelector(p)):p}function Si(p){var _=p||{},O,K,ae,Z,Q={},fe=[],me=[],_e=typeof window=="undefined"?1:window.devicePixelRatio,ge=!1,Ae=function(Re){Re&&N.raise(Re)},De=function(){};if(typeof _=="string"?(N(typeof document!="undefined","selector queries only supported in DOM enviroments"),O=document.querySelector(_),N(O,"invalid query string for element")):typeof _=="object"?bs(_)?O=_:Au(_)?(Z=_,ae=Z.canvas):(N.constructor(_),"gl"in _?Z=_.gl:"canvas"in _?ae=fi(_.canvas):"container"in _&&(K=fi(_.container)),"attributes"in _&&(Q=_.attributes,N.type(Q,"object","invalid context attributes")),"extensions"in _&&(fe=ko(_.extensions)),"optionalExtensions"in _&&(me=ko(_.optionalExtensions)),"onDone"in _&&(N.type(_.onDone,"function","invalid or missing onDone callback"),Ae=_.onDone),"profile"in _&&(ge=!!_.profile),"pixelRatio"in _&&(_e=+_.pixelRatio,N(_e>0,"invalid pixel ratio"))):N.raise("invalid arguments to regl"),O&&(O.nodeName.toLowerCase()==="canvas"?ae=O:K=O),!Z){if(!ae){N(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var se=Iu(K||document.body,Ae,_e);if(!se)return null;ae=se.canvas,De=se.onDestroy}Q.premultipliedAlpha===void 0&&(Q.premultipliedAlpha=!0),Z=Nu(ae,Q)}return Z?{gl:Z,canvas:ae,container:K,extensions:fe,optionalExtensions:me,pixelRatio:_e,profile:ge,onDone:Ae,onDestroy:De}:(De(),Ae("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function xs(p,_){var O={};function K(Q){N.type(Q,"string","extension name must be string");var fe=Q.toLowerCase(),me;try{me=O[fe]=p.getExtension(fe)}catch(_e){}return!!me}for(var ae=0;ae<_.extensions.length;++ae){var Z=_.extensions[ae];if(!K(Z))return _.onDestroy(),_.onDone('"'+Z+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return _.optionalExtensions.forEach(K),{extensions:O,restore:function(){Object.keys(O).forEach(function(Q){if(O[Q]&&!K(Q))throw new Error("(regl): error restoring extension "+Q)})}}}function cr(p,_){for(var O=Array(p),K=0;K<p;++K)O[K]=_(K);return O}var Ti=5120,Ji=5121,Go=5122,Eo=5123,Ii=5124,ws=5125,Ma=5126;function Zc(p){for(var _=16;_<=1<<28;_*=16)if(p<=_)return _;return 0}function ea(p){var _,O;return _=(p>65535)<<4,p>>>=_,O=(p>255)<<3,p>>>=O,_|=O,O=(p>15)<<2,p>>>=O,_|=O,O=(p>3)<<1,p>>>=O,_|=O,_|p>>1}function ka(){var p=cr(8,function(){return[]});function _(Z){var Q=Zc(Z),fe=p[ea(Q)>>2];return fe.length>0?fe.pop():new ArrayBuffer(Q)}function O(Z){p[ea(Z.byteLength)>>2].push(Z)}function K(Z,Q){var fe=null;switch(Z){case Ti:fe=new Int8Array(_(Q),0,Q);break;case Ji:fe=new Uint8Array(_(Q),0,Q);break;case Go:fe=new Int16Array(_(2*Q),0,Q);break;case Eo:fe=new Uint16Array(_(2*Q),0,Q);break;case Ii:fe=new Int32Array(_(4*Q),0,Q);break;case ws:fe=new Uint32Array(_(4*Q),0,Q);break;case Ma:fe=new Float32Array(_(4*Q),0,Q);break;default:return null}return fe.length!==Q?fe.subarray(0,Q):fe}function ae(Z){O(Z.buffer)}return{alloc:_,free:O,allocType:K,freeType:ae}}var Ln=ka();Ln.zero=ka();var _s=3408,Ru=3410,Du=3411,Ga=3412,Cu=3413,Ou=3414,Lu=3415,Mu=33901,ku=33902,Ss=3379,Gu=3386,S=34921,C=36347,Se=36348,Ce=35661,Ge=35660,Oe=34930,tt=36349,it=34076,xt=34024,Lt=7936,ln=7937,Mt=7938,nn=35724,Xt=34047,rn=36063,mn=34852,Sn=3553,gn=34067,Mn=34069,dn=33984,Yn=6408,Fn=5126,qt=5121,bn=36160,zn=36053,Qt=36064,yn=16384,on=function(p,_){var O=1;_.ext_texture_filter_anisotropic&&(O=p.getParameter(Xt));var K=1,ae=1;_.webgl_draw_buffers&&(K=p.getParameter(mn),ae=p.getParameter(rn));var Z=!!_.oes_texture_float;if(Z){var Q=p.createTexture();p.bindTexture(Sn,Q),p.texImage2D(Sn,0,Yn,1,1,0,Yn,Fn,null);var fe=p.createFramebuffer();if(p.bindFramebuffer(bn,fe),p.framebufferTexture2D(bn,Qt,Sn,Q,0),p.bindTexture(Sn,null),p.checkFramebufferStatus(bn)!==zn)Z=!1;else{p.viewport(0,0,1,1),p.clearColor(1,0,0,1),p.clear(yn);var me=Ln.allocType(Fn,4);p.readPixels(0,0,1,1,Yn,Fn,me),p.getError()?Z=!1:(p.deleteFramebuffer(fe),p.deleteTexture(Q),Z=me[0]===1),Ln.freeType(me)}}var _e=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),ge=!0;if(!_e){var Ae=p.createTexture(),De=Ln.allocType(qt,36);p.activeTexture(dn),p.bindTexture(gn,Ae),p.texImage2D(Mn,0,Yn,3,3,0,Yn,qt,De),Ln.freeType(De),p.bindTexture(gn,null),p.deleteTexture(Ae),ge=!p.getError()}return{colorBits:[p.getParameter(Ru),p.getParameter(Du),p.getParameter(Ga),p.getParameter(Cu)],depthBits:p.getParameter(Ou),stencilBits:p.getParameter(Lu),subpixelBits:p.getParameter(_s),extensions:Object.keys(_).filter(function(se){return!!_[se]}),maxAnisotropic:O,maxDrawbuffers:K,maxColorAttachments:ae,pointSizeDims:p.getParameter(Mu),lineWidthDims:p.getParameter(ku),maxViewportDims:p.getParameter(Gu),maxCombinedTextureUnits:p.getParameter(Ce),maxCubeMapSize:p.getParameter(it),maxRenderbufferSize:p.getParameter(xt),maxTextureUnits:p.getParameter(Oe),maxTextureSize:p.getParameter(Ss),maxAttributes:p.getParameter(S),maxVertexUniforms:p.getParameter(C),maxVertexTextureUnits:p.getParameter(Ge),maxVaryingVectors:p.getParameter(Se),maxFragmentUniforms:p.getParameter(tt),glsl:p.getParameter(nn),renderer:p.getParameter(ln),vendor:p.getParameter(Lt),version:p.getParameter(Mt),readFloat:Z,npotTextureCube:ge}};function wt(p){return!!p&&typeof p=="object"&&Array.isArray(p.shape)&&Array.isArray(p.stride)&&typeof p.offset=="number"&&p.shape.length===p.stride.length&&(Array.isArray(p.data)||pt(p.data))}var kt=function(p){return Object.keys(p).map(function(_){return p[_]})},sn={shape:Po,flatten:xr};function Tn(p,_,O){for(var K=0;K<_;++K)O[K]=p[K]}function Gr(p,_,O,K){for(var ae=0,Z=0;Z<_;++Z)for(var Q=p[Z],fe=0;fe<O;++fe)K[ae++]=Q[fe]}function Qr(p,_,O,K,ae,Z){for(var Q=Z,fe=0;fe<_;++fe)for(var me=p[fe],_e=0;_e<O;++_e)for(var ge=me[_e],Ae=0;Ae<K;++Ae)ae[Q++]=ge[Ae]}function Jr(p,_,O,K,ae){for(var Z=1,Q=O+1;Q<_.length;++Q)Z*=_[Q];var fe=_[O];if(_.length-O===4){var me=_[O+1],_e=_[O+2],ge=_[O+3];for(Q=0;Q<fe;++Q)Qr(p[Q],me,_e,ge,K,ae),ae+=Z}else for(Q=0;Q<fe;++Q)Jr(p[Q],_,O+1,K,ae),ae+=Z}function xr(p,_,O,K){var ae=1;if(_.length)for(var Z=0;Z<_.length;++Z)ae*=_[Z];else ae=0;var Q=K||Ln.allocType(O,ae);switch(_.length){case 0:break;case 1:Tn(p,_[0],Q);break;case 2:Gr(p,_[0],_[1],Q);break;case 3:Qr(p,_[0],_[1],_[2],Q,0);break;default:Jr(p,_,0,Q,0)}return Q}function Po(p){for(var _=[],O=p;O.length;O=O[0])_.push(O.length);return _}var Fo={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},un=5120,kn=5122,Cr=5124,Pr=5121,wr=5123,eo=5125,so=5126,uo=5126,pr={int8:un,int16:kn,int32:Cr,uint8:Pr,uint16:wr,uint32:eo,float:so,float32:uo},Ts=35048,ta=35040,Ni={dynamic:Ts,stream:ta,static:35044},co=sn.flatten,na=sn.shape,In=35044,fo=35040,zo=5121,Pa=5126,bo=[];bo[5120]=1,bo[5122]=2,bo[5124]=4,bo[5121]=1,bo[5123]=2,bo[5125]=4,bo[5126]=4;function Bo(p){return Fo[Object.prototype.toString.call(p)]|0}function xo(p,_){for(var O=0;O<_.length;++O)p[O]=_[O]}function Ai(p,_,O,K,ae,Z,Q){for(var fe=0,me=0;me<O;++me)for(var _e=0;_e<K;++_e)p[fe++]=_[ae*me+Z*_e+Q]}function ra(p,_,O,K){var ae=0,Z={};function Q(V){this.id=ae++,this.buffer=p.createBuffer(),this.type=V,this.usage=In,this.byteLength=0,this.dimension=1,this.dtype=zo,this.persistentData=null,O.profile&&(this.stats={size:0})}Q.prototype.bind=function(){p.bindBuffer(this.type,this.buffer)},Q.prototype.destroy=function(){De(this)};var fe=[];function me(V,J){var ye=fe.pop();return ye||(ye=new Q(V)),ye.bind(),Ae(ye,J,fo,0,1,!1),ye}function _e(V){fe.push(V)}function ge(V,J,ye){V.byteLength=J.byteLength,p.bufferData(V.type,J,ye)}function Ae(V,J,ye,Me,ne,ze){var le;if(V.usage=ye,Array.isArray(J)){if(V.dtype=Me||Pa,J.length>0){var Ie;if(Array.isArray(J[0])){le=na(J);for(var de=1,Ne=1;Ne<le.length;++Ne)de*=le[Ne];V.dimension=de,Ie=co(J,le,V.dtype),ge(V,Ie,ye),ze?V.persistentData=Ie:Ln.freeType(Ie)}else if(typeof J[0]=="number"){V.dimension=ne;var Qe=Ln.allocType(V.dtype,J.length);xo(Qe,J),ge(V,Qe,ye),ze?V.persistentData=Qe:Ln.freeType(Qe)}else pt(J[0])?(V.dimension=J[0].length,V.dtype=Me||Bo(J[0])||Pa,Ie=co(J,[J.length,J[0].length],V.dtype),ge(V,Ie,ye),ze?V.persistentData=Ie:Ln.freeType(Ie)):N.raise("invalid buffer data")}}else if(pt(J))V.dtype=Me||Bo(J),V.dimension=ne,ge(V,J,ye),ze&&(V.persistentData=new Uint8Array(new Uint8Array(J.buffer)));else if(wt(J)){le=J.shape;var lt=J.stride,Le=J.offset,xe=0,ce=0,at=0,_t=0;le.length===1?(xe=le[0],ce=1,at=lt[0],_t=0):le.length===2?(xe=le[0],ce=le[1],at=lt[0],_t=lt[1]):N.raise("invalid shape"),V.dtype=Me||Bo(J.data)||Pa,V.dimension=ce;var We=Ln.allocType(V.dtype,xe*ce);Ai(We,J.data,xe,ce,at,_t,Le),ge(V,We,ye),ze?V.persistentData=We:Ln.freeType(We)}else J instanceof ArrayBuffer?(V.dtype=zo,V.dimension=ne,ge(V,J,ye),ze&&(V.persistentData=new Uint8Array(new Uint8Array(J)))):N.raise("invalid buffer data")}function De(V){_.bufferCount--,K(V);var J=V.buffer;N(J,"buffer must not be deleted already"),p.deleteBuffer(J),V.buffer=null,delete Z[V.id]}function se(V,J,ye,Me){_.bufferCount++;var ne=new Q(J);Z[ne.id]=ne;function ze(de){var Ne=In,Qe=null,lt=0,Le=0,xe=1;return Array.isArray(de)||pt(de)||wt(de)||de instanceof ArrayBuffer?Qe=de:typeof de=="number"?lt=de|0:de&&(N.type(de,"object","buffer arguments must be an object, a number or an array"),"data"in de&&(N(Qe===null||Array.isArray(Qe)||pt(Qe)||wt(Qe),"invalid data for buffer"),Qe=de.data),"usage"in de&&(N.parameter(de.usage,Ni,"invalid buffer usage"),Ne=Ni[de.usage]),"type"in de&&(N.parameter(de.type,pr,"invalid buffer type"),Le=pr[de.type]),"dimension"in de&&(N.type(de.dimension,"number","invalid dimension"),xe=de.dimension|0),"length"in de&&(N.nni(lt,"buffer length must be a nonnegative integer"),lt=de.length|0)),ne.bind(),Qe?Ae(ne,Qe,Ne,Le,xe,Me):(lt&&p.bufferData(ne.type,lt,Ne),ne.dtype=Le||zo,ne.usage=Ne,ne.dimension=xe,ne.byteLength=lt),O.profile&&(ne.stats.size=ne.byteLength*bo[ne.dtype]),ze}function le(de,Ne){N(Ne+de.byteLength<=ne.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+de.byteLength+" starting from offset "+Ne+" to a buffer of size "+ne.byteLength),p.bufferSubData(ne.type,Ne,de)}function Ie(de,Ne){var Qe=(Ne||0)|0,lt;if(ne.bind(),pt(de)||de instanceof ArrayBuffer)le(de,Qe);else if(Array.isArray(de)){if(de.length>0)if(typeof de[0]=="number"){var Le=Ln.allocType(ne.dtype,de.length);xo(Le,de),le(Le,Qe),Ln.freeType(Le)}else if(Array.isArray(de[0])||pt(de[0])){lt=na(de);var xe=co(de,lt,ne.dtype);le(xe,Qe),Ln.freeType(xe)}else N.raise("invalid buffer data")}else if(wt(de)){lt=de.shape;var ce=de.stride,at=0,_t=0,We=0,ht=0;lt.length===1?(at=lt[0],_t=1,We=ce[0],ht=0):lt.length===2?(at=lt[0],_t=lt[1],We=ce[0],ht=ce[1]):N.raise("invalid shape");var ot=Array.isArray(de.data)?ne.dtype:Bo(de.data),It=Ln.allocType(ot,at*_t);Ai(It,de.data,at,_t,We,ht,de.offset),le(It,Qe),Ln.freeType(It)}else N.raise("invalid data for buffer subdata");return ze}return ye||ze(V),ze._reglType="buffer",ze._buffer=ne,ze.subdata=Ie,O.profile&&(ze.stats=ne.stats),ze.destroy=function(){De(ne)},ze}function Re(){kt(Z).forEach(function(V){V.buffer=p.createBuffer(),p.bindBuffer(V.type,V.buffer),p.bufferData(V.type,V.persistentData||V.byteLength,V.usage)})}return O.profile&&(_.getTotalBufferSize=function(){var V=0;return Object.keys(Z).forEach(function(J){V+=Z[J].stats.size}),V}),{create:se,createStream:me,destroyStream:_e,clear:function(){kt(Z).forEach(De),fe.forEach(De)},getBuffer:function(V){return V&&V._buffer instanceof Q?V._buffer:null},restore:Re,_initBuffer:Ae}}var Is=0,Ns=0,Zr=1,Pu=1,wo=4,Uo=4,_o={points:Is,point:Ns,lines:Zr,line:Pu,triangles:wo,triangle:Uo,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},As=0,Fu=1,So=4,oa=5120,Vo=5121,ia=5122,lo=5123,Rs=5124,To=5125,Fa=34963,zu=35040,Ds=35044;function Ri(p,_,O,K){var ae={},Z=0,Q={uint8:Vo,uint16:lo};_.oes_element_index_uint&&(Q.uint32=To);function fe(Re){this.id=Z++,ae[this.id]=this,this.buffer=Re,this.primType=So,this.vertCount=0,this.type=0}fe.prototype.bind=function(){this.buffer.bind()};var me=[];function _e(Re){var V=me.pop();return V||(V=new fe(O.create(null,Fa,!0,!1)._buffer)),Ae(V,Re,zu,-1,-1,0,0),V}function ge(Re){me.push(Re)}function Ae(Re,V,J,ye,Me,ne,ze){Re.buffer.bind();var le;if(V){var Ie=ze;!ze&&(!pt(V)||wt(V)&&!pt(V.data))&&(Ie=_.oes_element_index_uint?To:lo),O._initBuffer(Re.buffer,V,J,Ie,3)}else p.bufferData(Fa,ne,J),Re.buffer.dtype=le||Vo,Re.buffer.usage=J,Re.buffer.dimension=3,Re.buffer.byteLength=ne;if(le=ze,!ze){switch(Re.buffer.dtype){case Vo:case oa:le=Vo;break;case lo:case ia:le=lo;break;case To:case Rs:le=To;break;default:N.raise("unsupported type for element array")}Re.buffer.dtype=le}Re.type=le,N(le!==To||!!_.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var de=Me;de<0&&(de=Re.buffer.byteLength,le===lo?de>>=1:le===To&&(de>>=2)),Re.vertCount=de;var Ne=ye;if(ye<0){Ne=So;var Qe=Re.buffer.dimension;Qe===1&&(Ne=As),Qe===2&&(Ne=Fu),Qe===3&&(Ne=So)}Re.primType=Ne}function De(Re){K.elementsCount--,N(Re.buffer!==null,"must not double destroy elements"),delete ae[Re.id],Re.buffer.destroy(),Re.buffer=null}function se(Re,V){var J=O.create(null,Fa,!0),ye=new fe(J._buffer);K.elementsCount++;function Me(ne){if(!ne)J(),ye.primType=So,ye.vertCount=0,ye.type=Vo;else if(typeof ne=="number")J(ne),ye.primType=So,ye.vertCount=ne|0,ye.type=Vo;else{var ze=null,le=Ds,Ie=-1,de=-1,Ne=0,Qe=0;Array.isArray(ne)||pt(ne)||wt(ne)?ze=ne:(N.type(ne,"object","invalid arguments for elements"),"data"in ne&&(ze=ne.data,N(Array.isArray(ze)||pt(ze)||wt(ze),"invalid data for element buffer")),"usage"in ne&&(N.parameter(ne.usage,Ni,"invalid element buffer usage"),le=Ni[ne.usage]),"primitive"in ne&&(N.parameter(ne.primitive,_o,"invalid element buffer primitive"),Ie=_o[ne.primitive]),"count"in ne&&(N(typeof ne.count=="number"&&ne.count>=0,"invalid vertex count for elements"),de=ne.count|0),"type"in ne&&(N.parameter(ne.type,Q,"invalid buffer type"),Qe=Q[ne.type]),"length"in ne?Ne=ne.length|0:(Ne=de,Qe===lo||Qe===ia?Ne*=2:(Qe===To||Qe===Rs)&&(Ne*=4))),Ae(ye,ze,le,Ie,de,Ne,Qe)}return Me}return Me(Re),Me._reglType="elements",Me._elements=ye,Me.subdata=function(ne,ze){return J.subdata(ne,ze),Me},Me.destroy=function(){De(ye)},Me}return{create:se,createStream:_e,destroyStream:ge,getElements:function(Re){return typeof Re=="function"&&Re._elements instanceof fe?Re._elements:null},clear:function(){kt(ae).forEach(De)}}}var za=new Float32Array(1),Cs=new Uint32Array(za.buffer),aa=5123;function Ba(p){for(var _=Ln.allocType(aa,p.length),O=0;O<p.length;++O)if(isNaN(p[O]))_[O]=65535;else if(p[O]===1/0)_[O]=31744;else if(p[O]===-1/0)_[O]=64512;else{za[0]=p[O];var K=Cs[0],ae=K>>>31<<15,Z=(K<<1>>>24)-127,Q=K>>13&1024-1;if(Z<-24)_[O]=ae;else if(Z<-14){var fe=-14-Z;_[O]=ae+(Q+1024>>fe)}else Z>15?_[O]=ae+31744:_[O]=ae+(Z+15<<10)+Q}return _}function Nn(p){return Array.isArray(p)||pt(p)}var Ua=function(p){return!(p&p-1)&&!!p},sa=34467,jr=3553,Va=34067,Di=34069,Yr=6408,Ci=6406,li=6407,di=6409,Xo=6410,pn=32854,$t=32855,Kn=36194,qn=32819,Fr=32820,zr=33635,Bu=34042,Os=6402,Ls=34041,Uu=35904,Vu=35906,ua=36193,Xu=33776,$u=33777,Wu=33778,Hu=33779,jc=35986,Yc=35987,Kc=34798,qc=35840,Qc=35841,Zu=35842,Jc=35843,ef=36196,Xa=5121,tf=5123,nf=5125,Ms=5126,Th=10242,Ih=10243,zl=10497,ju=33071,Bl=33648,Ul=10240,Vl=10241,$a=9728,Xl=9729,Wa=9984,rf=9985,of=9986,Yu=9987,Nh=33170,Ha=4352,$o=4353,$l=4354,ca=34046,Wl=3317,af=37440,sf=37441,Ah=37443,Hl=37444,fa=33984,Za=[Wa,of,rf,Yu],ks=[0,di,Xo,li,Yr],to={};to[di]=to[Ci]=to[Os]=1,to[Ls]=to[Xo]=2,to[li]=to[Uu]=3,to[Yr]=to[Vu]=4;function Oi(p){return"[object "+p+"]"}var Ku=Oi("HTMLCanvasElement"),uf=Oi("OffscreenCanvas"),qu=Oi("CanvasRenderingContext2D"),Qu=Oi("ImageBitmap"),Gs=Oi("HTMLImageElement"),cf=Oi("HTMLVideoElement"),Zl=Object.keys(Fo).concat([Ku,uf,qu,Qu,Gs,cf]),ja=[];ja[Xa]=1,ja[Ms]=4,ja[ua]=2,ja[tf]=2,ja[nf]=4;var fr=[];fr[pn]=2,fr[$t]=2,fr[Kn]=2,fr[Ls]=4,fr[Xu]=.5,fr[$u]=.5,fr[Wu]=1,fr[Hu]=1,fr[jc]=.5,fr[Yc]=1,fr[Kc]=1,fr[qc]=.5,fr[Qc]=.25,fr[Zu]=.5,fr[Jc]=.25,fr[ef]=.5;function Ps(p){return Array.isArray(p)&&(p.length===0||typeof p[0]=="number")}function Ju(p){if(!Array.isArray(p))return!1;var _=p.length;return!(_===0||!Nn(p[0]))}function Or(p){return Object.prototype.toString.call(p)}function jl(p){return Or(p)===Ku}function ec(p){return Or(p)===uf}function Yl(p){return Or(p)===qu}function ff(p){return Or(p)===Qu}function Kl(p){return Or(p)===Gs}function lf(p){return Or(p)===cf}function Fs(p){if(!p)return!1;var _=Or(p);return Zl.indexOf(_)>=0?!0:Ps(p)||Ju(p)||wt(p)}function ql(p){return Fo[Object.prototype.toString.call(p)]|0}function Ql(p,_){var O=_.length;switch(p.type){case Xa:case tf:case nf:case Ms:var K=Ln.allocType(p.type,O);K.set(_),p.data=K;break;case ua:p.data=Ba(_);break;default:N.raise("unsupported texture type, must specify a typed array")}}function df(p,_){return Ln.allocType(p.type===ua?Ms:p.type,_)}function hf(p,_){p.type===ua?(p.data=Ba(_),Ln.freeType(_)):p.data=_}function vf(p,_,O,K,ae,Z){for(var Q=p.width,fe=p.height,me=p.channels,_e=Q*fe*me,ge=df(p,_e),Ae=0,De=0;De<fe;++De)for(var se=0;se<Q;++se)for(var Re=0;Re<me;++Re)ge[Ae++]=_[O*se+K*De+ae*Re+Z];hf(p,ge)}function zs(p,_,O,K,ae,Z){var Q;if(typeof fr[p]!="undefined"?Q=fr[p]:Q=to[p]*ja[_],Z&&(Q*=6),ae){for(var fe=0,me=O;me>=1;)fe+=Q*me*me,me/=2;return fe}else return Q*O*K}function Jl(p,_,O,K,ae,Z,Q){var fe={"don't care":Ha,"dont care":Ha,nice:$l,fast:$o},me={repeat:zl,clamp:ju,mirror:Bl},_e={nearest:$a,linear:Xl},ge=oe({mipmap:Yu,"nearest mipmap nearest":Wa,"linear mipmap nearest":rf,"nearest mipmap linear":of,"linear mipmap linear":Yu},_e),Ae={none:0,browser:Hl},De={uint8:Xa,rgba4:qn,rgb565:zr,"rgb5 a1":Fr},se={alpha:Ci,luminance:di,"luminance alpha":Xo,rgb:li,rgba:Yr,rgba4:pn,"rgb5 a1":$t,rgb565:Kn},Re={};_.ext_srgb&&(se.srgb=Uu,se.srgba=Vu),_.oes_texture_float&&(De.float32=De.float=Ms),_.oes_texture_half_float&&(De.float16=De["half float"]=ua),_.webgl_depth_texture&&(oe(se,{depth:Os,"depth stencil":Ls}),oe(De,{uint16:tf,uint32:nf,"depth stencil":Bu})),_.webgl_compressed_texture_s3tc&&oe(Re,{"rgb s3tc dxt1":Xu,"rgba s3tc dxt1":$u,"rgba s3tc dxt3":Wu,"rgba s3tc dxt5":Hu}),_.webgl_compressed_texture_atc&&oe(Re,{"rgb atc":jc,"rgba atc explicit alpha":Yc,"rgba atc interpolated alpha":Kc}),_.webgl_compressed_texture_pvrtc&&oe(Re,{"rgb pvrtc 4bppv1":qc,"rgb pvrtc 2bppv1":Qc,"rgba pvrtc 4bppv1":Zu,"rgba pvrtc 2bppv1":Jc}),_.webgl_compressed_texture_etc1&&(Re["rgb etc1"]=ef);var V=Array.prototype.slice.call(p.getParameter(sa));Object.keys(Re).forEach(function(D){var Y=Re[D];V.indexOf(Y)>=0&&(se[D]=Y)});var J=Object.keys(se);O.textureFormats=J;var ye=[];Object.keys(se).forEach(function(D){var Y=se[D];ye[Y]=D});var Me=[];Object.keys(De).forEach(function(D){var Y=De[D];Me[Y]=D});var ne=[];Object.keys(_e).forEach(function(D){var Y=_e[D];ne[Y]=D});var ze=[];Object.keys(ge).forEach(function(D){var Y=ge[D];ze[Y]=D});var le=[];Object.keys(me).forEach(function(D){var Y=me[D];le[Y]=D});var Ie=J.reduce(function(D,Y){var H=se[Y];return H===di||H===Ci||H===di||H===Xo||H===Os||H===Ls||_.ext_srgb&&(H===Uu||H===Vu)?D[H]=H:H===$t||Y.indexOf("rgba")>=0?D[H]=Yr:D[H]=li,D},{});function de(){this.internalformat=Yr,this.format=Yr,this.type=Xa,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Hl,this.width=0,this.height=0,this.channels=0}function Ne(D,Y){D.internalformat=Y.internalformat,D.format=Y.format,D.type=Y.type,D.compressed=Y.compressed,D.premultiplyAlpha=Y.premultiplyAlpha,D.flipY=Y.flipY,D.unpackAlignment=Y.unpackAlignment,D.colorSpace=Y.colorSpace,D.width=Y.width,D.height=Y.height,D.channels=Y.channels}function Qe(D,Y){if(!(typeof Y!="object"||!Y)){if("premultiplyAlpha"in Y&&(N.type(Y.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),D.premultiplyAlpha=Y.premultiplyAlpha),"flipY"in Y&&(N.type(Y.flipY,"boolean","invalid texture flip"),D.flipY=Y.flipY),"alignment"in Y&&(N.oneOf(Y.alignment,[1,2,4,8],"invalid texture unpack alignment"),D.unpackAlignment=Y.alignment),"colorSpace"in Y&&(N.parameter(Y.colorSpace,Ae,"invalid colorSpace"),D.colorSpace=Ae[Y.colorSpace]),"type"in Y){var H=Y.type;N(_.oes_texture_float||!(H==="float"||H==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),N(_.oes_texture_half_float||!(H==="half float"||H==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),N(_.webgl_depth_texture||!(H==="uint16"||H==="uint32"||H==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),N.parameter(H,De,"invalid texture type"),D.type=De[H]}var Be=D.width,Dt=D.height,R=D.channels,x=!1;"shape"in Y?(N(Array.isArray(Y.shape)&&Y.shape.length>=2,"shape must be an array"),Be=Y.shape[0],Dt=Y.shape[1],Y.shape.length===3&&(R=Y.shape[2],N(R>0&&R<=4,"invalid number of channels"),x=!0),N(Be>=0&&Be<=O.maxTextureSize,"invalid width"),N(Dt>=0&&Dt<=O.maxTextureSize,"invalid height")):("radius"in Y&&(Be=Dt=Y.radius,N(Be>=0&&Be<=O.maxTextureSize,"invalid radius")),"width"in Y&&(Be=Y.width,N(Be>=0&&Be<=O.maxTextureSize,"invalid width")),"height"in Y&&(Dt=Y.height,N(Dt>=0&&Dt<=O.maxTextureSize,"invalid height")),"channels"in Y&&(R=Y.channels,N(R>0&&R<=4,"invalid number of channels"),x=!0)),D.width=Be|0,D.height=Dt|0,D.channels=R|0;var M=!1;if("format"in Y){var B=Y.format;N(_.webgl_depth_texture||!(B==="depth"||B==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),N.parameter(B,se,"invalid texture format");var X=D.internalformat=se[B];D.format=Ie[X],B in De&&("type"in Y||(D.type=De[B])),B in Re&&(D.compressed=!0),M=!0}!x&&M?D.channels=to[D.format]:x&&!M?D.channels!==ks[D.format]&&(D.format=D.internalformat=ks[D.channels]):M&&x&&N(D.channels===to[D.format],"number of channels inconsistent with specified format")}}function lt(D){p.pixelStorei(af,D.flipY),p.pixelStorei(sf,D.premultiplyAlpha),p.pixelStorei(Ah,D.colorSpace),p.pixelStorei(Wl,D.unpackAlignment)}function Le(){de.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function xe(D,Y){var H=null;if(Fs(Y)?H=Y:Y&&(N.type(Y,"object","invalid pixel data type"),Qe(D,Y),"x"in Y&&(D.xOffset=Y.x|0),"y"in Y&&(D.yOffset=Y.y|0),Fs(Y.data)&&(H=Y.data)),N(!D.compressed||H instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Y.copy){N(!H,"can not specify copy and data field for the same texture");var Be=ae.viewportWidth,Dt=ae.viewportHeight;D.width=D.width||Be-D.xOffset,D.height=D.height||Dt-D.yOffset,D.needsCopy=!0,N(D.xOffset>=0&&D.xOffset<Be&&D.yOffset>=0&&D.yOffset<Dt&&D.width>0&&D.width<=Be&&D.height>0&&D.height<=Dt,"copy texture read out of bounds")}else if(!H)D.width=D.width||1,D.height=D.height||1,D.channels=D.channels||4;else if(pt(H))D.channels=D.channels||4,D.data=H,!("type"in Y)&&D.type===Xa&&(D.type=ql(H));else if(Ps(H))D.channels=D.channels||4,Ql(D,H),D.alignment=1,D.needsFree=!0;else if(wt(H)){var R=H.data;!Array.isArray(R)&&D.type===Xa&&(D.type=ql(R));var x=H.shape,M=H.stride,B,X,F,G,z,A;x.length===3?(F=x[2],A=M[2]):(N(x.length===2,"invalid ndarray pixel data, must be 2 or 3D"),F=1,A=1),B=x[0],X=x[1],G=M[0],z=M[1],D.alignment=1,D.width=B,D.height=X,D.channels=F,D.format=D.internalformat=ks[F],D.needsFree=!0,vf(D,R,G,z,A,H.offset)}else if(jl(H)||ec(H)||Yl(H))jl(H)||ec(H)?D.element=H:D.element=H.canvas,D.width=D.element.width,D.height=D.element.height,D.channels=4;else if(ff(H))D.element=H,D.width=H.width,D.height=H.height,D.channels=4;else if(Kl(H))D.element=H,D.width=H.naturalWidth,D.height=H.naturalHeight,D.channels=4;else if(lf(H))D.element=H,D.width=H.videoWidth,D.height=H.videoHeight,D.channels=4;else if(Ju(H)){var L=D.width||H[0].length,I=D.height||H.length,U=D.channels;Nn(H[0][0])?U=U||H[0][0].length:U=U||1;for(var W=sn.shape(H),ie=1,ue=0;ue<W.length;++ue)ie*=W[ue];var re=df(D,ie);sn.flatten(H,W,"",re),hf(D,re),D.alignment=1,D.width=L,D.height=I,D.channels=U,D.format=D.internalformat=ks[U],D.needsFree=!0}D.type===Ms?N(O.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):D.type===ua&&N(O.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function ce(D,Y,H){var Be=D.element,Dt=D.data,R=D.internalformat,x=D.format,M=D.type,B=D.width,X=D.height;lt(D),Be?p.texImage2D(Y,H,x,x,M,Be):D.compressed?p.compressedTexImage2D(Y,H,R,B,X,0,Dt):D.needsCopy?(K(),p.copyTexImage2D(Y,H,x,D.xOffset,D.yOffset,B,X,0)):p.texImage2D(Y,H,x,B,X,0,x,M,Dt||null)}function at(D,Y,H,Be,Dt){var R=D.element,x=D.data,M=D.internalformat,B=D.format,X=D.type,F=D.width,G=D.height;lt(D),R?p.texSubImage2D(Y,Dt,H,Be,B,X,R):D.compressed?p.compressedTexSubImage2D(Y,Dt,H,Be,M,F,G,x):D.needsCopy?(K(),p.copyTexSubImage2D(Y,Dt,H,Be,D.xOffset,D.yOffset,F,G)):p.texSubImage2D(Y,Dt,H,Be,F,G,B,X,x)}var _t=[];function We(){return _t.pop()||new Le}function ht(D){D.needsFree&&Ln.freeType(D.data),Le.call(D),_t.push(D)}function ot(){de.call(this),this.genMipmaps=!1,this.mipmapHint=Ha,this.mipmask=0,this.images=Array(16)}function It(D,Y,H){var Be=D.images[0]=We();D.mipmask=1,Be.width=D.width=Y,Be.height=D.height=H,Be.channels=D.channels=4}function Ut(D,Y){var H=null;if(Fs(Y))H=D.images[0]=We(),Ne(H,D),xe(H,Y),D.mipmask=1;else if(Qe(D,Y),Array.isArray(Y.mipmap))for(var Be=Y.mipmap,Dt=0;Dt<Be.length;++Dt)H=D.images[Dt]=We(),Ne(H,D),H.width>>=Dt,H.height>>=Dt,xe(H,Be[Dt]),D.mipmask|=1<<Dt;else H=D.images[0]=We(),Ne(H,D),xe(H,Y),D.mipmask=1;Ne(D,D.images[0]),D.compressed&&(D.internalformat===Xu||D.internalformat===$u||D.internalformat===Wu||D.internalformat===Hu)&&N(D.width%4===0&&D.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function $n(D,Y){for(var H=D.images,Be=0;Be<H.length;++Be){if(!H[Be])return;ce(H[Be],Y,Be)}}var or=[];function St(){var D=or.pop()||new ot;de.call(D),D.mipmask=0;for(var Y=0;Y<16;++Y)D.images[Y]=null;return D}function Qn(D){for(var Y=D.images,H=0;H<Y.length;++H)Y[H]&&ht(Y[H]),Y[H]=null;or.push(D)}function vn(){this.minFilter=$a,this.magFilter=$a,this.wrapS=ju,this.wrapT=ju,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Ha}function Bn(D,Y){if("min"in Y){var H=Y.min;N.parameter(H,ge),D.minFilter=ge[H],Za.indexOf(D.minFilter)>=0&&!("faces"in Y)&&(D.genMipmaps=!0)}if("mag"in Y){var Be=Y.mag;N.parameter(Be,_e),D.magFilter=_e[Be]}var Dt=D.wrapS,R=D.wrapT;if("wrap"in Y){var x=Y.wrap;typeof x=="string"?(N.parameter(x,me),Dt=R=me[x]):Array.isArray(x)&&(N.parameter(x[0],me),N.parameter(x[1],me),Dt=me[x[0]],R=me[x[1]])}else{if("wrapS"in Y){var M=Y.wrapS;N.parameter(M,me),Dt=me[M]}if("wrapT"in Y){var B=Y.wrapT;N.parameter(B,me),R=me[B]}}if(D.wrapS=Dt,D.wrapT=R,"anisotropic"in Y){var X=Y.anisotropic;N(typeof X=="number"&&X>=1&&X<=O.maxAnisotropic,"aniso samples must be between 1 and "),D.anisotropic=Y.anisotropic}if("mipmap"in Y){var F=!1;switch(typeof Y.mipmap){case"string":N.parameter(Y.mipmap,fe,"invalid mipmap hint"),D.mipmapHint=fe[Y.mipmap],D.genMipmaps=!0,F=!0;break;case"boolean":F=D.genMipmaps=Y.mipmap;break;case"object":N(Array.isArray(Y.mipmap),"invalid mipmap type"),D.genMipmaps=!1,F=!0;break;default:N.raise("invalid mipmap type")}F&&!("min"in Y)&&(D.minFilter=Wa)}}function Wn(D,Y){p.texParameteri(Y,Vl,D.minFilter),p.texParameteri(Y,Ul,D.magFilter),p.texParameteri(Y,Th,D.wrapS),p.texParameteri(Y,Ih,D.wrapT),_.ext_texture_filter_anisotropic&&p.texParameteri(Y,ca,D.anisotropic),D.genMipmaps&&(p.hint(Nh,D.mipmapHint),p.generateMipmap(Y))}var Hn=0,dr={},hr=O.maxTextureUnits,An=Array(hr).map(function(){return null});function Tt(D){de.call(this),this.mipmask=0,this.internalformat=Yr,this.id=Hn++,this.refCount=1,this.target=D,this.texture=p.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new vn,Q.profile&&(this.stats={size:0})}function ir(D){p.activeTexture(fa),p.bindTexture(D.target,D.texture)}function zt(){var D=An[0];D?p.bindTexture(D.target,D.texture):p.bindTexture(jr,null)}function et(D){var Y=D.texture;N(Y,"must not double destroy texture");var H=D.unit,Be=D.target;H>=0&&(p.activeTexture(fa+H),p.bindTexture(Be,null),An[H]=null),p.deleteTexture(Y),D.texture=null,D.params=null,D.pixels=null,D.refCount=0,delete dr[D.id],Z.textureCount--}oe(Tt.prototype,{bind:function(){var D=this;D.bindCount+=1;var Y=D.unit;if(Y<0){for(var H=0;H<hr;++H){var Be=An[H];if(Be){if(Be.bindCount>0)continue;Be.unit=-1}An[H]=D,Y=H;break}Y>=hr&&N.raise("insufficient number of texture units"),Q.profile&&Z.maxTextureUnits<Y+1&&(Z.maxTextureUnits=Y+1),D.unit=Y,p.activeTexture(fa+Y),p.bindTexture(D.target,D.texture)}return Y},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&et(this)}});function Ct(D,Y){var H=new Tt(jr);dr[H.id]=H,Z.textureCount++;function Be(x,M){var B=H.texInfo;vn.call(B);var X=St();return typeof x=="number"?typeof M=="number"?It(X,x|0,M|0):It(X,x|0,x|0):x?(N.type(x,"object","invalid arguments to regl.texture"),Bn(B,x),Ut(X,x)):It(X,1,1),B.genMipmaps&&(X.mipmask=(X.width<<1)-1),H.mipmask=X.mipmask,Ne(H,X),N.texture2D(B,X,O),H.internalformat=X.internalformat,Be.width=X.width,Be.height=X.height,ir(H),$n(X,jr),Wn(B,jr),zt(),Qn(X),Q.profile&&(H.stats.size=zs(H.internalformat,H.type,X.width,X.height,B.genMipmaps,!1)),Be.format=ye[H.internalformat],Be.type=Me[H.type],Be.mag=ne[B.magFilter],Be.min=ze[B.minFilter],Be.wrapS=le[B.wrapS],Be.wrapT=le[B.wrapT],Be}function Dt(x,M,B,X){N(!!x,"must specify image data");var F=M|0,G=B|0,z=X|0,A=We();return Ne(A,H),A.width=0,A.height=0,xe(A,x),A.width=A.width||(H.width>>z)-F,A.height=A.height||(H.height>>z)-G,N(H.type===A.type&&H.format===A.format&&H.internalformat===A.internalformat,"incompatible format for texture.subimage"),N(F>=0&&G>=0&&F+A.width<=H.width&&G+A.height<=H.height,"texture.subimage write out of bounds"),N(H.mipmask&1<<z,"missing mipmap data"),N(A.data||A.element||A.needsCopy,"missing image data"),ir(H),at(A,jr,F,G,z),zt(),ht(A),Be}function R(x,M){var B=x|0,X=M|0||B;if(B===H.width&&X===H.height)return Be;Be.width=H.width=B,Be.height=H.height=X,ir(H);for(var F=0;H.mipmask>>F;++F){var G=B>>F,z=X>>F;if(!G||!z)break;p.texImage2D(jr,F,H.format,G,z,0,H.format,H.type,null)}return zt(),Q.profile&&(H.stats.size=zs(H.internalformat,H.type,B,X,!1,!1)),Be}return Be(D,Y),Be.subimage=Dt,Be.resize=R,Be._reglType="texture2d",Be._texture=H,Q.profile&&(Be.stats=H.stats),Be.destroy=function(){H.decRef()},Be}function Gt(D,Y,H,Be,Dt,R){var x=new Tt(Va);dr[x.id]=x,Z.cubeCount++;var M=new Array(6);function B(G,z,A,L,I,U){var W,ie=x.texInfo;for(vn.call(ie),W=0;W<6;++W)M[W]=St();if(typeof G=="number"||!G){var ue=G|0||1;for(W=0;W<6;++W)It(M[W],ue,ue)}else if(typeof G=="object")if(z)Ut(M[0],G),Ut(M[1],z),Ut(M[2],A),Ut(M[3],L),Ut(M[4],I),Ut(M[5],U);else if(Bn(ie,G),Qe(x,G),"faces"in G){var re=G.faces;for(N(Array.isArray(re)&&re.length===6,"cube faces must be a length 6 array"),W=0;W<6;++W)N(typeof re[W]=="object"&&!!re[W],"invalid input for cube map face"),Ne(M[W],x),Ut(M[W],re[W])}else for(W=0;W<6;++W)Ut(M[W],G);else N.raise("invalid arguments to cube map");for(Ne(x,M[0]),O.npotTextureCube||N(Ua(x.width)&&Ua(x.height),"your browser does not support non power or two texture dimensions"),ie.genMipmaps?x.mipmask=(M[0].width<<1)-1:x.mipmask=M[0].mipmask,N.textureCube(x,ie,M,O),x.internalformat=M[0].internalformat,B.width=M[0].width,B.height=M[0].height,ir(x),W=0;W<6;++W)$n(M[W],Di+W);for(Wn(ie,Va),zt(),Q.profile&&(x.stats.size=zs(x.internalformat,x.type,B.width,B.height,ie.genMipmaps,!0)),B.format=ye[x.internalformat],B.type=Me[x.type],B.mag=ne[ie.magFilter],B.min=ze[ie.minFilter],B.wrapS=le[ie.wrapS],B.wrapT=le[ie.wrapT],W=0;W<6;++W)Qn(M[W]);return B}function X(G,z,A,L,I){N(!!z,"must specify image data"),N(typeof G=="number"&&G===(G|0)&&G>=0&&G<6,"invalid face");var U=A|0,W=L|0,ie=I|0,ue=We();return Ne(ue,x),ue.width=0,ue.height=0,xe(ue,z),ue.width=ue.width||(x.width>>ie)-U,ue.height=ue.height||(x.height>>ie)-W,N(x.type===ue.type&&x.format===ue.format&&x.internalformat===ue.internalformat,"incompatible format for texture.subimage"),N(U>=0&&W>=0&&U+ue.width<=x.width&&W+ue.height<=x.height,"texture.subimage write out of bounds"),N(x.mipmask&1<<ie,"missing mipmap data"),N(ue.data||ue.element||ue.needsCopy,"missing image data"),ir(x),at(ue,Di+G,U,W,ie),zt(),ht(ue),B}function F(G){var z=G|0;if(z!==x.width){B.width=x.width=z,B.height=x.height=z,ir(x);for(var A=0;A<6;++A)for(var L=0;x.mipmask>>L;++L)p.texImage2D(Di+A,L,x.format,z>>L,z>>L,0,x.format,x.type,null);return zt(),Q.profile&&(x.stats.size=zs(x.internalformat,x.type,B.width,B.height,!1,!0)),B}}return B(D,Y,H,Be,Dt,R),B.subimage=X,B.resize=F,B._reglType="textureCube",B._texture=x,Q.profile&&(B.stats=x.stats),B.destroy=function(){x.decRef()},B}function Rn(){for(var D=0;D<hr;++D)p.activeTexture(fa+D),p.bindTexture(jr,null),An[D]=null;kt(dr).forEach(et),Z.cubeCount=0,Z.textureCount=0}Q.profile&&(Z.getTotalTextureSize=function(){var D=0;return Object.keys(dr).forEach(function(Y){D+=dr[Y].stats.size}),D});function Do(){for(var D=0;D<hr;++D){var Y=An[D];Y&&(Y.bindCount=0,Y.unit=-1,An[D]=null)}kt(dr).forEach(function(H){H.texture=p.createTexture(),p.bindTexture(H.target,H.texture);for(var Be=0;Be<32;++Be)if(H.mipmask&1<<Be)if(H.target===jr)p.texImage2D(jr,Be,H.internalformat,H.width>>Be,H.height>>Be,0,H.internalformat,H.type,null);else for(var Dt=0;Dt<6;++Dt)p.texImage2D(Di+Dt,Be,H.internalformat,H.width>>Be,H.height>>Be,0,H.internalformat,H.type,null);Wn(H.texInfo,H.target)})}function Ko(){for(var D=0;D<hr;++D){var Y=An[D];Y&&(Y.bindCount=0,Y.unit=-1,An[D]=null),p.activeTexture(fa+D),p.bindTexture(jr,null),p.bindTexture(Va,null)}}return{create2D:Ct,createCube:Gt,clear:Rn,getTexture:function(D){return null},restore:Do,refresh:Ko}}var Wo=36161,Ya=32854,pf=32855,mf=36194,gf=33189,yf=36168,Ef=34041,tc=35907,bf=34836,xf=34842,wf=34843,no=[];no[Ya]=2,no[pf]=2,no[mf]=2,no[gf]=2,no[yf]=1,no[Ef]=4,no[tc]=4,no[bf]=16,no[xf]=8,no[wf]=6;function _f(p,_,O){return no[p]*_*O}var ed=function(p,_,O,K,ae){var Z={rgba4:Ya,rgb565:mf,"rgb5 a1":pf,depth:gf,stencil:yf,"depth stencil":Ef};_.ext_srgb&&(Z.srgba=tc),_.ext_color_buffer_half_float&&(Z.rgba16f=xf,Z.rgb16f=wf),_.webgl_color_buffer_float&&(Z.rgba32f=bf);var Q=[];Object.keys(Z).forEach(function(se){var Re=Z[se];Q[Re]=se});var fe=0,me={};function _e(se){this.id=fe++,this.refCount=1,this.renderbuffer=se,this.format=Ya,this.width=0,this.height=0,ae.profile&&(this.stats={size:0})}_e.prototype.decRef=function(){--this.refCount<=0&&ge(this)};function ge(se){var Re=se.renderbuffer;N(Re,"must not double destroy renderbuffer"),p.bindRenderbuffer(Wo,null),p.deleteRenderbuffer(Re),se.renderbuffer=null,se.refCount=0,delete me[se.id],K.renderbufferCount--}function Ae(se,Re){var V=new _e(p.createRenderbuffer());me[V.id]=V,K.renderbufferCount++;function J(Me,ne){var ze=0,le=0,Ie=Ya;if(typeof Me=="object"&&Me){var de=Me;if("shape"in de){var Ne=de.shape;N(Array.isArray(Ne)&&Ne.length>=2,"invalid renderbuffer shape"),ze=Ne[0]|0,le=Ne[1]|0}else"radius"in de&&(ze=le=de.radius|0),"width"in de&&(ze=de.width|0),"height"in de&&(le=de.height|0);"format"in de&&(N.parameter(de.format,Z,"invalid renderbuffer format"),Ie=Z[de.format])}else typeof Me=="number"?(ze=Me|0,typeof ne=="number"?le=ne|0:le=ze):Me?N.raise("invalid arguments to renderbuffer constructor"):ze=le=1;if(N(ze>0&&le>0&&ze<=O.maxRenderbufferSize&&le<=O.maxRenderbufferSize,"invalid renderbuffer size"),!(ze===V.width&&le===V.height&&Ie===V.format))return J.width=V.width=ze,J.height=V.height=le,V.format=Ie,p.bindRenderbuffer(Wo,V.renderbuffer),p.renderbufferStorage(Wo,Ie,ze,le),N(p.getError()===0,"invalid render buffer format"),ae.profile&&(V.stats.size=_f(V.format,V.width,V.height)),J.format=Q[V.format],J}function ye(Me,ne){var ze=Me|0,le=ne|0||ze;return ze===V.width&&le===V.height||(N(ze>0&&le>0&&ze<=O.maxRenderbufferSize&&le<=O.maxRenderbufferSize,"invalid renderbuffer size"),J.width=V.width=ze,J.height=V.height=le,p.bindRenderbuffer(Wo,V.renderbuffer),p.renderbufferStorage(Wo,V.format,ze,le),N(p.getError()===0,"invalid render buffer format"),ae.profile&&(V.stats.size=_f(V.format,V.width,V.height))),J}return J(se,Re),J.resize=ye,J._reglType="renderbuffer",J._renderbuffer=V,ae.profile&&(J.stats=V.stats),J.destroy=function(){V.decRef()},J}ae.profile&&(K.getTotalRenderbufferSize=function(){var se=0;return Object.keys(me).forEach(function(Re){se+=me[Re].stats.size}),se});function De(){kt(me).forEach(function(se){se.renderbuffer=p.createRenderbuffer(),p.bindRenderbuffer(Wo,se.renderbuffer),p.renderbufferStorage(Wo,se.format,se.width,se.height)}),p.bindRenderbuffer(Wo,null)}return{create:Ae,clear:function(){kt(me).forEach(ge)},restore:De}},Ho=36160,nc=36161,la=3553,Bs=34069,Sf=36064,rc=36096,Tf=36128,If=33306,td=36053,Nf=36054,nd=36055,Af=36057,rd=36061,od=36193,id=5121,Rf=5126,oc=6407,Df=6408,ic=6402,ad=[oc,Df],Ka=[];Ka[Df]=4,Ka[oc]=3;var qa=[];qa[id]=1,qa[Rf]=4,qa[od]=2;var sd=32854,ud=32855,cd=36194,Cf=33189,ac=36168,fd=34041,Of=35907,ld=34836,Rh=34842,Lf=34843,dd=[sd,ud,cd,Of,Rh,Lf,ld],da={};da[td]="complete",da[Nf]="incomplete attachment",da[Af]="incomplete dimensions",da[nd]="incomplete, missing attachment",da[rd]="unsupported";function hd(p,_,O,K,ae,Z){var Q={cur:null,next:null,dirty:!1,setFBO:null},fe=["rgba"],me=["rgba4","rgb565","rgb5 a1"];_.ext_srgb&&me.push("srgba"),_.ext_color_buffer_half_float&&me.push("rgba16f","rgb16f"),_.webgl_color_buffer_float&&me.push("rgba32f");var _e=["uint8"];_.oes_texture_half_float&&_e.push("half float","float16"),_.oes_texture_float&&_e.push("float","float32");function ge(Le,xe,ce){this.target=Le,this.texture=xe,this.renderbuffer=ce;var at=0,_t=0;xe?(at=xe.width,_t=xe.height):ce&&(at=ce.width,_t=ce.height),this.width=at,this.height=_t}function Ae(Le){Le&&(Le.texture&&Le.texture._texture.decRef(),Le.renderbuffer&&Le.renderbuffer._renderbuffer.decRef())}function De(Le,xe,ce){if(Le)if(Le.texture){var at=Le.texture._texture,_t=Math.max(1,at.width),We=Math.max(1,at.height);N(_t===xe&&We===ce,"inconsistent width/height for supplied texture"),at.refCount+=1}else{var ht=Le.renderbuffer._renderbuffer;N(ht.width===xe&&ht.height===ce,"inconsistent width/height for renderbuffer"),ht.refCount+=1}}function se(Le,xe){xe&&(xe.texture?p.framebufferTexture2D(Ho,Le,xe.target,xe.texture._texture.texture,0):p.framebufferRenderbuffer(Ho,Le,nc,xe.renderbuffer._renderbuffer.renderbuffer))}function Re(Le){var xe=la,ce=null,at=null,_t=Le;typeof Le=="object"&&(_t=Le.data,"target"in Le&&(xe=Le.target|0)),N.type(_t,"function","invalid attachment data");var We=_t._reglType;return We==="texture2d"?(ce=_t,N(xe===la)):We==="textureCube"?(ce=_t,N(xe>=Bs&&xe<Bs+6,"invalid cube map target")):We==="renderbuffer"?(at=_t,xe=nc):N.raise("invalid regl object for attachment"),new ge(xe,ce,at)}function V(Le,xe,ce,at,_t){if(ce){var We=K.create2D({width:Le,height:xe,format:at,type:_t});return We._texture.refCount=0,new ge(la,We,null)}else{var ht=ae.create({width:Le,height:xe,format:at});return ht._renderbuffer.refCount=0,new ge(nc,null,ht)}}function J(Le){return Le&&(Le.texture||Le.renderbuffer)}function ye(Le,xe,ce){Le&&(Le.texture?Le.texture.resize(xe,ce):Le.renderbuffer&&Le.renderbuffer.resize(xe,ce),Le.width=xe,Le.height=ce)}var Me=0,ne={};function ze(){this.id=Me++,ne[this.id]=this,this.framebuffer=p.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function le(Le){Le.colorAttachments.forEach(Ae),Ae(Le.depthAttachment),Ae(Le.stencilAttachment),Ae(Le.depthStencilAttachment)}function Ie(Le){var xe=Le.framebuffer;N(xe,"must not double destroy framebuffer"),p.deleteFramebuffer(xe),Le.framebuffer=null,Z.framebufferCount--,delete ne[Le.id]}function de(Le){var xe;p.bindFramebuffer(Ho,Le.framebuffer);var ce=Le.colorAttachments;for(xe=0;xe<ce.length;++xe)se(Sf+xe,ce[xe]);for(xe=ce.length;xe<O.maxColorAttachments;++xe)p.framebufferTexture2D(Ho,Sf+xe,la,null,0);p.framebufferTexture2D(Ho,If,la,null,0),p.framebufferTexture2D(Ho,rc,la,null,0),p.framebufferTexture2D(Ho,Tf,la,null,0),se(rc,Le.depthAttachment),se(Tf,Le.stencilAttachment),se(If,Le.depthStencilAttachment);var at=p.checkFramebufferStatus(Ho);!p.isContextLost()&&at!==td&&N.raise("framebuffer configuration not supported, status = "+da[at]),p.bindFramebuffer(Ho,Q.next?Q.next.framebuffer:null),Q.cur=Q.next,p.getError()}function Ne(Le,xe){var ce=new ze;Z.framebufferCount++;function at(We,ht){var ot;N(Q.next!==ce,"can not update framebuffer which is currently in use");var It=0,Ut=0,$n=!0,or=!0,St=null,Qn=!0,vn="rgba",Bn="uint8",Wn=1,Hn=null,dr=null,hr=null,An=!1;if(typeof We=="number")It=We|0,Ut=ht|0||It;else if(!We)It=Ut=1;else{N.type(We,"object","invalid arguments for framebuffer");var Tt=We;if("shape"in Tt){var ir=Tt.shape;N(Array.isArray(ir)&&ir.length>=2,"invalid shape for framebuffer"),It=ir[0],Ut=ir[1]}else"radius"in Tt&&(It=Ut=Tt.radius),"width"in Tt&&(It=Tt.width),"height"in Tt&&(Ut=Tt.height);("color"in Tt||"colors"in Tt)&&(St=Tt.color||Tt.colors,Array.isArray(St)&&N(St.length===1||_.webgl_draw_buffers,"multiple render targets not supported")),St||("colorCount"in Tt&&(Wn=Tt.colorCount|0,N(Wn>0,"invalid color buffer count")),"colorTexture"in Tt&&(Qn=!!Tt.colorTexture,vn="rgba4"),"colorType"in Tt&&(Bn=Tt.colorType,Qn?(N(_.oes_texture_float||!(Bn==="float"||Bn==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),N(_.oes_texture_half_float||!(Bn==="half float"||Bn==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Bn==="half float"||Bn==="float16"?(N(_.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),vn="rgba16f"):(Bn==="float"||Bn==="float32")&&(N(_.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),vn="rgba32f"),N.oneOf(Bn,_e,"invalid color type")),"colorFormat"in Tt&&(vn=Tt.colorFormat,fe.indexOf(vn)>=0?Qn=!0:me.indexOf(vn)>=0?Qn=!1:Qn?N.oneOf(Tt.colorFormat,fe,"invalid color format for texture"):N.oneOf(Tt.colorFormat,me,"invalid color format for renderbuffer"))),("depthTexture"in Tt||"depthStencilTexture"in Tt)&&(An=!!(Tt.depthTexture||Tt.depthStencilTexture),N(!An||_.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Tt&&(typeof Tt.depth=="boolean"?$n=Tt.depth:(Hn=Tt.depth,or=!1)),"stencil"in Tt&&(typeof Tt.stencil=="boolean"?or=Tt.stencil:(dr=Tt.stencil,$n=!1)),"depthStencil"in Tt&&(typeof Tt.depthStencil=="boolean"?$n=or=Tt.depthStencil:(hr=Tt.depthStencil,$n=!1,or=!1))}var zt=null,et=null,Ct=null,Gt=null;if(Array.isArray(St))zt=St.map(Re);else if(St)zt=[Re(St)];else for(zt=new Array(Wn),ot=0;ot<Wn;++ot)zt[ot]=V(It,Ut,Qn,vn,Bn);N(_.webgl_draw_buffers||zt.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),N(zt.length<=O.maxColorAttachments,"too many color attachments, not supported"),It=It||zt[0].width,Ut=Ut||zt[0].height,Hn?et=Re(Hn):$n&&!or&&(et=V(It,Ut,An,"depth","uint32")),dr?Ct=Re(dr):or&&!$n&&(Ct=V(It,Ut,!1,"stencil","uint8")),hr?Gt=Re(hr):!Hn&&!dr&&or&&$n&&(Gt=V(It,Ut,An,"depth stencil","depth stencil")),N(!!Hn+!!dr+!!hr<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Rn=null;for(ot=0;ot<zt.length;++ot)if(De(zt[ot],It,Ut),N(!zt[ot]||zt[ot].texture&&ad.indexOf(zt[ot].texture._texture.format)>=0||zt[ot].renderbuffer&&dd.indexOf(zt[ot].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+ot+" is invalid"),zt[ot]&&zt[ot].texture){var Do=Ka[zt[ot].texture._texture.format]*qa[zt[ot].texture._texture.type];Rn===null?Rn=Do:N(Rn===Do,"all color attachments much have the same number of bits per pixel.")}return De(et,It,Ut),N(!et||et.texture&&et.texture._texture.format===ic||et.renderbuffer&&et.renderbuffer._renderbuffer.format===Cf,"invalid depth attachment for framebuffer object"),De(Ct,It,Ut),N(!Ct||Ct.renderbuffer&&Ct.renderbuffer._renderbuffer.format===ac,"invalid stencil attachment for framebuffer object"),De(Gt,It,Ut),N(!Gt||Gt.texture&&Gt.texture._texture.format===fd||Gt.renderbuffer&&Gt.renderbuffer._renderbuffer.format===fd,"invalid depth-stencil attachment for framebuffer object"),le(ce),ce.width=It,ce.height=Ut,ce.colorAttachments=zt,ce.depthAttachment=et,ce.stencilAttachment=Ct,ce.depthStencilAttachment=Gt,at.color=zt.map(J),at.depth=J(et),at.stencil=J(Ct),at.depthStencil=J(Gt),at.width=ce.width,at.height=ce.height,de(ce),at}function _t(We,ht){N(Q.next!==ce,"can not resize a framebuffer which is currently in use");var ot=Math.max(We|0,1),It=Math.max(ht|0||ot,1);if(ot===ce.width&&It===ce.height)return at;for(var Ut=ce.colorAttachments,$n=0;$n<Ut.length;++$n)ye(Ut[$n],ot,It);return ye(ce.depthAttachment,ot,It),ye(ce.stencilAttachment,ot,It),ye(ce.depthStencilAttachment,ot,It),ce.width=at.width=ot,ce.height=at.height=It,de(ce),at}return at(Le,xe),oe(at,{resize:_t,_reglType:"framebuffer",_framebuffer:ce,destroy:function(){Ie(ce),le(ce)},use:function(We){Q.setFBO({framebuffer:at},We)}})}function Qe(Le){var xe=Array(6);function ce(_t){var We;N(xe.indexOf(Q.next)<0,"can not update framebuffer which is currently in use");var ht={color:null},ot=0,It=null,Ut="rgba",$n="uint8",or=1;if(typeof _t=="number")ot=_t|0;else if(!_t)ot=1;else{N.type(_t,"object","invalid arguments for framebuffer");var St=_t;if("shape"in St){var Qn=St.shape;N(Array.isArray(Qn)&&Qn.length>=2,"invalid shape for framebuffer"),N(Qn[0]===Qn[1],"cube framebuffer must be square"),ot=Qn[0]}else"radius"in St&&(ot=St.radius|0),"width"in St?(ot=St.width|0,"height"in St&&N(St.height===ot,"must be square")):"height"in St&&(ot=St.height|0);("color"in St||"colors"in St)&&(It=St.color||St.colors,Array.isArray(It)&&N(It.length===1||_.webgl_draw_buffers,"multiple render targets not supported")),It||("colorCount"in St&&(or=St.colorCount|0,N(or>0,"invalid color buffer count")),"colorType"in St&&(N.oneOf(St.colorType,_e,"invalid color type"),$n=St.colorType),"colorFormat"in St&&(Ut=St.colorFormat,N.oneOf(St.colorFormat,fe,"invalid color format for texture"))),"depth"in St&&(ht.depth=St.depth),"stencil"in St&&(ht.stencil=St.stencil),"depthStencil"in St&&(ht.depthStencil=St.depthStencil)}var vn;if(It)if(Array.isArray(It))for(vn=[],We=0;We<It.length;++We)vn[We]=It[We];else vn=[It];else{vn=Array(or);var Bn={radius:ot,format:Ut,type:$n};for(We=0;We<or;++We)vn[We]=K.createCube(Bn)}for(ht.color=Array(vn.length),We=0;We<vn.length;++We){var Wn=vn[We];N(typeof Wn=="function"&&Wn._reglType==="textureCube","invalid cube map"),ot=ot||Wn.width,N(Wn.width===ot&&Wn.height===ot,"invalid cube map shape"),ht.color[We]={target:Bs,data:vn[We]}}for(We=0;We<6;++We){for(var Hn=0;Hn<vn.length;++Hn)ht.color[Hn].target=Bs+We;We>0&&(ht.depth=xe[0].depth,ht.stencil=xe[0].stencil,ht.depthStencil=xe[0].depthStencil),xe[We]?xe[We](ht):xe[We]=Ne(ht)}return oe(ce,{width:ot,height:ot,color:vn})}function at(_t){var We,ht=_t|0;if(N(ht>0&&ht<=O.maxCubeMapSize,"invalid radius for cube fbo"),ht===ce.width)return ce;var ot=ce.color;for(We=0;We<ot.length;++We)ot[We].resize(ht);for(We=0;We<6;++We)xe[We].resize(ht);return ce.width=ce.height=ht,ce}return ce(Le),oe(ce,{faces:xe,resize:at,_reglType:"framebufferCube",destroy:function(){xe.forEach(function(_t){_t.destroy()})}})}function lt(){Q.cur=null,Q.next=null,Q.dirty=!0,kt(ne).forEach(function(Le){Le.framebuffer=p.createFramebuffer(),de(Le)})}return oe(Q,{getFramebuffer:function(Le){if(typeof Le=="function"&&Le._reglType==="framebuffer"){var xe=Le._framebuffer;if(xe instanceof ze)return xe}return null},create:Ne,createCube:Qe,clear:function(){kt(ne).forEach(Ie)},restore:lt})}var Dh=5126,Mf=34962;function kf(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Dh,this.offset=0,this.stride=0,this.divisor=0}function vd(p,_,O,K,ae){for(var Z=O.maxAttributes,Q=new Array(Z),fe=0;fe<Z;++fe)Q[fe]=new kf;var me=0,_e={},ge={Record:kf,scope:{},state:Q,currentVAO:null,targetVAO:null,restore:De()?ne:function(){},createVAO:ze,getVAO:Re,destroyBuffer:Ae,setVAO:De()?V:J,clear:De()?ye:function(){}};function Ae(le){for(var Ie=0;Ie<Q.length;++Ie){var de=Q[Ie];de.buffer===le&&(p.disableVertexAttribArray(Ie),de.buffer=null)}}function De(){return _.oes_vertex_array_object}function se(){return _.angle_instanced_arrays}function Re(le){return typeof le=="function"&&le._vao?le._vao:null}function V(le){if(le!==ge.currentVAO){var Ie=De();le?Ie.bindVertexArrayOES(le.vao):Ie.bindVertexArrayOES(null),ge.currentVAO=le}}function J(le){if(le!==ge.currentVAO){if(le)le.bindAttrs();else for(var Ie=se(),de=0;de<Q.length;++de){var Ne=Q[de];Ne.buffer?(p.enableVertexAttribArray(de),p.vertexAttribPointer(de,Ne.size,Ne.type,Ne.normalized,Ne.stride,Ne.offfset),Ie&&Ne.divisor&&Ie.vertexAttribDivisorANGLE(de,Ne.divisor)):(p.disableVertexAttribArray(de),p.vertexAttrib4f(de,Ne.x,Ne.y,Ne.z,Ne.w))}ge.currentVAO=le}}function ye(){kt(_e).forEach(function(le){le.destroy()})}function Me(){this.id=++me,this.attributes=[];var le=De();le?this.vao=le.createVertexArrayOES():this.vao=null,_e[this.id]=this,this.buffers=[]}Me.prototype.bindAttrs=function(){for(var le=se(),Ie=this.attributes,de=0;de<Ie.length;++de){var Ne=Ie[de];Ne.buffer?(p.enableVertexAttribArray(de),p.bindBuffer(Mf,Ne.buffer.buffer),p.vertexAttribPointer(de,Ne.size,Ne.type,Ne.normalized,Ne.stride,Ne.offset),le&&Ne.divisor&&le.vertexAttribDivisorANGLE(de,Ne.divisor)):(p.disableVertexAttribArray(de),p.vertexAttrib4f(de,Ne.x,Ne.y,Ne.z,Ne.w))}for(var Qe=Ie.length;Qe<Z;++Qe)p.disableVertexAttribArray(Qe)},Me.prototype.refresh=function(){var le=De();le&&(le.bindVertexArrayOES(this.vao),this.bindAttrs(),ge.currentVAO=this)},Me.prototype.destroy=function(){if(this.vao){var le=De();this===ge.currentVAO&&(ge.currentVAO=null,le.bindVertexArrayOES(null)),le.deleteVertexArrayOES(this.vao),this.vao=null}_e[this.id]&&(delete _e[this.id],K.vaoCount-=1)};function ne(){var le=De();le&&kt(_e).forEach(function(Ie){Ie.refresh()})}function ze(le){var Ie=new Me;K.vaoCount+=1;function de(Ne){N(Array.isArray(Ne),"arguments to vertex array constructor must be an array"),N(Ne.length<Z,"too many attributes"),N(Ne.length>0,"must specify at least one attribute");var Qe={},lt=Ie.attributes;lt.length=Ne.length;for(var Le=0;Le<Ne.length;++Le){var xe=Ne[Le],ce=lt[Le]=new kf,at=xe.data||xe;if(Array.isArray(at)||pt(at)||wt(at)){var _t;Ie.buffers[Le]&&(_t=Ie.buffers[Le],pt(at)&&_t._buffer.byteLength>=at.byteLength?_t.subdata(at):(_t.destroy(),Ie.buffers[Le]=null)),Ie.buffers[Le]||(_t=Ie.buffers[Le]=ae.create(xe,Mf,!1,!0)),ce.buffer=ae.getBuffer(_t),ce.size=ce.buffer.dimension|0,ce.normalized=!1,ce.type=ce.buffer.dtype,ce.offset=0,ce.stride=0,ce.divisor=0,ce.state=1,Qe[Le]=1}else ae.getBuffer(xe)?(ce.buffer=ae.getBuffer(xe),ce.size=ce.buffer.dimension|0,ce.normalized=!1,ce.type=ce.buffer.dtype,ce.offset=0,ce.stride=0,ce.divisor=0,ce.state=1):ae.getBuffer(xe.buffer)?(ce.buffer=ae.getBuffer(xe.buffer),ce.size=(+xe.size||ce.buffer.dimension)|0,ce.normalized=!!xe.normalized||!1,"type"in xe?(N.parameter(xe.type,pr,"invalid buffer type"),ce.type=pr[xe.type]):ce.type=ce.buffer.dtype,ce.offset=(xe.offset||0)|0,ce.stride=(xe.stride||0)|0,ce.divisor=(xe.divisor||0)|0,ce.state=1,N(ce.size>=1&&ce.size<=4,"size must be between 1 and 4"),N(ce.offset>=0,"invalid offset"),N(ce.stride>=0&&ce.stride<=255,"stride must be between 0 and 255"),N(ce.divisor>=0,"divisor must be positive"),N(!ce.divisor||!!_.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in xe?(N(Le>0,"first attribute must not be a constant"),ce.x=+xe.x||0,ce.y=+xe.y||0,ce.z=+xe.z||0,ce.w=+xe.w||0,ce.state=2):N(!1,"invalid attribute spec for location "+Le)}for(var We=0;We<Ie.buffers.length;++We)!Qe[We]&&Ie.buffers[We]&&(Ie.buffers[We].destroy(),Ie.buffers[We]=null);return Ie.refresh(),de}return de.destroy=function(){for(var Ne=0;Ne<Ie.buffers.length;++Ne)Ie.buffers[Ne]&&Ie.buffers[Ne].destroy();Ie.buffers.length=0,Ie.destroy()},de._vao=Ie,de._reglType="vao",de(le)}return ge}var Gf=35632,pd=35633,md=35718,gd=35721;function yd(p,_,O,K){var ae={},Z={};function Q(V,J,ye,Me){this.name=V,this.id=J,this.location=ye,this.info=Me}function fe(V,J){for(var ye=0;ye<V.length;++ye)if(V[ye].id===J.id){V[ye].location=J.location;return}V.push(J)}function me(V,J,ye){var Me=V===Gf?ae:Z,ne=Me[J];if(!ne){var ze=_.str(J);ne=p.createShader(V),p.shaderSource(ne,ze),p.compileShader(ne),N.shaderError(p,ne,ze,V,ye),Me[J]=ne}return ne}var _e={},ge=[],Ae=0;function De(V,J){this.id=Ae++,this.fragId=V,this.vertId=J,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,K.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function se(V,J,ye){var Me,ne,ze=me(Gf,V.fragId),le=me(pd,V.vertId),Ie=V.program=p.createProgram();if(p.attachShader(Ie,ze),p.attachShader(Ie,le),ye)for(Me=0;Me<ye.length;++Me){var de=ye[Me];p.bindAttribLocation(Ie,de[0],de[1])}p.linkProgram(Ie),N.linkError(p,Ie,_.str(V.fragId),_.str(V.vertId),J);var Ne=p.getProgramParameter(Ie,md);K.profile&&(V.stats.uniformsCount=Ne);var Qe=V.uniforms;for(Me=0;Me<Ne;++Me)if(ne=p.getActiveUniform(Ie,Me),ne)if(ne.size>1)for(var lt=0;lt<ne.size;++lt){var Le=ne.name.replace("[0]","["+lt+"]");fe(Qe,new Q(Le,_.id(Le),p.getUniformLocation(Ie,Le),ne))}else fe(Qe,new Q(ne.name,_.id(ne.name),p.getUniformLocation(Ie,ne.name),ne));var xe=p.getProgramParameter(Ie,gd);K.profile&&(V.stats.attributesCount=xe);var ce=V.attributes;for(Me=0;Me<xe;++Me)ne=p.getActiveAttrib(Ie,Me),ne&&fe(ce,new Q(ne.name,_.id(ne.name),p.getAttribLocation(Ie,ne.name),ne))}K.profile&&(O.getMaxUniformsCount=function(){var V=0;return ge.forEach(function(J){J.stats.uniformsCount>V&&(V=J.stats.uniformsCount)}),V},O.getMaxAttributesCount=function(){var V=0;return ge.forEach(function(J){J.stats.attributesCount>V&&(V=J.stats.attributesCount)}),V});function Re(){ae={},Z={};for(var V=0;V<ge.length;++V)se(ge[V],null,ge[V].attributes.map(function(J){return[J.location,J.name]}))}return{clear:function(){var V=p.deleteShader.bind(p);kt(ae).forEach(V),ae={},kt(Z).forEach(V),Z={},ge.forEach(function(J){p.deleteProgram(J.program)}),ge.length=0,_e={},O.shaderCount=0},program:function(V,J,ye,Me){N.command(V>=0,"missing vertex shader",ye),N.command(J>=0,"missing fragment shader",ye);var ne=_e[J];ne||(ne=_e[J]={});var ze=ne[V];if(ze&&(ze.refCount++,!Me))return ze;var le=new De(J,V);return O.shaderCount++,se(le,ye,Me),ze||(ne[V]=le),ge.push(le),oe(le,{destroy:function(){if(le.refCount--,le.refCount<=0){p.deleteProgram(le.program);var Ie=ge.indexOf(le);ge.splice(Ie,1),O.shaderCount--}ne[le.vertId].refCount<=0&&(p.deleteShader(Z[le.vertId]),delete Z[le.vertId],delete _e[le.fragId][le.vertId]),Object.keys(_e[le.fragId]).length||(p.deleteShader(ae[le.fragId]),delete ae[le.fragId],delete _e[le.fragId])}})},restore:Re,shader:me,frag:-1,vert:-1}}var Pf=6408,Qa=5121,Ed=3333,Ja=5126;function bd(p,_,O,K,ae,Z,Q){function fe(ge){var Ae;_.next===null?(N(ae.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Ae=Qa):(N(_.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Ae=_.next.colorAttachments[0].texture._texture.type,Z.oes_texture_float?(N(Ae===Qa||Ae===Ja,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Ae===Ja&&N(Q.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):N(Ae===Qa,"Reading from a framebuffer is only allowed for the type 'uint8'"));var De=0,se=0,Re=K.framebufferWidth,V=K.framebufferHeight,J=null;pt(ge)?J=ge:ge&&(N.type(ge,"object","invalid arguments to regl.read()"),De=ge.x|0,se=ge.y|0,N(De>=0&&De<K.framebufferWidth,"invalid x offset for regl.read"),N(se>=0&&se<K.framebufferHeight,"invalid y offset for regl.read"),Re=(ge.width||K.framebufferWidth-De)|0,V=(ge.height||K.framebufferHeight-se)|0,J=ge.data||null),J&&(Ae===Qa?N(J instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Ae===Ja&&N(J instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),N(Re>0&&Re+De<=K.framebufferWidth,"invalid width for read pixels"),N(V>0&&V+se<=K.framebufferHeight,"invalid height for read pixels"),O();var ye=Re*V*4;return J||(Ae===Qa?J=new Uint8Array(ye):Ae===Ja&&(J=J||new Float32Array(ye))),N.isTypedArray(J,"data buffer for regl.read() must be a typedarray"),N(J.byteLength>=ye,"data buffer for regl.read() too small"),p.pixelStorei(Ed,4),p.readPixels(De,se,Re,V,Pf,Ae,J),J}function me(ge){var Ae;return _.setFBO({framebuffer:ge.framebuffer},function(){Ae=fe(ge)}),Ae}function _e(ge){return!ge||!("framebuffer"in ge)?fe(ge):me(ge)}return _e}function ha(p){return Array.prototype.slice.call(p)}function va(p){return ha(p).join("")}function xd(){var p=0,_=[],O=[];function K(Ae){for(var De=0;De<O.length;++De)if(O[De]===Ae)return _[De];var se="g"+p++;return _.push(se),O.push(Ae),se}function ae(){var Ae=[];function De(){Ae.push.apply(Ae,ha(arguments))}var se=[];function Re(){var V="v"+p++;return se.push(V),arguments.length>0&&(Ae.push(V,"="),Ae.push.apply(Ae,ha(arguments)),Ae.push(";")),V}return oe(De,{def:Re,toString:function(){return va([se.length>0?"var "+se.join(",")+";":"",va(Ae)])}})}function Z(){var Ae=ae(),De=ae(),se=Ae.toString,Re=De.toString;function V(J,ye){De(J,ye,"=",Ae.def(J,ye),";")}return oe(function(){Ae.apply(Ae,ha(arguments))},{def:Ae.def,entry:Ae,exit:De,save:V,set:function(J,ye,Me){V(J,ye),Ae(J,ye,"=",Me,";")},toString:function(){return se()+Re()}})}function Q(){var Ae=va(arguments),De=Z(),se=Z(),Re=De.toString,V=se.toString;return oe(De,{then:function(){return De.apply(De,ha(arguments)),this},else:function(){return se.apply(se,ha(arguments)),this},toString:function(){var J=V();return J&&(J="else{"+J+"}"),va(["if(",Ae,"){",Re(),"}",J])}})}var fe=ae(),me={};function _e(Ae,De){var se=[];function Re(){var ne="a"+se.length;return se.push(ne),ne}De=De||0;for(var V=0;V<De;++V)Re();var J=Z(),ye=J.toString,Me=me[Ae]=oe(J,{arg:Re,toString:function(){return va(["function(",se.join(),"){",ye(),"}"])}});return Me}function ge(){var Ae=['"use strict";',fe,"return {"];Object.keys(me).forEach(function(Re){Ae.push('"',Re,'":',me[Re].toString(),",")}),Ae.push("}");var De=va(Ae).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),se=Function.apply(null,_.concat(De));return se.apply(null,O)}return{global:fe,link:K,block:ae,proc:_e,scope:Z,cond:Q,compile:ge}}var Li="xyzw".split(""),sc=5121,hi=1,uc=2,Us=0,cc=1,Vs=2,Xs=3,$s=4,fc=5,Ff=6,lc="dither",dc="blend.enable",zf="blend.color",Ws="blend.equation",Hs="blend.func",hc="depth.enable",wd="depth.func",Bf="depth.range",Uf="depth.mask",vc="colorMask",Vf="cull.enable",_d="cull.face",pc="frontFace",Xf="lineWidth",$f="polygonOffset.enable",mc="polygonOffset.offset",Wf="sample.alpha",Hf="sample.enable",gc="sample.coverage",Zf="stencil.enable",jf="stencil.mask",es="stencil.func",yc="stencil.opFront",ts="stencil.opBack",Yf="scissor.enable",Zs="scissor.box",ho="viewport",ns="profile",Mi="framebuffer",rs="vert",os="frag",ki="elements",Gi="primitive",Pi="count",js="offset",Ys="instances",is="vao",Ec="Width",bc="Height",pa=Mi+Ec,vi=Mi+bc,xc=ho+Ec,Sd=ho+bc,Kf="drawingBuffer",Ks=Kf+Ec,qf=Kf+bc,qs=[Hs,Ws,es,yc,ts,gc,ho,Zs,mc],Zo=34962,Qf=34963,ma=35632,Td=35633,_r=3553,ga=34067,as=2884,Qs=3042,Js=3024,wc=2960,Id=2929,ya=3089,eu=32823,Nd=32926,Ad=32928,_c=5126,tu=35664,nu=35665,jo=35666,Ea=5124,ru=35667,ou=35668,iu=35669,Sc=35670,ss=35671,au=35672,Br=35673,Sr=35674,ba=35675,us=35676,cs=35678,Yo=35680,Jf=4,fs=1028,Fi=1029,Tc=2304,Io=2305,Ur=32775,el=32776,ls=519,No=7680,Ic=0,tl=1,nl=32774,zi=513,rl=36160,Rd=36064,Ao={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},ol=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],xa={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},pi={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},il={frag:ma,vert:Td},Nc={cw:Tc,ccw:Io};function Ro(p){return Array.isArray(p)||pt(p)||wt(p)}function wa(p){return p.sort(function(_,O){return _===ho?-1:O===ho?1:_<O?-1:1})}function lr(p,_,O,K){this.thisDep=p,this.contextDep=_,this.propDep=O,this.append=K}function mi(p){return p&&!(p.thisDep||p.contextDep||p.propDep)}function Xn(p){return new lr(!1,!1,!1,p)}function Vr(p,_){var O=p.type;if(O===Us){var K=p.data.length;return new lr(!0,K>=1,K>=2,_)}else if(O===$s){var ae=p.data;return new lr(ae.thisDep,ae.contextDep,ae.propDep,_)}else{if(O===fc)return new lr(!1,!1,!1,_);if(O===Ff){for(var Z=!1,Q=!1,fe=!1,me=0;me<p.data.length;++me){var _e=p.data[me];if(_e.type===cc)fe=!0;else if(_e.type===Vs)Q=!0;else if(_e.type===Xs)Z=!0;else if(_e.type===Us){Z=!0;var ge=_e.data;ge>=1&&(Q=!0),ge>=2&&(fe=!0)}else _e.type===$s&&(Z=Z||_e.data.thisDep,Q=Q||_e.data.contextDep,fe=fe||_e.data.propDep)}return new lr(Z,Q,fe,_)}else return new lr(O===Xs,O===Vs,O===cc,_)}}var al=new lr(!1,!1,!1,function(){});function Dd(p,_,O,K,ae,Z,Q,fe,me,_e,ge,Ae,De,se,Re){var V=_e.Record,J={add:32774,subtract:32778,"reverse subtract":32779};O.ext_blend_minmax&&(J.min=Ur,J.max=el);var ye=O.angle_instanced_arrays,Me=O.webgl_draw_buffers,ne={dirty:!0,profile:Re.profile},ze={},le=[],Ie={},de={};function Ne(R){return R.replace(".","_")}function Qe(R,x,M){var B=Ne(R);le.push(R),ze[B]=ne[B]=!!M,Ie[B]=x}function lt(R,x,M){var B=Ne(R);le.push(R),Array.isArray(M)?(ne[B]=M.slice(),ze[B]=M.slice()):ne[B]=ze[B]=M,de[B]=x}Qe(lc,Js),Qe(dc,Qs),lt(zf,"blendColor",[0,0,0,0]),lt(Ws,"blendEquationSeparate",[nl,nl]),lt(Hs,"blendFuncSeparate",[tl,Ic,tl,Ic]),Qe(hc,Id,!0),lt(wd,"depthFunc",zi),lt(Bf,"depthRange",[0,1]),lt(Uf,"depthMask",!0),lt(vc,vc,[!0,!0,!0,!0]),Qe(Vf,as),lt(_d,"cullFace",Fi),lt(pc,pc,Io),lt(Xf,Xf,1),Qe($f,eu),lt(mc,"polygonOffset",[0,0]),Qe(Wf,Nd),Qe(Hf,Ad),lt(gc,"sampleCoverage",[1,!1]),Qe(Zf,wc),lt(jf,"stencilMask",-1),lt(es,"stencilFunc",[ls,0,-1]),lt(yc,"stencilOpSeparate",[fs,No,No,No]),lt(ts,"stencilOpSeparate",[Fi,No,No,No]),Qe(Yf,ya),lt(Zs,"scissor",[0,0,p.drawingBufferWidth,p.drawingBufferHeight]),lt(ho,ho,[0,0,p.drawingBufferWidth,p.drawingBufferHeight]);var Le={gl:p,context:De,strings:_,next:ze,current:ne,draw:Ae,elements:Z,buffer:ae,shader:ge,attributes:_e.state,vao:_e,uniforms:me,framebuffer:fe,extensions:O,timer:se,isBufferArgs:Ro},xe={primTypes:_o,compareFuncs:xa,blendFuncs:Ao,blendEquations:J,stencilOps:pi,glTypes:pr,orientationType:Nc};N.optional(function(){Le.isArrayLike=Nn}),Me&&(xe.backBuffer=[Fi],xe.drawBuffer=cr(K.maxDrawbuffers,function(R){return R===0?[0]:cr(R,function(x){return Rd+x})}));var ce=0;function at(){var R=xd(),x=R.link,M=R.global;R.id=ce++,R.batchId="0";var B=x(Le),X=R.shared={props:"a0"};Object.keys(Le).forEach(function(L){X[L]=M.def(B,".",L)}),N.optional(function(){R.CHECK=x(N),R.commandStr=N.guessCommand(),R.command=x(R.commandStr),R.assert=function(L,I,U){L("if(!(",I,"))",this.CHECK,".commandRaise(",x(U),",",this.command,");")},xe.invalidBlendCombinations=ol});var F=R.next={},G=R.current={};Object.keys(de).forEach(function(L){Array.isArray(ne[L])&&(F[L]=M.def(X.next,".",L),G[L]=M.def(X.current,".",L))});var z=R.constants={};Object.keys(xe).forEach(function(L){z[L]=M.def(JSON.stringify(xe[L]))}),R.invoke=function(L,I){switch(I.type){case Us:var U=["this",X.context,X.props,R.batchId];return L.def(x(I.data),".call(",U.slice(0,Math.max(I.data.length+1,4)),")");case cc:return L.def(X.props,I.data);case Vs:return L.def(X.context,I.data);case Xs:return L.def("this",I.data);case $s:return I.data.append(R,L),I.data.ref;case fc:return I.data.toString();case Ff:return I.data.map(function(W){return R.invoke(L,W)})}},R.attribCache={};var A={};return R.scopeAttrib=function(L){var I=_.id(L);if(I in A)return A[I];var U=_e.scope[I];U||(U=_e.scope[I]=new V);var W=A[I]=x(U);return W},R}function _t(R){var x=R.static,M=R.dynamic,B;if(ns in x){var X=!!x[ns];B=Xn(function(G,z){return X}),B.enable=X}else if(ns in M){var F=M[ns];B=Vr(F,function(G,z){return G.invoke(z,F)})}return B}function We(R,x){var M=R.static,B=R.dynamic;if(Mi in M){var X=M[Mi];return X?(X=fe.getFramebuffer(X),N.command(X,"invalid framebuffer object"),Xn(function(G,z){var A=G.link(X),L=G.shared;z.set(L.framebuffer,".next",A);var I=L.context;return z.set(I,"."+pa,A+".width"),z.set(I,"."+vi,A+".height"),A})):Xn(function(G,z){var A=G.shared;z.set(A.framebuffer,".next","null");var L=A.context;return z.set(L,"."+pa,L+"."+Ks),z.set(L,"."+vi,L+"."+qf),"null"})}else if(Mi in B){var F=B[Mi];return Vr(F,function(G,z){var A=G.invoke(z,F),L=G.shared,I=L.framebuffer,U=z.def(I,".getFramebuffer(",A,")");N.optional(function(){G.assert(z,"!"+A+"||"+U,"invalid framebuffer object")}),z.set(I,".next",U);var W=L.context;return z.set(W,"."+pa,U+"?"+U+".width:"+W+"."+Ks),z.set(W,"."+vi,U+"?"+U+".height:"+W+"."+qf),U})}else return null}function ht(R,x,M){var B=R.static,X=R.dynamic;function F(A){if(A in B){var L=B[A];N.commandType(L,"object","invalid "+A,M.commandStr);var I=!0,U=L.x|0,W=L.y|0,ie,ue;return"width"in L?(ie=L.width|0,N.command(ie>=0,"invalid "+A,M.commandStr)):I=!1,"height"in L?(ue=L.height|0,N.command(ue>=0,"invalid "+A,M.commandStr)):I=!1,new lr(!I&&x&&x.thisDep,!I&&x&&x.contextDep,!I&&x&&x.propDep,function(Ye,yt){var He=Ye.shared.context,rt=ie;"width"in L||(rt=yt.def(He,".",pa,"-",U));var vt=ue;return"height"in L||(vt=yt.def(He,".",vi,"-",W)),[U,W,rt,vt]})}else if(A in X){var re=X[A],we=Vr(re,function(Ye,yt){var He=Ye.invoke(yt,re);N.optional(function(){Ye.assert(yt,He+"&&typeof "+He+'==="object"',"invalid "+A)});var rt=Ye.shared.context,vt=yt.def(He,".x|0"),Vt=yt.def(He,".y|0"),Gn=yt.def('"width" in ',He,"?",He,".width|0:","(",rt,".",pa,"-",vt,")"),Tr=yt.def('"height" in ',He,"?",He,".height|0:","(",rt,".",vi,"-",Vt,")");return N.optional(function(){Ye.assert(yt,Gn+">=0&&"+Tr+">=0","invalid "+A)}),[vt,Vt,Gn,Tr]});return x&&(we.thisDep=we.thisDep||x.thisDep,we.contextDep=we.contextDep||x.contextDep,we.propDep=we.propDep||x.propDep),we}else return x?new lr(x.thisDep,x.contextDep,x.propDep,function(Ye,yt){var He=Ye.shared.context;return[0,0,yt.def(He,".",pa),yt.def(He,".",vi)]}):null}var G=F(ho);if(G){var z=G;G=new lr(G.thisDep,G.contextDep,G.propDep,function(A,L){var I=z.append(A,L),U=A.shared.context;return L.set(U,"."+xc,I[2]),L.set(U,"."+Sd,I[3]),I})}return{viewport:G,scissor_box:F(Zs)}}function ot(R,x){var M=R.static,B=typeof M[os]=="string"&&typeof M[rs]=="string";if(B){if(Object.keys(x.dynamic).length>0)return null;var X=x.static,F=Object.keys(X);if(F.length>0&&typeof X[F[0]]=="number"){for(var G=[],z=0;z<F.length;++z)N(typeof X[F[z]]=="number","must specify all vertex attribute locations when using vaos"),G.push([X[F[z]]|0,F[z]]);return G}}return null}function It(R,x,M){var B=R.static,X=R.dynamic;function F(I){if(I in B){var U=_.id(B[I]);N.optional(function(){ge.shader(il[I],U,N.guessCommand())});var W=Xn(function(){return U});return W.id=U,W}else if(I in X){var ie=X[I];return Vr(ie,function(ue,re){var we=ue.invoke(re,ie),Ye=re.def(ue.shared.strings,".id(",we,")");return N.optional(function(){re(ue.shared.shader,".shader(",il[I],",",Ye,",",ue.command,");")}),Ye})}return null}var G=F(os),z=F(rs),A=null,L;return mi(G)&&mi(z)?(A=ge.program(z.id,G.id,null,M),L=Xn(function(I,U){return I.link(A)})):L=new lr(G&&G.thisDep||z&&z.thisDep,G&&G.contextDep||z&&z.contextDep,G&&G.propDep||z&&z.propDep,function(I,U){var W=I.shared.shader,ie;G?ie=G.append(I,U):ie=U.def(W,".",os);var ue;z?ue=z.append(I,U):ue=U.def(W,".",rs);var re=W+".program("+ue+","+ie;return N.optional(function(){re+=","+I.command}),U.def(re+")")}),{frag:G,vert:z,progVar:L,program:A}}function Ut(R,x){var M=R.static,B=R.dynamic;function X(){if(ki in M){var I=M[ki];Ro(I)?I=Z.getElements(Z.create(I,!0)):I&&(I=Z.getElements(I),N.command(I,"invalid elements",x.commandStr));var U=Xn(function(ie,ue){if(I){var re=ie.link(I);return ie.ELEMENTS=re,re}return ie.ELEMENTS=null,null});return U.value=I,U}else if(ki in B){var W=B[ki];return Vr(W,function(ie,ue){var re=ie.shared,we=re.isBufferArgs,Ye=re.elements,yt=ie.invoke(ue,W),He=ue.def("null"),rt=ue.def(we,"(",yt,")"),vt=ie.cond(rt).then(He,"=",Ye,".createStream(",yt,");").else(He,"=",Ye,".getElements(",yt,");");return N.optional(function(){ie.assert(vt.else,"!"+yt+"||"+He,"invalid elements")}),ue.entry(vt),ue.exit(ie.cond(rt).then(Ye,".destroyStream(",He,");")),ie.ELEMENTS=He,He})}return null}var F=X();function G(){if(Gi in M){var I=M[Gi];return N.commandParameter(I,_o,"invalid primitve",x.commandStr),Xn(function(W,ie){return _o[I]})}else if(Gi in B){var U=B[Gi];return Vr(U,function(W,ie){var ue=W.constants.primTypes,re=W.invoke(ie,U);return N.optional(function(){W.assert(ie,re+" in "+ue,"invalid primitive, must be one of "+Object.keys(_o))}),ie.def(ue,"[",re,"]")})}else if(F)return mi(F)?F.value?Xn(function(W,ie){return ie.def(W.ELEMENTS,".primType")}):Xn(function(){return Jf}):new lr(F.thisDep,F.contextDep,F.propDep,function(W,ie){var ue=W.ELEMENTS;return ie.def(ue,"?",ue,".primType:",Jf)});return null}function z(I,U){if(I in M){var W=M[I]|0;return N.command(!U||W>=0,"invalid "+I,x.commandStr),Xn(function(ue,re){return U&&(ue.OFFSET=W),W})}else if(I in B){var ie=B[I];return Vr(ie,function(ue,re){var we=ue.invoke(re,ie);return U&&(ue.OFFSET=we,N.optional(function(){ue.assert(re,we+">=0","invalid "+I)})),we})}else if(U&&F)return Xn(function(ue,re){return ue.OFFSET="0",0});return null}var A=z(js,!0);function L(){if(Pi in M){var I=M[Pi]|0;return N.command(typeof I=="number"&&I>=0,"invalid vertex count",x.commandStr),Xn(function(){return I})}else if(Pi in B){var U=B[Pi];return Vr(U,function(ue,re){var we=ue.invoke(re,U);return N.optional(function(){ue.assert(re,"typeof "+we+'==="number"&&'+we+">=0&&"+we+"===("+we+"|0)","invalid vertex count")}),we})}else if(F)if(mi(F)){if(F)return A?new lr(A.thisDep,A.contextDep,A.propDep,function(ue,re){var we=re.def(ue.ELEMENTS,".vertCount-",ue.OFFSET);return N.optional(function(){ue.assert(re,we+">=0","invalid vertex offset/element buffer too small")}),we}):Xn(function(ue,re){return re.def(ue.ELEMENTS,".vertCount")});var W=Xn(function(){return-1});return N.optional(function(){W.MISSING=!0}),W}else{var ie=new lr(F.thisDep||A.thisDep,F.contextDep||A.contextDep,F.propDep||A.propDep,function(ue,re){var we=ue.ELEMENTS;return ue.OFFSET?re.def(we,"?",we,".vertCount-",ue.OFFSET,":-1"):re.def(we,"?",we,".vertCount:-1")});return N.optional(function(){ie.DYNAMIC=!0}),ie}return null}return{elements:F,primitive:G(),count:L(),instances:z(Ys,!1),offset:A}}function $n(R,x){var M=R.static,B=R.dynamic,X={};return le.forEach(function(F){var G=Ne(F);function z(A,L){if(F in M){var I=A(M[F]);X[G]=Xn(function(){return I})}else if(F in B){var U=B[F];X[G]=Vr(U,function(W,ie){return L(W,ie,W.invoke(ie,U))})}}switch(F){case Vf:case dc:case lc:case Zf:case hc:case Yf:case $f:case Wf:case Hf:case Uf:return z(function(A){return N.commandType(A,"boolean",F,x.commandStr),A},function(A,L,I){return N.optional(function(){A.assert(L,"typeof "+I+'==="boolean"',"invalid flag "+F,A.commandStr)}),I});case wd:return z(function(A){return N.commandParameter(A,xa,"invalid "+F,x.commandStr),xa[A]},function(A,L,I){var U=A.constants.compareFuncs;return N.optional(function(){A.assert(L,I+" in "+U,"invalid "+F+", must be one of "+Object.keys(xa))}),L.def(U,"[",I,"]")});case Bf:return z(function(A){return N.command(Nn(A)&&A.length===2&&typeof A[0]=="number"&&typeof A[1]=="number"&&A[0]<=A[1],"depth range is 2d array",x.commandStr),A},function(A,L,I){N.optional(function(){A.assert(L,A.shared.isArrayLike+"("+I+")&&"+I+".length===2&&typeof "+I+'[0]==="number"&&typeof '+I+'[1]==="number"&&'+I+"[0]<="+I+"[1]","depth range must be a 2d array")});var U=L.def("+",I,"[0]"),W=L.def("+",I,"[1]");return[U,W]});case Hs:return z(function(A){N.commandType(A,"object","blend.func",x.commandStr);var L="srcRGB"in A?A.srcRGB:A.src,I="srcAlpha"in A?A.srcAlpha:A.src,U="dstRGB"in A?A.dstRGB:A.dst,W="dstAlpha"in A?A.dstAlpha:A.dst;return N.commandParameter(L,Ao,G+".srcRGB",x.commandStr),N.commandParameter(I,Ao,G+".srcAlpha",x.commandStr),N.commandParameter(U,Ao,G+".dstRGB",x.commandStr),N.commandParameter(W,Ao,G+".dstAlpha",x.commandStr),N.command(ol.indexOf(L+", "+U)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+L+", "+U+")",x.commandStr),[Ao[L],Ao[U],Ao[I],Ao[W]]},function(A,L,I){var U=A.constants.blendFuncs;N.optional(function(){A.assert(L,I+"&&typeof "+I+'==="object"',"invalid blend func, must be an object")});function W(He,rt){var vt=L.def('"',He,rt,'" in ',I,"?",I,".",He,rt,":",I,".",He);return N.optional(function(){A.assert(L,vt+" in "+U,"invalid "+F+"."+He+rt+", must be one of "+Object.keys(Ao))}),vt}var ie=W("src","RGB"),ue=W("dst","RGB");N.optional(function(){var He=A.constants.invalidBlendCombinations;A.assert(L,He+".indexOf("+ie+'+", "+'+ue+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var re=L.def(U,"[",ie,"]"),we=L.def(U,"[",W("src","Alpha"),"]"),Ye=L.def(U,"[",ue,"]"),yt=L.def(U,"[",W("dst","Alpha"),"]");return[re,Ye,we,yt]});case Ws:return z(function(A){if(typeof A=="string")return N.commandParameter(A,J,"invalid "+F,x.commandStr),[J[A],J[A]];if(typeof A=="object")return N.commandParameter(A.rgb,J,F+".rgb",x.commandStr),N.commandParameter(A.alpha,J,F+".alpha",x.commandStr),[J[A.rgb],J[A.alpha]];N.commandRaise("invalid blend.equation",x.commandStr)},function(A,L,I){var U=A.constants.blendEquations,W=L.def(),ie=L.def(),ue=A.cond("typeof ",I,'==="string"');return N.optional(function(){function re(we,Ye,yt){A.assert(we,yt+" in "+U,"invalid "+Ye+", must be one of "+Object.keys(J))}re(ue.then,F,I),A.assert(ue.else,I+"&&typeof "+I+'==="object"',"invalid "+F),re(ue.else,F+".rgb",I+".rgb"),re(ue.else,F+".alpha",I+".alpha")}),ue.then(W,"=",ie,"=",U,"[",I,"];"),ue.else(W,"=",U,"[",I,".rgb];",ie,"=",U,"[",I,".alpha];"),L(ue),[W,ie]});case zf:return z(function(A){return N.command(Nn(A)&&A.length===4,"blend.color must be a 4d array",x.commandStr),cr(4,function(L){return+A[L]})},function(A,L,I){return N.optional(function(){A.assert(L,A.shared.isArrayLike+"("+I+")&&"+I+".length===4","blend.color must be a 4d array")}),cr(4,function(U){return L.def("+",I,"[",U,"]")})});case jf:return z(function(A){return N.commandType(A,"number",G,x.commandStr),A|0},function(A,L,I){return N.optional(function(){A.assert(L,"typeof "+I+'==="number"',"invalid stencil.mask")}),L.def(I,"|0")});case es:return z(function(A){N.commandType(A,"object",G,x.commandStr);var L=A.cmp||"keep",I=A.ref||0,U="mask"in A?A.mask:-1;return N.commandParameter(L,xa,F+".cmp",x.commandStr),N.commandType(I,"number",F+".ref",x.commandStr),N.commandType(U,"number",F+".mask",x.commandStr),[xa[L],I,U]},function(A,L,I){var U=A.constants.compareFuncs;N.optional(function(){function re(){A.assert(L,Array.prototype.join.call(arguments,""),"invalid stencil.func")}re(I+"&&typeof ",I,'==="object"'),re('!("cmp" in ',I,")||(",I,".cmp in ",U,")")});var W=L.def('"cmp" in ',I,"?",U,"[",I,".cmp]",":",No),ie=L.def(I,".ref|0"),ue=L.def('"mask" in ',I,"?",I,".mask|0:-1");return[W,ie,ue]});case yc:case ts:return z(function(A){N.commandType(A,"object",G,x.commandStr);var L=A.fail||"keep",I=A.zfail||"keep",U=A.zpass||"keep";return N.commandParameter(L,pi,F+".fail",x.commandStr),N.commandParameter(I,pi,F+".zfail",x.commandStr),N.commandParameter(U,pi,F+".zpass",x.commandStr),[F===ts?Fi:fs,pi[L],pi[I],pi[U]]},function(A,L,I){var U=A.constants.stencilOps;N.optional(function(){A.assert(L,I+"&&typeof "+I+'==="object"',"invalid "+F)});function W(ie){return N.optional(function(){A.assert(L,'!("'+ie+'" in '+I+")||("+I+"."+ie+" in "+U+")","invalid "+F+"."+ie+", must be one of "+Object.keys(pi))}),L.def('"',ie,'" in ',I,"?",U,"[",I,".",ie,"]:",No)}return[F===ts?Fi:fs,W("fail"),W("zfail"),W("zpass")]});case mc:return z(function(A){N.commandType(A,"object",G,x.commandStr);var L=A.factor|0,I=A.units|0;return N.commandType(L,"number",G+".factor",x.commandStr),N.commandType(I,"number",G+".units",x.commandStr),[L,I]},function(A,L,I){N.optional(function(){A.assert(L,I+"&&typeof "+I+'==="object"',"invalid "+F)});var U=L.def(I,".factor|0"),W=L.def(I,".units|0");return[U,W]});case _d:return z(function(A){var L=0;return A==="front"?L=fs:A==="back"&&(L=Fi),N.command(!!L,G,x.commandStr),L},function(A,L,I){return N.optional(function(){A.assert(L,I+'==="front"||'+I+'==="back"',"invalid cull.face")}),L.def(I,'==="front"?',fs,":",Fi)});case Xf:return z(function(A){return N.command(typeof A=="number"&&A>=K.lineWidthDims[0]&&A<=K.lineWidthDims[1],"invalid line width, must be a positive number between "+K.lineWidthDims[0]+" and "+K.lineWidthDims[1],x.commandStr),A},function(A,L,I){return N.optional(function(){A.assert(L,"typeof "+I+'==="number"&&'+I+">="+K.lineWidthDims[0]+"&&"+I+"<="+K.lineWidthDims[1],"invalid line width")}),I});case pc:return z(function(A){return N.commandParameter(A,Nc,G,x.commandStr),Nc[A]},function(A,L,I){return N.optional(function(){A.assert(L,I+'==="cw"||'+I+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),L.def(I+'==="cw"?'+Tc+":"+Io)});case vc:return z(function(A){return N.command(Nn(A)&&A.length===4,"color.mask must be length 4 array",x.commandStr),A.map(function(L){return!!L})},function(A,L,I){return N.optional(function(){A.assert(L,A.shared.isArrayLike+"("+I+")&&"+I+".length===4","invalid color.mask")}),cr(4,function(U){return"!!"+I+"["+U+"]"})});case gc:return z(function(A){N.command(typeof A=="object"&&A,G,x.commandStr);var L="value"in A?A.value:1,I=!!A.invert;return N.command(typeof L=="number"&&L>=0&&L<=1,"sample.coverage.value must be a number between 0 and 1",x.commandStr),[L,I]},function(A,L,I){N.optional(function(){A.assert(L,I+"&&typeof "+I+'==="object"',"invalid sample.coverage")});var U=L.def('"value" in ',I,"?+",I,".value:1"),W=L.def("!!",I,".invert");return[U,W]})}}),X}function or(R,x){var M=R.static,B=R.dynamic,X={};return Object.keys(M).forEach(function(F){var G=M[F],z;if(typeof G=="number"||typeof G=="boolean")z=Xn(function(){return G});else if(typeof G=="function"){var A=G._reglType;A==="texture2d"||A==="textureCube"?z=Xn(function(L){return L.link(G)}):A==="framebuffer"||A==="framebufferCube"?(N.command(G.color.length>0,'missing color attachment for framebuffer sent to uniform "'+F+'"',x.commandStr),z=Xn(function(L){return L.link(G.color[0])})):N.commandRaise('invalid data for uniform "'+F+'"',x.commandStr)}else Nn(G)?z=Xn(function(L){var I=L.global.def("[",cr(G.length,function(U){return N.command(typeof G[U]=="number"||typeof G[U]=="boolean","invalid uniform "+F,L.commandStr),G[U]}),"]");return I}):N.commandRaise('invalid or missing data for uniform "'+F+'"',x.commandStr);z.value=G,X[F]=z}),Object.keys(B).forEach(function(F){var G=B[F];X[F]=Vr(G,function(z,A){return z.invoke(A,G)})}),X}function St(R,x){var M=R.static,B=R.dynamic,X={};return Object.keys(M).forEach(function(F){var G=M[F],z=_.id(F),A=new V;if(Ro(G))A.state=hi,A.buffer=ae.getBuffer(ae.create(G,Zo,!1,!0)),A.type=0;else{var L=ae.getBuffer(G);if(L)A.state=hi,A.buffer=L,A.type=0;else if(N.command(typeof G=="object"&&G,"invalid data for attribute "+F,x.commandStr),"constant"in G){var I=G.constant;A.buffer="null",A.state=uc,typeof I=="number"?A.x=I:(N.command(Nn(I)&&I.length>0&&I.length<=4,"invalid constant for attribute "+F,x.commandStr),Li.forEach(function(Ye,yt){yt<I.length&&(A[Ye]=I[yt])}))}else{Ro(G.buffer)?L=ae.getBuffer(ae.create(G.buffer,Zo,!1,!0)):L=ae.getBuffer(G.buffer),N.command(!!L,'missing buffer for attribute "'+F+'"',x.commandStr);var U=G.offset|0;N.command(U>=0,'invalid offset for attribute "'+F+'"',x.commandStr);var W=G.stride|0;N.command(W>=0&&W<256,'invalid stride for attribute "'+F+'", must be integer betweeen [0, 255]',x.commandStr);var ie=G.size|0;N.command(!("size"in G)||ie>0&&ie<=4,'invalid size for attribute "'+F+'", must be 1,2,3,4',x.commandStr);var ue=!!G.normalized,re=0;"type"in G&&(N.commandParameter(G.type,pr,"invalid type for attribute "+F,x.commandStr),re=pr[G.type]);var we=G.divisor|0;"divisor"in G&&(N.command(we===0||ye,'cannot specify divisor for attribute "'+F+'", instancing not supported',x.commandStr),N.command(we>=0,'invalid divisor for attribute "'+F+'"',x.commandStr)),N.optional(function(){var Ye=x.commandStr,yt=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(G).forEach(function(He){N.command(yt.indexOf(He)>=0,'unknown parameter "'+He+'" for attribute pointer "'+F+'" (valid parameters are '+yt+")",Ye)})}),A.buffer=L,A.state=hi,A.size=ie,A.normalized=ue,A.type=re||L.dtype,A.offset=U,A.stride=W,A.divisor=we}}X[F]=Xn(function(Ye,yt){var He=Ye.attribCache;if(z in He)return He[z];var rt={isStream:!1};return Object.keys(A).forEach(function(vt){rt[vt]=A[vt]}),A.buffer&&(rt.buffer=Ye.link(A.buffer),rt.type=rt.type||rt.buffer+".dtype"),He[z]=rt,rt})}),Object.keys(B).forEach(function(F){var G=B[F];function z(A,L){var I=A.invoke(L,G),U=A.shared,W=A.constants,ie=U.isBufferArgs,ue=U.buffer;N.optional(function(){A.assert(L,I+"&&(typeof "+I+'==="object"||typeof '+I+'==="function")&&('+ie+"("+I+")||"+ue+".getBuffer("+I+")||"+ue+".getBuffer("+I+".buffer)||"+ie+"("+I+'.buffer)||("constant" in '+I+"&&(typeof "+I+'.constant==="number"||'+U.isArrayLike+"("+I+".constant))))",'invalid dynamic attribute "'+F+'"')});var re={isStream:L.def(!1)},we=new V;we.state=hi,Object.keys(we).forEach(function(rt){re[rt]=L.def(""+we[rt])});var Ye=re.buffer,yt=re.type;L("if(",ie,"(",I,")){",re.isStream,"=true;",Ye,"=",ue,".createStream(",Zo,",",I,");",yt,"=",Ye,".dtype;","}else{",Ye,"=",ue,".getBuffer(",I,");","if(",Ye,"){",yt,"=",Ye,".dtype;",'}else if("constant" in ',I,"){",re.state,"=",uc,";","if(typeof "+I+'.constant === "number"){',re[Li[0]],"=",I,".constant;",Li.slice(1).map(function(rt){return re[rt]}).join("="),"=0;","}else{",Li.map(function(rt,vt){return re[rt]+"="+I+".constant.length>"+vt+"?"+I+".constant["+vt+"]:0;"}).join(""),"}}else{","if(",ie,"(",I,".buffer)){",Ye,"=",ue,".createStream(",Zo,",",I,".buffer);","}else{",Ye,"=",ue,".getBuffer(",I,".buffer);","}",yt,'="type" in ',I,"?",W.glTypes,"[",I,".type]:",Ye,".dtype;",re.normalized,"=!!",I,".normalized;");function He(rt){L(re[rt],"=",I,".",rt,"|0;")}return He("size"),He("offset"),He("stride"),He("divisor"),L("}}"),L.exit("if(",re.isStream,"){",ue,".destroyStream(",Ye,");","}"),re}X[F]=Vr(G,z)}),X}function Qn(R,x){var M=R.static,B=R.dynamic;if(is in M){var X=M[is];return X!==null&&_e.getVAO(X)===null&&(X=_e.createVAO(X)),Xn(function(G){return G.link(_e.getVAO(X))})}else if(is in B){var F=B[is];return Vr(F,function(G,z){var A=G.invoke(z,F);return z.def(G.shared.vao+".getVAO("+A+")")})}return null}function vn(R){var x=R.static,M=R.dynamic,B={};return Object.keys(x).forEach(function(X){var F=x[X];B[X]=Xn(function(G,z){return typeof F=="number"||typeof F=="boolean"?""+F:G.link(F)})}),Object.keys(M).forEach(function(X){var F=M[X];B[X]=Vr(F,function(G,z){return G.invoke(z,F)})}),B}function Bn(R,x,M,B,X){var F=R.static,G=R.dynamic;N.optional(function(){var He=[Mi,rs,os,ki,Gi,js,Pi,Ys,ns,is].concat(le);function rt(vt){Object.keys(vt).forEach(function(Vt){N.command(He.indexOf(Vt)>=0,'unknown parameter "'+Vt+'"',X.commandStr)})}rt(F),rt(G)});var z=ot(R,x),A=We(R,X),L=ht(R,A,X),I=Ut(R,X),U=$n(R,X),W=It(R,X,z);function ie(He){var rt=L[He];rt&&(U[He]=rt)}ie(ho),ie(Ne(Zs));var ue=Object.keys(U).length>0,re={framebuffer:A,draw:I,shader:W,state:U,dirty:ue,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(re.profile=_t(R,X),re.uniforms=or(M,X),re.drawVAO=re.scopeVAO=Qn(R,X),!re.drawVAO&&W.program&&!z&&O.angle_instanced_arrays){var we=!0,Ye=W.program.attributes.map(function(He){var rt=x.static[He];return we=we&&!!rt,rt});if(we&&Ye.length>0){var yt=_e.getVAO(_e.createVAO(Ye));re.drawVAO=new lr(null,null,null,function(He,rt){return He.link(yt)}),re.useVAO=!0}}return z?re.useVAO=!0:re.attributes=St(x,X),re.context=vn(B,X),re}function Wn(R,x,M){var B=R.shared,X=B.context,F=R.scope();Object.keys(M).forEach(function(G){x.save(X,"."+G);var z=M[G],A=z.append(R,x);Array.isArray(A)?F(X,".",G,"=[",A.join(),"];"):F(X,".",G,"=",A,";")}),x(F)}function Hn(R,x,M,B){var X=R.shared,F=X.gl,G=X.framebuffer,z;Me&&(z=x.def(X.extensions,".webgl_draw_buffers"));var A=R.constants,L=A.drawBuffer,I=A.backBuffer,U;M?U=M.append(R,x):U=x.def(G,".next"),B||x("if(",U,"!==",G,".cur){"),x("if(",U,"){",F,".bindFramebuffer(",rl,",",U,".framebuffer);"),Me&&x(z,".drawBuffersWEBGL(",L,"[",U,".colorAttachments.length]);"),x("}else{",F,".bindFramebuffer(",rl,",null);"),Me&&x(z,".drawBuffersWEBGL(",I,");"),x("}",G,".cur=",U,";"),B||x("}")}function dr(R,x,M){var B=R.shared,X=B.gl,F=R.current,G=R.next,z=B.current,A=B.next,L=R.cond(z,".dirty");le.forEach(function(I){var U=Ne(I);if(!(U in M.state)){var W,ie;if(U in G){W=G[U],ie=F[U];var ue=cr(ne[U].length,function(we){return L.def(W,"[",we,"]")});L(R.cond(ue.map(function(we,Ye){return we+"!=="+ie+"["+Ye+"]"}).join("||")).then(X,".",de[U],"(",ue,");",ue.map(function(we,Ye){return ie+"["+Ye+"]="+we}).join(";"),";"))}else{W=L.def(A,".",U);var re=R.cond(W,"!==",z,".",U);L(re),U in Ie?re(R.cond(W).then(X,".enable(",Ie[U],");").else(X,".disable(",Ie[U],");"),z,".",U,"=",W,";"):re(X,".",de[U],"(",W,");",z,".",U,"=",W,";")}}}),Object.keys(M.state).length===0&&L(z,".dirty=false;"),x(L)}function hr(R,x,M,B){var X=R.shared,F=R.current,G=X.current,z=X.gl;wa(Object.keys(M)).forEach(function(A){var L=M[A];if(!(B&&!B(L))){var I=L.append(R,x);if(Ie[A]){var U=Ie[A];mi(L)?I?x(z,".enable(",U,");"):x(z,".disable(",U,");"):x(R.cond(I).then(z,".enable(",U,");").else(z,".disable(",U,");")),x(G,".",A,"=",I,";")}else if(Nn(I)){var W=F[A];x(z,".",de[A],"(",I,");",I.map(function(ie,ue){return W+"["+ue+"]="+ie}).join(";"),";")}else x(z,".",de[A],"(",I,");",G,".",A,"=",I,";")}})}function An(R,x){ye&&(R.instancing=x.def(R.shared.extensions,".angle_instanced_arrays"))}function Tt(R,x,M,B,X){var F=R.shared,G=R.stats,z=F.current,A=F.timer,L=M.profile;function I(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var U,W;function ie(He){U=x.def(),He(U,"=",I(),";"),typeof X=="string"?He(G,".count+=",X,";"):He(G,".count++;"),se&&(B?(W=x.def(),He(W,"=",A,".getNumPendingQueries();")):He(A,".beginQuery(",G,");"))}function ue(He){He(G,".cpuTime+=",I(),"-",U,";"),se&&(B?He(A,".pushScopeStats(",W,",",A,".getNumPendingQueries(),",G,");"):He(A,".endQuery();"))}function re(He){var rt=x.def(z,".profile");x(z,".profile=",He,";"),x.exit(z,".profile=",rt,";")}var we;if(L){if(mi(L)){L.enable?(ie(x),ue(x.exit),re("true")):re("false");return}we=L.append(R,x),re(we)}else we=x.def(z,".profile");var Ye=R.block();ie(Ye),x("if(",we,"){",Ye,"}");var yt=R.block();ue(yt),x.exit("if(",we,"){",yt,"}")}function ir(R,x,M,B,X){var F=R.shared;function G(A){switch(A){case tu:case ru:case ss:return 2;case nu:case ou:case au:return 3;case jo:case iu:case Br:return 4;default:return 1}}function z(A,L,I){var U=F.gl,W=x.def(A,".location"),ie=x.def(F.attributes,"[",W,"]"),ue=I.state,re=I.buffer,we=[I.x,I.y,I.z,I.w],Ye=["buffer","normalized","offset","stride"];function yt(){x("if(!",ie,".buffer){",U,".enableVertexAttribArray(",W,");}");var rt=I.type,vt;if(I.size?vt=x.def(I.size,"||",L):vt=L,x("if(",ie,".type!==",rt,"||",ie,".size!==",vt,"||",Ye.map(function(Gn){return ie+"."+Gn+"!=="+I[Gn]}).join("||"),"){",U,".bindBuffer(",Zo,",",re,".buffer);",U,".vertexAttribPointer(",[W,vt,rt,I.normalized,I.stride,I.offset],");",ie,".type=",rt,";",ie,".size=",vt,";",Ye.map(function(Gn){return ie+"."+Gn+"="+I[Gn]+";"}).join(""),"}"),ye){var Vt=I.divisor;x("if(",ie,".divisor!==",Vt,"){",R.instancing,".vertexAttribDivisorANGLE(",[W,Vt],");",ie,".divisor=",Vt,";}")}}function He(){x("if(",ie,".buffer){",U,".disableVertexAttribArray(",W,");",ie,".buffer=null;","}if(",Li.map(function(rt,vt){return ie+"."+rt+"!=="+we[vt]}).join("||"),"){",U,".vertexAttrib4f(",W,",",we,");",Li.map(function(rt,vt){return ie+"."+rt+"="+we[vt]+";"}).join(""),"}")}ue===hi?yt():ue===uc?He():(x("if(",ue,"===",hi,"){"),yt(),x("}else{"),He(),x("}"))}B.forEach(function(A){var L=A.name,I=M.attributes[L],U;if(I){if(!X(I))return;U=I.append(R,x)}else{if(!X(al))return;var W=R.scopeAttrib(L);N.optional(function(){R.assert(x,W+".state","missing attribute "+L)}),U={},Object.keys(new V).forEach(function(ie){U[ie]=x.def(W,".",ie)})}z(R.link(A),G(A.info.type),U)})}function zt(R,x,M,B,X){for(var F=R.shared,G=F.gl,z,A=0;A<B.length;++A){var L=B[A],I=L.name,U=L.info.type,W=M.uniforms[I],ie=R.link(L),ue=ie+".location",re;if(W){if(!X(W))continue;if(mi(W)){var we=W.value;if(N.command(we!==null&&typeof we!="undefined",'missing uniform "'+I+'"',R.commandStr),U===cs||U===Yo){N.command(typeof we=="function"&&(U===cs&&(we._reglType==="texture2d"||we._reglType==="framebuffer")||U===Yo&&(we._reglType==="textureCube"||we._reglType==="framebufferCube")),"invalid texture for uniform "+I,R.commandStr);var Ye=R.link(we._texture||we.color[0]._texture);x(G,".uniform1i(",ue,",",Ye+".bind());"),x.exit(Ye,".unbind();")}else if(U===Sr||U===ba||U===us){N.optional(function(){N.command(Nn(we),"invalid matrix for uniform "+I,R.commandStr),N.command(U===Sr&&we.length===4||U===ba&&we.length===9||U===us&&we.length===16,"invalid length for matrix uniform "+I,R.commandStr)});var yt=R.global.def("new Float32Array(["+Array.prototype.slice.call(we)+"])"),He=2;U===ba?He=3:U===us&&(He=4),x(G,".uniformMatrix",He,"fv(",ue,",false,",yt,");")}else{switch(U){case _c:N.commandType(we,"number","uniform "+I,R.commandStr),z="1f";break;case tu:N.command(Nn(we)&&we.length===2,"uniform "+I,R.commandStr),z="2f";break;case nu:N.command(Nn(we)&&we.length===3,"uniform "+I,R.commandStr),z="3f";break;case jo:N.command(Nn(we)&&we.length===4,"uniform "+I,R.commandStr),z="4f";break;case Sc:N.commandType(we,"boolean","uniform "+I,R.commandStr),z="1i";break;case Ea:N.commandType(we,"number","uniform "+I,R.commandStr),z="1i";break;case ss:N.command(Nn(we)&&we.length===2,"uniform "+I,R.commandStr),z="2i";break;case ru:N.command(Nn(we)&&we.length===2,"uniform "+I,R.commandStr),z="2i";break;case au:N.command(Nn(we)&&we.length===3,"uniform "+I,R.commandStr),z="3i";break;case ou:N.command(Nn(we)&&we.length===3,"uniform "+I,R.commandStr),z="3i";break;case Br:N.command(Nn(we)&&we.length===4,"uniform "+I,R.commandStr),z="4i";break;case iu:N.command(Nn(we)&&we.length===4,"uniform "+I,R.commandStr),z="4i";break}x(G,".uniform",z,"(",ue,",",Nn(we)?Array.prototype.slice.call(we):we,");")}continue}else re=W.append(R,x)}else{if(!X(al))continue;re=x.def(F.uniforms,"[",_.id(I),"]")}U===cs?(N(!Array.isArray(re),"must specify a scalar prop for textures"),x("if(",re,"&&",re,'._reglType==="framebuffer"){',re,"=",re,".color[0];","}")):U===Yo&&(N(!Array.isArray(re),"must specify a scalar prop for cube maps"),x("if(",re,"&&",re,'._reglType==="framebufferCube"){',re,"=",re,".color[0];","}")),N.optional(function(){function Tr(vo,cu){R.assert(x,vo,'bad data or missing for uniform "'+I+'".  '+cu)}function Rc(vo){N(!Array.isArray(re),"must not specify an array type for uniform"),Tr("typeof "+re+'==="'+vo+'"',"invalid type, expected "+vo)}function Wt(vo,cu){Array.isArray(re)?N(re.length===vo,"must have length "+vo):Tr(F.isArrayLike+"("+re+")&&"+re+".length==="+vo,"invalid vector, should have length "+vo,R.commandStr)}function Dc(vo){N(!Array.isArray(re),"must not specify a value type"),Tr("typeof "+re+'==="function"&&'+re+'._reglType==="texture'+(vo===_r?"2d":"Cube")+'"',"invalid texture type",R.commandStr)}switch(U){case Ea:Rc("number");break;case ru:Wt(2,"number");break;case ou:Wt(3,"number");break;case iu:Wt(4,"number");break;case _c:Rc("number");break;case tu:Wt(2,"number");break;case nu:Wt(3,"number");break;case jo:Wt(4,"number");break;case Sc:Rc("boolean");break;case ss:Wt(2,"boolean");break;case au:Wt(3,"boolean");break;case Br:Wt(4,"boolean");break;case Sr:Wt(4,"number");break;case ba:Wt(9,"number");break;case us:Wt(16,"number");break;case cs:Dc(_r);break;case Yo:Dc(ga);break}});var rt=1;switch(U){case cs:case Yo:var vt=x.def(re,"._texture");x(G,".uniform1i(",ue,",",vt,".bind());"),x.exit(vt,".unbind();");continue;case Ea:case Sc:z="1i";break;case ru:case ss:z="2i",rt=2;break;case ou:case au:z="3i",rt=3;break;case iu:case Br:z="4i",rt=4;break;case _c:z="1f";break;case tu:z="2f",rt=2;break;case nu:z="3f",rt=3;break;case jo:z="4f",rt=4;break;case Sr:z="Matrix2fv";break;case ba:z="Matrix3fv";break;case us:z="Matrix4fv";break}if(x(G,".uniform",z,"(",ue,","),z.charAt(0)==="M"){var Vt=Math.pow(U-Sr+2,2),Gn=R.global.def("new Float32Array(",Vt,")");Array.isArray(re)?x("false,(",cr(Vt,function(Tr){return Gn+"["+Tr+"]="+re[Tr]}),",",Gn,")"):x("false,(Array.isArray(",re,")||",re," instanceof Float32Array)?",re,":(",cr(Vt,function(Tr){return Gn+"["+Tr+"]="+re+"["+Tr+"]"}),",",Gn,")")}else rt>1?x(cr(rt,function(Tr){return Array.isArray(re)?re[Tr]:re+"["+Tr+"]"})):(N(!Array.isArray(re),"uniform value must not be an array"),x(re));x(");")}}function et(R,x,M,B){var X=R.shared,F=X.gl,G=X.draw,z=B.draw;function A(){var vt=z.elements,Vt,Gn=x;return vt?((vt.contextDep&&B.contextDynamic||vt.propDep)&&(Gn=M),Vt=vt.append(R,Gn)):Vt=Gn.def(G,".",ki),Vt&&Gn("if("+Vt+")"+F+".bindBuffer("+Qf+","+Vt+".buffer.buffer);"),Vt}function L(){var vt=z.count,Vt,Gn=x;return vt?((vt.contextDep&&B.contextDynamic||vt.propDep)&&(Gn=M),Vt=vt.append(R,Gn),N.optional(function(){vt.MISSING&&R.assert(x,"false","missing vertex count"),vt.DYNAMIC&&R.assert(Gn,Vt+">=0","missing vertex count")})):(Vt=Gn.def(G,".",Pi),N.optional(function(){R.assert(Gn,Vt+">=0","missing vertex count")})),Vt}var I=A();function U(vt){var Vt=z[vt];return Vt?Vt.contextDep&&B.contextDynamic||Vt.propDep?Vt.append(R,M):Vt.append(R,x):x.def(G,".",vt)}var W=U(Gi),ie=U(js),ue=L();if(typeof ue=="number"){if(ue===0)return}else M("if(",ue,"){"),M.exit("}");var re,we;ye&&(re=U(Ys),we=R.instancing);var Ye=I+".type",yt=z.elements&&mi(z.elements);function He(){function vt(){M(we,".drawElementsInstancedANGLE(",[W,ue,Ye,ie+"<<(("+Ye+"-"+sc+")>>1)",re],");")}function Vt(){M(we,".drawArraysInstancedANGLE(",[W,ie,ue,re],");")}I?yt?vt():(M("if(",I,"){"),vt(),M("}else{"),Vt(),M("}")):Vt()}function rt(){function vt(){M(F+".drawElements("+[W,ue,Ye,ie+"<<(("+Ye+"-"+sc+")>>1)"]+");")}function Vt(){M(F+".drawArrays("+[W,ie,ue]+");")}I?yt?vt():(M("if(",I,"){"),vt(),M("}else{"),Vt(),M("}")):Vt()}ye&&(typeof re!="number"||re>=0)?typeof re=="string"?(M("if(",re,">0){"),He(),M("}else if(",re,"<0){"),rt(),M("}")):He():rt()}function Ct(R,x,M,B,X){var F=at(),G=F.proc("body",X);return N.optional(function(){F.commandStr=x.commandStr,F.command=F.link(x.commandStr)}),ye&&(F.instancing=G.def(F.shared.extensions,".angle_instanced_arrays")),R(F,G,M,B),F.compile().body}function Gt(R,x,M,B){An(R,x),M.useVAO?M.drawVAO?x(R.shared.vao,".setVAO(",M.drawVAO.append(R,x),");"):x(R.shared.vao,".setVAO(",R.shared.vao,".targetVAO);"):(x(R.shared.vao,".setVAO(null);"),ir(R,x,M,B.attributes,function(){return!0})),zt(R,x,M,B.uniforms,function(){return!0}),et(R,x,x,M)}function Rn(R,x){var M=R.proc("draw",1);An(R,M),Wn(R,M,x.context),Hn(R,M,x.framebuffer),dr(R,M,x),hr(R,M,x.state),Tt(R,M,x,!1,!0);var B=x.shader.progVar.append(R,M);if(M(R.shared.gl,".useProgram(",B,".program);"),x.shader.program)Gt(R,M,x,x.shader.program);else{M(R.shared.vao,".setVAO(null);");var X=R.global.def("{}"),F=M.def(B,".id"),G=M.def(X,"[",F,"]");M(R.cond(G).then(G,".call(this,a0);").else(G,"=",X,"[",F,"]=",R.link(function(z){return Ct(Gt,R,x,z,1)}),"(",B,");",G,".call(this,a0);"))}Object.keys(x.state).length>0&&M(R.shared.current,".dirty=true;")}function Do(R,x,M,B){R.batchId="a1",An(R,x);function X(){return!0}ir(R,x,M,B.attributes,X),zt(R,x,M,B.uniforms,X),et(R,x,x,M)}function Ko(R,x,M,B){An(R,x);var X=M.contextDep,F=x.def(),G="a0",z="a1",A=x.def();R.shared.props=A,R.batchId=F;var L=R.scope(),I=R.scope();x(L.entry,"for(",F,"=0;",F,"<",z,";++",F,"){",A,"=",G,"[",F,"];",I,"}",L.exit);function U(Ye){return Ye.contextDep&&X||Ye.propDep}function W(Ye){return!U(Ye)}if(M.needsContext&&Wn(R,I,M.context),M.needsFramebuffer&&Hn(R,I,M.framebuffer),hr(R,I,M.state,U),M.profile&&U(M.profile)&&Tt(R,I,M,!1,!0),B)M.useVAO?M.drawVAO?U(M.drawVAO)?I(R.shared.vao,".setVAO(",M.drawVAO.append(R,I),");"):L(R.shared.vao,".setVAO(",M.drawVAO.append(R,L),");"):L(R.shared.vao,".setVAO(",R.shared.vao,".targetVAO);"):(L(R.shared.vao,".setVAO(null);"),ir(R,L,M,B.attributes,W),ir(R,I,M,B.attributes,U)),zt(R,L,M,B.uniforms,W),zt(R,I,M,B.uniforms,U),et(R,L,I,M);else{var ie=R.global.def("{}"),ue=M.shader.progVar.append(R,I),re=I.def(ue,".id"),we=I.def(ie,"[",re,"]");I(R.shared.gl,".useProgram(",ue,".program);","if(!",we,"){",we,"=",ie,"[",re,"]=",R.link(function(Ye){return Ct(Do,R,M,Ye,2)}),"(",ue,");}",we,".call(this,a0[",F,"],",F,");")}}function D(R,x){var M=R.proc("batch",2);R.batchId="0",An(R,M);var B=!1,X=!0;Object.keys(x.context).forEach(function(ie){B=B||x.context[ie].propDep}),B||(Wn(R,M,x.context),X=!1);var F=x.framebuffer,G=!1;F?(F.propDep?B=G=!0:F.contextDep&&B&&(G=!0),G||Hn(R,M,F)):Hn(R,M,null),x.state.viewport&&x.state.viewport.propDep&&(B=!0);function z(ie){return ie.contextDep&&B||ie.propDep}dr(R,M,x),hr(R,M,x.state,function(ie){return!z(ie)}),(!x.profile||!z(x.profile))&&Tt(R,M,x,!1,"a1"),x.contextDep=B,x.needsContext=X,x.needsFramebuffer=G;var A=x.shader.progVar;if(A.contextDep&&B||A.propDep)Ko(R,M,x,null);else{var L=A.append(R,M);if(M(R.shared.gl,".useProgram(",L,".program);"),x.shader.program)Ko(R,M,x,x.shader.program);else{M(R.shared.vao,".setVAO(null);");var I=R.global.def("{}"),U=M.def(L,".id"),W=M.def(I,"[",U,"]");M(R.cond(W).then(W,".call(this,a0,a1);").else(W,"=",I,"[",U,"]=",R.link(function(ie){return Ct(Ko,R,x,ie,2)}),"(",L,");",W,".call(this,a0,a1);"))}}Object.keys(x.state).length>0&&M(R.shared.current,".dirty=true;")}function Y(R,x){var M=R.proc("scope",3);R.batchId="a2";var B=R.shared,X=B.current;Wn(R,M,x.context),x.framebuffer&&x.framebuffer.append(R,M),wa(Object.keys(x.state)).forEach(function(G){var z=x.state[G],A=z.append(R,M);Nn(A)?A.forEach(function(L,I){M.set(R.next[G],"["+I+"]",L)}):M.set(B.next,"."+G,A)}),Tt(R,M,x,!0,!0),[ki,js,Pi,Ys,Gi].forEach(function(G){var z=x.draw[G];z&&M.set(B.draw,"."+G,""+z.append(R,M))}),Object.keys(x.uniforms).forEach(function(G){var z=x.uniforms[G].append(R,M);Array.isArray(z)&&(z="["+z.join()+"]"),M.set(B.uniforms,"["+_.id(G)+"]",z)}),Object.keys(x.attributes).forEach(function(G){var z=x.attributes[G].append(R,M),A=R.scopeAttrib(G);Object.keys(new V).forEach(function(L){M.set(A,"."+L,z[L])})}),x.scopeVAO&&M.set(B.vao,".targetVAO",x.scopeVAO.append(R,M));function F(G){var z=x.shader[G];z&&M.set(B.shader,"."+G,z.append(R,M))}F(rs),F(os),Object.keys(x.state).length>0&&(M(X,".dirty=true;"),M.exit(X,".dirty=true;")),M("a1(",R.shared.context,",a0,",R.batchId,");")}function H(R){if(!(typeof R!="object"||Nn(R))){for(var x=Object.keys(R),M=0;M<x.length;++M)if(En.isDynamic(R[x[M]]))return!0;return!1}}function Be(R,x,M){var B=x.static[M];if(!B||!H(B))return;var X=R.global,F=Object.keys(B),G=!1,z=!1,A=!1,L=R.global.def("{}");F.forEach(function(U){var W=B[U];if(En.isDynamic(W)){typeof W=="function"&&(W=B[U]=En.unbox(W));var ie=Vr(W,null);G=G||ie.thisDep,A=A||ie.propDep,z=z||ie.contextDep}else{switch(X(L,".",U,"="),typeof W){case"number":X(W);break;case"string":X('"',W,'"');break;case"object":Array.isArray(W)&&X("[",W.join(),"]");break;default:X(R.link(W));break}X(";")}});function I(U,W){F.forEach(function(ie){var ue=B[ie];if(En.isDynamic(ue)){var re=U.invoke(W,ue);W(L,".",ie,"=",re,";")}})}x.dynamic[M]=new En.DynamicVariable($s,{thisDep:G,contextDep:z,propDep:A,ref:L,append:I}),delete x.static[M]}function Dt(R,x,M,B,X){var F=at();F.stats=F.link(X),Object.keys(x.static).forEach(function(z){Be(F,x,z)}),qs.forEach(function(z){Be(F,R,z)});var G=Bn(R,x,M,B,F);return Rn(F,G),Y(F,G),D(F,G),oe(F.compile(),{destroy:function(){G.shader.program.destroy()}})}return{next:ze,current:ne,procs:function(){var R=at(),x=R.proc("poll"),M=R.proc("refresh"),B=R.block();x(B),M(B);var X=R.shared,F=X.gl,G=X.next,z=X.current;B(z,".dirty=false;"),Hn(R,x),Hn(R,M,null,!0);var A;ye&&(A=R.link(ye)),O.oes_vertex_array_object&&M(R.link(O.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var L=0;L<K.maxAttributes;++L){var I=M.def(X.attributes,"[",L,"]"),U=R.cond(I,".buffer");U.then(F,".enableVertexAttribArray(",L,");",F,".bindBuffer(",Zo,",",I,".buffer.buffer);",F,".vertexAttribPointer(",L,",",I,".size,",I,".type,",I,".normalized,",I,".stride,",I,".offset);").else(F,".disableVertexAttribArray(",L,");",F,".vertexAttrib4f(",L,",",I,".x,",I,".y,",I,".z,",I,".w);",I,".buffer=null;"),M(U),ye&&M(A,".vertexAttribDivisorANGLE(",L,",",I,".divisor);")}return M(R.shared.vao,".currentVAO=null;",R.shared.vao,".setVAO(",R.shared.vao,".targetVAO);"),Object.keys(Ie).forEach(function(W){var ie=Ie[W],ue=B.def(G,".",W),re=R.block();re("if(",ue,"){",F,".enable(",ie,")}else{",F,".disable(",ie,")}",z,".",W,"=",ue,";"),M(re),x("if(",ue,"!==",z,".",W,"){",re,"}")}),Object.keys(de).forEach(function(W){var ie=de[W],ue=ne[W],re,we,Ye=R.block();if(Ye(F,".",ie,"("),Nn(ue)){var yt=ue.length;re=R.global.def(G,".",W),we=R.global.def(z,".",W),Ye(cr(yt,function(He){return re+"["+He+"]"}),");",cr(yt,function(He){return we+"["+He+"]="+re+"["+He+"];"}).join("")),x("if(",cr(yt,function(He){return re+"["+He+"]!=="+we+"["+He+"]"}).join("||"),"){",Ye,"}")}else re=B.def(G,".",W),we=B.def(z,".",W),Ye(re,");",z,".",W,"=",re,";"),x("if(",re,"!==",we,"){",Ye,"}");M(Ye)}),R.compile()}(),compile:Dt}}function Cd(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Od=34918,_a=34919,Ac=35007,Ld=function(p,_){if(!_.ext_disjoint_timer_query)return null;var O=[];function K(){return O.pop()||_.ext_disjoint_timer_query.createQueryEXT()}function ae(ye){O.push(ye)}var Z=[];function Q(ye){var Me=K();_.ext_disjoint_timer_query.beginQueryEXT(Ac,Me),Z.push(Me),se(Z.length-1,Z.length,ye)}function fe(){_.ext_disjoint_timer_query.endQueryEXT(Ac)}function me(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var _e=[];function ge(){return _e.pop()||new me}function Ae(ye){_e.push(ye)}var De=[];function se(ye,Me,ne){var ze=ge();ze.startQueryIndex=ye,ze.endQueryIndex=Me,ze.sum=0,ze.stats=ne,De.push(ze)}var Re=[],V=[];function J(){var ye,Me,ne=Z.length;if(ne!==0){V.length=Math.max(V.length,ne+1),Re.length=Math.max(Re.length,ne+1),Re[0]=0,V[0]=0;var ze=0;for(ye=0,Me=0;Me<Z.length;++Me){var le=Z[Me];_.ext_disjoint_timer_query.getQueryObjectEXT(le,_a)?(ze+=_.ext_disjoint_timer_query.getQueryObjectEXT(le,Od),ae(le)):Z[ye++]=le,Re[Me+1]=ze,V[Me+1]=ye}for(Z.length=ye,ye=0,Me=0;Me<De.length;++Me){var Ie=De[Me],de=Ie.startQueryIndex,Ne=Ie.endQueryIndex;Ie.sum+=Re[Ne]-Re[de];var Qe=V[de],lt=V[Ne];lt===Qe?(Ie.stats.gpuTime+=Ie.sum/1e6,Ae(Ie)):(Ie.startQueryIndex=Qe,Ie.endQueryIndex=lt,De[ye++]=Ie)}De.length=ye}}return{beginQuery:Q,endQuery:fe,pushScopeStats:se,update:J,getNumPendingQueries:function(){return Z.length},clear:function(){O.push.apply(O,Z);for(var ye=0;ye<O.length;ye++)_.ext_disjoint_timer_query.deleteQueryEXT(O[ye]);Z.length=0,O.length=0},restore:function(){Z.length=0,O.length=0}}},Md=16384,su=256,kd=1024,Gd=34962,sl="webglcontextlost",ul="webglcontextrestored",Bi=1,uu=2,Pd=3;function Ui(p,_){for(var O=0;O<p.length;++O)if(p[O]===_)return O;return-1}function Sa(p){var _=Si(p);if(!_)return null;var O=_.gl,K=O.getContextAttributes(),ae=O.isContextLost(),Z=xs(O,_);if(!Z)return null;var Q=ao(),fe=Cd(),me=Z.extensions,_e=Ld(O,me),ge=br(),Ae=O.drawingBufferWidth,De=O.drawingBufferHeight,se={tick:0,time:0,viewportWidth:Ae,viewportHeight:De,framebufferWidth:Ae,framebufferHeight:De,drawingBufferWidth:Ae,drawingBufferHeight:De,pixelRatio:_.pixelRatio},Re={},V={elements:null,primitive:4,count:-1,offset:0,instances:-1},J=on(O,me),ye=ra(O,fe,_,ne),Me=vd(O,me,J,fe,ye);function ne(et){return Me.destroyBuffer(et)}var ze=Ri(O,me,ye,fe),le=yd(O,Q,fe,_),Ie=Jl(O,me,J,function(){Qe.procs.poll()},se,fe,_),de=ed(O,me,J,fe,_),Ne=hd(O,me,J,Ie,de,fe),Qe=Dd(O,Q,me,J,ye,ze,Ie,Ne,Re,Me,le,V,se,_e,_),lt=bd(O,Ne,Qe.procs.poll,se,K,me,J),Le=Qe.next,xe=O.canvas,ce=[],at=[],_t=[],We=[_.onDestroy],ht=null;function ot(){if(ce.length===0){_e&&_e.update(),ht=null;return}ht=io.next(ot),hr();for(var et=ce.length-1;et>=0;--et){var Ct=ce[et];Ct&&Ct(se,null,0)}O.flush(),_e&&_e.update()}function It(){!ht&&ce.length>0&&(ht=io.next(ot))}function Ut(){ht&&(io.cancel(ot),ht=null)}function $n(et){et.preventDefault(),ae=!0,Ut(),at.forEach(function(Ct){Ct()})}function or(et){O.getError(),ae=!1,Z.restore(),le.restore(),ye.restore(),Ie.restore(),de.restore(),Ne.restore(),Me.restore(),_e&&_e.restore(),Qe.procs.refresh(),It(),_t.forEach(function(Ct){Ct()})}xe&&(xe.addEventListener(sl,$n,!1),xe.addEventListener(ul,or,!1));function St(){ce.length=0,Ut(),xe&&(xe.removeEventListener(sl,$n),xe.removeEventListener(ul,or)),le.clear(),Ne.clear(),de.clear(),Ie.clear(),ze.clear(),ye.clear(),Me.clear(),_e&&_e.clear(),We.forEach(function(et){et()})}function Qn(et){N(!!et,"invalid args to regl({...})"),N.type(et,"object","invalid args to regl({...})");function Ct(X){var F=oe({},X);delete F.uniforms,delete F.attributes,delete F.context,delete F.vao,"stencil"in F&&F.stencil.op&&(F.stencil.opBack=F.stencil.opFront=F.stencil.op,delete F.stencil.op);function G(z){if(z in F){var A=F[z];delete F[z],Object.keys(A).forEach(function(L){F[z+"."+L]=A[L]})}}return G("blend"),G("depth"),G("cull"),G("stencil"),G("polygonOffset"),G("scissor"),G("sample"),"vao"in X&&(F.vao=X.vao),F}function Gt(X,F){var G={},z={};return Object.keys(X).forEach(function(A){var L=X[A];if(En.isDynamic(L)){z[A]=En.unbox(L,A);return}else if(F&&Array.isArray(L)){for(var I=0;I<L.length;++I)if(En.isDynamic(L[I])){z[A]=En.unbox(L,A);return}}G[A]=L}),{dynamic:z,static:G}}var Rn=Gt(et.context||{},!0),Do=Gt(et.uniforms||{},!0),Ko=Gt(et.attributes||{},!1),D=Gt(Ct(et),!1),Y={gpuTime:0,cpuTime:0,count:0},H=Qe.compile(D,Ko,Do,Rn,Y),Be=H.draw,Dt=H.batch,R=H.scope,x=[];function M(X){for(;x.length<X;)x.push(null);return x}function B(X,F){var G;if(ae&&N.raise("context lost"),typeof X=="function")return R.call(this,null,X,0);if(typeof F=="function")if(typeof X=="number")for(G=0;G<X;++G)R.call(this,null,F,G);else if(Array.isArray(X))for(G=0;G<X.length;++G)R.call(this,X[G],F,G);else return R.call(this,X,F,0);else if(typeof X=="number"){if(X>0)return Dt.call(this,M(X|0),X|0)}else if(Array.isArray(X)){if(X.length)return Dt.call(this,X,X.length)}else return Be.call(this,X)}return oe(B,{stats:Y,destroy:function(){H.destroy()}})}var vn=Ne.setFBO=Qn({framebuffer:En.define.call(null,Bi,"framebuffer")});function Bn(et,Ct){var Gt=0;Qe.procs.poll();var Rn=Ct.color;Rn&&(O.clearColor(+Rn[0]||0,+Rn[1]||0,+Rn[2]||0,+Rn[3]||0),Gt|=Md),"depth"in Ct&&(O.clearDepth(+Ct.depth),Gt|=su),"stencil"in Ct&&(O.clearStencil(Ct.stencil|0),Gt|=kd),N(!!Gt,"called regl.clear with no buffer specified"),O.clear(Gt)}function Wn(et){if(N(typeof et=="object"&&et,"regl.clear() takes an object as input"),"framebuffer"in et)if(et.framebuffer&&et.framebuffer_reglType==="framebufferCube")for(var Ct=0;Ct<6;++Ct)vn(oe({framebuffer:et.framebuffer.faces[Ct]},et),Bn);else vn(et,Bn);else Bn(null,et)}function Hn(et){N.type(et,"function","regl.frame() callback must be a function"),ce.push(et);function Ct(){var Gt=Ui(ce,et);N(Gt>=0,"cannot cancel a frame twice");function Rn(){var Do=Ui(ce,Rn);ce[Do]=ce[ce.length-1],ce.length-=1,ce.length<=0&&Ut()}ce[Gt]=Rn}return It(),{cancel:Ct}}function dr(){var et=Le.viewport,Ct=Le.scissor_box;et[0]=et[1]=Ct[0]=Ct[1]=0,se.viewportWidth=se.framebufferWidth=se.drawingBufferWidth=et[2]=Ct[2]=O.drawingBufferWidth,se.viewportHeight=se.framebufferHeight=se.drawingBufferHeight=et[3]=Ct[3]=O.drawingBufferHeight}function hr(){se.tick+=1,se.time=Tt(),dr(),Qe.procs.poll()}function An(){Ie.refresh(),dr(),Qe.procs.refresh(),_e&&_e.update()}function Tt(){return(br()-ge)/1e3}An();function ir(et,Ct){N.type(Ct,"function","listener callback must be a function");var Gt;switch(et){case"frame":return Hn(Ct);case"lost":Gt=at;break;case"restore":Gt=_t;break;case"destroy":Gt=We;break;default:N.raise("invalid event, must be one of frame,lost,restore,destroy")}return Gt.push(Ct),{cancel:function(){for(var Rn=0;Rn<Gt.length;++Rn)if(Gt[Rn]===Ct){Gt[Rn]=Gt[Gt.length-1],Gt.pop();return}}}}var zt=oe(Qn,{clear:Wn,prop:En.define.bind(null,Bi),context:En.define.bind(null,uu),this:En.define.bind(null,Pd),draw:Qn({}),buffer:function(et){return ye.create(et,Gd,!1,!1)},elements:function(et){return ze.create(et,!1)},texture:Ie.create2D,cube:Ie.createCube,renderbuffer:de.create,framebuffer:Ne.create,framebufferCube:Ne.createCube,vao:Me.createVAO,attributes:K,frame:Hn,on:ir,limits:J,hasExtension:function(et){return J.extensions.indexOf(et.toLowerCase())>=0},read:lt,destroy:St,_gl:O,_refresh:An,poll:function(){hr(),_e&&_e.update()},now:Tt,stats:fe});return _.onDone(null,zt),zt}return Sa})},68608:function(qe){function pt(oe){if(oe===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return oe}qe.exports=pt,qe.exports.__esModule=!0,qe.exports.default=qe.exports},38888:function(qe,pt,oe){var ee=oe(44908),Zt=oe(14614),At=oe(91621);function nt(jt){var bt=Zt();return function(){var _n=ee(jt),Vn;if(bt){var Ot=ee(this).constructor;Vn=Reflect.construct(_n,arguments,Ot)}else Vn=_n.apply(this,arguments);return At(this,Vn)}}qe.exports=nt,qe.exports.__esModule=!0,qe.exports.default=qe.exports},44908:function(qe){function pt(oe){return qe.exports=pt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Zt){return Zt.__proto__||Object.getPrototypeOf(Zt)},qe.exports.__esModule=!0,qe.exports.default=qe.exports,pt(oe)}qe.exports=pt,qe.exports.__esModule=!0,qe.exports.default=qe.exports},58853:function(qe,pt,oe){var ee=oe(49154);function Zt(At,nt){if(typeof nt!="function"&&nt!==null)throw new TypeError("Super expression must either be null or a function");At.prototype=Object.create(nt&&nt.prototype,{constructor:{value:At,writable:!0,configurable:!0}}),Object.defineProperty(At,"prototype",{writable:!1}),nt&&ee(At,nt)}qe.exports=Zt,qe.exports.__esModule=!0,qe.exports.default=qe.exports},14614:function(qe){function pt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(oe){return!1}}qe.exports=pt,qe.exports.__esModule=!0,qe.exports.default=qe.exports},91621:function(qe,pt,oe){var ee=oe(37635).default,Zt=oe(68608);function At(nt,jt){if(jt&&(ee(jt)==="object"||typeof jt=="function"))return jt;if(jt!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zt(nt)}qe.exports=At,qe.exports.__esModule=!0,qe.exports.default=qe.exports},49154:function(qe){function pt(oe,ee){return qe.exports=pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(At,nt){return At.__proto__=nt,At},qe.exports.__esModule=!0,qe.exports.default=qe.exports,pt(oe,ee)}qe.exports=pt,qe.exports.__esModule=!0,qe.exports.default=qe.exports},45728:function(qe,pt,oe){var ee=oe(7202).default;function Zt(){"use strict";qe.exports=Zt=function(){return At},qe.exports.__esModule=!0,qe.exports.default=qe.exports;var At={},nt=Object.prototype,jt=nt.hasOwnProperty,bt=Object.defineProperty||function(Xe,Te,ke){Xe[Te]=ke.value},be=typeof Symbol=="function"?Symbol:{},_n=be.iterator||"@@iterator",Vn=be.asyncIterator||"@@asyncIterator",Ot=be.toStringTag||"@@toStringTag";function Bt(Xe,Te,ke){return Object.defineProperty(Xe,Te,{value:ke,enumerable:!0,configurable:!0,writable:!0}),Xe[Te]}try{Bt({},"")}catch(Xe){Bt=function(ke,$e,ft){return ke[$e]=ft}}function Je(Xe,Te,ke,$e){var ft=Te&&Te.prototype instanceof yr?Te:yr,st=Object.create(ft.prototype),tn=new jn($e||[]);return bt(st,"_invoke",{value:bi(Xe,ke,tn)}),st}function hn(Xe,Te,ke){try{return{type:"normal",arg:Xe.call(Te,ke)}}catch($e){return{type:"throw",arg:$e}}}At.wrap=Je;var Rt={};function yr(){}function er(){}function Er(){}var Cn={};Bt(Cn,_n,function(){return this});var tr=Object.getPrototypeOf,Nr=tr&&tr(tr(On([])));Nr&&Nr!==nt&&jt.call(Nr,_n)&&(Cn=Nr);var $r=Er.prototype=yr.prototype=Object.create(Cn);function go(Xe){["next","throw","return"].forEach(function(Te){Bt(Xe,Te,function(ke){return this._invoke(Te,ke)})})}function ro(Xe,Te){function ke(ft,st,tn,Kt){var fn=hn(Xe[ft],Xe,st);if(fn.type!=="throw"){var Wr=fn.arg,Ar=Wr.value;return Ar&&ee(Ar)=="object"&&jt.call(Ar,"__await")?Te.resolve(Ar.__await).then(function(Hr){ke("next",Hr,tn,Kt)},function(Hr){ke("throw",Hr,tn,Kt)}):Te.resolve(Ar).then(function(Hr){Wr.value=Hr,tn(Wr)},function(Hr){return ke("throw",Hr,tn,Kt)})}Kt(fn.arg)}var $e;bt(this,"_invoke",{value:function(st,tn){function Kt(){return new Te(function(fn,Wr){ke(st,tn,fn,Wr)})}return $e=$e?$e.then(Kt,Kt):Kt()}})}function bi(Xe,Te,ke){var $e="suspendedStart";return function(ft,st){if($e==="executing")throw new Error("Generator is already running");if($e==="completed"){if(ft==="throw")throw st;return{value:void 0,done:!0}}for(ke.method=ft,ke.arg=st;;){var tn=ke.delegate;if(tn){var Kt=yo(tn,ke);if(Kt){if(Kt===Rt)continue;return Kt}}if(ke.method==="next")ke.sent=ke._sent=ke.arg;else if(ke.method==="throw"){if($e==="suspendedStart")throw $e="completed",ke.arg;ke.dispatchException(ke.arg)}else ke.method==="return"&&ke.abrupt("return",ke.arg);$e="executing";var fn=hn(Xe,Te,ke);if(fn.type==="normal"){if($e=ke.done?"completed":"suspendedYield",fn.arg===Rt)continue;return{value:fn.arg,done:ke.done}}fn.type==="throw"&&($e="completed",ke.method="throw",ke.arg=fn.arg)}}}function yo(Xe,Te){var ke=Te.method,$e=Xe.iterator[ke];if($e===void 0)return Te.delegate=null,ke==="throw"&&Xe.iterator.return&&(Te.method="return",Te.arg=void 0,yo(Xe,Te),Te.method==="throw")||ke!=="return"&&(Te.method="throw",Te.arg=new TypeError("The iterator does not provide a '"+ke+"' method")),Rt;var ft=hn($e,Xe.iterator,Te.arg);if(ft.type==="throw")return Te.method="throw",Te.arg=ft.arg,Te.delegate=null,Rt;var st=ft.arg;return st?st.done?(Te[Xe.resultName]=st.value,Te.next=Xe.nextLoc,Te.method!=="return"&&(Te.method="next",Te.arg=void 0),Te.delegate=null,Rt):st:(Te.method="throw",Te.arg=new TypeError("iterator result is not an object"),Te.delegate=null,Rt)}function ct(Xe){var Te={tryLoc:Xe[0]};1 in Xe&&(Te.catchLoc=Xe[1]),2 in Xe&&(Te.finallyLoc=Xe[2],Te.afterLoc=Xe[3]),this.tryEntries.push(Te)}function ar(Xe){var Te=Xe.completion||{};Te.type="normal",delete Te.arg,Xe.completion=Te}function jn(Xe){this.tryEntries=[{tryLoc:"root"}],Xe.forEach(ct,this),this.reset(!0)}function On(Xe){if(Xe||Xe===""){var Te=Xe[_n];if(Te)return Te.call(Xe);if(typeof Xe.next=="function")return Xe;if(!isNaN(Xe.length)){var ke=-1,$e=function ft(){for(;++ke<Xe.length;)if(jt.call(Xe,ke))return ft.value=Xe[ke],ft.done=!1,ft;return ft.value=void 0,ft.done=!0,ft};return $e.next=$e}}throw new TypeError(ee(Xe)+" is not iterable")}return er.prototype=Er,bt($r,"constructor",{value:Er,configurable:!0}),bt(Er,"constructor",{value:er,configurable:!0}),er.displayName=Bt(Er,Ot,"GeneratorFunction"),At.isGeneratorFunction=function(Xe){var Te=typeof Xe=="function"&&Xe.constructor;return!!Te&&(Te===er||(Te.displayName||Te.name)==="GeneratorFunction")},At.mark=function(Xe){return Object.setPrototypeOf?Object.setPrototypeOf(Xe,Er):(Xe.__proto__=Er,Bt(Xe,Ot,"GeneratorFunction")),Xe.prototype=Object.create($r),Xe},At.awrap=function(Xe){return{__await:Xe}},go(ro.prototype),Bt(ro.prototype,Vn,function(){return this}),At.AsyncIterator=ro,At.async=function(Xe,Te,ke,$e,ft){ft===void 0&&(ft=Promise);var st=new ro(Je(Xe,Te,ke,$e),ft);return At.isGeneratorFunction(Te)?st:st.next().then(function(tn){return tn.done?tn.value:st.next()})},go($r),Bt($r,Ot,"Generator"),Bt($r,_n,function(){return this}),Bt($r,"toString",function(){return"[object Generator]"}),At.keys=function(Xe){var Te=Object(Xe),ke=[];for(var $e in Te)ke.push($e);return ke.reverse(),function ft(){for(;ke.length;){var st=ke.pop();if(st in Te)return ft.value=st,ft.done=!1,ft}return ft.done=!0,ft}},At.values=On,jn.prototype={constructor:jn,reset:function(Te){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(ar),!Te)for(var ke in this)ke.charAt(0)==="t"&&jt.call(this,ke)&&!isNaN(+ke.slice(1))&&(this[ke]=void 0)},stop:function(){this.done=!0;var Te=this.tryEntries[0].completion;if(Te.type==="throw")throw Te.arg;return this.rval},dispatchException:function(Te){if(this.done)throw Te;var ke=this;function $e(Wr,Ar){return tn.type="throw",tn.arg=Te,ke.next=Wr,Ar&&(ke.method="next",ke.arg=void 0),!!Ar}for(var ft=this.tryEntries.length-1;ft>=0;--ft){var st=this.tryEntries[ft],tn=st.completion;if(st.tryLoc==="root")return $e("end");if(st.tryLoc<=this.prev){var Kt=jt.call(st,"catchLoc"),fn=jt.call(st,"finallyLoc");if(Kt&&fn){if(this.prev<st.catchLoc)return $e(st.catchLoc,!0);if(this.prev<st.finallyLoc)return $e(st.finallyLoc)}else if(Kt){if(this.prev<st.catchLoc)return $e(st.catchLoc,!0)}else{if(!fn)throw new Error("try statement without catch or finally");if(this.prev<st.finallyLoc)return $e(st.finallyLoc)}}}},abrupt:function(Te,ke){for(var $e=this.tryEntries.length-1;$e>=0;--$e){var ft=this.tryEntries[$e];if(ft.tryLoc<=this.prev&&jt.call(ft,"finallyLoc")&&this.prev<ft.finallyLoc){var st=ft;break}}st&&(Te==="break"||Te==="continue")&&st.tryLoc<=ke&&ke<=st.finallyLoc&&(st=null);var tn=st?st.completion:{};return tn.type=Te,tn.arg=ke,st?(this.method="next",this.next=st.finallyLoc,Rt):this.complete(tn)},complete:function(Te,ke){if(Te.type==="throw")throw Te.arg;return Te.type==="break"||Te.type==="continue"?this.next=Te.arg:Te.type==="return"?(this.rval=this.arg=Te.arg,this.method="return",this.next="end"):Te.type==="normal"&&ke&&(this.next=ke),Rt},finish:function(Te){for(var ke=this.tryEntries.length-1;ke>=0;--ke){var $e=this.tryEntries[ke];if($e.finallyLoc===Te)return this.complete($e.completion,$e.afterLoc),ar($e),Rt}},catch:function(Te){for(var ke=this.tryEntries.length-1;ke>=0;--ke){var $e=this.tryEntries[ke];if($e.tryLoc===Te){var ft=$e.completion;if(ft.type==="throw"){var st=ft.arg;ar($e)}return st}}throw new Error("illegal catch attempt")},delegateYield:function(Te,ke,$e){return this.delegate={iterator:On(Te),resultName:ke,nextLoc:$e},this.method==="next"&&(this.arg=void 0),Rt}},At}qe.exports=Zt,qe.exports.__esModule=!0,qe.exports.default=qe.exports},7202:function(qe){function pt(oe){"@babel/helpers - typeof";return qe.exports=pt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ee){return typeof ee}:function(ee){return ee&&typeof Symbol=="function"&&ee.constructor===Symbol&&ee!==Symbol.prototype?"symbol":typeof ee},qe.exports.__esModule=!0,qe.exports.default=qe.exports,pt(oe)}qe.exports=pt,qe.exports.__esModule=!0,qe.exports.default=qe.exports},86170:function(qe,pt,oe){var ee=oe(45728)();qe.exports=ee;try{regeneratorRuntime=ee}catch(Zt){typeof globalThis=="object"?globalThis.regeneratorRuntime=ee:Function("r","regeneratorRuntime = r")(ee)}}}]);
