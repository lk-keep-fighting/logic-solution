"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[5315],{42798:function(X,B,e){e.r(B),e.d(B,{default:function(){return me}});var R=e(48305),a=e.n(R),Z=e(9413),f={editorContainer:"editorContainer___czC1W"},_=e(25298),P=e.n(_),F=e(17069),I=e.n(F),j=e(21742),y=e.n(j),A=e(83136),K=e.n(A),m=e(87363),J=e(22763),S=e(42327),x=e(3044),i=e(21644),d=e(77201),r=e(62086),u=function(E){y()(T,E);var L=K()(T);function T(){return P()(this,T),L.apply(this,arguments)}return I()(T,[{key:"render",value:function(){var Y,W="cxd",G="zh-CN",U=this.props,z=U.pageSchmea,$=U.preview,N=U.isMobile,H=U.onChange;return(0,r.jsx)(J.MLE,{value:z,isMobile:N,preview:$,onChange:H,showCustomRenderersPanel:!0})}}]),T}(m.Component),t=u,s=e(58523),n=e(39765),o=e(90171),c=e(39710),D=e(57946),b=e(63121),g=e(94391),h=e(874),q=e.n(h),de=e(9565),w=e(950),ee=e(99294),_e=e(28120);w.Z.interceptors.response.use(function(E){return E.data?E:Promise.reject(new Error(E.data.message))},function(E){if(console.log("axios error"),E.response.data){var L=E.response;return console.log("--\u300Bdata\u6709\u8FD4\u56DE\u503C\uFF0C\u5224\u5B9A\u4E3A\u4E1A\u52A1\u5F02\u5E38\uFF0C\u7EE7\u7EED\u8FD4\u56DEresponse\uFF01"),console.log(L),L}return Promise.reject(E)});var pe=function(L){var T="cxd",ge="zh-CN",Y=(0,Z.UO)(),W=Y.render,G=Y.id,U=(0,m.useState)({}),z=a()(U,2),$=z[0],N=z[1];(0,m.useEffect)(function(){console.log("Editor"),console.log(W),(0,ee.n4)(W,G).then(function(v){return N(v)})},[G]);var H=(0,m.useState)(!1),ne=a()(H,2),V=ne[0],fe=ne[1],he=(0,m.useState)(!1),te=a()(he,2),ve=te[0],Q=te[1],Ce=(0,m.useState)(!1),ae=a()(Ce,2),re=ae[0],se=ae[1],ye=(0,m.useState)(""),ue=a()(ye,2),oe=ue[0],De=ue[1],Ae=(0,m.useState)(""),ie=a()(Ae,2),le=ie[0],ce=ie[1];return(0,r.jsxs)("div",{className:f.editorContainer,children:[(0,r.jsxs)(s.Z,{style:{margin:"5px",float:"right"},children:[(0,r.jsx)(n.ZP,{onClick:function(){return fe(!V)},children:V?"\u7F16\u8F91":"\u9884\u89C8"},1),(0,r.jsx)(n.ZP,{type:"primary",onClick:function(l){q()(JSON.stringify($))},children:"\u590D\u5236\u914D\u7F6E"},2),(0,r.jsx)(n.ZP,{type:"primary",onClick:function(l){(0,ee.wx)(W,G,$)},children:"\u4FDD\u5B58\u5230DB"},3)]}),(0,r.jsx)(o.Z,{style:{margin:"0px"}}),(0,r.jsx)(t,{pageSchmea:$,preview:V,onChange:function(l){return N(l)},style:{height:"100vh"}}),(0,r.jsxs)(c.Z,{open:ve,confirmLoading:re,title:"\u914D\u7F6E\u751F\u6210\u5C0F\u52A9\u624B(Beta)",cancelText:"\u53D6\u6D88",okText:"\u4F7F\u7528\u914D\u7F6E",width:800,onOk:function(){Q(!1),N(JSON.parse(le))},onCancel:function(){return Q(!1)},children:[(0,r.jsx)(D.Z.TextArea,{style:{margin:"5px"},placeholder:'\u8F93\u5165\u4E00\u6BB5\u9700\u6C42\uFF0C\u5982"\u751F\u6210\u4E00\u4E2A\u4EFB\u52A1\u7BA1\u7406\u754C\u9762\uFF0C\u4EFB\u52A1\u4FE1\u606F\u5305\u542B\u4EFB\u52A1\u53F7id\u3001\u65F6\u95F4time\u3001\u8D1F\u8D23\u4EBAmgr_user',onChange:function(l){return De(l.target.value)}}),(0,r.jsx)(n.ZP,{loading:re,onClick:function(){if(oe.length==0){b.ZP.warning("\u8BF7\u8F93\u5165\u4E00\u6BB5\u9700\u6C42\u63D0\u793A");return}Q(!0),se(!0),w.Z.post("/openai/v1/chat/completions",{headers:{Authorization:"Bearer ".concat({NODE_ENV:"production",PUBLIC_PATH:"/logic/"}.REACT_APP_OPENAI_API_KEY||"YOUR_OPENAI_API_KEY")},data:{model:"gpt-3.5-turbo",messages:[{role:"system",content:"\u4F60\u662F\u4E00\u4E2Aamis\u914D\u7F6E\u6587\u4EF6\u751F\u6210\u5668\uFF0C\u5E2E\u6211\u751F\u6210json\u914D\u7F6E\u6587\u4EF6"},{role:"user",content:oe}]}}).then(function(l){var M=l.choices[0].message.content;se(!1);var O=M.indexOf("```"),C=M.lastIndexOf("```"),k=M.substring(O+7,C);console.log(k),ce(k)})},icon:(0,r.jsx)(de.Z,{}),type:"primary",style:{width:"100%",marginTop:"5px",marginBottom:"5px"},children:"\u751F\u6210\u914D\u7F6E\u2193"}),(0,r.jsx)(g.MLE,{value:le,onChange:function(l){return ce(l)},height:300,language:"json",options:{fetcher:function(l){var M=l.url,O=l.method,C=l.data,k=l.responseType,p=l.config,Ee=l.headers;return p=p||{},p.withCredentials=!0,k&&(p.responseType=k),p.cancelExecutor&&(p.cancelToken=new w.Z.CancelToken(p.cancelExecutor)),p.headers=Ee||{},O!=="post"&&O!=="put"&&O!=="patch"?(C&&(p.params=C),w.Z[O](M,p)):(C&&C instanceof FormData?(p.headers=p.headers||{},p.headers["Content-Type"]="multipart/form-data"):C&&typeof C!="string"&&!(C instanceof Blob)&&!(C instanceof ArrayBuffer)&&(C=JSON.stringify(C),p.headers=p.headers||{},p.headers["Content-Type"]="application/json"),w.Z[O](M,C,p))},isCancel:function(l){return w.Z.isCancel(l)},copy:function(l){q()(l),g.Amu.success("\u5185\u5BB9\u5DF2\u590D\u5236\u5230\u7C98\u8D34\u677F")},theme:T}})]})]})},me=pe},99294:function(X,B,e){e.d(B,{CD:function(){return J},UD:function(){return K},n4:function(){return x},wx:function(){return d}});var R=e(90228),a=e.n(R),Z=e(87999),f=e.n(Z),_=e(33627),P=e(25298),F=e.n(P),I=e(17069),j=e.n(I),y=e(72591),A=function(){function u(){F()(this,u)}return j()(u,null,[{key:"getAssetFromDb",value:function(){var t=f()(a()().mark(function n(o,c){var D;return a()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,y.U2)("/api/ide/settings/asset/".concat(o,"/").concat(c));case 2:return D=g.sent.data,g.abrupt("return",JSON.parse(D.data.config));case 4:case"end":return g.stop()}},n)}));function s(n,o){return t.apply(this,arguments)}return s}()},{key:"saveAssetToDb",value:function(){var t=f()(a()().mark(function n(o,c,D){return a()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",(0,y.v_)("/api/ide/settings/asset/".concat(o,"/").concat(c),D));case 1:case"end":return g.stop()}},n)}));function s(n,o,c){return t.apply(this,arguments)}return s}()},{key:"getRemoteAssetFromDb",value:function(){var t=f()(a()().mark(function n(o,c,D){var b;return a()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,y.U2)("/api/ide/papi/".concat(o,"/api/ide/settings/asset/").concat(c,"/").concat(D));case 2:return b=h.sent.data,h.abrupt("return",JSON.parse(b.data.config));case 4:case"end":return h.stop()}},n)}));function s(n,o,c){return t.apply(this,arguments)}return s}()},{key:"saveRemoteAssetToDb",value:function(){var t=f()(a()().mark(function n(o,c,D,b){return a()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,y.v_)("/api/ide/papi/".concat(o,"/api/ide/settings/asset/").concat(c,"/").concat(D),b));case 1:case"end":return h.stop()}},n)}));function s(n,o,c,D){return t.apply(this,arguments)}return s}()}]),u}();function K(u){return m.apply(this,arguments)}function m(){return m=f()(a()().mark(function u(t){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(_.j.getModel()!="db"){n.next=4;break}return n.abrupt("return",A.getAssetFromDb("page",t));case 4:return n.next=6,(0,y.U2)("/logic/setting/pages/".concat(t,".json"));case 6:return n.abrupt("return",n.sent.data);case 7:case"end":return n.stop()}},u)})),m.apply(this,arguments)}function J(u){return S.apply(this,arguments)}function S(){return S=f()(a()().mark(function u(t){return a()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(_.j.getModel()!="db"){n.next=4;break}return n.abrupt("return",A.getAssetFromDb("form",t));case 4:return n.next=6,(0,y.U2)("/logic/setting/forms/".concat(t,".json"));case 6:return n.abrupt("return",n.sent.data);case 7:case"end":return n.stop()}},u)})),S.apply(this,arguments)}function x(u,t){return i.apply(this,arguments)}function i(){return i=f()(a()().mark(function u(t,s){return a()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(_.j.getModel()!="db"){o.next=4;break}return o.abrupt("return",A.getAssetFromDb(t,s));case 4:return o.next=6,(0,y.U2)("/logic/setting/".concat(t,"s/").concat(s,".json"));case 6:return o.abrupt("return",o.sent.data);case 7:case"end":return o.stop()}},u)})),i.apply(this,arguments)}function d(u,t,s){return r.apply(this,arguments)}function r(){return r=f()(a()().mark(function u(t,s,n){return a()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(_.j.getModel()!="db"){c.next=2;break}return c.abrupt("return",A.saveAssetToDb(t,s,n));case 2:case"end":return c.stop()}},u)})),r.apply(this,arguments)}},72591:function(X,B,e){e.d(B,{U2:function(){return I},gz:function(){return y},v_:function(){return J}});var R=e(90228),a=e.n(R),Z=e(26068),f=e.n(Z),_=e(87999),P=e.n(_),F=e(950);function I(i,d){return j.apply(this,arguments)}function j(){return j=P()(a()().mark(function i(d,r){return a()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",F.Z.get(d,x(r)));case 1:case"end":return t.stop()}},i)})),j.apply(this,arguments)}function y(i,d,r){return A.apply(this,arguments)}function A(){return A=P()(a()().mark(function i(d,r,u){return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",F.Z.put(d,r,x(u)));case 1:case"end":return s.stop()}},i)})),A.apply(this,arguments)}function K(i,d){return m.apply(this,arguments)}function m(){return m=_asyncToGenerator(_regeneratorRuntime().mark(function i(d,r){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",axios.delete(d,x(r)));case 1:case"end":return t.stop()}},i)})),m.apply(this,arguments)}function J(i,d,r){return S.apply(this,arguments)}function S(){return S=P()(a()().mark(function i(d,r,u){return a()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",F.Z.post(d,r,x(u)));case 1:case"end":return s.stop()}},i)})),S.apply(this,arguments)}function x(i){var d={"Content-Type":"application/json;charset=UTF-8"};return localStorage.getItem("token")&&(d.Authorization="Bearer "+localStorage.getItem("token")),f()(f()({},i),{},{headers:f()(f()({},d),i==null?void 0:i.headers)})}}}]);
