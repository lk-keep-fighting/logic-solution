"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[5315],{55639:function(Y,w,e){e.r(w),e.d(w,{default:function(){return me}});var Z=e(54306),r=e.n(Z),J=e(98306),f={editorContainer:"editorContainer___czC1W"},x=e(21140),F=e.n(x),j=e(63466),_=e.n(j),T=e(58853),y=e.n(T),S=e(38888),W=e.n(S),m=e(87363),I=e(63204),b=e(33358),P=e(49500),l=e(16123),d=e(78057),a=e(33130),u=function(A){y()(O,A);var $=W()(O);function O(){return F()(this,O),$.apply(this,arguments)}return _()(O,[{key:"render",value:function(){var H,K="cxd",k="zh-CN",U=this.props,z=U.pageSchmea,L=U.preview,G=U.isMobile,Q=U.onChange;return(0,a.jsx)(I.MLE,{value:z,isMobile:G,preview:L,onChange:Q,showCustomRenderersPanel:!0})}}]),O}(m.Component),t=u,s=e(4283),n=e(54145),o=e(8051),c=e(51394),D=e(53914),E=e(83217),g=e(2069),h=e(90010),q=e.n(h),de=e(56868),M=e(70517),ee=e(12472),xe=e(82162);M.Z.interceptors.response.use(function(A){return A.data?A:Promise.reject(new Error(A.data.message))},function(A){if(console.log("axios error"),A.response.data){var $=A.response;return console.log("--\u300Bdata\u6709\u8FD4\u56DE\u503C\uFF0C\u5224\u5B9A\u4E3A\u4E1A\u52A1\u5F02\u5E38\uFF0C\u7EE7\u7EED\u8FD4\u56DEresponse\uFF01"),console.log($),$}return Promise.reject(A)});var pe=function($){var O="cxd",ge="zh-CN",H=(0,J.UO)(),K=H.render,k=H.id,U=(0,m.useState)({}),z=r()(U,2),L=z[0],G=z[1];(0,m.useEffect)(function(){console.log("Editor"),console.log(K),(0,ee.n4)(K,k).then(function(v){return G(v)})},[k]);var Q=(0,m.useState)(!1),ne=r()(Q,2),X=ne[0],fe=ne[1],he=(0,m.useState)(!1),te=r()(he,2),ve=te[0],V=te[1],Ce=(0,m.useState)(!1),re=r()(Ce,2),ae=re[0],se=re[1],ye=(0,m.useState)(""),ue=r()(ye,2),oe=ue[0],De=ue[1],Se=(0,m.useState)(""),le=r()(Se,2),ie=le[0],ce=le[1];return(0,a.jsxs)("div",{className:f.editorContainer,children:[(0,a.jsxs)(s.Z,{style:{margin:"5px",float:"right"},children:[(0,a.jsx)(n.ZP,{onClick:function(){return fe(!X)},children:X?"\u7F16\u8F91":"\u9884\u89C8"},1),(0,a.jsx)(n.ZP,{type:"primary",onClick:function(i){q()(JSON.stringify(L))},children:"\u590D\u5236\u914D\u7F6E"},2),(0,a.jsx)(n.ZP,{type:"primary",onClick:function(i){(0,ee.wx)(K,k,L)},children:"\u4FDD\u5B58\u5230DB"},3)]}),(0,a.jsx)(o.Z,{style:{margin:"0px"}}),(0,a.jsx)(t,{pageSchmea:L,preview:X,onChange:function(i){return G(i)},style:{height:"100vh"}}),(0,a.jsxs)(c.Z,{open:ve,confirmLoading:ae,title:"\u914D\u7F6E\u751F\u6210\u5C0F\u52A9\u624B(Beta)",cancelText:"\u53D6\u6D88",okText:"\u4F7F\u7528\u914D\u7F6E",width:800,onOk:function(){V(!1),G(JSON.parse(ie))},onCancel:function(){return V(!1)},children:[(0,a.jsx)(D.Z.TextArea,{style:{margin:"5px"},placeholder:'\u8F93\u5165\u4E00\u6BB5\u9700\u6C42\uFF0C\u5982"\u751F\u6210\u4E00\u4E2A\u4EFB\u52A1\u7BA1\u7406\u754C\u9762\uFF0C\u4EFB\u52A1\u4FE1\u606F\u5305\u542B\u4EFB\u52A1\u53F7id\u3001\u65F6\u95F4time\u3001\u8D1F\u8D23\u4EBAmgr_user',onChange:function(i){return De(i.target.value)}}),(0,a.jsx)(n.ZP,{loading:ae,onClick:function(){if(oe.length==0){E.ZP.warning("\u8BF7\u8F93\u5165\u4E00\u6BB5\u9700\u6C42\u63D0\u793A");return}V(!0),se(!0),M.Z.post("/openai/v1/chat/completions",{headers:{Authorization:"Bearer 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"},data:{model:"gpt-3.5-turbo",messages:[{role:"system",content:"\u4F60\u662F\u4E00\u4E2Aamis\u914D\u7F6E\u6587\u4EF6\u751F\u6210\u5668\uFF0C\u5E2E\u6211\u751F\u6210json\u914D\u7F6E\u6587\u4EF6"},{role:"user",content:oe}]}}).then(function(i){var R=i.choices[0].message.content;se(!1);var B=R.indexOf("```"),C=R.lastIndexOf("```"),N=R.substring(B+7,C);console.log(N),ce(N)})},icon:(0,a.jsx)(de.Z,{}),type:"primary",style:{width:"100%",marginTop:"5px",marginBottom:"5px"},children:"\u751F\u6210\u914D\u7F6E\u2193"}),(0,a.jsx)(g.ML,{value:ie,onChange:function(i){return ce(i)},height:300,language:"json",options:{fetcher:function(i){var R=i.url,B=i.method,C=i.data,N=i.responseType,p=i.config,Ae=i.headers;return p=p||{},p.withCredentials=!0,N&&(p.responseType=N),p.cancelExecutor&&(p.cancelToken=new M.Z.CancelToken(p.cancelExecutor)),p.headers=Ae||{},B!=="post"&&B!=="put"&&B!=="patch"?(C&&(p.params=C),M.Z[B](R,p)):(C&&C instanceof FormData?(p.headers=p.headers||{},p.headers["Content-Type"]="multipart/form-data"):C&&typeof C!="string"&&!(C instanceof Blob)&&!(C instanceof ArrayBuffer)&&(C=JSON.stringify(C),p.headers=p.headers||{},p.headers["Content-Type"]="application/json"),M.Z[B](R,C,p))},isCancel:function(i){return M.Z.isCancel(i)},copy:function(i){q()(i),g.Am.success("\u5185\u5BB9\u5DF2\u590D\u5236\u5230\u7C98\u8D34\u677F")},theme:O}})]})]})},me=pe},12472:function(Y,w,e){e.d(w,{CD:function(){return I},UD:function(){return W},n4:function(){return P},wx:function(){return d}});var Z=e(25359),r=e.n(Z),J=e(49811),f=e.n(J),x=e(31837),F=e(21140),j=e.n(F),_=e(63466),T=e.n(_),y=e(57475),S=function(){function u(){j()(this,u)}return T()(u,null,[{key:"getAssetFromDb",value:function(){var t=f()(r()().mark(function n(o,c){var D;return r()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,y.U2)("/api/ide/settings/asset/".concat(o,"/").concat(c));case 2:return D=g.sent.data,g.abrupt("return",JSON.parse(D.data.config));case 4:case"end":return g.stop()}},n)}));function s(n,o){return t.apply(this,arguments)}return s}()},{key:"saveAssetToDb",value:function(){var t=f()(r()().mark(function n(o,c,D){return r()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",(0,y.v_)("/api/ide/settings/asset/".concat(o,"/").concat(c),D));case 1:case"end":return g.stop()}},n)}));function s(n,o,c){return t.apply(this,arguments)}return s}()},{key:"getRemoteAssetFromDb",value:function(){var t=f()(r()().mark(function n(o,c,D){var E;return r()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,y.U2)("/papi/".concat(o,"/api/ide/settings/asset/").concat(c,"/").concat(D));case 2:return E=h.sent.data,h.abrupt("return",JSON.parse(E.data.config));case 4:case"end":return h.stop()}},n)}));function s(n,o,c){return t.apply(this,arguments)}return s}()},{key:"saveRemoteAssetToDb",value:function(){var t=f()(r()().mark(function n(o,c,D,E){return r()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,y.v_)("/papi/".concat(o,"/api/ide/settings/asset/").concat(c,"/").concat(D),E));case 1:case"end":return h.stop()}},n)}));function s(n,o,c,D){return t.apply(this,arguments)}return s}()}]),u}();function W(u){return m.apply(this,arguments)}function m(){return m=f()(r()().mark(function u(t){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(x.j.getModel()!="db"){n.next=4;break}return n.abrupt("return",S.getAssetFromDb("page",t));case 4:return n.next=6,(0,y.U2)("/logic/setting/pages/".concat(t,".json"));case 6:return n.abrupt("return",n.sent.data);case 7:case"end":return n.stop()}},u)})),m.apply(this,arguments)}function I(u){return b.apply(this,arguments)}function b(){return b=f()(r()().mark(function u(t){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(x.j.getModel()!="db"){n.next=4;break}return n.abrupt("return",S.getAssetFromDb("form",t));case 4:return n.next=6,(0,y.U2)("/logic/setting/forms/".concat(t,".json"));case 6:return n.abrupt("return",n.sent.data);case 7:case"end":return n.stop()}},u)})),b.apply(this,arguments)}function P(u,t){return l.apply(this,arguments)}function l(){return l=f()(r()().mark(function u(t,s){return r()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(x.j.getModel()!="db"){o.next=4;break}return o.abrupt("return",S.getAssetFromDb(t,s));case 4:return o.next=6,(0,y.U2)("/logic/setting/".concat(t,"s/").concat(s,".json"));case 6:return o.abrupt("return",o.sent.data);case 7:case"end":return o.stop()}},u)})),l.apply(this,arguments)}function d(u,t,s){return a.apply(this,arguments)}function a(){return a=f()(r()().mark(function u(t,s,n){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(x.j.getModel()!="db"){c.next=2;break}return c.abrupt("return",S.saveAssetToDb(t,s,n));case 2:case"end":return c.stop()}},u)})),a.apply(this,arguments)}},57475:function(Y,w,e){e.d(w,{U2:function(){return _},gz:function(){return y},v_:function(){return I}});var Z=e(25359),r=e.n(Z),J=e(57213),f=e.n(J),x=e(49811),F=e.n(x),j=e(70517);function _(l,d){return T.apply(this,arguments)}function T(){return T=F()(r()().mark(function l(d,a){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",j.Z.get(d,P(a)));case 1:case"end":return t.stop()}},l)})),T.apply(this,arguments)}function y(l,d,a){return S.apply(this,arguments)}function S(){return S=F()(r()().mark(function l(d,a,u){return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",j.Z.put(d,a,P(u)));case 1:case"end":return s.stop()}},l)})),S.apply(this,arguments)}function W(l,d){return m.apply(this,arguments)}function m(){return m=_asyncToGenerator(_regeneratorRuntime().mark(function l(d,a){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",axios.delete(d,P(a)));case 1:case"end":return t.stop()}},l)})),m.apply(this,arguments)}function I(l,d,a){return b.apply(this,arguments)}function b(){return b=F()(r()().mark(function l(d,a,u){return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",j.Z.post(d,a,P(u)));case 1:case"end":return s.stop()}},l)})),b.apply(this,arguments)}function P(l){var d={"Content-Type":"application/json;charset=UTF-8"};return localStorage.getItem("token")&&(d.Authorization="Bearer "+localStorage.getItem("token")),f()(f()({},l),{},{headers:f()(f()({},d),l==null?void 0:l.headers)})}}}]);
