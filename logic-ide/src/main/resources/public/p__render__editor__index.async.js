"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[5315],{42798:function(Y,B,e){e.r(B),e.d(B,{default:function(){return me}});var R=e(48305),r=e.n(R),Z=e(9413),f={editorContainer:"editorContainer___czC1W"},E=e(25298),_=e.n(E),j=e(17069),J=e.n(j),x=e(21742),y=e.n(x),S=e(83136),N=e.n(S),m=e(87363),I=e(22763),b=e(42327),T=e(3044),i=e(21644),d=e(77201),a=e(62086),u=function(A){y()(P,A);var $=N()(P);function P(){return _()(this,P),$.apply(this,arguments)}return J()(P,[{key:"render",value:function(){var H,W="cxd",K="zh-CN",M=this.props,z=M.pageSchmea,k=M.preview,L=M.isMobile,Q=M.onChange;return(0,a.jsx)(I.MLE,{value:z,isMobile:L,preview:k,onChange:Q,showCustomRenderersPanel:!0})}}]),P}(m.Component),t=u,s=e(58523),n=e(39765),o=e(90171),c=e(39710),D=e(57946),F=e(63121),g=e(94391),h=e(874),q=e.n(h),de=e(9565),w=e(950),ee=e(99294),Ee=e(28120);w.Z.interceptors.response.use(function(A){return A.data?A:Promise.reject(new Error(A.data.message))},function(A){if(console.log("axios error"),A.response.data){var $=A.response;return console.log("--\u300Bdata\u6709\u8FD4\u56DE\u503C\uFF0C\u5224\u5B9A\u4E3A\u4E1A\u52A1\u5F02\u5E38\uFF0C\u7EE7\u7EED\u8FD4\u56DEresponse\uFF01"),console.log($),$}return Promise.reject(A)});var pe=function($){var P="cxd",ge="zh-CN",H=(0,Z.UO)(),W=H.render,K=H.id,M=(0,m.useState)({}),z=r()(M,2),k=z[0],L=z[1];(0,m.useEffect)(function(){console.log("Editor"),console.log(W),(0,ee.n4)(W,K).then(function(v){return L(v)})},[K]);var Q=(0,m.useState)(!1),ne=r()(Q,2),X=ne[0],fe=ne[1],he=(0,m.useState)(!1),te=r()(he,2),ve=te[0],V=te[1],Ce=(0,m.useState)(!1),re=r()(Ce,2),ae=re[0],se=re[1],ye=(0,m.useState)(""),ue=r()(ye,2),oe=ue[0],De=ue[1],Se=(0,m.useState)(""),ie=r()(Se,2),le=ie[0],ce=ie[1];return(0,a.jsxs)("div",{className:f.editorContainer,children:[(0,a.jsxs)(s.Z,{style:{margin:"5px",float:"right"},children:[(0,a.jsx)(n.ZP,{onClick:function(){return fe(!X)},children:X?"\u7F16\u8F91":"\u9884\u89C8"},1),(0,a.jsx)(n.ZP,{type:"primary",onClick:function(l){q()(JSON.stringify(k))},children:"\u590D\u5236\u914D\u7F6E"},2),(0,a.jsx)(n.ZP,{type:"primary",onClick:function(l){(0,ee.wx)(W,K,k)},children:"\u4FDD\u5B58\u5230DB"},3)]}),(0,a.jsx)(o.Z,{style:{margin:"0px"}}),(0,a.jsx)(t,{pageSchmea:k,preview:X,onChange:function(l){return L(l)},style:{height:"100vh"}}),(0,a.jsxs)(c.Z,{open:ve,confirmLoading:ae,title:"\u914D\u7F6E\u751F\u6210\u5C0F\u52A9\u624B(Beta)",cancelText:"\u53D6\u6D88",okText:"\u4F7F\u7528\u914D\u7F6E",width:800,onOk:function(){V(!1),L(JSON.parse(le))},onCancel:function(){return V(!1)},children:[(0,a.jsx)(D.Z.TextArea,{style:{margin:"5px"},placeholder:'\u8F93\u5165\u4E00\u6BB5\u9700\u6C42\uFF0C\u5982"\u751F\u6210\u4E00\u4E2A\u4EFB\u52A1\u7BA1\u7406\u754C\u9762\uFF0C\u4EFB\u52A1\u4FE1\u606F\u5305\u542B\u4EFB\u52A1\u53F7id\u3001\u65F6\u95F4time\u3001\u8D1F\u8D23\u4EBAmgr_user',onChange:function(l){return De(l.target.value)}}),(0,a.jsx)(n.ZP,{loading:ae,onClick:function(){if(oe.length==0){F.ZP.warning("\u8BF7\u8F93\u5165\u4E00\u6BB5\u9700\u6C42\u63D0\u793A");return}V(!0),se(!0),w.Z.post("/openai/v1/chat/completions",{headers:{Authorization:"Bearer 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"},data:{model:"gpt-3.5-turbo",messages:[{role:"system",content:"\u4F60\u662F\u4E00\u4E2Aamis\u914D\u7F6E\u6587\u4EF6\u751F\u6210\u5668\uFF0C\u5E2E\u6211\u751F\u6210json\u914D\u7F6E\u6587\u4EF6"},{role:"user",content:oe}]}}).then(function(l){var U=l.choices[0].message.content;se(!1);var O=U.indexOf("```"),C=U.lastIndexOf("```"),G=U.substring(O+7,C);console.log(G),ce(G)})},icon:(0,a.jsx)(de.Z,{}),type:"primary",style:{width:"100%",marginTop:"5px",marginBottom:"5px"},children:"\u751F\u6210\u914D\u7F6E\u2193"}),(0,a.jsx)(g.MLE,{value:le,onChange:function(l){return ce(l)},height:300,language:"json",options:{fetcher:function(l){var U=l.url,O=l.method,C=l.data,G=l.responseType,p=l.config,Ae=l.headers;return p=p||{},p.withCredentials=!0,G&&(p.responseType=G),p.cancelExecutor&&(p.cancelToken=new w.Z.CancelToken(p.cancelExecutor)),p.headers=Ae||{},O!=="post"&&O!=="put"&&O!=="patch"?(C&&(p.params=C),w.Z[O](U,p)):(C&&C instanceof FormData?(p.headers=p.headers||{},p.headers["Content-Type"]="multipart/form-data"):C&&typeof C!="string"&&!(C instanceof Blob)&&!(C instanceof ArrayBuffer)&&(C=JSON.stringify(C),p.headers=p.headers||{},p.headers["Content-Type"]="application/json"),w.Z[O](U,C,p))},isCancel:function(l){return w.Z.isCancel(l)},copy:function(l){q()(l),g.Amu.success("\u5185\u5BB9\u5DF2\u590D\u5236\u5230\u7C98\u8D34\u677F")},theme:P}})]})]})},me=pe},99294:function(Y,B,e){e.d(B,{CD:function(){return I},UD:function(){return N},n4:function(){return T},wx:function(){return d}});var R=e(90228),r=e.n(R),Z=e(87999),f=e.n(Z),E=e(33627),_=e(25298),j=e.n(_),J=e(17069),x=e.n(J),y=e(72591),S=function(){function u(){j()(this,u)}return x()(u,null,[{key:"getAssetFromDb",value:function(){var t=f()(r()().mark(function n(o,c){var D;return r()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,y.U2)("/api/ide/settings/asset/".concat(o,"/").concat(c));case 2:return D=g.sent.data,g.abrupt("return",JSON.parse(D.data.config));case 4:case"end":return g.stop()}},n)}));function s(n,o){return t.apply(this,arguments)}return s}()},{key:"saveAssetToDb",value:function(){var t=f()(r()().mark(function n(o,c,D){return r()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",(0,y.v_)("/api/ide/settings/asset/".concat(o,"/").concat(c),D));case 1:case"end":return g.stop()}},n)}));function s(n,o,c){return t.apply(this,arguments)}return s}()},{key:"getRemoteAssetFromDb",value:function(){var t=f()(r()().mark(function n(o,c,D){var F;return r()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,(0,y.U2)("/api/ide/papi/".concat(o,"/api/ide/settings/asset/").concat(c,"/").concat(D));case 2:return F=h.sent.data,h.abrupt("return",JSON.parse(F.data.config));case 4:case"end":return h.stop()}},n)}));function s(n,o,c){return t.apply(this,arguments)}return s}()},{key:"saveRemoteAssetToDb",value:function(){var t=f()(r()().mark(function n(o,c,D,F){return r()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,y.v_)("/api/ide/papi/".concat(o,"/api/ide/settings/asset/").concat(c,"/").concat(D),F));case 1:case"end":return h.stop()}},n)}));function s(n,o,c,D){return t.apply(this,arguments)}return s}()}]),u}();function N(u){return m.apply(this,arguments)}function m(){return m=f()(r()().mark(function u(t){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(E.j.getModel()!="db"){n.next=4;break}return n.abrupt("return",S.getAssetFromDb("page",t));case 4:return n.next=6,(0,y.U2)("/logic/setting/pages/".concat(t,".json"));case 6:return n.abrupt("return",n.sent.data);case 7:case"end":return n.stop()}},u)})),m.apply(this,arguments)}function I(u){return b.apply(this,arguments)}function b(){return b=f()(r()().mark(function u(t){return r()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(E.j.getModel()!="db"){n.next=4;break}return n.abrupt("return",S.getAssetFromDb("form",t));case 4:return n.next=6,(0,y.U2)("/logic/setting/forms/".concat(t,".json"));case 6:return n.abrupt("return",n.sent.data);case 7:case"end":return n.stop()}},u)})),b.apply(this,arguments)}function T(u,t){return i.apply(this,arguments)}function i(){return i=f()(r()().mark(function u(t,s){return r()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(E.j.getModel()!="db"){o.next=4;break}return o.abrupt("return",S.getAssetFromDb(t,s));case 4:return o.next=6,(0,y.U2)("/logic/setting/".concat(t,"s/").concat(s,".json"));case 6:return o.abrupt("return",o.sent.data);case 7:case"end":return o.stop()}},u)})),i.apply(this,arguments)}function d(u,t,s){return a.apply(this,arguments)}function a(){return a=f()(r()().mark(function u(t,s,n){return r()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(E.j.getModel()!="db"){c.next=2;break}return c.abrupt("return",S.saveAssetToDb(t,s,n));case 2:case"end":return c.stop()}},u)})),a.apply(this,arguments)}},72591:function(Y,B,e){e.d(B,{U2:function(){return J},gz:function(){return y},v_:function(){return I}});var R=e(90228),r=e.n(R),Z=e(26068),f=e.n(Z),E=e(87999),_=e.n(E),j=e(950);function J(i,d){return x.apply(this,arguments)}function x(){return x=_()(r()().mark(function i(d,a){return r()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",j.Z.get(d,T(a)));case 1:case"end":return t.stop()}},i)})),x.apply(this,arguments)}function y(i,d,a){return S.apply(this,arguments)}function S(){return S=_()(r()().mark(function i(d,a,u){return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",j.Z.put(d,a,T(u)));case 1:case"end":return s.stop()}},i)})),S.apply(this,arguments)}function N(i,d){return m.apply(this,arguments)}function m(){return m=_asyncToGenerator(_regeneratorRuntime().mark(function i(d,a){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",axios.delete(d,T(a)));case 1:case"end":return t.stop()}},i)})),m.apply(this,arguments)}function I(i,d,a){return b.apply(this,arguments)}function b(){return b=_()(r()().mark(function i(d,a,u){return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",j.Z.post(d,a,T(u)));case 1:case"end":return s.stop()}},i)})),b.apply(this,arguments)}function T(i){var d={"Content-Type":"application/json;charset=UTF-8"};return localStorage.getItem("token")&&(d.Authorization="Bearer "+localStorage.getItem("token")),f()(f()({},i),{},{headers:f()(f()({},d),i==null?void 0:i.headers)})}}}]);
