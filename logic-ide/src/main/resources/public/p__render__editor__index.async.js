"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[5315],{55639:function(K,P,e){e.r(P),e.d(P,{default:function(){return me}});var A=e(54306),t=e.n(A),O=e(98306),m={editorContainer:"editorContainer___czC1W"},D=e(21140),E=e.n(D),C=e(63466),p=e.n(C),s=e(58853),l=e.n(s),i=e(38888),x=e.n(i),_=e(87363),b=e(63204),v=e(33358),u=e(49500),r=e(16123),h=e(78057),n=e(33130),g=function(f){l()(y,f);var B=x()(y);function y(){return E()(this,y),B.apply(this,arguments)}return p()(y,[{key:"render",value:function(){var J,L="cxd",w="zh-CN",T=this.props,W=T.pageSchmea,F=T.preview,I=T.isMobile,G=T.onChange;return(0,n.jsx)(b.MLE,{value:W,isMobile:I,preview:F,onChange:G,showCustomRenderersPanel:!0})}}]),y}(_.Component),M=g,re=e(4283),Z=e(54145),ue=e(8051),oe=e(51394),le=e(53914),_e=e(83217),k=e(2069),ie=e(90010),z=e.n(ie),de=e(56868),S=e(70517),H=e(70256),Pe=e(82162);S.Z.interceptors.response.use(function(f){return f.data?f:Promise.reject(new Error(f.data.message))},function(f){if(console.log("axios error"),f.response.data){var B=f.response;return console.log("--\u300Bdata\u6709\u8FD4\u56DE\u503C\uFF0C\u5224\u5B9A\u4E3A\u4E1A\u52A1\u5F02\u5E38\uFF0C\u7EE7\u7EED\u8FD4\u56DEresponse\uFF01"),console.log(B),B}return Promise.reject(f)});var ce=function(B){var y="cxd",ge="zh-CN",J=(0,O.UO)(),L=J.render,w=J.id,T=(0,_.useState)({}),W=t()(T,2),F=W[0],I=W[1];(0,_.useEffect)(function(){console.log("Editor"),console.log(L),(0,H.n4)(L,w).then(function(d){return I(d)})},[w]);var G=(0,_.useState)(!1),Q=t()(G,2),N=Q[0],pe=Q[1],ve=(0,_.useState)(!1),X=t()(ve,2),he=X[0],$=X[1],fe=(0,_.useState)(!1),V=t()(fe,2),Y=V[0],q=V[1],De=(0,_.useState)(""),ee=t()(De,2),ne=ee[0],Ee=ee[1],Ce=(0,_.useState)(""),te=t()(Ce,2),se=te[0],ae=te[1];return(0,n.jsxs)("div",{className:m.editorContainer,children:[(0,n.jsxs)(re.Z,{style:{margin:"5px",float:"right"},children:[(0,n.jsx)(Z.ZP,{onClick:function(){return pe(!N)},children:N?"\u7F16\u8F91":"\u9884\u89C8"},1),(0,n.jsx)(Z.ZP,{type:"primary",onClick:function(a){z()(JSON.stringify(F))},children:"\u590D\u5236\u914D\u7F6E"},2),(0,n.jsx)(Z.ZP,{type:"primary",onClick:function(a){(0,H.wx)(L,w,F)},children:"\u4FDD\u5B58\u5230DB"},3)]}),(0,n.jsx)(ue.Z,{style:{margin:"0px"}}),(0,n.jsx)(M,{pageSchmea:F,preview:N,onChange:function(a){return I(a)},style:{height:"100vh"}}),(0,n.jsxs)(oe.Z,{open:he,confirmLoading:Y,title:"\u914D\u7F6E\u751F\u6210\u5C0F\u52A9\u624B(Beta)",cancelText:"\u53D6\u6D88",okText:"\u4F7F\u7528\u914D\u7F6E",width:800,onOk:function(){$(!1),I(JSON.parse(se))},onCancel:function(){return $(!1)},children:[(0,n.jsx)(le.Z.TextArea,{style:{margin:"5px"},placeholder:'\u8F93\u5165\u4E00\u6BB5\u9700\u6C42\uFF0C\u5982"\u751F\u6210\u4E00\u4E2A\u4EFB\u52A1\u7BA1\u7406\u754C\u9762\uFF0C\u4EFB\u52A1\u4FE1\u606F\u5305\u542B\u4EFB\u52A1\u53F7id\u3001\u65F6\u95F4time\u3001\u8D1F\u8D23\u4EBAmgr_user',onChange:function(a){return Ee(a.target.value)}}),(0,n.jsx)(Z.ZP,{loading:Y,onClick:function(){if(ne.length==0){_e.ZP.warning("\u8BF7\u8F93\u5165\u4E00\u6BB5\u9700\u6C42\u63D0\u793A");return}$(!0),q(!0),S.Z.post("/openai/v1/chat/completions",{headers:{Authorization:"Bearer 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"},data:{model:"gpt-3.5-turbo",messages:[{role:"system",content:"\u4F60\u662F\u4E00\u4E2Aamis\u914D\u7F6E\u6587\u4EF6\u751F\u6210\u5668\uFF0C\u5E2E\u6211\u751F\u6210json\u914D\u7F6E\u6587\u4EF6"},{role:"user",content:ne}]}}).then(function(a){var U=a.choices[0].message.content;q(!1);var j=U.indexOf("```"),c=U.lastIndexOf("```"),R=U.substring(j+7,c);console.log(R),ae(R)})},icon:(0,n.jsx)(de.Z,{}),type:"primary",style:{width:"100%",marginTop:"5px",marginBottom:"5px"},children:"\u751F\u6210\u914D\u7F6E\u2193"}),(0,n.jsx)(k.ML,{value:se,onChange:function(a){return ae(a)},height:300,language:"json",options:{fetcher:function(a){var U=a.url,j=a.method,c=a.data,R=a.responseType,o=a.config,be=a.headers;return o=o||{},o.withCredentials=!0,R&&(o.responseType=R),o.cancelExecutor&&(o.cancelToken=new S.Z.CancelToken(o.cancelExecutor)),o.headers=be||{},j!=="post"&&j!=="put"&&j!=="patch"?(c&&(o.params=c),S.Z[j](U,o)):(c&&c instanceof FormData?(o.headers=o.headers||{},o.headers["Content-Type"]="multipart/form-data"):c&&typeof c!="string"&&!(c instanceof Blob)&&!(c instanceof ArrayBuffer)&&(c=JSON.stringify(c),o.headers=o.headers||{},o.headers["Content-Type"]="application/json"),S.Z[j](U,c,o))},isCancel:function(a){return S.Z.isCancel(a)},copy:function(a){z()(a),k.Am.success("\u5185\u5BB9\u5DF2\u590D\u5236\u5230\u7C98\u8D34\u677F")},theme:y}})]})]})},me=ce},85002:function(K,P,e){e.d(P,{Z:function(){return l}});var A=e(25359),t=e.n(A),O=e(49811),m=e.n(O),D=e(21140),E=e.n(D),C=e(63466),p=e.n(C),s=e(57475),l=function(){function i(){E()(this,i)}return p()(i,null,[{key:"getAssetFromDb",value:function(){var x=m()(t()().mark(function b(v,u){var r;return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,s.U2)("/api/ide/settings/asset/".concat(v,"/").concat(u));case 2:return r=n.sent.data,n.abrupt("return",JSON.parse(r.data.config));case 4:case"end":return n.stop()}},b)}));function _(b,v){return x.apply(this,arguments)}return _}()},{key:"saveAssetToDb",value:function(){var x=m()(t()().mark(function b(v,u,r){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,s.v_)("/api/ide/settings/asset/".concat(v,"/").concat(u),r));case 1:case"end":return n.stop()}},b)}));function _(b,v,u){return x.apply(this,arguments)}return _}()}]),i}()},70256:function(K,P,e){e.d(P,{CD:function(){return l},UD:function(){return p},n4:function(){return x},wx:function(){return b}});var A=e(25359),t=e.n(A),O=e(49811),m=e.n(O),D=e(31837),E=e(85002),C=e(57475);function p(u){return s.apply(this,arguments)}function s(){return s=m()(t()().mark(function u(r){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:debugger;if(D.j.getModel()!="db"){n.next=5;break}return n.abrupt("return",E.Z.getAssetFromDb("page",r));case 5:return n.next=7,(0,C.U2)("/setting/pages/".concat(r,".json"));case 7:return n.abrupt("return",n.sent.data);case 8:case"end":return n.stop()}},u)})),s.apply(this,arguments)}function l(u){return i.apply(this,arguments)}function i(){return i=m()(t()().mark(function u(r){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(D.j.getModel()!="db"){n.next=4;break}return n.abrupt("return",E.Z.getAssetFromDb("form",r));case 4:return n.next=6,(0,C.U2)("/setting/forms/".concat(r,".json"));case 6:return n.abrupt("return",n.sent.data);case 7:case"end":return n.stop()}},u)})),i.apply(this,arguments)}function x(u,r){return _.apply(this,arguments)}function _(){return _=m()(t()().mark(function u(r,h){return t()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(D.j.getModel()!="db"){g.next=4;break}return g.abrupt("return",E.Z.getAssetFromDb(r,h));case 4:return g.next=6,(0,C.U2)("/setting/".concat(r,"s/").concat(h,".json"));case 6:return g.abrupt("return",g.sent.data);case 7:case"end":return g.stop()}},u)})),_.apply(this,arguments)}function b(u,r,h){return v.apply(this,arguments)}function v(){return v=m()(t()().mark(function u(r,h,n){return t()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(D.j.getModel()!="db"){M.next=2;break}return M.abrupt("return",E.Z.saveAssetToDb(r,h,n));case 2:case"end":return M.stop()}},u)})),v.apply(this,arguments)}},57475:function(K,P,e){e.d(P,{U2:function(){return m},v_:function(){return C}});var A=e(57213),t=e.n(A),O=e(70517);function m(s,l){return O.Z.get(s,p(l))}function D(s,l,i){return axios.put(s,l,p(i))}function E(s,l){return axios.delete(s,p(l))}function C(s,l,i){return O.Z.post(s,l,p(i))}function p(s){var l={"Content-Type":"application/json;charset=UTF-8"};return localStorage.getItem("token")&&(l.Authorization=localStorage.getItem("token")),t()(t()({},s),{},{headers:t()(t()({},l),s==null?void 0:s.headers)})}}}]);
