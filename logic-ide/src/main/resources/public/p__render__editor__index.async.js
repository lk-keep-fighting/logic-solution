"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[5315],{55639:function($,A,e){e.r(A),e.d(A,{default:function(){return de}});var S=e(54306),t=e.n(S),j=e(98306),g={editorContainer:"editorContainer___czC1W"},h=e(21140),C=e.n(h),f=e(63466),T=e.n(f),D=e(58853),F=e.n(D),p=e(38888),E=e.n(p),l=e(87363),v=e(63204),d=e(33358),u=e(49500),r=e(16123),s=e(33130),n=function(m){F()(P,m);var B=E()(P);function P(){return C()(this,P),B.apply(this,arguments)}return T()(P,[{key:"render",value:function(){var K,I="cxd",L="zh-CN",O=this.props,W=O.pageSchmea,U=O.preview,Z=O.isMobile,J=O.onChange;return(0,s.jsx)(v.MLE,{value:W,isMobile:Z,preview:U,onChange:J,showCustomRenderersPanel:!0})}}]),P}(l.Component),c=n,b=e(4283),w=e(54145),re=e(8051),ue=e(10502),oe=e(53914),le=e(83217),k=e(2069),ie=e(90010),z=e.n(ie),_e=e(56868),x=e(70517),Q=e(70256),be=e(82162);x.Z.interceptors.response.use(function(m){return m.data?m:Promise.reject(new Error(m.data.message))},function(m){if(console.log("axios error"),m.response.data){var B=m.response;return console.log("--\u300Bdata\u6709\u8FD4\u56DE\u503C\uFF0C\u5224\u5B9A\u4E3A\u4E1A\u52A1\u5F02\u5E38\uFF0C\u7EE7\u7EED\u8FD4\u56DEresponse\uFF01"),console.log(B),B}return Promise.reject(m)});var ce=function(B){var P="cxd",me="zh-CN",K=(0,j.UO)(),I=K.render,L=K.id,O=(0,l.useState)({}),W=t()(O,2),U=W[0],Z=W[1];(0,l.useEffect)(function(){console.log("Editor"),console.log(I),(0,Q.n4)(I,L).then(function(i){return Z(i)})},[L]);var J=(0,l.useState)(!1),X=t()(J,2),G=X[0],ge=X[1],pe=(0,l.useState)(!1),H=t()(pe,2),ve=H[0],N=H[1],he=(0,l.useState)(!1),V=t()(he,2),Y=V[0],q=V[1],fe=(0,l.useState)(""),ee=t()(fe,2),ne=ee[0],De=ee[1],Ce=(0,l.useState)(""),se=t()(Ce,2),te=se[0],ae=se[1];return(0,s.jsxs)("div",{className:g.editorContainer,children:[(0,s.jsxs)(b.Z,{style:{margin:"5px",float:"right"},children:[(0,s.jsx)(w.ZP,{onClick:function(){return ge(!G)},children:G?"\u7F16\u8F91":"\u9884\u89C8"},1),(0,s.jsx)(w.ZP,{type:"primary",onClick:function(a){z()(JSON.stringify(U))},children:"\u590D\u5236\u914D\u7F6E"},2),(0,s.jsx)(w.ZP,{type:"primary",onClick:function(a){(0,Q.wx)(I,L,U)},children:"\u4FDD\u5B58\u5230DB"},3)]}),(0,s.jsx)(re.Z,{style:{margin:"0px"}}),(0,s.jsx)(c,{pageSchmea:U,preview:G,onChange:function(a){return Z(a)},style:{height:"100vh"}}),(0,s.jsxs)(ue.Z,{open:ve,confirmLoading:Y,title:"\u914D\u7F6E\u751F\u6210\u5C0F\u52A9\u624B(Beta)",cancelText:"\u53D6\u6D88",okText:"\u4F7F\u7528\u914D\u7F6E",width:800,onOk:function(){N(!1),Z(JSON.parse(te))},onCancel:function(){return N(!1)},children:[(0,s.jsx)(oe.Z.TextArea,{style:{margin:"5px"},placeholder:'\u8F93\u5165\u4E00\u6BB5\u9700\u6C42\uFF0C\u5982"\u751F\u6210\u4E00\u4E2A\u4EFB\u52A1\u7BA1\u7406\u754C\u9762\uFF0C\u4EFB\u52A1\u4FE1\u606F\u5305\u542B\u4EFB\u52A1\u53F7id\u3001\u65F6\u95F4time\u3001\u8D1F\u8D23\u4EBAmgr_user',onChange:function(a){return De(a.target.value)}}),(0,s.jsx)(w.ZP,{loading:Y,onClick:function(){if(ne.length==0){le.ZP.warning("\u8BF7\u8F93\u5165\u4E00\u6BB5\u9700\u6C42\u63D0\u793A");return}N(!0),q(!0),x.Z.post("/openai/v1/chat/completions",{headers:{Authorization:"Bearer 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"},data:{model:"gpt-3.5-turbo",messages:[{role:"system",content:"\u4F60\u662F\u4E00\u4E2Aamis\u914D\u7F6E\u6587\u4EF6\u751F\u6210\u5668\uFF0C\u5E2E\u6211\u751F\u6210json\u914D\u7F6E\u6587\u4EF6"},{role:"user",content:ne}]}}).then(function(a){var M=a.choices[0].message.content;q(!1);var y=M.indexOf("```"),_=M.lastIndexOf("```"),R=M.substring(y+7,_);console.log(R),ae(R)})},icon:(0,s.jsx)(_e.Z,{}),type:"primary",style:{width:"100%",marginTop:"5px",marginBottom:"5px"},children:"\u751F\u6210\u914D\u7F6E\u2193"}),(0,s.jsx)(k.ML,{value:te,onChange:function(a){return ae(a)},height:300,language:"json",options:{fetcher:function(a){var M=a.url,y=a.method,_=a.data,R=a.responseType,o=a.config,Ee=a.headers;return o=o||{},o.withCredentials=!0,R&&(o.responseType=R),o.cancelExecutor&&(o.cancelToken=new x.Z.CancelToken(o.cancelExecutor)),o.headers=Ee||{},y!=="post"&&y!=="put"&&y!=="patch"?(_&&(o.params=_),x.Z[y](M,o)):(_&&_ instanceof FormData?(o.headers=o.headers||{},o.headers["Content-Type"]="multipart/form-data"):_&&typeof _!="string"&&!(_ instanceof Blob)&&!(_ instanceof ArrayBuffer)&&(_=JSON.stringify(_),o.headers=o.headers||{},o.headers["Content-Type"]="application/json"),x.Z[y](M,_,o))},isCancel:function(a){return x.Z.isCancel(a)},copy:function(a){z()(a),k.Am.success("\u5185\u5BB9\u5DF2\u590D\u5236\u5230\u7C98\u8D34\u677F")},theme:P}})]})]})},de=ce},85002:function($,A,e){e.d(A,{Z:function(){return F}});var S=e(25359),t=e.n(S),j=e(49811),g=e.n(j),h=e(21140),C=e.n(h),f=e(63466),T=e.n(f),D=e(70517),F=function(){function p(){C()(this,p)}return T()(p,null,[{key:"getAssetFromDb",value:function(){var E=g()(t()().mark(function v(d,u){var r;return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,D.Z.get("/api/ide/settings/asset/".concat(d,"/").concat(u));case 2:return r=n.sent.data,n.abrupt("return",JSON.parse(r.data.config));case 4:case"end":return n.stop()}},v)}));function l(v,d){return E.apply(this,arguments)}return l}()},{key:"saveAssetToDb",value:function(){var E=g()(t()().mark(function v(d,u,r){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",D.Z.post("/api/ide/settings/asset/".concat(d,"/").concat(u),r));case 1:case"end":return n.stop()}},v)}));function l(v,d,u){return E.apply(this,arguments)}return l}()}]),p}()},70256:function($,A,e){e.d(A,{CD:function(){return F},UD:function(){return T},n4:function(){return E},wx:function(){return v}});var S=e(25359),t=e.n(S),j=e(49811),g=e.n(j),h=e(31837),C=e(70517),f=e(85002);function T(u){return D.apply(this,arguments)}function D(){return D=g()(t()().mark(function u(r){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:debugger;if(h.j.getModel()!="db"){n.next=5;break}return n.abrupt("return",f.Z.getAssetFromDb("page",r));case 5:return n.next=7,C.Z.get("/setting/pages/".concat(r,".json"));case 7:return n.abrupt("return",n.sent.data);case 8:case"end":return n.stop()}},u)})),D.apply(this,arguments)}function F(u){return p.apply(this,arguments)}function p(){return p=g()(t()().mark(function u(r){return t()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(h.j.getModel()!="db"){n.next=4;break}return n.abrupt("return",f.Z.getAssetFromDb("form",r));case 4:return n.next=6,C.Z.get("/setting/forms/".concat(r,".json"));case 6:return n.abrupt("return",n.sent.data);case 7:case"end":return n.stop()}},u)})),p.apply(this,arguments)}function E(u,r){return l.apply(this,arguments)}function l(){return l=g()(t()().mark(function u(r,s){return t()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(h.j.getModel()!="db"){c.next=4;break}return c.abrupt("return",f.Z.getAssetFromDb(r,s));case 4:return c.next=6,C.Z.get("/setting/".concat(r,"s/").concat(s,".json"));case 6:return c.abrupt("return",c.sent.data);case 7:case"end":return c.stop()}},u)})),l.apply(this,arguments)}function v(u,r,s){return d.apply(this,arguments)}function d(){return d=g()(t()().mark(function u(r,s,n){return t()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(h.j.getModel()!="db"){b.next=2;break}return b.abrupt("return",f.Z.saveAssetToDb(r,s,n));case 2:case"end":return b.stop()}},u)})),d.apply(this,arguments)}}}]);
