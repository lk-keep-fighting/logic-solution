"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[2780],{42651:function(A,S,n){n.d(S,{Z:function(){return l}});var C=n(21140),r=n.n(C),f=n(63466),u=n.n(f),o=n(52510),p=n.n(o),l=function(){function t(d){r()(this,t),p()(this,"_nodeConfig",void 0),p()(this,"_groups",void 0),this._nodeConfig=JSON.parse(JSON.stringify(d)),this._nodeConfig._groups&&(this._groups=this._nodeConfig._groups)}return u()(t,[{key:"getNodeConfig",value:function(){return this._nodeConfig}},{key:"getGroups",value:function(){return this._groups}},{key:"setLabel",value:function(a){this._nodeConfig.attrs&&(this._nodeConfig.attrs.text.text=a)}},{key:"setGroups",value:function(a){this._groups=a}},{key:"setConfigSchemel",value:function(a){this._nodeConfig.data?(this._nodeConfig.data.configSchema=a,this._nodeConfig.data.config={type:a}):this._nodeConfig.data={configSchema:a,config:{type:a}}}},{key:"setConfigData",value:function(a){this._nodeConfig.data?this._nodeConfig.data.config=a:this._nodeConfig.data={config:a}}}]),t}()},72107:function(A,S,n){n.d(S,{Ld:function(){return C},Iz:function(){return a},Du:function(){return m},dO:function(){return c},z1:function(){return N},X0:function(){return d},_w:function(){return j}});var C=function(e){return e.TypeAnnotation="TypeAnnotation",e.Structure="Structure",e.StructureProperty="StructureProperty",e.TypeParam="TypeParam",e.Variable="Variable",e.Logic="Logic",e.LogicItem="LogicItem",e}({}),r=function(e){return e.start="start",e.end="end",e.switch="switch",e["switch-case"]="switch-case",e["switch-def"]="switch-def",e["mqtt-pub"]="mqtt-pub",e["mqtt-sub"]="mqtt-sub",e["mqtt-unsub"]="mqtt-unsub",e["mqtt-client"]="mqtt-client",e["mqtt-server"]="mqtt-server",e["mqtt-broker"]="mqtt-broker",e.http="http",e.logic="logic",e.js="js",e.wait="wait",e}({}),f=n(63466),u=n.n(f),o=n(21140),p=n.n(o),l=n(52510),t=n.n(l),d=u()(function e(_){p()(this,e),t()(this,"concept",void 0),t()(this,"name",void 0),t()(this,"label",void 0),t()(this,"description",void 0),t()(this,"typeAnnotation",void 0),t()(this,"required",!1),t()(this,"defaultValue",void 0),this.concept=C.StructureProperty,this.name=_}),a=u()(function e(_){p()(this,e),t()(this,"concept",C.Logic),t()(this,"schemeVersion",void 0),t()(this,"version",void 0),t()(this,"id",void 0),t()(this,"name",void 0),t()(this,"label",void 0),t()(this,"description",void 0),t()(this,"triggerType",void 0),t()(this,"log",void 0),t()(this,"cron",void 0),t()(this,"typeParams",void 0),t()(this,"params",void 0),t()(this,"returns",void 0),t()(this,"variables",void 0),t()(this,"envs",void 0),t()(this,"items",[]),t()(this,"visualConfig",void 0),this.id=_,this.schemeVersion="0.1"}),m=u()(function e(_,D){var B=this;p()(this,e),t()(this,"concept","LogicItem"),t()(this,"id",void 0),t()(this,"name",void 0),t()(this,"type",void 0),t()(this,"label",void 0),t()(this,"description",void 0),t()(this,"params",void 0),t()(this,"returns",void 0),t()(this,"envs",void 0),t()(this,"afterReturnAdaptor",void 0),t()(this,"returnAccept",void 0),t()(this,"nextId",void 0),t()(this,"endId",void 0),t()(this,"condition",void 0),t()(this,"script",void 0),t()(this,"timeout",void 0),t()(this,"branches",void 0),t()(this,"url",void 0),t()(this,"method",void 0),t()(this,"headers",void 0),t()(this,"queryParams",void 0),t()(this,"tranScope",void 0),t()(this,"body",void 0),t()(this,"setEnv",function(i){B.envs=i}),this.type=D,this.id=_}),v=null,c=u()(function e(_){p()(this,e),t()(this,"concept","Param"),t()(this,"name",void 0),t()(this,"description",void 0),t()(this,"typeAnnotation",void 0),t()(this,"required",void 0),t()(this,"defaultValue",void 0),this.name=_}),P=n(58853),b=n.n(P),h=n(38888),x=n.n(h),N=function(e){b()(D,e);var _=x()(D);function D(B){var i;return p()(this,D),i=_.call(this,B),i.concept="Return",i}return u()(D)}(c),j=function(e){b()(D,e);var _=x()(D);function D(B){var i;return p()(this,D),i=_.call(this,B),i.concept="Variable",i}return u()(D)}(c)},3619:function(A,S,n){n.d(S,{V:function(){return r}});var C=n(17600),r=function(o){var p=new C.Vq({type:"dagre",begin:[400,100],ranker:"network-simplex",rankdir:"TB",ranksep:20,nodeSize:50,align:"DL",controlPoints:!0}),l=o.getNodes(),t=o.getEdges(),d=p.layout({nodes:l,edges:t}),a=d.nodes,m=a===void 0?[]:a;l.forEach(function(v){var c=m.find(function(P){return P.id===v.id});c.x-=v.size().width/2,c.y-=v.size().height/2,v.position(c.x,c.y)})},f=function(o,p){debugger;var l=new DagreLayout({type:"dagre",begin:[400,100],ranker:"tight-tree",rankdir:"TB",ranksep:20,nodeSize:50,controlPoints:!0}),t=l.layout({nodes:o,edges:p}),d=t.nodes,a=d===void 0?[]:d;o.forEach(function(m){var v=a.find(function(c){return c.id===m.id});v.x-=m.size().width/2,v.y-=m.size().height/2,m.position(v.x,v.y)})}},89147:function(A,S,n){n.d(S,{m:function(){return P}});var C=n(5671),r=n(95812),f=n(53914),u={customNode:"customNode___zxYMy",input:"input___oBweR",switchNode:"switchNode___PXP4B"},o=n(33130),p=function(h){return(0,o.jsx)("div",{className:u.customNode,children:(0,o.jsx)(f.Z,{className:"input",value:h==null?void 0:h.data,width:80})})},l=n(371),t=function(h){return(0,o.jsx)("div",{className:styles.customNode,children:(0,o.jsx)(l.Z,{className:"input",value:h==null?void 0:h.data,width:80})})},d=n(57213),a=n.n(d),m=function(h){var x,N,j,e=h.node,_=(x=e.data.config)===null||x===void 0?void 0:x.name,D=_||"case";return(0,o.jsxs)("div",{className:u.customNode,children:[(0,o.jsx)("span",{children:"case"}),(0,o.jsx)(f.Z,{addonAfter:_,className:"input",value:e==null||(N=e.data)===null||N===void 0||(j=N.config)===null||j===void 0?void 0:j.case,width:150,onChange:function(i){var g=e.data;e.setData(a()(a()({},g),{},{config:a()(a()({},g.config),{},{case:i.target.value})}))}})]})},v=function(h){var x,N=h.node;return(0,o.jsx)("div",{className:u.customNode,children:(0,o.jsx)(f.Z,{addonBefore:"switch",className:"input",value:(x=N.data)===null||x===void 0?void 0:x.config.condition,onChange:function(e){var _=N.data;N.setData(a()(a()({},_),{},{config:a()(a()({},_.config),{},{condition:e.target.value})}))},width:100})})},c=function(h){return(0,o.jsx)("div",{className:u.customNode,children:(0,o.jsx)("div",{style:{textAlign:"center",fontSize:"15px"},children:"default"})})};function P(b){b.forEach(function(h){console.log("\u6CE8\u518C\u65B0\u8282\u70B9:"+h.name),C.kJ.registerNode(h.name,h.config,!0)}),(0,r.z2)({shape:"string",component:p}),(0,r.z2)({shape:"num",component:t}),(0,r.z2)({shape:"switch",component:v}),(0,r.z2)({shape:"switch-case",component:m}),(0,r.z2)({shape:"switch-default",component:c})}},58146:function(A,S,n){n.d(S,{K:function(){return t}});var C=n(57213),r=n.n(C),f=n(12490),u=50,o=50,p=[{name:"ExtSharp",config:{width:100,height:o,attrs:{body:{rx:6,ry:6,stroke:"#5F95FF",strokeWidth:1,fill:"rgba(95,149,255,0.05)",refWidth:1,refHeight:1},image:{refX:2,refY:0},text:{refX:4,refY:20,fontSize:12,"text-anchor":"start"}},markup:[{tagName:"rect",selector:"body"},{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]}}],l=n(42651);function t(d,a,m){var v=50,c=50,P={body:{}},b=[new l.Z({shape:"circle",width:v,height:c,attrs:{body:r()(r()({},P.body),{},{fill:"white"}),text:{text:"\u4EA4\u4E92\u70B9"}},markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}],ports:f.Tt,data:{config:{type:"wait-for-continue"}},_groups:["global"]}),new l.Z({shape:"circle",label:"end",width:v,height:c,attrs:{body:r()(r()({},P.body),{},{fill:"#d9d9d9"}),text:{text:"end"}},markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}],ports:f.Tt,data:{config:{type:"end"}},_groups:["global"]}),new l.Z({shape:"ExtSharp",attrs:{text:{text:"http\u8BF7\u6C42",fontSize:14},image:{"xlink:href":"/icons/http.svg",width:20,x:2,y:2}},data:{config:{type:"http",method:"POST"}},ports:f.Tt,_groups:["biz"]}),new l.Z({shape:"ExtSharp",ports:f.Tt,attrs:{image:{width:15,x:2,y:2,"xlink:href":"/icons/code.svg"},text:{text:"js\u811A\u672C",fontSize:14}},data:{config:{type:"js"}},_groups:["biz"]}),new l.Z({shape:"ExtSharp",ports:f.Tt,attrs:{image:{width:15,x:2,y:2,"xlink:href":"/icons/java.svg"},text:{text:"java\u65B9\u6CD5",fontSize:14}},data:{config:{type:"java"}},_groups:["biz"]}),new l.Z({shape:"ExtSharp",ports:f.Tt,attrs:{image:{width:15,x:2,y:2,"xlink:href":"/icons/CarbonSubflowLocal.svg"},text:{text:"\u590D\u7528\u903B\u8F91",fontSize:14}},data:{config:{type:"sub-logic"}},_groups:["biz"]}),new l.Z({shape:"ExtSharp",width:50,height:c,label:"switch",attrs:{image:{"xlink:href":"/icons/switch.svg",width:45,x:1,y:2},text:{text:"switch",fontSize:14,refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"switch"}},ports:f.Tt,_groups:["ctrl"]}),new l.Z({shape:"ExtSharp",width:v,height:c,attrs:{image:{"xlink:href":"/icons/text.svg",width:30,x:8,y:10},text:{text:"case",fontSize:14,refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"switch-case"}},ports:f.Tt,_groups:["ctrl"]}),new l.Z({shape:"ExtSharp",width:50,height:c,attrs:{image:{"xlink:href":"/icons/text.svg",width:30,x:8,y:10},text:{text:"default",fontSize:14,refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"switch-default"}},ports:f.Tt,_groups:["ctrl"]}),new l.Z({shape:"ExtSharp",width:v,height:c,attrs:{image:{"xlink:href":"/icons/delay.svg",width:30,x:8,y:10},text:{text:"\u7B49\u5F85",fontSize:14,refX:.5,refY:"100%",refY2:4,textAnchor:"middle",textVerticalAnchor:"top"}},data:{config:{type:"wait",timeout:"2000"}},ports:f.Tt,_groups:["ctrl"]})];d&&d.length>0&&Array.prototype.push.apply(b,d);var h=[{name:"global",title:"\u5168\u5C40\u8282\u70B9",graphHeight:110},{name:"ctrl",title:"\u903B\u8F91\u63A7\u5236",graphHeight:220},{name:"biz",title:"\u4E1A\u52A1\u8C03\u7528",graphHeight:220}];a&&a.length>0&&Array.prototype.push.apply(h,a);var x=p;return m&&m.length>0&&Array.prototype.push.apply(x,m),{Shapes:x,Nodes:b,Groups:h}}},48364:function(A,S,n){n.d(S,{Uh:function(){return D},YH:function(){return v},az:function(){return P},b9:function(){return e},gC:function(){return N},m9:function(){return h}});var C=n(25359),r=n.n(C),f=n(49811),u=n.n(f),o=n(70517),p=n(5726),l=n.n(p);function t(i){return d.apply(this,arguments)}function d(){return d=_asyncToGenerator(_regeneratorRuntime().mark(function i(g){return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",axios.post("/api/ide/pub/logic/dev-to-test".concat(g)));case 1:case"end":return s.stop()}},i)})),d.apply(this,arguments)}function a(i){return m.apply(this,arguments)}function m(){return m=_asyncToGenerator(_regeneratorRuntime().mark(function i(g){return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",axios.get("/api/ide/logic/".concat(g)));case 1:case"end":return s.stop()}},i)})),m.apply(this,arguments)}function v(i){return c.apply(this,arguments)}function c(){return c=u()(r()().mark(function i(g){return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",o.Z.get("/api/ide/logic/".concat(g,"/config")).then(function(w){var y;return(y=w.data)===null||y===void 0?void 0:y.data}));case 1:case"end":return s.stop()}},i)})),c.apply(this,arguments)}function P(i,g,L){return b.apply(this,arguments)}function b(){return b=u()(r()().mark(function i(g,L,s){return r()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",o.Z.put("/api/ide/logic/edit/".concat(g),{version:L,configJson:s,updateTime:l()().format("YYYY-MM-DD HH:mm:ss")}));case 1:case"end":return y.stop()}},i)})),b.apply(this,arguments)}function h(i){return x.apply(this,arguments)}function x(){return x=u()(r()().mark(function i(g){return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",o.Z.get("/api/ide/logic-instance/".concat(g)).then(function(w){var y=w.data.data;return y}));case 1:case"end":return s.stop()}},i)})),x.apply(this,arguments)}function N(i){return j.apply(this,arguments)}function j(){return j=u()(r()().mark(function i(g){return r()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",o.Z.post("/api/ide/logic-logs",{filters:[{dataIndex:"logicId",values:[g.logicId],type:"="},{dataIndex:"bizId",values:[g.bizId],type:"="}],pageSize:1e3,orderBy:[{dataIndex:"id",desc:!0}]}).then(function(w){var y=w.data.data.records;return y&&y.map(function(E){E.itemLogs&&(E.itemLogs=JSON.parse(E.itemLogs))}),y}));case 1:case"end":return s.stop()}},i)})),j.apply(this,arguments)}function e(i,g){return _.apply(this,arguments)}function _(){return _=u()(r()().mark(function i(g,L){return r()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",o.Z.post("/api/ide/logic-baks",{filters:[{dataIndex:"id",values:[g],type:"="},{dataIndex:"version",values:[L],type:"="}]}).then(function(y){var E=y.data.data.records[0].configJson,O=JSON.parse(E);return O}));case 1:case"end":return w.stop()}},i)})),_.apply(this,arguments)}function D(i,g){return B.apply(this,arguments)}function B(){return B=u()(r()().mark(function i(g,L){return r()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",o.Z.post("/api/ide/logic-baks",{filters:[{dataIndex:"id",values:[g],type:"="},{dataIndex:"version",values:[L],type:"="}]}).then(function(y){var E=y.data.data.records[0],O=E.configJson;return E.configJson=JSON.parse(O),E}));case 1:case"end":return w.stop()}},i)})),B.apply(this,arguments)}}}]);
