(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[1756],{31756:function(x,Q,I){"use strict";I.r(Q),I.d(Q,{CRUDRenderer:function(){return Te},CRUDRendererBase:function(){return ce},default:function(){return de}});var c=I(15767),E=I(87363),A=I.n(E),N=I(31223),L=I.n(N),w=I(12557),V=I.n(w),ne=I(24465),J=I.n(ne),re=I(86974),fe=I.n(re),p=I(42977),W=I(94391),ve=I(19334),me=I.n(ve),ie=I(61533),Se=I.n(ie),ge=I(59245),z=I.n(ge),ye=I(33170),le=I.n(ye),be=I(6663),Pe=I(69143),se=I.n(Pe),Ce=I(34736),Oe=I.n(Ce),Fe=["selectedChange","columnSort","columnFilter","columnSearch","columnToggled","orderChange","rowClick","rowDbClick","rowMouseEnter","rowMouseLeave","selected"],de=function(M){(0,c.ZT)(v,M);function v(t){var e=M.call(this,t)||this;e.filterOnEvent=Oe()(function(s){return J()(s,function(P,b){return!Fe.includes(b)})}),e.controlRef=e.controlRef.bind(e),e.handleFilterReset=e.handleFilterReset.bind(e),e.handleFilterSubmit=e.handleFilterSubmit.bind(e),e.handleFilterInit=e.handleFilterInit.bind(e),e.handleAction=e.handleAction.bind(e),e.dispatchEvent=e.dispatchEvent.bind(e),e.handleBulkAction=e.handleBulkAction.bind(e),e.handleChangePage=e.handleChangePage.bind(e),e.handleBulkGo=e.handleBulkGo.bind(e),e.handleDialogConfirm=e.handleDialogConfirm.bind(e),e.handleDialogClose=e.handleDialogClose.bind(e),e.handleItemChange=e.handleItemChange.bind(e),e.handleSave=e.handleSave.bind(e),e.handleSaveOrder=e.handleSaveOrder.bind(e),e.handleSelect=e.handleSelect.bind(e),e.handleChildPopOverOpen=e.handleChildPopOverOpen.bind(e),e.handleChildPopOverClose=e.handleChildPopOverClose.bind(e),e.search=e.search.bind(e),e.silentSearch=e.silentSearch.bind(e),e.handleQuery=e.handleQuery.bind(e),e.renderHeaderToolbar=e.renderHeaderToolbar.bind(e),e.renderFooterToolbar=e.renderFooterToolbar.bind(e),e.clearSelection=e.clearSelection.bind(e),e.filterItemIndex=e.filterItemIndex.bind(e);var n=t.location,r=t.store,a=t.pageField,i=t.perPageField,l=t.totalField,o=t.syncLocation,d=t.loadDataOnce,u=e.getParseQueryOptions(t);e.mounted=!0,o&&n&&(n.query||n.search)?r.updateQuery((0,p.mB4)(n,u),void 0,a,i):o&&!n&&window.location.search&&r.updateQuery((0,p.mB4)(window.location,u),void 0,a,i),e.props.store.setFilterTogglable(!!e.props.filterTogglable,e.props.filterDefaultVisible),e.props.api&&e.props.store.updateData({items:[]});var h;return e.props.pickerMode&&(h=(0,p.v8S)(e.props))&&e.syncSelectedFromPicker(h),e}return v.prototype.componentDidMount=function(){var t=this.props,e=t.store,n=t.autoGenerateFilter,r=t.perPageField,a=t.columns;this.props.perPage&&!e.query[r||"perPage"]&&e.changePage(e.page,this.props.perPage),(!this.props.filter&&!n||e.filterTogglable&&!e.filterVisible)&&this.handleFilterInit({}),this.parentContainer=this.getClosestParentContainer()},v.prototype.componentDidUpdate=function(t){var e,n=this.props,r=t.store;(0,p.aGv)(["toolbar","headerToolbar","footerToolbar","bulkActions"],t,n)&&(this.renderHeaderToolbar=this.renderHeaderToolbar.bind(this),this.renderFooterToolbar=this.renderFooterToolbar.bind(this));var a;this.props.pickerMode&&!L()(a=(0,p.v8S)(this.props),(0,p.v8S)(t))&&!L()(a,r.selectedItems.concat())&&this.syncSelectedFromPicker(a),!!this.props.filterTogglable!=!!t.filterTogglable&&r.setFilterTogglable(!!n.filterTogglable,n.filterDefaultVisible);var i=!1;if(t.syncLocation&&t.location&&t.location.search!==n.location.search&&(r.updateQuery((0,p.mB4)(n.location,this.getParseQueryOptions(n)),void 0,n.pageField,n.perPageField),i=!!(n.api&&(0,p.RjM)(r.query,this.lastQuery,!1))),!i){if(t.api&&n.api&&(0,p.rMT)(t.api,n.api,r.fetchCtxOf(t.data,{pageField:t.pageField,perPageField:t.perPageField}),r.fetchCtxOf(n.data,{pageField:n.pageField,perPageField:n.perPageField})))i=!0;else if(!n.api&&(0,p.SSQ)(n.source)&&n.data!==t.data){var l=(0,p.OgC)(n.source,n.data,"| raw");(!this.lastData||this.lastData!==l)&&(r.initFromScope(n.data,n.source,{columns:(e=r.columns)!==null&&e!==void 0?e:n.columns,totalField:n.totalField}),this.props.pickerMode&&(a=(0,p.v8S)(this.props))&&this.syncSelectedFromPicker(a),this.lastData=l)}}i&&this.search()},v.prototype.componentWillUnmount=function(){var t,e;this.mounted=!1,clearTimeout(this.timer),(e=(t=this.filterOnEvent.cache).clear)===null||e===void 0||e.call(t)},v.prototype.getParseQueryOptions=function(t){var e,n=t.parsePrimitiveQuery,r={parsePrimitive:!!((0,p.Kn2)(n)?n!=null&&n.enable:n),primitiveTypes:(e=n==null?void 0:n.types)!==null&&e!==void 0?e:["boolean"]};return r},v.prototype.getClosestParentContainer=function(){var t=(0,ie.findDOMNode)(this),e=t==null?void 0:t.closest("[role=dialog]");return e},v.prototype.controlRef=function(t){for(;t&&t.getWrappedInstance;)t=t.getWrappedInstance();this.control=t},v.prototype.handleAction=function(t,e,n,r,a){var i=this;r===void 0&&(r=!1);var l=this.props,o=l.onAction,d=l.store,u=l.messages,h=l.pickerMode,s=l.env,P=l.pageField,b=l.stopAutoRefreshWhenModalIsOpen;if(!d.loading)if(e.actionType==="dialog"){d.setCurrentAction(e,this.props.resolveDefinitions);var g=n.index,f=d.items.length;return b&&clearTimeout(this.timer),new Promise(function(_){d.openDialog(n,{hasNext:g<f-1,nextIndex:g+1,hasPrev:g>0,prevIndex:g-1,index:g},function(O,F){var T;(T=e.callback)===null||T===void 0||T.call(e,O,F),_({confirmed:O,value:F})},a||i.context)})}else if(e.actionType==="ajax"){d.setCurrentAction(e,this.props.resolveDefinitions);var y=n,m=e.redirect&&(0,p.hXT)(e.redirect,y);return m&&e.blank&&s.jumpTo(m,e,y),(0,p.X1t)(e.api,y)?d.saveRemote(e.api,y,{successMessage:e.messages&&e.messages.success||u&&u.saveSuccess,errorMessage:e.messages&&e.messages.failed||u&&u.saveFailed}).then(function(_){return(0,c.mG)(i,void 0,void 0,function(){var O,F;return(0,c.Jh)(this,function(T){switch(T.label){case 0:return O=(0,p.nW9)(n,_),e.feedback&&(0,p.pn4)(e.feedback,O)?[4,this.openFeedback(e.feedback,O)]:[3,2];case 1:T.sent(),b&&clearTimeout(this.timer),T.label=2;case 2:return F=e.redirect&&(0,p.hXT)(e.redirect,O),F&&!e.blank&&s.jumpTo(F,e,O),e.reload?this.reloadTarget((0,p.u22)(e.reload,O),O):F||this.search(void 0,void 0,!0,!0),e.close&&this.closeTarget(e.close),[2]}})})}).catch(function(_){if(r||e.countDown)throw _}):void 0}else if(e.actionType==="reload"&&!e.target)this.reload();else{if(h&&(e.actionType==="confirm"||e.actionType==="submit"))return d.setCurrentAction(e,this.props.resolveDefinitions),Promise.resolve({items:d.selectedItems.concat()});if(e.onClick){d.setCurrentAction(e,this.props.resolveDefinitions);var C=e.onClick;typeof C=="string"&&(C=(0,p.PqP)(C,"event","props","data")),C&&C(t,this.props,n)}else o(t,e,n,r,a||this.context)}},v.prototype.handleBulkAction=function(t,e,n,r){var a=this,i,l=this.props,o=l.store,d=l.primaryField,u=l.onAction,h=l.messages,s=l.pageField,P=l.stopAutoRefreshWhenModalIsOpen,b=l.env;if(!(!t.length&&r.requireSelected!==!1)){var g=t.map(function(C){return C.hasOwnProperty(d)?C[d]:null}).filter(function(C){return C}).join(","),f=(0,p._bA)([o.mergedData,{event:n},(0,c.pi)((0,c.pi)((0,c.pi)({},t[0]),o.eventContext),{currentPageData:(((i=o.mergedData)===null||i===void 0?void 0:i.items)||[]).concat(),rows:t,items:t,ids:g})]),y=function(){if(r.actionType==="dialog")return a.handleAction(n,(0,c.pi)((0,c.pi)({},r),{__from:"bulkAction"}),f);r.actionType==="ajax"?(0,p.X1t)(r.api,f)&&o.saveRemote(r.api,f,{successMessage:r.messages&&r.messages.success||h&&h.saveSuccess,errorMessage:r.messages&&r.messages.failed||h&&h.saveFailed}).then(function(C){return(0,c.mG)(a,void 0,void 0,function(){var _,O,F;return(0,c.Jh)(this,function(T){switch(T.label){case 0:return _=(0,p.nW9)(f,C),r.feedback&&(0,p.pn4)(r.feedback,_)?[4,this.openFeedback(r.feedback,_)]:[3,2];case 1:T.sent(),P&&clearTimeout(this.timer),T.label=2;case 2:return r.reload?this.reloadTarget((0,p.u22)(r.reload,_),_):this.search((F={},F[s||"page"]=1,F),void 0,!0,!0),r.close&&this.closeTarget(r.close),O=r.redirect&&(0,p.hXT)(r.redirect,_),O&&b.jumpTo(O,r,_),[2]}})})}).catch(function(){return null}):u&&u(n,r,f,!1,a.context)},m="";!r.ignoreConfirm&&r.confirmText&&b.confirm&&(m=(0,p.hXT)(r.confirmText,f))?b.confirm(m,(0,p.hXT)(r.confirmTitle,f)||void 0).then(function(C){return C&&y()}):y()}},v.prototype.handleItemAction=function(t,e){this.doAction(t,e)},v.prototype.handleFilterInit=function(t){var e,n=this.props,r=n.defaultParams,a=n.columns,i=n.matchFunc,l=n.store,o=n.orderBy,d=n.orderDir,u=n.totalField,h=n.dispatchEvent,s=(0,c.pi)({},r);o&&(s.orderBy=o,s.orderDir=d||"asc"),this.handleFilterSubmit((0,c.pi)((0,c.pi)((0,c.pi)({},s),t),l.query),!1,!0,this.props.initFetch!==!1,!0),l.setPristineQuery();var P=this.props,b=P.pickerMode,g=P.options;if(b){l.initFromScope({items:g||[]},"${items}",{columns:(e=l.columns)!==null&&e!==void 0?e:a,matchFunc:i,totalField:u});var f=void 0;(f=(0,p.v8S)(this.props))&&this.syncSelectedFromPicker(f)}},v.prototype.handleFilterReset=function(t,e){var n=this.props,r=n.store,a=n.syncLocation,i=n.env,l=n.pageField,o=n.perPageField,d={};Object.keys(t).forEach(function(u){return d[u]=""}),r.updateQuery((0,c.pi)((0,c.pi)({},d),r.pristineQuery),a&&i&&i.updateLocation?function(u){return i.updateLocation(u)}:void 0,l,o,!0),this.lastQuery=r.query,!(e!=null&&e.actionType&&["reset-and-submit","clear-and-submit","submit"].includes(e.actionType))&&this.search()},v.prototype.handleFilterSubmit=function(t,e,n,r,a){var i,l,o;e===void 0&&(e=!0),n===void 0&&(n=!1),r===void 0&&(r=!0),a===void 0&&(a=!1);var d=this.props,u=d.store,h=d.syncLocation,s=d.env,P=d.pageField,b=d.perPageField,g=d.loadDataOnceFetchOnFilter,f=d.parsePrimitiveQuery,y=this.getParseQueryOptions(this.props);t=(0,c.pi)((0,c.pi)({},t),V()((o=(l=t==null?void 0:t.__super)===null||l===void 0?void 0:l.diff)!==null&&o!==void 0?o:{},function(m){return m===void 0})),t=h?(0,p.J1H)((0,p.mUA)(t,void 0,!0)):t,f&&(t=(0,p.pa5)(t,y)),u.updateQuery((0,c.pi)((0,c.pi)({},t),(i={},i[P||"page"]=e?1:u.page,i)),h&&s&&s.updateLocation?function(m){return s.updateLocation(m,n)}:void 0,P,b),this.lastQuery=u.query,r&&this.search(void 0,void 0,void 0,g!==!1,a)},v.prototype.handleBulkGo=function(t,e,n){var r=this,a=this.props.store.selectedAction,i=this.props.env,l="";return a.confirmText&&(l=(0,p.hXT)(a.confirmText,this.props.store.mergedData))?i.confirm(l).then(function(o){return o&&r.handleBulkAction(t,e,n,a)}):this.handleBulkAction(t,e,n,a)},v.prototype.handleDialogConfirm=function(t,e,n,r){var a,i,l,o,d=this.props,u=d.store,h=d.pageField,s=d.stopAutoRefreshWhenModalIsOpen,P=d.interval,b=d.silentPolling,g=d.env;u.closeDialog(!0,t);var f=u.action;if(s&&P&&(this.timer=setTimeout(b?this.silentSearch:this.search,Math.max(P,1e3))),e.actionType==="next"&&typeof n.nextIndex=="number"&&u.data.items[n.nextIndex])return this.handleAction(void 0,(0,c.pi)({},f),(0,p.nW9)((0,p.nW9)(u.data,{index:n.nextIndex}),u.data.items[n.nextIndex]));if(e.actionType==="prev"&&typeof n.prevIndex=="number"&&u.data.items[n.prevIndex])return this.handleAction(void 0,(0,c.pi)({},f),(0,p.nW9)((0,p.nW9)(u.data,{index:n.prevIndex}),u.data.items[n.prevIndex]));if(t.length){var y=t[0];n=(0,p.nW9)(n,y);var m=r[0];if(m&&m.props.type==="form")if(y&&y.__saved){var C=(i=e.reload)!==null&&i!==void 0?i:f.reload;C||this.search(f.__from?(a={},a[h||"page"]=1,a):void 0,void 0,!0,!0)}else y&&(y.hasOwnProperty("items")&&y.items||y.hasOwnProperty("ids"))&&this.control.bulkUpdate&&this.control.bulkUpdate(y,y.items)}var _=(l=e.reload)!==null&&l!==void 0?l:f.reload;_&&this.reloadTarget((0,p.u22)(_,n),n);var O=(o=e.redirect)!==null&&o!==void 0?o:f.redirect;O=O&&(0,p.hXT)(O,n),O&&g.jumpTo(O,f,n)},v.prototype.handleDialogClose=function(t){t===void 0&&(t=!1);var e=this.props,n=e.store,r=e.stopAutoRefreshWhenModalIsOpen,a=e.silentPolling,i=e.interval;n.closeDialog(t),r&&i&&(this.timer=setTimeout(a?this.silentSearch:this.search,Math.max(i,1e3)))},v.prototype.openFeedback=function(t,e){var n=this;return new Promise(function(r){var a=n.props.store;a.setCurrentAction({type:"button",actionType:"dialog",dialog:t},n.props.resolveDefinitions),a.openDialog(e,void 0,function(i){r(i)},n.context)})},v.prototype.search=function(t,e,n,r,a){var i,l,o,d,u;return r===void 0&&(r=!1),a===void 0&&(a=!1),(0,c.mG)(this,void 0,void 0,function(){var h,s,P,b,g,f,y,m,C,_,O,F,T,D,R,H,ae,X,j,U,K,G,$,S,Z,Y,q,ee,B,B,oe,te;return(0,c.Jh)(this,function(k){switch(k.label){case 0:return h=this.props,s=h.store,P=h.api,b=h.messages,g=h.pageField,f=h.perPageField,y=h.totalField,m=h.interval,C=h.stopAutoRefreshWhen,_=h.stopAutoRefreshWhenModalIsOpen,O=h.silentPolling,F=h.syncLocation,T=h.syncResponse2Query,D=h.pickerMode,R=h.env,H=h.loadDataOnce,ae=h.loadDataOnceFetchOnFilter,X=h.source,j=h.columns,U=h.dispatchEvent,n&&!D&&s.resetSelection(),K="",t&&typeof t.loadDataMode=="string"&&(K="load-more",delete t.loadDataMode),clearTimeout(this.timer),t&&s.updateQuery(t,!K&&F&&R&&R.updateLocation?R.updateLocation:void 0,g,f),this.lastQuery=s.query,G=(0,p.nW9)(s.data,s.query),$=!((i=this.props)===null||i===void 0)&&i.matchFunc&&typeof this.props.matchFunc=="string"?(0,p.PqP)(this.props.matchFunc,"items","itemsRaw","options"):void 0,(0,p.X1t)(P,G)?[4,s.fetchInitData(P,G,{successMessage:b&&b.fetchSuccess,errorMessage:b&&b.fetchFailed,autoAppend:!0,forceReload:r,loadDataOnce:H,source:X,silent:e,pageField:g,perPageField:f,totalField:y,loadDataMode:K,syncResponse2Query:T,columns:(l=s.columns)!==null&&l!==void 0?l:j,matchFunc:$,filterOnAllColumns:ae===!1,minLoadingTime:t==null?void 0:t.minLoadingTime,dataAppendTo:t==null?void 0:t.dataAppendTo})]:[3,8];case 1:return S=k.sent(),(0,be.fh)(s)?(Z=s.page,Y=s.lastPage,q=s.msg,ee=s.error,a?[4,U==null?void 0:U("fetchInited",(0,p.nW9)(this.props.data,{responseData:S!=null&&S.ok?(o=s.data)!==null&&o!==void 0?o:{}:S,responseStatus:(S==null?void 0:S.status)===void 0?ee?1:0:S==null?void 0:S.status,responseMsg:q}))]:[3,3]):[2,S];case 2:return B=k.sent(),B!=null&&B.prevented?[2,s.data]:[3,5];case 3:return[4,U==null?void 0:U("research",(0,p.nW9)(this.props.data,{responseData:S!=null&&S.ok?(d=s.data)!==null&&d!==void 0?d:{}:S,responseStatus:(S==null?void 0:S.status)===void 0?ee?1:0:S==null?void 0:S.status,responseMsg:q}))];case 4:if(B=k.sent(),B!=null&&B.prevented)return[2,s.data];k.label=5;case 5:return!H&&!s.data.items.length&&!m&&Z>1&&Y<Z?[4,this.search((0,c.pi)((0,c.pi)({},s.query),(te={},te[g||"page"]=Y,te)),!1,void 0)]:[3,7];case 6:k.sent(),k.label=7;case 7:return S!=null&&S.ok&&m&&this.mounted&&(!C||!(_&&s.hasModalOpened||(0,p.fz_)(C,(0,p.nW9)(s.data,s.query))))&&(this.timer=setTimeout(O?this.silentSearch.bind(this,void 0,void 0,!0):this.search.bind(this,void 0,void 0,void 0,!0),Math.max(m,1e3))),[3,9];case 8:X&&s.initFromScope(G,X,{columns:(u=s.columns)!==null&&u!==void 0?u:j,matchFunc:$,totalField:y}),k.label=9;case 9:return this.props.pickerMode&&this.props.onSelect&&(oe=(0,p.v8S)(this.props))&&this.syncSelectedFromPicker(oe),[2,s.data]}})})},v.prototype.silentSearch=function(t,e,n){return n===void 0&&(n=!1),this.search(t,!0,e,n)},v.prototype.handleChangePage=function(t,e,n){var r;return(0,c.mG)(this,void 0,void 0,function(){var a,i,l,o,d,u,h,s,P,b,g,f,y,m,C;return(0,c.Jh)(this,function(_){switch(_.label){case 0:return a=this.props,i=a.store,l=a.syncLocation,o=a.env,d=a.pageField,u=a.perPageField,h=a.pageDirectionField,s=a.autoJumpToTopOnPagerChange,P=a.translate,b=a.api,g=a.loadDataOnce,b&&!g&&(!((r=this.control)===null||r===void 0)&&r.hasModifiedItems())?[4,(0,W.iGu)(P("CRUD.confirmLeaveUnSavedPage"))]:[3,2];case 1:if(f=_.sent(),!f)return[2];_.label=2;case 2:return y=(C={},C[d||"page"]=t,C),n&&(y[h||"pageDir"]=n),e&&(y[u||"perPage"]=e),i.updateQuery(y,l&&(o!=null&&o.updateLocation)?o.updateLocation:void 0,d,u),this.search(void 0,void 0,void 0),s&&this.control&&(this.control.scrollToTop?this.control.scrollToTop():((0,ie.findDOMNode)(this.control).scrollIntoView(),m=window.scrollY,m&&window.scroll(0,m))),[2]}})})},v.prototype.syncSelectedFromPicker=function(t){var e=this.props,n=e.store,r=e.primaryField,a=e.strictMode,i=function(o,d){var u=o[r||"id"],h=d[r||"id"],s=a?u===h:u==h;return!!(o===d||u&&s)},l=t.map(function(o){var d;return se()(o)||(o=(d={},d[r||"id"]=o,d)),(0,p.hEs)(n.items,function(u){return i(u,o)})||o});this.props.store.setSelectedItems(l)},v.prototype.handleItemChange=function(t,e,n){var r=this.props.store,a="".concat(n).split(".").map(function(l){return parseInt(l,10)}),i=(0,p.o5f)(r.items,a,1,t);r.replaceItems(i)},v.prototype.handleSave=function(t,e,n,r,a,i){var l=this,o=this.props,d=o.store,u=o.quickSaveApi,h=o.quickSaveItemApi,s=o.primaryField,P=o.env,b=o.messages,g=o.reload,f=o.dispatchEvent;if(Array.isArray(t)){if(!(0,p.X1t)(u)){P&&P.alert("CRUD quickSaveApi is required");return}var y=(0,p.nW9)(d.data,{rows:t,rowsDiff:e,indexes:n,rowsOrigin:a});return t.length&&t[0].hasOwnProperty(s||"id")&&(y.ids=t.map(function(_){return _[s||"id"]}).join(",")),r&&(y.unModifiedItems=r),d.saveRemote(u,y,{successMessage:b&&b.saveFailed,errorMessage:b&&b.saveSuccess}).then(function(_){return(0,c.mG)(l,void 0,void 0,function(){var O,F,T;return(0,c.Jh)(this,function(D){switch(D.label){case 0:return _?[4,f==null?void 0:f("quickSaveSucc",(0,p.ktx)(y,{result:_}))]:[2];case 1:return O=D.sent(),O!=null&&O.prevented?[2]:(F=(T=i==null?void 0:i.reload)!==null&&T!==void 0?T:g,[2,F?this.reloadTarget((0,p.u22)(F,y),y):this.search(void 0,void 0,!0,!0)])}})})}).catch(function(_){return(0,c.mG)(l,void 0,void 0,function(){return(0,c.Jh)(this,function(O){switch(O.label){case 0:return[4,f==null?void 0:f("quickSaveFail",(0,p.nW9)(this.props.data,{error:_}))];case 1:return O.sent(),[2]}})})})}else{if(!(0,p.X1t)(h)){P&&P.alert("CRUD quickSaveItemApi is required!");return}var m=(0,p.nW9)(d.data,{item:t,modified:e,origin:a}),C=(0,p.nW9)(m,t);return d.saveRemote(h,C).then(function(_){return(0,c.mG)(l,void 0,void 0,function(){var O,F,T;return(0,c.Jh)(this,function(D){switch(D.label){case 0:return _?[4,f==null?void 0:f("quickSaveItemSucc",(0,p.ktx)(m,{result:_}))]:[2];case 1:return O=D.sent(),O!=null&&O.prevented?[2]:(F=(T=i==null?void 0:i.reload)!==null&&T!==void 0?T:g,[2,F?this.reloadTarget((0,p.u22)(F,m),m):this.search(void 0,void 0,!0,!0)])}})})}).catch(function(_){return(0,c.mG)(l,void 0,void 0,function(){return(0,c.Jh)(this,function(O){switch(O.label){case 0:return i!=null&&i.resetOnFailed&&this.control.reset(),[4,f==null?void 0:f("quickSaveItemFail",(0,p.nW9)(this.props.data,{error:_}))];case 1:return O.sent(),[2]}})})})}},v.prototype.handleSaveOrder=function(t,e){var n=this,r=this.props,a=r.store,i=r.saveOrderApi,l=r.orderField,o=r.primaryField,d=r.env,u=r.reload,h=r.dispatchEvent;if(!i){d&&d.alert("CRUD saveOrderApi is required!");return}var s=(0,p.nW9)(a.data),P,b,g=[],f=o&&e[0]&&e[0].hasOwnProperty(o);if(f||(s.idMap={}),s.insertAfter={},e.forEach(function(F){if(~t.indexOf(F))if(P){var T=f?P[o]:e.indexOf(P);s.insertAfter[T]=s.insertAfter[T]||[],f||(s.idMap[T]=P),s.insertAfter[T].push(f?F[o]:F)}else g.push(F);else P=F,b=b||F}),b&&g.length){var y=f?b[o]:e.indexOf(b);f||(s.idMap[y]=b),s.insertBefore={},s.insertBefore[y]=g.map(function(F){return f?F[o]:F})}else if(g.length){var m=g[0],C=f?m[o]:e.indexOf(m);f||(s.idMap[C]=m),s.insertAfter[C]=g.slice(1).map(function(F){return f?F[o]:F})}if(l){var _=(a.page-1)*a.perPage||0;e=(0,p.GyU)(e,function(F,T,D){var R;return(0,p.ktx)(F,(R={},R[l]=(D===1?_:0)+T+1,R))})}if(s.rows=e.concat(),f){var O=function(F){return F.map(function(T){return"".concat(T[o]).concat(Array.isArray(T.children)&&T.children.length?"[".concat(O(T.children),"]"):"")}).join(",")};s.ids=O(e),l&&(s.order=(0,p.GyU)(e,function(F){return me()(F,[o,l,"children"])}))}return(0,p.X1t)(i,s)&&a.saveRemote(i,s).then(function(F){return(0,c.mG)(n,void 0,void 0,function(){var T;return(0,c.Jh)(this,function(D){switch(D.label){case 0:return F?[4,h==null?void 0:h("saveOrderSucc",(0,p.ktx)(s,{result:F}))]:[2];case 1:return T=D.sent(),T!=null&&T.prevented?[2]:(u&&this.reloadTarget((0,p.u22)(u,s),s),this.search(void 0,void 0,!0,!0),[2])}})})}).catch(function(F){return(0,c.mG)(n,void 0,void 0,function(){return(0,c.Jh)(this,function(T){switch(T.label){case 0:return[4,h==null?void 0:h("saveOrderFail",(0,p.nW9)(this.props.data,{error:F}))];case 1:return T.sent(),[2]}})})})},v.prototype.handleSelect=function(t,e){var n=this.props,r=n.store,a=n.keepItemSelectionOnPageChange,i=n.primaryField,l=n.multiple,o=n.pickerMode,d=n.strictMode,u=n.onSelect,h=t;if(a&&r.selectedItems.length){var s;r.items.length>t.length+e.length?s=function(g,f){return(g.__pristine||g)===(f.__pristine||f)}:s=function(g,f){var y=g[i||"id"],m=f[i||"id"],C=d?y===m:y==m;return g===f||y&&C};var P=t.concat();h=r.selectedItems.map(function(g){var f=P.findIndex(function(y){return s(y,g)});return~f?P.splice(f,1)[0]:(0,p.hEs)(e,function(y){return s(y,g)})?null:g}).filter(function(g){return g}).concat(P)}var b=r.items.filter(function(g){return!h.find(function(f){return(f.__pristine||f)===g})}).map(function(g){return e.find(function(f){return f.__pristine===g})||g});o&&l===!1&&h.length>1&&b.push.apply(b,h.splice(0,h.length-1)),r.setSelectedItems(h),r.setUnSelectedItems(b),u&&u(h,b)},v.prototype.handleChildPopOverOpen=function(t){this.props.interval&&t&&~["dialog","drawer"].indexOf(t.mode)&&(this.props.stopAutoRefreshWhenModalIsOpen&&clearTimeout(this.timer),this.props.store.setInnerModalOpened(!0))},v.prototype.handleChildPopOverClose=function(t){var e=this.props,n=e.stopAutoRefreshWhenModalIsOpen,r=e.silentPolling,a=e.interval;t&&~["dialog","drawer"].indexOf(t.mode)&&(this.props.store.setInnerModalOpened(!1),n&&a&&(this.timer=setTimeout(r?this.silentSearch:this.search,Math.max(a,1e3))))},v.prototype.handleQuery=function(t,e,n,r,a){var i,l=this.props,o=l.store,d=l.syncLocation,u=l.env,h=l.pageField,s=l.perPageField,P=l.loadDataOnceFetchOnFilter;return o.updateQuery(r?(0,c.pi)((i={},i[h||"page"]=1,i),t):t,d&&u&&u.updateLocation?u.updateLocation:void 0,h,s,n),this.search(void 0,void 0,a!=null?a:n,e!=null?e:P===!0)},v.prototype.reload=function(t,e,n,r,a,i){return e?this.receive(e,void 0,a,i==null?void 0:i.resetPage,!0):this.search(void 0,void 0,!0,!0)},v.prototype.receive=function(t,e,n,r,a){return this.handleQuery(t,!0,n,r,a)},v.prototype.reloadTarget=function(t,e){},v.prototype.closeTarget=function(t){},v.prototype.doAction=function(t,e,n,r){var a;return n===void 0&&(n=!1),(0,c.mG)(this,void 0,void 0,function(){var i,l,o;return(0,c.Jh)(this,function(d){switch(d.label){case 0:return i=this.props.store,t.actionType&&["submitQuickEdit","toggleExpanded","setExpanded","initDrag","cancelDrag","selectAll","clearAll"].includes(t.actionType)?[2,(a=this.control)===null||a===void 0?void 0:a.doAction(t,e,n,r)]:[3,1];case 1:return t.actionType!=="select"?[3,3]:[4,(0,p.tW8)(i.items,e,r==null?void 0:r.index,r==null?void 0:r.condition)];case 2:return l=d.sent(),o=i.items.filter(function(u){return!l.includes(u)}),[2,this.handleSelect(l,o)];case 3:return[2,this.handleAction(void 0,t,e,n)]}})})},v.prototype.dispatchEvent=function(t,e,n,r){if(t==="selectedChange"&&this.control===n){var a=this.props.store;e.selectedItems=a.selectedItems.concat(),e.unSelectedItems=a.unSelectedItems.concat()}return this.props.dispatchEvent(t,e,n,r)},v.prototype.unSelectItem=function(t,e){var n=this.props.store,r=n.selectedItems.concat(),a=n.unSelectedItems.concat(),i=r.indexOf(t);~i&&a.push.apply(a,r.splice(i,1)),n.setSelectedItems(r),n.setUnSelectedItems(a)},v.prototype.clearSelection=function(){var t=this.props,e=t.store,n=t.itemCheckableOn,r=(0,c.CR)(fe()(e.selectedItems,function(o){return!n||(0,p.fz_)(n,o)}),2),a=r[0],i=r[1],l=e.unSelectedItems.concat(a);e.setSelectedItems(i),e.setUnSelectedItems(l)},v.prototype.hasBulkActionsToolbar=function(){var t=this.props,e=t.headerToolbar,n=t.footerToolbar,r=t.enableBulkActions;if(r===!1)return!1;var a=function(i){return~["bulkActions","bulk-actions"].indexOf(i.type||i)};return Array.isArray(e)&&le()(e,a)||Array.isArray(n)&&le()(n,a)},v.prototype.hasBulkActions=function(){var t=this.props,e=t.bulkActions,n=t.itemActions,r=t.store;if(!e||!e.length)return!1;var a=[],i=r.mergedData;return e&&e.length&&(a=e.map(function(l){return(0,c.pi)((0,c.pi)({},l),(0,p.Lti)(l,i))}).filter(function(l){return!l.hidden&&l.visible!==!1})),a.length},v.prototype.renderBulkActions=function(t){var e=this,n,r=this.props,a=r.bulkActions,i=r.itemActions,l=r.store,o=r.render,d=r.classnames,u=r.primaryField,h=r.enableBulkActions;if(!a||!a.length||h===!1)return null;var s=l.selectedItems,P=l.unSelectedItems,b=[],g=[],f=(0,p.nW9)(l.mergedData,(0,c.pi)((0,c.pi)({currentPageData:(((n=l.mergedData)===null||n===void 0?void 0:n.items)||[]).concat()},l.eventContext),{rows:s.concat(),items:s.concat(),ids:s.map(function(m){return m.hasOwnProperty(u)?m[u]:null}).filter(function(m){return m}).join(",")}));a&&a.length&&(!i||!i.length||s.length>1)&&(b=a.map(function(m){return(0,c.pi)((0,c.pi)({},m),(0,p.Lti)(m,f))}).filter(function(m){return!m.hidden&&m.visible!==!1}));var y=(0,p.nW9)(l.data,s.length?s[0]:{});return i&&s.length<=1&&(g=i.map(function(m){return(0,c.pi)((0,c.pi)({},m),(0,p.Lti)(m,y))}).filter(function(m){return!m.hidden&&m.visible!==!1})),b.length||g.length?A().createElement("div",{className:d("Crud-actions")},b.map(function(m,C){return o("bulk-action/".concat(C),(0,c.pi)((0,c.pi)({},z()(m,["visibleOn","hiddenOn","disabledOn"])),{type:m.type||"button",ignoreConfirm:!0}),{key:"bulk-".concat(C),data:f,disabled:m.disabled||(m.requireSelected!==!1?!s.length:!1),onAction:e.handleBulkAction.bind(e,s.concat(),P.concat())})}),g.map(function(m,C){return o("bulk-action/".concat(C),(0,c.pi)((0,c.pi)({},z()(m,["visibleOn","hiddenOn","disabledOn"])),{type:"button"}),{key:"item-".concat(C),data:y,disabled:m.disabled||s.length!==1,onAction:e.handleItemAction.bind(e,m,y)})})):null},v.prototype.renderPagination=function(t){var e=this.props,n=e.store,r=e.render,a=e.classnames,i=e.alwaysShowPagination,l=e.perPageAvailable,o=e.testIdBuilder,d=n.page,u=n.lastPage;if(n.mode!=="simple"&&n.lastPage<2&&!i)return null;var h={};if(Array.isArray(l)&&(h.perPageAvailable=l),typeof t!="string"){Object.assign(h,t);var s=t.showPageInput;h.showPageInput=s===!0||u>9&&s==null,h.total=(0,p.OgC)(t.total,n.data)}else h.showPageInput=u>9;return A().createElement("div",{className:a("Crud-pager")},r("pagination",{type:"pagination",testIdBuilder:o==null?void 0:o.getChild("pagination")},(0,c.pi)((0,c.pi)({},h),{activePage:d,lastPage:u,hasNext:n.hasNext,mode:n.mode,perPage:n.perPage,popOverContainer:this.parentContainer,onPageChange:this.handleChangePage})))},v.prototype.renderStatistics=function(){var t=this.props,e=t.store,n=t.classnames,r=t.translate,a=t.alwaysShowPagination;return e.lastPage<=1&&!a?null:A().createElement("div",{className:n("Crud-statistics")},r("CRUD.stat",{page:e.page,lastPage:e.lastPage,total:e.total}))},v.prototype.renderSwitchPerPage=function(t){var e=this,n=this.props,r=n.mobileUI,a=n.store,i=n.perPageAvailable,l=n.classnames,o=n.classPrefix,d=n.translate,u=n.testIdBuilder,h=t.items;if(!h.length)return null;var s=r?(i||[5,10,20,50,100]).map(function(P){return{label:P+" \u6761/\u9875",value:P+""}}):(i||[5,10,20,50,100]).map(function(P){return{label:P,value:P+""}});return A().createElement("div",{className:l("Crud-pageSwitch")},r?null:A().createElement("span",null,d("CRUD.perPage")),A().createElement(W.PhF,{classPrefix:o,searchable:!1,placeholder:d("Select.placeholder"),options:s,value:a.perPage+"",onChange:function(P){return e.handleChangePage(1,P.value)},clearable:!1,popOverContainer:this.parentContainer,testIdBuilder:u==null?void 0:u.getChild("perPage")}))},v.prototype.renderLoadMore=function(){var t=this,e=this.props,n=e.store,r=e.classPrefix,a=e.classnames,i=e.translate,l=e.testIdBuilder,o=e.loadMoreProps,d=o===void 0?{}:o,u=n.page,h=n.lastPage,s=d.showIcon,P=s===void 0?!0:s,b=d.showText,g=b===void 0?!0:b,f=d.iconType,y=f===void 0?"loading-outline":f,m=d.contentText,C=m===void 0?{contentdown:"\u70B9\u51FB\u52A0\u8F7D\u66F4\u591A",contentrefresh:"\u52A0\u8F7D\u4E2D...",contentnomore:"\u6CA1\u6709\u66F4\u591A\u6570\u636E\u4E86"}:m,_=d.minLoadingTime,O=d.dataAppendTo,F=d.color,T=n.loading,D=u>=h;return A().createElement("div",{className:a("Crud-loadMore"),style:F?{"--Spinner-color":F,color:F}:void 0,onClick:function(){T||D||t.search({page:u+1,loadDataMode:"load-more",minLoadingTime:_,dataAppendTo:O})}},P&&A().createElement(W.$jN,{show:T,icon:y,size:"sm"}),g&&A().createElement("span",null,T?C.contentrefresh:D?C.contentnomore:C.contentdown))},v.prototype.renderFilterToggler=function(){var t,e,n,r=this.props,a=r.store,i=r.classnames,l=r.translate,o=r.filterTogglable;if(!a.filterTogglable)return null;var d=se()(o)?(0,c.pi)({},o):{};return a.filterVisible&&(d.icon=(t=d.activeIcon)!==null&&t!==void 0?t:d.icon,d.label=(e=d.activeLabel)!==null&&e!==void 0?e:d.label),A().createElement("button",{onClick:function(){return a.setFilterVisible(!a.filterVisible)},className:i("Button Button--size-default Button--default",{"is-active":a.filterVisible})},d.icon?A().createElement(W.JO$,{icon:d.icon,className:"icon m-r-xs"}):(d==null?void 0:d.icon)!==!1?A().createElement(W.JO$,{icon:"filter",className:"icon m-r-xs"}):null,(n=d==null?void 0:d.label)!==null&&n!==void 0?n:l("CRUD.filter"))},v.prototype.renderExportCSV=function(t){var e=this.props,n=e.store,r=e.classPrefix,a=e.translate,i=e.loadDataOnce,l=t.api,o=t.filename;return A().createElement(W.zxk,{classPrefix:r,onClick:function(){return n.exportAsCSV({loadDataOnce:i,api:l,filename:o,data:n.filterData})}},t.label||a("CRUD.exportCSV"))},v.prototype.renderToolbar=function(t,e,n,r){var a=this;if(e===void 0&&(e=0),n===void 0&&(n={}),!t)return null;var i=this.props,l=i.render,o=i.store,d=i.mobileUI,u=i.translate,h=i.testIdBuilder,s=t.type||t;if(s==="bulkActions"||s==="bulk-actions")return this.renderBulkActions(n);if(s==="pagination")return this.renderPagination(t);if(s==="statistics")return this.renderStatistics();if(s==="switch-per-page")return this.renderSwitchPerPage(n);if(s==="load-more")return this.renderLoadMore();if(s==="filter-toggler")return this.renderFilterToggler();if(s==="export-csv")return this.renderExportCSV(t);if(s==="reload"){var P={label:"",icon:"fa fa-sync",tooltip:u("reload"),tooltipPlacement:"top",type:"button"};return typeof t=="object"&&(P=(0,c.pi)((0,c.pi)({},P),z()(t,["type","align"]))),l("toolbar/".concat(e),P,{onAction:function(){a.reload()}})}else if(Array.isArray(t)){var b=t.filter(function(C){return(0,p.pn4)(C,o.toolbarData)}).map(function(C,_){return{dom:a.renderToolbar(C,_,n,r),toolbar:C}}).filter(function(C){return C.dom}),g=b.length,f=this.props.classnames;return g?A().createElement("div",(0,c.pi)({className:f("Crud-toolbar"),key:e},h==null?void 0:h.getChild("toolbar").getTestId()),b.map(function(C,_){var O=C.toolbar,F=C.dom,T=O.type||O,D=O.align||(T==="pagination"?"right":"left");return A().createElement("div",{key:O.id||_,className:f("Crud-toolbar-item",D?"Crud-toolbar-item--".concat(D):"",{"is-mobile":d})},F)})):null}var y=r?r(t,e):void 0;if(y!==void 0)return y;var m=n.$$editable;return l("toolbar/".concat(e),t,{data:o.toolbarData,page:o.page,lastPage:o.lastPage,perPage:o.perPage,total:o.total,onQuery:this.handleQuery,onAction:this.handleAction,onChangePage:this.handleChangePage,onBulkAction:this.handleBulkAction,$$editable:m})},v.prototype.renderHeaderToolbar=function(t,e){var n=this.props,r=n.toolbar,a=n.toolbarInline,i=n.headerToolbar;return r&&(Array.isArray(i)?i=a?i.concat(r):[i,r]:i?i=[i,r]:i=r),this.renderToolbar(i||[],0,t,e)},v.prototype.renderFooterToolbar=function(t,e){var n=this.props,r=n.toolbar,a=n.toolbarInline,i=n.footerToolbar;return r&&(Array.isArray(i)?i=a?i.concat(r):[i,r]:i?i=[i,r]:i=r),this.renderToolbar(i,0,t,e)},v.prototype.renderTag=function(t,e){var n=this.props,r=n.classnames,a=n.labelField,i=n.labelTpl,l=n.primaryField,o=n.valueField,d=n.translate,u=n.env,h=n.itemCheckableOn,s=h?(0,p.fz_)(h,t):!0;return A().createElement("div",{key:e,className:r("Crud-value",s?"":"is-disabled")},A().createElement("span",{className:r("Crud-valueIcon"),onClick:this.unSelectItem.bind(this,t,e)},"\xD7"),A().createElement("span",{className:r("Crud-valueLabel")},i?A().createElement(W.Vtq,{html:(0,p.hXT)(i,t),filterHtml:u.filterHtml}):(0,p.E04)(t,a||"label")||(0,p.E04)(t,o||l||"id")))},v.prototype.renderSelection=function(){var t=this,e=this.props,n=e.store,r=e.classPrefix,a=e.classnames,i=e.labelField,l=e.labelTpl,o=e.primaryField,d=e.valueField,u=e.translate,h=e.env,s=e.popOverContainer,P=e.multiple,b=e.maxTagCount,g=e.overflowTagPopover,f=e.keepItemSelectionOnPageChange;if(!n.selectedItems.length||!f||P===!1)return null;var y=n.selectedItems.length,m=n.selectedItems,C=P!==!1&&(0,p.wYV)(b,{start:0,end:y,left:"inclusive",right:"exclusive"});return C&&(m=(0,c.ev)((0,c.ev)([],(0,c.CR)(n.selectedItems.slice(0,b)),!1),[{label:"+ ".concat(y-b," ..."),value:"__overflow_tag__"}],!1)),A().createElement("div",{className:a("Crud-selection")},A().createElement("div",{className:a("Crud-selectionLabel")},u("CRUD.selected",{total:n.selectedItems.length})),m.map(function(_,O){return C&&O===b?A().createElement(W.pfc,{key:O,container:s,tooltip:(0,c.pi)((0,c.pi)({placement:"top",trigger:"hover",showArrow:!1,offset:[0,-10],tooltipClassName:a("Crud-selection-overflow",g==null?void 0:g.tooltipClassName),title:u("\u5DF2\u9009\u9879")},z()(g,["children","content","tooltipClassName"])),{children:function(){return A().createElement("div",{className:a("".concat(r,"Crud-selection-overflow-wrapper"))},n.selectedItems.slice(b,y).map(function(F,T){var D=T+b;return t.renderTag(F,D)}))}})},A().createElement("div",{key:O,className:a("Crud-value")},A().createElement("span",{className:a("Crud-valueLabel")},_.label))):t.renderTag(_,O)}),A().createElement("a",{onClick:this.clearSelection,className:a("Crud-selectionClear")},u("clear")))},v.prototype.renderFilter=function(){var t,e=this.props,n=e.store,r=e.render,a=e.classnames,i=e.filter,l=e.translate,o=e.testIdBuilder,d=e.filterCanAccessSuperData,u=d===void 0?!0:d;return!i||n.filterTogglable&&!n.filterVisible?null:r("filter",(0,c.pi)((0,c.pi)({title:l("CRUD.filter"),mode:"inline",submitText:l("search")},i),{type:"form",api:null,testIdBuilder:o==null?void 0:o.getChild("filter")}),{key:"filter",panelClassName:a("Crud-filter",i.panelClassName||"Panel--default"),data:n.filterData,onReset:this.handleFilterReset,onSubmit:this.handleFilterSubmit,onInit:this.handleFilterInit,formStore:void 0,canAccessSuperData:(t=i==null?void 0:i.canAccessSuperData)!==null&&t!==void 0?t:u})},v.prototype.filterItemIndex=function(t){var e,n=this.props.store,r="".concat(t).split(".").map(function(i){return parseInt(i,10)});if(!Array.isArray(n.data.items))return t;var a=(e=n.data.items)===null||e===void 0?void 0:e[r[0]];return a&&(r[0]=n.items.findIndex(function(i){return(i.__pristine||i)===(a.__pristine||a)})),r.join(".")},v.prototype.filterBodySchema=function(t){return t},v.prototype.renderBody=function(){var t,e=this.props,n=e.className,r=e.style,a=e.bodyClassName,i=e.filter,l=e.render,o=e.store,d=e.mode,u=e.syncLocation,h=e.children,s=e.bulkActions,P=e.pickerMode,b=e.multiple,g=e.strictMode,f=e.valueField,y=e.primaryField,m=e.value,C=e.hideQuickSaveBtn,_=e.itemActions,O=e.classnames,F=e.keepItemSelectionOnPageChange,T=e.maxKeepItemSelectionLength,D=e.maxItemSelectionLength,R=e.onAction,H=e.popOverContainer,ae=e.translate,X=e.onQuery,j=e.autoGenerateFilter,U=e.onSelect,K=e.autoFillHeight,G=e.onEvent,$=e.onSave,S=e.onSaveOrder,Z=e.onPopOverOpened,Y=e.onPopOverClosed,q=e.onSearchableFromReset,ee=e.onSearchableFromSubmit,B=e.onSearchableFromInit,oe=e.headerToolbarRender,te=e.footerToolbarRender,k=e.testIdBuilder,_e=e.id,ue=e.filterCanAccessSuperData,Ie=ue===void 0?!0:ue,pe=e.selectable,Ae=pe===void 0?!1:pe,he=(0,c._T)(e,["className","style","bodyClassName","filter","render","store","mode","syncLocation","children","bulkActions","pickerMode","multiple","strictMode","valueField","primaryField","value","hideQuickSaveBtn","itemActions","classnames","keepItemSelectionOnPageChange","maxKeepItemSelectionLength","maxItemSelectionLength","onAction","popOverContainer","translate","onQuery","autoGenerateFilter","onSelect","autoFillHeight","onEvent","onSave","onSaveOrder","onPopOverOpened","onPopOverClosed","onSearchableFromReset","onSearchableFromSubmit","onSearchableFromInit","headerToolbarRender","footerToolbarRender","testIdBuilder","id","filterCanAccessSuperData","selectable"]);return l("body",(0,c.pi)((0,c.pi)({},this.filterBodySchema(he)),{id:_e,onEvent:this.filterOnEvent(G),columns:(t=o.columns)!==null&&t!==void 0?t:he.columns,type:d||"table"}),{key:"body",className:O("Crud-body",a),ref:this.controlRef,autoGenerateFilter:!i&&j,filterCanAccessSuperData:Ie,autoFillHeight:K,selectable:!!(this.hasBulkActionsToolbar()&&this.hasBulkActions()||P||Ae),itemActions:_,multiple:b===void 0?!!(s&&s.length>0):b,selected:o.selectedItemsAsArray,strictMode:g,keepItemSelectionOnPageChange:F,maxKeepItemSelectionLength:T,maxItemSelectionLength:D,valueField:f||y,primaryField:y,hideQuickSaveBtn:C,items:o.data.items,fullItems:o.itemsAsArray,query:o.query,orderBy:o.query.orderBy,orderDir:o.query.orderDir,popOverContainer:H,onAction:this.handleAction,dispatchEvent:this.dispatchEvent,onItemChange:this.handleItemChange,onSave:this.handleSave,onSaveOrder:this.handleSaveOrder,onQuery:this.handleQuery,onSelect:this.handleSelect,onPopOverOpened:this.handleChildPopOverOpen,onPopOverClosed:this.handleChildPopOverClose,onSearchableFromReset:this.handleFilterReset,onSearchableFromSubmit:this.handleFilterSubmit,onSearchableFromInit:this.handleFilterInit,headerToolbarRender:this.renderHeaderToolbar,footerToolbarRender:this.renderFooterToolbar,data:o.mergedData,loading:o.loading,host:this,filterItemIndex:this.filterItemIndex,onDbClick:this.props.rowDbClick,testIdBuilder:k==null?void 0:k.getChild("body")})},v.prototype.render=function(){var t=this.props,e=t.className,n=t.style,r=t.render,a=t.store,i=t.classnames,l=t.translate,o=t.testIdBuilder,d=t.id,u=t.mobileUI;return A().createElement("div",(0,c.pi)({className:i("Crud",e,{"is-loading":a.loading,"is-mobile":u}),style:n,"data-id":d,"data-role":"container"},o==null?void 0:o.getChild("wrapper").getTestId()),this.renderFilter(),this.renderSelection(),this.renderBody(),r("dialog",(0,c.pi)((0,c.pi)({},a.action&&a.action.dialog),{type:"dialog"}),{key:"dialog",data:a.dialogData,onConfirm:this.handleDialogConfirm,onClose:this.handleDialogClose,show:a.dialogOpen}))},v.propsList=["bulkActions","itemActions","mode","orderField","syncLocation","toolbar","toolbarInline","messages","value","options","multiple","valueField","defaultParams","bodyClassName","perPageAvailable","pageField","perPageField","totalField","pageDirectionField","hideQuickSaveBtn","autoJumpToTopOnPagerChange","interval","silentPolling","stopAutoRefreshWhen","stopAutoRefreshWhenModalIsOpen","api","affixHeader","columnsTogglable","placeholder","tableClassName","headerClassName","footerClassName","headerToolbar","footerToolbar","filterTogglable","filterDefaultVisible","autoGenerateFilter","syncResponse2Query","keepItemSelectionOnPageChange","labelTpl","labelField","loadDataOnce","loadDataOnceFetchOnFilter","source","header","columns","size","onChange","onInit","onSaved","onSave","onQuery","formStore","autoFillHeight","maxTagCount","overflowTagPopover","parsePrimitiveQuery","matchFunc","loadMoreProps"],v.defaultProps={toolbarInline:!0,headerToolbar:["bulkActions"],footerToolbar:["statistics","pagination"],primaryField:"id",syncLocation:!0,pageField:"page",perPageField:"perPage",totalField:"total",pageDirectionField:"pageDir",hideQuickSaveBtn:!1,autoJumpToTopOnPagerChange:!0,silentPolling:!1,filterTogglable:!1,filterDefaultVisible:!0,loadDataOnce:!1,autoFillHeight:!1,parsePrimitiveQuery:!0,loadMoreProps:{showIcon:!0,showText:!0,iconType:"loading-outline",contentText:{contentdown:"\u70B9\u51FB\u52A0\u8F7D\u66F4\u591A",contentrefresh:"\u52A0\u8F7D\u4E2D...",contentnomore:"\u6CA1\u6709\u66F4\u591A\u6570\u636E\u4E86"}}},v}(A().Component),ce=function(M){(0,c.ZT)(v,M);function v(t,e){var n=M.call(this,t)||this,r=e;return r.registerComponent(n),n}return v.prototype.componentWillUnmount=function(){M.prototype.componentWillUnmount.call(this);var t=this.context;t.unRegisterComponent(this)},v.prototype.reload=function(t,e,n,r,a,i){var l,o=this.context;return i!=null&&i.index||i!=null&&i.condition?(l=this.control)===null||l===void 0?void 0:l.reload("",e,n,void 0,void 0,i):t?o.reload(e?"".concat(t,"?").concat((0,p.mUA)(e)):t,n):M.prototype.reload.call(this,t,e,n,r,a,i)},v.prototype.receive=function(t,e,n,r,a){return(0,c.mG)(this,void 0,void 0,function(){var i;return(0,c.Jh)(this,function(l){return i=this.context,e?[2,i.send(e,t)]:[2,M.prototype.receive.call(this,t,void 0,n,r,a)]})})},v.prototype.reloadTarget=function(t,e){var n=this.context;n.reload(t,e)},v.prototype.closeTarget=function(t){var e=this.context;e.close(t)},v.prototype.setData=function(t,e,n,r){var a,i,l;return(0,c.mG)(this,void 0,void 0,function(){var o,d,u;return(0,c.Jh)(this,function(h){return o=this.props.store,n!==void 0||r!==void 0?[2,(i=(a=this.control)===null||a===void 0?void 0:a.setData)===null||i===void 0?void 0:i.call(a,t,e,n,r)]:(d=(t==null?void 0:t.total)||(t==null?void 0:t.count),u=(l=t.rows)!==null&&l!==void 0?l:t.items,d!==void 0&&o.updateTotal(parseInt(d,10)),[2,o.updateData((0,c.pi)((0,c.pi)({},t),u?{items:u}:{}),void 0,e)])})})},v.prototype.getData=function(){var t=this.props,e=t.store,n=t.data;return e.getData(n)},v.contextType=p.ZHe,v}(de),Te=function(M){(0,c.ZT)(v,M);function v(){return M!==null&&M.apply(this,arguments)||this}return v=(0,c.gn)([(0,p.Thl)({type:"crud",storeType:p.qh2.name,isolateScope:!0})],v),v}(ce)},2226:function(x){var Q="Expected a function";function I(c){if(typeof c!="function")throw new TypeError(Q);return function(){var E=arguments;switch(E.length){case 0:return!c.call(this);case 1:return!c.call(this,E[0]);case 2:return!c.call(this,E[0],E[1]);case 3:return!c.call(this,E[0],E[1],E[2])}return!c.apply(this,E)}}x.exports=I},24465:function(x,Q,I){var c=I(5673),E=I(2226),A=I(12557);function N(L,w){return A(L,E(c(w)))}x.exports=N},86974:function(x,Q,I){var c=I(49884),E=c(function(A,N,L){A[L?0:1].push(N)},function(){return[[],[]]});x.exports=E},12557:function(x,Q,I){var c=I(75697),E=I(5673),A=I(32648),N=I(21699);function L(w,V){if(w==null)return{};var ne=c(N(w),function(J){return[J]});return V=E(V),A(w,ne,function(J,re){return V(J,re[0])})}x.exports=L}}]);
