"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[219],{40219:function(D,v,l){l.r(v),l.d(v,{Audio:function(){return f},AudioRenderer:function(){return T}});var e=l(15767),E=l(87363),s=l.n(E),N=l(42950),k=l.n(N),r=l(42977),d=l(94391),f=function(p){(0,e.ZT)(a,p);function a(){var n=p!==null&&p.apply(this,arguments)||this;return n.state={src:(0,r.v8S)(n.props,function(t){return t.src?(0,r.hXT)(t.src,t.data,"| raw"):void 0})||"",isReady:!1,muted:!1,playing:!1,played:0,seeking:!1,volume:.8,prevVolume:.8,loaded:0,playbackRate:1,showHandlePlaybackRate:!1,showHandleVolume:!1},n}return a.prototype.componentWillUnmount=function(){clearTimeout(this.progressTimeout),clearTimeout(this.durationTimeout)},a.prototype.componentDidMount=function(){var n=this.props.autoPlay,t=!!n;this.setState({playing:t},this.progress)},a.prototype.componentDidUpdate=function(n){var t=this,i=this.props;(0,r.GcO)(i,n,function(o){return t.setState({src:o,playing:!1},function(){t.audio.load(),t.progress()})},function(o){return o.src?(0,r.hXT)(o.src,o.data,"| raw"):void 0})},a.prototype.progress=function(){if(clearTimeout(this.progressTimeout),this.state.src&&this.audio){var n=this.audio.currentTime||0,t=this.audio.duration,i=n/t,o=this.state.playing;o=!!(i!=1&&o),this.setState({played:i,playing:o}),this.progressTimeout=setTimeout(this.progress,this.props.progressInterval/this.state.playbackRate)}},a.prototype.audioRef=function(n){this.audio=n},a.prototype.load=function(){this.setState({isReady:!0})},a.prototype.handlePlaybackRate=function(n){this.audio.playbackRate=n,this.setState({playbackRate:n,showHandlePlaybackRate:!1})},a.prototype.handleMute=function(){if(this.state.src){var n=this.state,t=n.muted,i=n.prevVolume,o=t?i:0;this.audio.muted=!t,this.setState({muted:!t,volume:o})}},a.prototype.handlePlaying=function(){if(this.state.src){var n=this.state.playing;n?this.audio.pause():this.audio.play(),this.setState({playing:!n})}},a.prototype.getCurrentTime=function(){if(!this.audio||!this.state.src||!this.state.isReady)return"0:00";var n=this.audio.duration,t=this.state.played;return this.formatTime(n*(t||0))},a.prototype.getDuration=function(){if(!this.audio||!this.state.src)return"0:00";if(!this.state.isReady)return this.onDurationCheck(),"0:00";var n=this.audio,t=n.duration,i=n.seekable;return t===1/0&&i.length>0?i.end(i.length-1):this.formatTime(t)},a.prototype.onDurationCheck=function(){clearTimeout(this.durationTimeout);var n=this.audio&&this.audio.duration;n||(this.durationTimeout=setTimeout(this.onDurationCheck,500))},a.prototype.onSeekChange=function(n){if(this.state.src){var t=n.target.value;this.setState({played:t})}},a.prototype.onSeekMouseDown=function(){this.setState({seeking:!0})},a.prototype.onSeekMouseUp=function(n){if(this.state.src&&this.state.seeking){var t=n.target.value,i=this.audio.duration;this.audio.currentTime=i*t;var o=this.props.loop,u=this.state.playing;u=t<1||o?u:!1,this.setState({playing:u,seeking:!1})}},a.prototype.setVolume=function(n){if(this.state.src){var t=n.target.value;this.audio.volume=t,this.setState({volume:t,prevVolume:t})}},a.prototype.formatTime=function(n){var t=new Date(n*1e3),i=t.getUTCHours(),o=isNaN(t.getUTCMinutes())?0:t.getUTCMinutes(),u=isNaN(t.getUTCSeconds())?"00":this.pad(t.getUTCSeconds());return i?"".concat(i,":").concat(this.pad(o),":").concat(u):"".concat(o,":").concat(u)},a.prototype.pad=function(n){return("0"+n).slice(-2)},a.prototype.toggleHandlePlaybackRate=function(){this.state.src&&this.setState({showHandlePlaybackRate:!this.state.showHandlePlaybackRate})},a.prototype.toggleHandleVolume=function(n){this.state.src&&this.setState({showHandleVolume:n})},a.prototype.renderRates=function(){var n=this,t=this.props,i=t.rates,o=t.classnames,u=this.state,m=u.showHandlePlaybackRate,g=u.playbackRate;return i&&i.length?m?s().createElement("div",{className:o("Audio-rateControl")},i.map(function(c,y){return s().createElement("div",{key:y,className:o("Audio-rateControlItem"),onClick:function(){return n.handlePlaybackRate(c)}},"x",c.toFixed(1))})):s().createElement("div",{className:o("Audio-rates"),onClick:this.toggleHandlePlaybackRate},"x",g.toFixed(1)):null},a.prototype.renderPlay=function(){var n=this.props.classnames,t=this.state.playing;return s().createElement("div",{className:n("Audio-play"),onClick:this.handlePlaying},t?s().createElement(d.JO$,{icon:"pause",className:"icon"}):s().createElement(d.JO$,{icon:"play",className:"icon"}))},a.prototype.renderTime=function(){var n=this.props.classnames;return s().createElement("div",{className:n("Audio-times")},this.getCurrentTime()," / ",this.getDuration())},a.prototype.renderProcess=function(){var n=this.props.classnames,t=this.state.played;return s().createElement("div",{className:n("Audio-process")},s().createElement("input",{type:"range",min:0,max:1,step:"any",value:t||0,onMouseDown:this.onSeekMouseDown,onChange:this.onSeekChange,onMouseUp:this.onSeekMouseUp}))},a.prototype.renderVolume=function(){var n=this,t=this.props.classnames,i=this.state,o=i.volume,u=i.showHandleVolume;return u?s().createElement("div",{className:t("Audio-volumeControl"),onMouseLeave:function(){return n.toggleHandleVolume(!1)}},s().createElement("div",{className:t("Audio-volumeControlIcon"),onClick:this.handleMute},o>0?s().createElement(d.JO$,{icon:"volume",className:"icon"}):s().createElement(d.JO$,{icon:"mute",className:"icon"})),s().createElement("input",{type:"range",min:0,max:1,step:"any",value:o,onChange:this.setVolume})):s().createElement("div",{className:t("Audio-volume"),onMouseEnter:function(){return n.toggleHandleVolume(!0)}},o>0?s().createElement(d.JO$,{icon:"volume",className:"icon"}):s().createElement(d.JO$,{icon:"mute",className:"icon"}))},a.prototype.render=function(){var n=this,t=this.props,i=t.className,o=t.style,u=t.inline,m=t.autoPlay,g=t.loop,c=t.controls,y=t.classnames,w=this.state,P=w.muted,R=w.src;return s().createElement("div",{className:y("Audio",i,u?"Audio--inline":""),style:o},s().createElement("audio",{className:y("Audio-original"),ref:this.audioRef,onCanPlay:this.load,autoPlay:m,controls:!0,muted:P,loop:g},s().createElement("source",{src:R})),s().createElement("div",{className:y("Audio-controls")},c&&c.map(function(h,C){h="render"+k()(h);var M=h;return s().createElement(s().Fragment,{key:C},n[M]())})))},a.defaultProps={inline:!0,autoPlay:!1,playbackRate:1,loop:!1,rates:[],progressInterval:1e3,controls:["rates","play","time","process","volume"]},(0,e.gn)([r.NjZ,(0,e.w6)("design:type",Function),(0,e.w6)("design:paramtypes",[]),(0,e.w6)("design:returntype",void 0)],a.prototype,"progress",null),(0,e.gn)([r.NjZ,(0,e.w6)("design:type",Function),(0,e.w6)("design:paramtypes",[HTMLMediaElement]),(0,e.w6)("design:returntype",void 0)],a.prototype,"audioRef",null),(0,e.gn)([r.NjZ,(0,e.w6)("design:type",Function),(0,e.w6)("design:paramtypes",[]),(0,e.w6)("design:returntype",void 0)],a.prototype,"load",null),(0,e.gn)([r.NjZ,(0,e.w6)("design:type",Function),(0,e.w6)("design:paramtypes",[Number]),(0,e.w6)("design:returntype",void 0)],a.prototype,"handlePlaybackRate",null),(0,e.gn)([r.NjZ,(0,e.w6)("design:type",Function),(0,e.w6)("design:paramtypes",[]),(0,e.w6)("design:returntype",void 0)],a.prototype,"handleMute",null),(0,e.gn)([r.NjZ,(0,e.w6)("design:type",Function),(0,e.w6)("design:paramtypes",[]),(0,e.w6)("design:returntype",void 0)],a.prototype,"handlePlaying",null),(0,e.gn)([r.NjZ,(0,e.w6)("design:type",Function),(0,e.w6)("design:paramtypes",[]),(0,e.w6)("design:returntype",void 0)],a.prototype,"getCurrentTime",null),(0,e.gn)([r.NjZ,(0,e.w6)("design:type",Function),(0,e.w6)("design:paramtypes",[]),(0,e.w6)("design:returntype",void 0)],a.prototype,"getDuration",null),(0,e.gn)([r.NjZ,(0,e.w6)("design:type",Function),(0,e.w6)("design:paramtypes",[]),(0,e.w6)("design:returntype",void 0)],a.prototype,"onDurationCheck",null),(0,e.gn)([r.NjZ,(0,e.w6)("design:type",Function),(0,e.w6)("design:paramtypes",[Object]),(0,e.w6)("design:returntype",void 0)],a.prototype,"onSeekChange",null),(0,e.gn)([r.NjZ,(0,e.w6)("design:type",Function),(0,e.w6)("design:paramtypes",[]),(0,e.w6)("design:returntype",void 0)],a.prototype,"onSeekMouseDown",null),(0,e.gn)([r.NjZ,(0,e.w6)("design:type",Function),(0,e.w6)("design:paramtypes",[Object]),(0,e.w6)("design:returntype",void 0)],a.prototype,"onSeekMouseUp",null),(0,e.gn)([r.NjZ,(0,e.w6)("design:type",Function),(0,e.w6)("design:paramtypes",[Object]),(0,e.w6)("design:returntype",void 0)],a.prototype,"setVolume",null),(0,e.gn)([r.NjZ,(0,e.w6)("design:type",Function),(0,e.w6)("design:paramtypes",[Number]),(0,e.w6)("design:returntype",void 0)],a.prototype,"formatTime",null),(0,e.gn)([r.NjZ,(0,e.w6)("design:type",Function),(0,e.w6)("design:paramtypes",[Number]),(0,e.w6)("design:returntype",void 0)],a.prototype,"pad",null),(0,e.gn)([r.NjZ,(0,e.w6)("design:type",Function),(0,e.w6)("design:paramtypes",[]),(0,e.w6)("design:returntype",void 0)],a.prototype,"toggleHandlePlaybackRate",null),(0,e.gn)([r.NjZ,(0,e.w6)("design:type",Function),(0,e.w6)("design:paramtypes",[Boolean]),(0,e.w6)("design:returntype",void 0)],a.prototype,"toggleHandleVolume",null),a}(s().Component),T=function(p){(0,e.ZT)(a,p);function a(){return p!==null&&p.apply(this,arguments)||this}return a=(0,e.gn)([(0,r.Thl)({type:"audio"})],a),a}(f)}}]);
