"use strict";(self.webpackChunkxuanwu_logic_web_design=self.webpackChunkxuanwu_logic_web_design||[]).push([[9435],{23542:function(de,A,e){e.d(A,{Z:function(){return ee}});var R=e(57213),h=e.n(R),m=e(788),O=e(63466),Q=e(21140),U=e(52510),Z=e(54306),d=e.n(Z),S=e(97944),P=e(83195),p=e(75904),B=e(47503),L=e(87363),y=e.n(L),a=e(84191),f=e(49425),c=e(94744),l=e(33130),K=null,r=function(x){var n=(0,S.Ik)(),J=(0,L.useContext)(P.r),u=J.logic;(0,L.useEffect)(function(){if(u){var I,g,N,T,G=c.y.getJsonByParams((I=u.variables)!==null&&I!==void 0?I:[]),ue=(0,a.k)("_var",G),ve=c.y.getJsonByParams((g=u.params)!==null&&g!==void 0?g:[]),te=(0,a.k)("_par",ve),Y=c.y.getJsonByParams((N=u.returns)!==null&&N!==void 0?N:[]),b=(0,a.k)("_ret",Y),W=c.y.getJsonByParams((T=u.envs)!==null&&T!==void 0?T:[]),ne=(0,a.k)("_env",W);n==null||n.languages.typescript.javascriptDefaults.addExtraLib(ue,"var.ts"),n==null||n.languages.typescript.javascriptDefaults.addExtraLib(te,"input.ts"),n==null||n.languages.typescript.javascriptDefaults.addExtraLib(b,"return.ts"),n==null||n.languages.typescript.javascriptDefaults.addExtraLib(ne,"env.ts"),n==null||n.languages.typescript.javascriptDefaults.addExtraLib("let _lastRet:{}","lastRet.ts")}return function(){var D;console.log("effect dispose"),n==null||(D=n.current)===null||D===void 0||D.dispose()}},[u==null?void 0:u.params,u==null?void 0:u.variables,u==null?void 0:u.returns,u==null?void 0:u.envs]);var z=(0,L.useState)(!1),o=d()(z,2),$=o[0],H=o[1];return(0,l.jsx)("div",{style:{width:"100%"},children:$?(0,l.jsx)(B.Z,{title:"js\u7F16\u8F91\u5668",centered:!0,width:1200,bodyStyle:{height:"80vh"},open:$,footer:null,onCancel:function(){return H(!1)},children:(0,l.jsx)(S.ML,h()(h()({theme:"vs-dark",defaultValue:x.value,defaultLanguage:x.language,options:{minimap:{enabled:!1}}},x),{},{height:"100%"}))}):(0,l.jsxs)("div",{children:[(0,l.jsx)(S.ML,h()({className:"editorByLoader",theme:"vs-dark",defaultValue:x.value,defaultLanguage:x.language,onMount:function(g){var N;(N=g.getAction("editor.action.formatDocument"))===null||N===void 0||N.run(),g.setValue(g.getValue())},options:{minimap:{enabled:!1}},height:500},x)),(0,l.jsx)(p.ZP,{size:"small",type:"text",icon:(0,l.jsx)(f.Z,{}),style:{position:"absolute",top:0,right:0,margin:"10px",color:"whitesmoke"},onClick:function(){return H(!0)}})]})})},V=y().memo(r),le=null,X=function(x){return(0,l.jsx)(V,h()(h()({},x),{},{language:"json"}))},k=X,re=null,w=function(x){return(0,l.jsx)(V,h()(h()({},x),{},{language:"javascript"}))},q=w,_=e(16414),t=function(x){return(0,L.useEffect)(function(){S._m.config({monaco:_})},[]),(0,l.jsx)(m.ZP,h()({widgets:{json:k,js:q}},x))},se=t,ee=t||se},19435:function(de,A,e){e.d(A,{O:function(){return F},A:function(){return R.Z}});var R=e(83195),h=e(54306),m=e.n(h),O=e(8049),Q=e(14990),U=e(22465),Z=e(5671),d=e(17696),S=e(19227),P=e(75476),p=e(1167),B=e(22150),L=e(40767),y=e(50720),a=e(58856),f=e(22983),c=e(39092),l=e(75904),K=e(86965),r=e(87363),V=e.n(r),le=e(10486),X=e(14232),k=e(37555),re=e(59998),w=e(72107),q=e(87093),_=e(23620),t=e(33130),se=V().createContext({logic:new w.Iz("")}),ee=function(n){var J,u=(0,r.useState)(),z=m()(u,2),o=z[0],$=z[1],H=(0,r.useState)(),I=m()(H,2),g=I[0],N=I[1],T=(0,r.useState)(!1),G=m()(T,2),ue=G[0],ve=G[1],te=(0,r.useState)(!0),Y=m()(te,2),b=Y[0],W=Y[1],ne=(0,r.useState)(),D=m()(ne,2),oe=D[0],ce=D[1],je=(0,r.useState)(),fe=m()(je,2),E=fe[0],Se=fe[1],Le=(0,r.useState)(),ge=m()(Le,2),ie=ge[0],Pe=ge[1],Ie=(0,r.useState)(),he=m()(Ie,2),Ne=he[0],me=he[1],Fe=(0,r.useState)(),xe=m()(Fe,2),Ze=xe[0],be=xe[1],ye=(0,r.useRef)(),Ce=function(j){var v=j.node;me(v);var i=E==null?void 0:E.itemLogs.find(function(C){return C.config.id==v.id});ce(i)};(0,r.useEffect)(function(){ie&&(o==null||o.centerCell(ie))},[ie,o]),(0,r.useEffect)(function(){console.log("play curItemLog",oe)},[oe]),(0,r.useEffect)(function(){var s=o==null?void 0:o.getNodes().find(function(j){return j.id==n.nextId});s==null||s.attr("body/fill","red"),Pe(s)},[n.nextId]),(0,r.useEffect)(function(){var s;o==null||(s=o.getNodes().find(function(j){return j.id==n.nextId}))===null||s===void 0||s.attr("body/fill","red")},[o]),(0,r.useEffect)(function(){n.config&&N(n.config)},[n.config]),(0,r.useEffect)(function(){var s,j;console.log("props.debugLogs",n.debugLogs),((s=n.debugLogs)===null||s===void 0?void 0:s.length)>0&&setInterval(De,2e3);var v=[];n&&((j=n.debugLogs)===null||j===void 0||j.forEach(function(i){var C,M;v.push({children:(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("span",{style:{cursor:"pointer",fontWeight:i.id==(E==null?void 0:E.id)?"bolder":"normal",color:i.id==(E==null?void 0:E.id)?"#52c41a":"black"},onClick:function(){Se(i),console.log(i),o==null||o.fromJSON(g==null?void 0:g.visualConfig);var Ee;i.itemLogs.forEach(function(Ae){var ae=o==null?void 0:o.getNodes().find(function(Re){return Re.id==Ae.config.id});ae&&(ae.attr("body/fill","#52c41a"),Ee=ae)}),o==null||o.centerCell(Ee),ce({}),me({})},children:[(0,t.jsx)("p",{children:(C=i.itemLogs[0])===null||C===void 0?void 0:C.config.name}),((M=n.logicIns)===null||M===void 0?void 0:M.version)==i.version?(0,t.jsx)("p",{}):(0,t.jsx)("p",{children:(0,t.jsxs)(L.Z,{children:[(0,t.jsx)(y.Z.Paragraph,{style:{color:"red"},children:"\u7248\u672C\u53F7:"}),(0,t.jsxs)(y.Z.Paragraph,{copyable:{tooltips:["\u70B9\u51FB\u590D\u5236","\u590D\u5236\u6210\u529F!"],text:i.version},children:[i.version,(0,t.jsx)(y.Z.Link,{style:{margin:"5px"},href:"#/assets/logic/i/".concat(i.logicId,"/view/").concat(i.version),target:"_blank",children:(0,t.jsx)(O.Z,{})})]})]})}),(0,t.jsxs)("p",{children:["\u4E1A\u52A1\u6807\u8BC6\uFF1A",i.bizId]}),(0,t.jsx)("p",{children:i.serverTime}),(0,t.jsx)("p",{children:i.message})]})}),color:i.success?"green":"red"})})),be(v)},[n.debugLogs,n.logicIns,o,E]),(0,r.useEffect)(function(){if(g){try{var s=(0,le.K)(),j=s.Shapes;(0,X.m)(j)}catch(i){console.error("\u6CE8\u518C\u8282\u70B9\u51FA\u9519\uFF1A"),console.error(i)}var v=new Z.kJ({container:ye.current,embedding:{enabled:!0,validate:function(C){return C.child.setData({hoverNode:C.parent}),!0}},mousewheel:{enabled:!0,modifiers:"ctrl",minScale:.5,maxScale:3},connecting:{router:"manhattan",connector:{name:"rounded",args:{radius:15}},anchor:"center",connectionPoint:"anchor",allowBlank:!1,allowMulti:!0,snap:{radius:20},createEdge:function(){return new Z.bn.kS({tools:[{name:"edge-editor",args:{attrs:{backgroundColor:"#fff"}}}],zIndex:0})},validateConnection:function(C){var M=C.targetMagnet;return!!M}},highlighting:{magnetAdsorbed:{name:"stroke",args:{attrs:{fill:"#5F95FF",stroke:"#5F95FF"}}}},background:{color:"#F2F7FA"},grid:!0});v.use(new p.H({enabled:!0,sharp:!0})).use(new d.A({enabled:!0})).use(new P.Y({enabled:!0,multiple:!0,strict:!0,rubberband:!0,movable:!0,showNodeSelectionBox:!0,pointerEvents:"none"})).use(new B.T({enabled:!0})).use(new S.N),v.on("edge:dblclick",function(){}),v.on("edge:mouseenter",function(){}),v.on("edge:mouseleave",function(){}),v.on("node:moved",function(){}),v.on("node:mouseenter",function(){}),v.on("node:mouseleave",function(){}),v.on("node:added",function(){}),v.on("node:dblclick",function(i){var C=i.node;W(!1)}),v.on("blank:dblclick",function(i){var C=i.x,M=i.y}),v.fromJSON(g.visualConfig),(0,re.V)(v),$(v)}},[g]),(0,r.useEffect)(function(){o==null||o.off("node:click",Ce),o==null||o.on("node:click",Ce)},[E]);var De=function(){},Me=[{key:"1",label:"\u65E5\u5FD7",children:(0,t.jsx)(_.gcu,{src:oe})},{key:"2",label:"\u8282\u70B9\u914D\u7F6E",children:(0,t.jsx)(q.Z,{editNode:Ne,configSchemaProvider:n.configSchemaProvider})}];return(0,t.jsxs)(a.Z,{style:{margin:0,height:"100vh"},children:[(0,t.jsxs)(a.Z.Sider,{theme:"light",collapsedWidth:0,width:300,style:{overflow:"auto",height:"100vh",position:"fixed",left:0,top:0,bottom:0,borderRight:"0.5px solid"},children:[(0,t.jsx)(f.Z,{children:"\u6700\u8FD1\u8BF7\u6C42"}),(0,t.jsx)(c.Z,{style:{height:"100%"},items:Ze})]}),(0,t.jsxs)(a.Z,{style:{marginLeft:300},children:[(0,t.jsxs)(a.Z.Header,{style:{backgroundColor:"white",padding:0},children:[(0,t.jsxs)(L.Z,{direction:"horizontal",style:{},children:[(0,t.jsx)(f.Z,{type:"vertical"}),(J=n.btns)===null||J===void 0?void 0:J.map(function(s){return s})]}),(0,t.jsx)(l.ZP,{type:"text",icon:b?(0,t.jsx)(Q.Z,{}):(0,t.jsx)(U.Z,{}),onClick:function(){W(!b)},style:{float:"right",right:"16px",fontSize:"16px",width:64,height:64}})]}),(0,t.jsx)(a.Z.Content,{className:"app-content",children:(0,t.jsx)(k.Z,{ref:ye})})]}),(0,t.jsxs)(a.Z.Sider,{theme:"light",collapsed:b,collapsedWidth:0,style:{overflow:"scroll"},title:"ddd",width:500,children:[(0,t.jsx)(l.ZP,{type:"text",onClick:function(){W(!b)},style:{float:"right",fontSize:"16px",width:64,height:64},children:"x"}),(0,t.jsx)(K.Z,{items:Me,defaultActiveKey:"1"})]})]})},F=ee},87093:function(de,A,e){var R=e(57213),h=e.n(R),m=e(788),O=e(87363),Q=e.n(O),U=e(23542),Z=e(33130);A.Z=function(d){var S,P=(0,m.cI)(),p=d.configSchemaProvider,B=function(a){var f,c,l;(f=d.editNode)===null||f===void 0||f.setAttrByPath("text/text",a.name);var K=(c=d.editNode)===null||c===void 0?void 0:c.data.config;d.editNode&&d.editNode.setData({config:h()(h()({},K),a)}),console.log("submit---props.editNode.data.config"),console.log((l=d.editNode)===null||l===void 0?void 0:l.data.config),d==null||d.onSubmit()},L=function(a){if(a&&a.data){var f,c=a.data.config||{},l=a.attrs;return c.name=l==null||(f=l.text)===null||f===void 0?void 0:f.text,c}else return{name:""}};return(0,O.useEffect)(function(){if(d.editNode&&d.editNode.data){var y=d.editNode.data.config||{};p(d.editNode.data.configSchema||y.type).then(function(a){var f,c=d.editNode.attrs;y.name=c==null||(f=c.text)===null||f===void 0?void 0:f.text,console.log("nodeConfigSchema"),console.log(a),P.setSchema(a,!0),P.resetFields(),P.setValues(y)})}},[d.editNode,(S=d.editNode)===null||S===void 0?void 0:S.data]),(0,Z.jsx)("div",{children:(0,Z.jsx)(U.Z,{form:P,onFinish:B,onReset:function(){var a=L(d.editNode);P.setValues(a)},footer:!!d.onSubmit})})}}}]);
